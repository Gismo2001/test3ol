var o5=Object.defineProperty;var l5=(i,t,e)=>t in i?o5(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var Tp=(i,t,e)=>(l5(i,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function e(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=e(r);fetch(r.href,s)}})();class Nr{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}const El={PROPERTYCHANGE:"propertychange"};class Rf{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function h5(i,t,e){let n,r;e=e||Rs;let s=0,a=i.length,o=!1;for(;s<a;)n=s+(a-s>>1),r=+e(i[n],t),r<0?s=n+1:(a=n,o=!r);return o?s:~s}function Rs(i,t){return i>t?1:i<t?-1:0}function F0(i,t,e){if(i[0]<=t)return 0;const n=i.length;if(t<=i[n-1])return n-1;if(typeof e=="function"){for(let r=1;r<n;++r){const s=i[r];if(s===t)return r;if(s<t)return e(t,i[r-1],s)>0?r-1:r}return n-1}if(e>0){for(let r=1;r<n;++r)if(i[r]<t)return r-1;return n-1}if(e<0){for(let r=1;r<n;++r)if(i[r]<=t)return r;return n-1}for(let r=1;r<n;++r){if(i[r]==t)return r;if(i[r]<t)return i[r-1]-t<t-i[r]?r-1:r}return n-1}function c5(i,t,e){for(;t<e;){const n=i[t];i[t]=i[e],i[e]=n,++t,--e}}function $n(i,t){const e=Array.isArray(t)?t:[t],n=e.length;for(let r=0;r<n;r++)i[i.length]=e[r]}function Os(i,t){const e=i.length;if(e!==t.length)return!1;for(let n=0;n<e;n++)if(i[n]!==t[n])return!1;return!0}function u5(i,t,e){const n=t||Rs;return i.every(function(r,s){if(s===0)return!0;const a=n(i[s-1],r);return!(a>0||e&&a===0)})}function _a(){return!0}function Nl(){return!1}function Sl(){}function T2(i){let t=!1,e,n,r;return function(){const s=Array.prototype.slice.call(arguments);return(!t||this!==r||!Os(s,n))&&(t=!0,r=this,n=s,e=i.apply(this,arguments)),e}}function ro(i){for(const t in i)delete i[t]}function Qa(i){let t;for(t in i)return!1;return!t}class Nf extends Rf{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const n=this.listeners_||(this.listeners_={}),r=n[t]||(n[t]=[]);r.includes(e)||r.push(e)}dispatchEvent(t){const e=typeof t=="string",n=e?t:t.type,r=this.listeners_&&this.listeners_[n];if(!r)return;const s=e?new Nr(t):t;s.target||(s.target=this.eventTarget_||this);const a=this.dispatching_||(this.dispatching_={}),o=this.pendingRemovals_||(this.pendingRemovals_={});n in a||(a[n]=0,o[n]=0),++a[n];let l;for(let h=0,c=r.length;h<c;++h)if("handleEvent"in r[h]?l=r[h].handleEvent(s):l=r[h].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--a[n]===0){let h=o[n];for(delete o[n];h--;)this.removeEventListener(n,Sl);delete a[n]}return l}disposeInternal(){this.listeners_&&ro(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(t,e){if(!this.listeners_)return;const n=this.listeners_[t];if(!n)return;const r=n.indexOf(e);r!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[r]=Sl,++this.pendingRemovals_[t]):(n.splice(r,1),n.length===0&&delete this.listeners_[t]))}}const le={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function _e(i,t,e,n,r){if(n&&n!==i&&(e=e.bind(n)),r){const a=e;e=function(){i.removeEventListener(t,e),a.apply(this,arguments)}}const s={target:i,type:t,listener:e};return i.addEventListener(t,e),s}function Ju(i,t,e,n){return _e(i,t,e,n,!0)}function Ke(i){i&&i.target&&(i.target.removeEventListener(i.type,i.listener),ro(i))}class uc extends Nf{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(le.CHANGE)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const n=t.length,r=new Array(n);for(let s=0;s<n;++s)r[s]=_e(this,t[s],e);return r}return _e(this,t,e)}onceInternal(t,e){let n;if(Array.isArray(t)){const r=t.length;n=new Array(r);for(let s=0;s<r;++s)n[s]=Ju(this,t[s],e)}else n=Ju(this,t,e);return e.ol_key=n,n}unInternal(t,e){const n=e.ol_key;if(n)qh(n);else if(Array.isArray(t))for(let r=0,s=t.length;r<s;++r)this.removeEventListener(t[r],e);else this.removeEventListener(t,e)}}uc.prototype.on;uc.prototype.once;uc.prototype.un;function qh(i){if(Array.isArray(i))for(let t=0,e=i.length;t<e;++t)Ke(i[t]);else Ke(i)}function ae(){throw new Error("Unimplemented abstract method.")}let f5=0;function Qt(i){return i.ol_uid||(i.ol_uid=String(++f5))}class Pp extends Nr{constructor(t,e,n){super(t),this.key=e,this.oldValue=n}}class Qn extends uc{constructor(t){super(),this.on,this.once,this.un,Qt(this),this.values_=null,t!==void 0&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let n;n=`change:${t}`,this.hasListener(n)&&this.dispatchEvent(new Pp(n,t,e)),n=El.PROPERTYCHANGE,this.hasListener(n)&&this.dispatchEvent(new Pp(n,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,n){const r=this.values_||(this.values_={});if(n)r[t]=e;else{const s=r[t];r[t]=e,s!==e&&this.notify(t,s)}}setProperties(t,e){for(const n in t)this.set(n,t[n],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const n=this.values_[t];delete this.values_[t],Qa(this.values_)&&(this.values_=null),e||this.notify(t,n)}}}const Yi={ADD:"add",REMOVE:"remove"},Ip={LENGTH:"length"};class du extends Nr{constructor(t,e,n){super(t),this.element=e,this.index=n}}class Tr extends Qn{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let n=0,r=this.array_.length;n<r;++n)this.assertUnique_(this.array_[n],n);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,n=t.length;e<n;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let n=0,r=e.length;n<r;++n)t(e[n],n,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(Ip.LENGTH)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new du(Yi.ADD,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let n=0,r=e.length;n<r;++n)if(e[n]===t)return this.removeAt(n)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new du(Yi.REMOVE,e,t)),e}setAt(t,e){const n=this.getLength();if(t>=n){this.insertAt(t,e);return}if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const r=this.array_[t];this.array_[t]=e,this.dispatchEvent(new du(Yi.REMOVE,r,t)),this.dispatchEvent(new du(Yi.ADD,e,t))}updateLength_(){this.set(Ip.LENGTH,this.array_.length)}assertUnique_(t,e){for(let n=0,r=this.array_.length;n<r;++n)if(this.array_[n]===t&&n!==e)throw new Error("Duplicate item added to a unique collection")}}const Be={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};function Ce(i,t){if(!i)throw new Error(t)}function hi(i,t,e){return Math.min(Math.max(i,t),e)}function d5(i,t,e,n,r,s){const a=r-e,o=s-n;if(a!==0||o!==0){const l=((i-e)*a+(t-n)*o)/(a*a+o*o);l>1?(e=r,n=s):l>0&&(e+=a*l,n+=o*l)}return Ms(i,t,e,n)}function Ms(i,t,e,n){const r=e-i,s=n-t;return r*r+s*s}function g5(i){const t=i.length;for(let n=0;n<t;n++){let r=n,s=Math.abs(i[n][n]);for(let o=n+1;o<t;o++){const l=Math.abs(i[o][n]);l>s&&(s=l,r=o)}if(s===0)return null;const a=i[r];i[r]=i[n],i[n]=a;for(let o=n+1;o<t;o++){const l=-i[o][n]/i[n][n];for(let h=n;h<t+1;h++)n==h?i[o][h]=0:i[o][h]+=l*i[n][h]}}const e=new Array(t);for(let n=t-1;n>=0;n--){e[n]=i[n][t]/i[n][n];for(let r=n-1;r>=0;r--)i[r][t]-=i[r][n]*e[n]}return e}function Rp(i){return i*180/Math.PI}function Ts(i){return i*Math.PI/180}function Za(i,t){const e=i%t;return e*t<0?e+t:e}function Zn(i,t,e){return i+e*(t-i)}function fc(i,t){const e=Math.pow(10,t);return Math.round(i*e)/e}function Np(i,t){return Math.round(fc(i,t))}function gu(i,t){return Math.floor(fc(i,t))}function pu(i,t){return Math.ceil(fc(i,t))}class P2 extends Qn{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);typeof t.properties=="object"&&(delete e.properties,Object.assign(e,t.properties)),e[Be.OPACITY]=t.opacity!==void 0?t.opacity:1,Ce(typeof e[Be.OPACITY]=="number","Layer opacity must be a number"),e[Be.VISIBLE]=t.visible!==void 0?t.visible:!0,e[Be.Z_INDEX]=t.zIndex,e[Be.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,e[Be.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,e[Be.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,e[Be.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,this.className_=e.className!==void 0?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:t===void 0?!0:t},n=this.getZIndex();return e.opacity=hi(Math.round(this.getOpacity()*100)/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=n===void 0&&!e.managed?1/0:n,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return ae()}getLayerStatesArray(t){return ae()}getExtent(){return this.get(Be.EXTENT)}getMaxResolution(){return this.get(Be.MAX_RESOLUTION)}getMinResolution(){return this.get(Be.MIN_RESOLUTION)}getMinZoom(){return this.get(Be.MIN_ZOOM)}getMaxZoom(){return this.get(Be.MAX_ZOOM)}getOpacity(){return this.get(Be.OPACITY)}getSourceState(){return ae()}getVisible(){return this.get(Be.VISIBLE)}getZIndex(){return this.get(Be.Z_INDEX)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(Be.EXTENT,t)}setMaxResolution(t){this.set(Be.MAX_RESOLUTION,t)}setMinResolution(t){this.set(Be.MIN_RESOLUTION,t)}setMaxZoom(t){this.set(Be.MAX_ZOOM,t)}setMinZoom(t){this.set(Be.MIN_ZOOM,t)}setOpacity(t){Ce(typeof t=="number","Layer opacity must be a number"),this.set(Be.OPACITY,t)}setVisible(t){this.set(Be.VISIBLE,t)}setZIndex(t){this.set(Be.Z_INDEX,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}const Zi={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},ri={ANIMATING:0,INTERACTING:1},Sr={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},p5=42,O0=256,Uh={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let m5=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Uh[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const k0=m5,dc=6378137,il=Math.PI*dc,_5=[-il,-il,il,il],v5=[-180,-85,180,85],mu=dc*Math.log(Math.tan(Math.PI/2));class jo extends k0{constructor(t){super({code:t,units:"m",extent:_5,global:!0,worldExtent:v5,getPointResolution:function(e,n){return e/Math.cosh(n[1]/dc)}})}}const Fp=[new jo("EPSG:3857"),new jo("EPSG:102100"),new jo("EPSG:102113"),new jo("EPSG:900913"),new jo("http://www.opengis.net/def/crs/EPSG/0/3857"),new jo("http://www.opengis.net/gml/srs/epsg.xml#3857")];function y5(i,t,e){const n=i.length;e=e>1?e:2,t===void 0&&(e>2?t=i.slice():t=new Array(n));for(let r=0;r<n;r+=e){t[r]=il*i[r]/180;let s=dc*Math.log(Math.tan(Math.PI*(+i[r+1]+90)/360));s>mu?s=mu:s<-mu&&(s=-mu),t[r+1]=s}return t}function x5(i,t,e){const n=i.length;e=e>1?e:2,t===void 0&&(e>2?t=i.slice():t=new Array(n));for(let r=0;r<n;r+=e)t[r]=180*i[r]/il,t[r+1]=360*Math.atan(Math.exp(i[r+1]/dc))/Math.PI-90;return t}const b5=6378137,Op=[-180,-90,180,90],w5=Math.PI*b5/180;class ja extends k0{constructor(t,e){super({code:t,units:"degrees",extent:Op,axisOrientation:e,global:!0,metersPerUnit:w5,worldExtent:Op})}}const kp=[new ja("CRS:84"),new ja("EPSG:4326","neu"),new ja("urn:ogc:def:crs:OGC:1.3:CRS84"),new ja("urn:ogc:def:crs:OGC:2:84"),new ja("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new ja("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new ja("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Bg={};function E5(i){return Bg[i]||Bg[i.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function S5(i,t){Bg[i]=t}let dl={};function Ll(i,t,e){const n=i.getCode(),r=t.getCode();n in dl||(dl[n]={}),dl[n][r]=e}function I2(i,t){let e;return i in dl&&t in dl[i]&&(e=dl[i][t]),e}const Hi={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function Qu(i){const t=Dn();for(let e=0,n=i.length;e<n;++e)Rh(t,i[e]);return t}function L5(i,t,e){const n=Math.min.apply(null,i),r=Math.min.apply(null,t),s=Math.max.apply(null,i),a=Math.max.apply(null,t);return is(n,r,s,a,e)}function va(i,t,e){return e?(e[0]=i[0]-t,e[1]=i[1]-t,e[2]=i[2]+t,e[3]=i[3]+t,e):[i[0]-t,i[1]-t,i[2]+t,i[3]+t]}function R2(i,t){return t?(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t):i.slice()}function so(i,t,e){let n,r;return t<i[0]?n=i[0]-t:i[2]<t?n=t-i[2]:n=0,e<i[1]?r=i[1]-e:i[3]<e?r=e-i[3]:r=0,n*n+r*r}function ya(i,t){return D0(i,t[0],t[1])}function As(i,t){return i[0]<=t[0]&&t[2]<=i[2]&&i[1]<=t[1]&&t[3]<=i[3]}function D0(i,t,e){return i[0]<=t&&t<=i[2]&&i[1]<=e&&e<=i[3]}function Gg(i,t){const e=i[0],n=i[1],r=i[2],s=i[3],a=t[0],o=t[1];let l=Hi.UNKNOWN;return a<e?l=l|Hi.LEFT:a>r&&(l=l|Hi.RIGHT),o<n?l=l|Hi.BELOW:o>s&&(l=l|Hi.ABOVE),l===Hi.UNKNOWN&&(l=Hi.INTERSECTING),l}function Dn(){return[1/0,1/0,-1/0,-1/0]}function is(i,t,e,n,r){return r?(r[0]=i,r[1]=t,r[2]=e,r[3]=n,r):[i,t,e,n]}function Fl(i){return is(1/0,1/0,-1/0,-1/0,i)}function N2(i,t){const e=i[0],n=i[1];return is(e,n,e,n,t)}function j0(i,t,e,n,r){const s=Fl(r);return O2(s,i,t,e,n)}function to(i,t){return i[0]==t[0]&&i[2]==t[2]&&i[1]==t[1]&&i[3]==t[3]}function F2(i,t){return t[0]<i[0]&&(i[0]=t[0]),t[2]>i[2]&&(i[2]=t[2]),t[1]<i[1]&&(i[1]=t[1]),t[3]>i[3]&&(i[3]=t[3]),i}function Rh(i,t){t[0]<i[0]&&(i[0]=t[0]),t[0]>i[2]&&(i[2]=t[0]),t[1]<i[1]&&(i[1]=t[1]),t[1]>i[3]&&(i[3]=t[1])}function O2(i,t,e,n,r){for(;e<n;e+=r)C5(i,t[e],t[e+1]);return i}function C5(i,t,e){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}function B0(i,t){let e;return e=t(Ff(i)),e||(e=t(Of(i)),e)||(e=t(kf(i)),e)||(e=t(Aa(i)),e)?e:!1}function zg(i){let t=0;return Ol(i)||(t=Re(i)*en(i)),t}function Ff(i){return[i[0],i[1]]}function Of(i){return[i[2],i[1]]}function xa(i){return[(i[0]+i[2])/2,(i[1]+i[3])/2]}function A5(i,t){let e;if(t==="bottom-left")e=Ff(i);else if(t==="bottom-right")e=Of(i);else if(t==="top-left")e=Aa(i);else if(t==="top-right")e=kf(i);else throw new Error("Invalid corner");return e}function qg(i,t,e,n,r){const[s,a,o,l,h,c,f,g]=Ug(i,t,e,n);return is(Math.min(s,o,h,f),Math.min(a,l,c,g),Math.max(s,o,h,f),Math.max(a,l,c,g),r)}function Ug(i,t,e,n){const r=t*n[0]/2,s=t*n[1]/2,a=Math.cos(e),o=Math.sin(e),l=r*a,h=r*o,c=s*a,f=s*o,g=i[0],d=i[1];return[g-l+f,d-h-c,g-l-f,d-h+c,g+l-f,d+h+c,g+l+f,d+h-c,g-l+f,d-h-c]}function en(i){return i[3]-i[1]}function Ka(i,t,e){const n=e||Dn();return ki(i,t)?(i[0]>t[0]?n[0]=i[0]:n[0]=t[0],i[1]>t[1]?n[1]=i[1]:n[1]=t[1],i[2]<t[2]?n[2]=i[2]:n[2]=t[2],i[3]<t[3]?n[3]=i[3]:n[3]=t[3]):Fl(n),n}function Aa(i){return[i[0],i[3]]}function kf(i){return[i[2],i[3]]}function Re(i){return i[2]-i[0]}function ki(i,t){return i[0]<=t[2]&&i[2]>=t[0]&&i[1]<=t[3]&&i[3]>=t[1]}function Ol(i){return i[2]<i[0]||i[3]<i[1]}function M5(i,t){return t?(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t):i}function T5(i,t,e){let n=!1;const r=Gg(i,t),s=Gg(i,e);if(r===Hi.INTERSECTING||s===Hi.INTERSECTING)n=!0;else{const a=i[0],o=i[1],l=i[2],h=i[3],c=t[0],f=t[1],g=e[0],d=e[1],m=(d-f)/(g-c);let y,b;s&Hi.ABOVE&&!(r&Hi.ABOVE)&&(y=g-(d-h)/m,n=y>=a&&y<=l),!n&&s&Hi.RIGHT&&!(r&Hi.RIGHT)&&(b=d-(g-l)*m,n=b>=o&&b<=h),!n&&s&Hi.BELOW&&!(r&Hi.BELOW)&&(y=g-(d-o)/m,n=y>=a&&y<=l),!n&&s&Hi.LEFT&&!(r&Hi.LEFT)&&(b=d-(g-a)*m,n=b>=o&&b<=h)}return n}function P5(i,t,e,n){if(Ol(i))return Fl(e);let r=[];if(n>1){const o=i[2]-i[0],l=i[3]-i[1];for(let h=0;h<n;++h)r.push(i[0]+o*h/n,i[1],i[2],i[1]+l*h/n,i[2]-o*h/n,i[3],i[0],i[3]-l*h/n)}else r=[i[0],i[1],i[2],i[1],i[2],i[3],i[0],i[3]];t(r,r,2);const s=[],a=[];for(let o=0,l=r.length;o<l;o+=2)s.push(r[o]),a.push(r[o+1]);return L5(s,a,e)}function k2(i,t){const e=t.getExtent(),n=xa(i);if(t.canWrapX()&&(n[0]<e[0]||n[0]>=e[2])){const r=Re(e),a=Math.floor((n[0]-e[0])/r)*r;i[0]-=a,i[2]-=a}return i}function I5(i,t){if(t.canWrapX()){const e=t.getExtent();if(!isFinite(i[0])||!isFinite(i[2]))return[[e[0],i[1],e[2],i[3]]];k2(i,t);const n=Re(e);if(Re(i)>n)return[[e[0],i[1],e[2],i[3]]];if(i[0]<e[0])return[[i[0]+n,i[1],e[2],i[3]],[e[0],i[1],i[2],i[3]]];if(i[2]>e[2])return[[i[0],i[1],e[2],i[3]],[e[0],i[1],i[2]-n,i[3]]]}return[i]}function D2(i,t){const e=(""+i).split("."),n=(""+t).split(".");for(let r=0;r<Math.max(e.length,n.length);r++){const s=parseInt(e[r]||"0",10),a=parseInt(n[r]||"0",10);if(s>a)return 1;if(a>s)return-1}return 0}function R5(i,t){return i[0]+=+t[0],i[1]+=+t[1],i}function $a(i){return function(t){return O5(t,i)}}function N5(i,t,e){return i?t.replace("{x}",i[0].toFixed(e)).replace("{y}",i[1].toFixed(e)):""}function tf(i,t){let e=!0;for(let n=i.length-1;n>=0;--n)if(i[n]!=t[n]){e=!1;break}return e}function G0(i,t){const e=Math.cos(t),n=Math.sin(t),r=i[0]*e-i[1]*n,s=i[1]*e+i[0]*n;return i[0]=r,i[1]=s,i}function F5(i,t){return i[0]*=t,i[1]*=t,i}function j2(i,t){const e=i[0]-t[0],n=i[1]-t[1];return e*e+n*n}function B2(i,t){return Math.sqrt(j2(i,t))}function O5(i,t){return N5(i,"{x}, {y}",t)}function Df(i,t){if(t.canWrapX()){const e=Re(t.getExtent()),n=G2(i,t,e);n&&(i[0]-=n*e)}return i}function G2(i,t,e){const n=t.getExtent();let r=0;return t.canWrapX()&&(i[0]<n[0]||i[0]>n[2])&&(e=e||Re(n),r=Math.floor((i[0]-n[0])/e)),r}const jf=63710088e-1;function Wg(i,t,e){e=e||jf;const n=Ts(i[1]),r=Ts(t[1]),s=(r-n)/2,a=Ts(t[0]-i[0])/2,o=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(n)*Math.cos(r);return 2*e*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))}function Qd(i,t){let e=0;for(let n=0,r=i.length;n<r-1;++n)e+=Wg(i[n],i[n+1],t);return e}function z2(i,t){t=t||{};const e=t.radius||jf,n=t.projection||"EPSG:3857",r=i.getType();r!=="GeometryCollection"&&(i=i.clone().transform(n,"EPSG:4326"));let s=0,a,o,l,h,c,f;switch(r){case"Point":case"MultiPoint":break;case"LineString":case"LinearRing":{a=i.getCoordinates(),s=Qd(a,e);break}case"MultiLineString":case"Polygon":{for(a=i.getCoordinates(),l=0,h=a.length;l<h;++l)s+=Qd(a[l],e);break}case"MultiPolygon":{for(a=i.getCoordinates(),l=0,h=a.length;l<h;++l)for(o=a[l],c=0,f=o.length;c<f;++c)s+=Qd(o[c],e);break}case"GeometryCollection":{const g=i.getGeometries();for(l=0,h=g.length;l<h;++l)s+=z2(g[l],t);break}default:throw new Error("Unsupported geometry type: "+r)}return s}function _u(i,t){let e=0;const n=i.length;let r=i[n-1][0],s=i[n-1][1];for(let a=0;a<n;a++){const o=i[a][0],l=i[a][1];e+=Ts(o-r)*(2+Math.sin(Ts(s))+Math.sin(Ts(l))),r=o,s=l}return e*t*t/2}function q2(i,t){t=t||{};const e=t.radius||jf,n=t.projection||"EPSG:3857",r=i.getType();r!=="GeometryCollection"&&(i=i.clone().transform(n,"EPSG:4326"));let s=0,a,o,l,h,c,f;switch(r){case"Point":case"MultiPoint":case"LineString":case"MultiLineString":case"LinearRing":break;case"Polygon":{for(a=i.getCoordinates(),s=Math.abs(_u(a[0],e)),l=1,h=a.length;l<h;++l)s-=Math.abs(_u(a[l],e));break}case"MultiPolygon":{for(a=i.getCoordinates(),l=0,h=a.length;l<h;++l)for(o=a[l],s+=Math.abs(_u(o[0],e)),c=1,f=o.length;c<f;++c)s-=Math.abs(_u(o[c],e));break}case"GeometryCollection":{const g=i.getGeometries();for(l=0,h=g.length;l<h;++l)s+=q2(g[l],t);break}default:throw new Error("Unsupported geometry type: "+r)}return s}function k5(i,t,e,n){n=n||jf;const r=Ts(i[1]),s=Ts(i[0]),a=t/n,o=Math.asin(Math.sin(r)*Math.cos(a)+Math.cos(r)*Math.sin(a)*Math.cos(e)),l=s+Math.atan2(Math.sin(e)*Math.sin(a)*Math.cos(r),Math.cos(a)-Math.sin(r)*Math.sin(o));return[Rp(l),Rp(o)]}function U2(...i){console.warn(...i)}let Vg=!0;function W2(i){Vg=!(i===void 0?!0:i)}function z0(i,t){if(t!==void 0){for(let e=0,n=i.length;e<n;++e)t[e]=i[e];t=t}else t=i.slice();return t}function q0(i,t){if(t!==void 0&&i!==t){for(let e=0,n=i.length;e<n;++e)t[e]=i[e];i=t}return i}function V2(i){S5(i.getCode(),i),Ll(i,i,z0)}function D5(i){i.forEach(V2)}function ti(i){return typeof i=="string"?E5(i):i||null}function Dp(i,t,e,n){i=ti(i);let r;const s=i.getPointResolutionFunc();if(s){if(r=s(t,e),n&&n!==i.getUnits()){const a=i.getMetersPerUnit();a&&(r=r*a/Uh[n])}}else{const a=i.getUnits();if(a=="degrees"&&!n||n=="degrees")r=t;else{const o=gc(i,ti("EPSG:4326"));if(o===q0&&a!=="degrees")r=t*i.getMetersPerUnit();else{let h=[e[0]-t/2,e[1],e[0]+t/2,e[1],e[0],e[1]-t/2,e[0],e[1]+t/2];h=o(h,h,2);const c=Wg(h.slice(0,2),h.slice(2,4)),f=Wg(h.slice(4,6),h.slice(6,8));r=(c+f)/2}const l=n?Uh[n]:i.getMetersPerUnit();l!==void 0&&(r/=l)}}return r}function Hg(i){D5(i),i.forEach(function(t){i.forEach(function(e){t!==e&&Ll(t,e,z0)})})}function j5(i,t,e,n){i.forEach(function(r){t.forEach(function(s){Ll(r,s,e),Ll(s,r,n)})})}function U0(i,t){return i?typeof i=="string"?ti(i):i:ti(t)}function jp(i){return function(t,e,n){const r=t.length;n=n!==void 0?n:2,e=e!==void 0?e:new Array(r);for(let s=0;s<r;s+=n){const a=i(t.slice(s,s+n)),o=a.length;for(let l=0,h=n;l<h;++l)e[s+l]=l>=o?t[s+l]:a[l]}return e}}function B5(i,t,e,n){const r=ti(i),s=ti(t);Ll(r,s,jp(e)),Ll(s,r,jp(n))}function H2(i,t){return W2(),ba(i,"EPSG:4326",t!==void 0?t:"EPSG:3857")}function qa(i,t){if(i===t)return!0;const e=i.getUnits()===t.getUnits();return(i.getCode()===t.getCode()||gc(i,t)===z0)&&e}function gc(i,t){const e=i.getCode(),n=t.getCode();let r=I2(e,n);return r||(r=q0),r}function Cl(i,t){const e=ti(i),n=ti(t);return gc(e,n)}function ba(i,t,e){return Cl(t,e)(i,void 0,i.length)}function G5(i,t,e,n){const r=Cl(t,e);return P5(i,r,void 0,n)}let z5=null;function q5(){return z5}function Xg(i,t){return i}function Mr(i,t){return Vg&&!tf(i,[0,0])&&i[0]>=-180&&i[0]<=180&&i[1]>=-90&&i[1]<=90&&(Vg=!1,U2("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),i}function W0(i,t){return i}function Yr(i,t){return i}function Bp(i,t,e){return function(n){let r,s;if(i.canWrapX()){const a=i.getExtent(),o=Re(a);n=n.slice(0),s=G2(n,i,o),s&&(n[0]=n[0]-s*o),n[0]=hi(n[0],a[0],a[2]),n[1]=hi(n[1],a[1],a[3]),r=e(n)}else r=e(n);return s&&t.canWrapX()&&(r[0]+=s*Re(t.getExtent())),r}}function U5(){Hg(Fp),Hg(kp),j5(kp,Fp,y5,x5)}U5();function Gp(i,t,e){return function(n,r,s,a,o){if(!n)return;if(!r&&!t)return n;const l=t?0:s[0]*r,h=t?0:s[1]*r,c=o?o[0]:0,f=o?o[1]:0;let g=i[0]+l/2+c,d=i[2]-l/2+c,m=i[1]+h/2+f,y=i[3]-h/2+f;g>d&&(g=(d+g)/2,d=g),m>y&&(m=(y+m)/2,y=m);let b=hi(n[0],g,d),x=hi(n[1],m,y);if(a&&e&&r){const E=30*r;b+=-E*Math.log(1+Math.max(0,g-n[0])/E)+E*Math.log(1+Math.max(0,n[0]-d)/E),x+=-E*Math.log(1+Math.max(0,m-n[1])/E)+E*Math.log(1+Math.max(0,n[1]-y)/E)}return[b,x]}}function W5(i){return i}function V0(i,t,e,n){const r=Re(t)/e[0],s=en(t)/e[1];return n?Math.min(i,Math.max(r,s)):Math.min(i,Math.min(r,s))}function H0(i,t,e){let n=Math.min(i,t);const r=50;return n*=Math.log(1+r*Math.max(0,i/t-1))/r+1,e&&(n=Math.max(n,e),n/=Math.log(1+r*Math.max(0,e/i-1))/r+1),hi(n,e/2,t*2)}function V5(i,t,e,n){return t=t!==void 0?t:!0,function(r,s,a,o){if(r!==void 0){const l=i[0],h=i[i.length-1],c=e?V0(l,e,a,n):l;if(o)return t?H0(r,c,h):hi(r,h,c);const f=Math.min(c,r),g=Math.floor(F0(i,f,s));return i[g]>c&&g<i.length-1?i[g+1]:i[g]}}}function H5(i,t,e,n,r,s){return n=n!==void 0?n:!0,e=e!==void 0?e:0,function(a,o,l,h){if(a!==void 0){const c=r?V0(t,r,l,s):t;if(h)return n?H0(a,c,e):hi(a,e,c);const f=1e-9,g=Math.ceil(Math.log(t/c)/Math.log(i)-f),d=-o*(.5-f)+.5,m=Math.min(c,a),y=Math.floor(Math.log(t/m)/Math.log(i)+d),b=Math.max(g,y),x=t/Math.pow(i,b);return hi(x,e,c)}}}function zp(i,t,e,n,r){return e=e!==void 0?e:!0,function(s,a,o,l){if(s!==void 0){const h=n?V0(i,n,o,r):i;return!e||!l?hi(s,t,h):H0(s,h,t)}}}function X0(i){if(i!==void 0)return 0}function qp(i){if(i!==void 0)return i}function X5(i){const t=2*Math.PI/i;return function(e,n){if(n)return e;if(e!==void 0)return e=Math.floor(e/t+.5)*t,e}}function Y5(i){const t=i===void 0?Ts(5):i;return function(e,n){return n||e===void 0?e:Math.abs(e)<=t?0:e}}function X2(i){return Math.pow(i,3)}function kl(i){return 1-X2(1-i)}function Z5(i){return 3*i*i-2*i*i*i}function K5(i){return i}const Y2=new Array(6);function Bi(){return[1,0,0,1,0,0]}function Up(i){return Gf(i,1,0,0,1,0,0)}function Bf(i,t){const e=i[0],n=i[1],r=i[2],s=i[3],a=i[4],o=i[5],l=t[0],h=t[1],c=t[2],f=t[3],g=t[4],d=t[5];return i[0]=e*l+r*h,i[1]=n*l+s*h,i[2]=e*c+r*f,i[3]=n*c+s*f,i[4]=e*g+r*d+a,i[5]=n*g+s*d+o,i}function Gf(i,t,e,n,r,s,a){return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i[4]=s,i[5]=a,i}function $5(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i}function xi(i,t){const e=t[0],n=t[1];return t[0]=i[0]*e+i[2]*n+i[4],t[1]=i[1]*e+i[3]*n+i[5],t}function tg(i,t,e){return Bf(i,Gf(Y2,t,0,0,e,0,0))}function J5(i,t,e){return Gf(i,t,0,0,e,0,0)}function Z2(i,t,e){return Bf(i,Gf(Y2,1,0,0,1,t,e))}function Jn(i,t,e,n,r,s,a,o){const l=Math.sin(s),h=Math.cos(s);return i[0]=n*h,i[1]=r*l,i[2]=-n*l,i[3]=r*h,i[4]=a*n*h-o*n*l+t,i[5]=a*r*l+o*r*h+e,i}function pc(i,t){const e=Q5(t);Ce(e!==0,"Transformation matrix cannot be inverted");const n=t[0],r=t[1],s=t[2],a=t[3],o=t[4],l=t[5];return i[0]=a/e,i[1]=-r/e,i[2]=-s/e,i[3]=n/e,i[4]=(s*l-a*o)/e,i[5]=-(n*l-r*o)/e,i}function Q5(i){return i[0]*i[3]-i[1]*i[2]}const Wp=[1e6,1e6,1e6,1e6,2,2];function Y0(i){return"matrix("+i.map((e,n)=>Math.round(e*Wp[n])/Wp[n]).join(", ")+")"}function ga(i,t,e,n,r,s){s=s||[];let a=0;for(let o=t;o<e;o+=n){const l=i[o],h=i[o+1];s[a++]=r[0]*l+r[2]*h+r[4],s[a++]=r[1]*l+r[3]*h+r[5]}return s&&s.length!=a&&(s.length=a),s}function Z0(i,t,e,n,r,s,a){a=a||[];const o=Math.cos(r),l=Math.sin(r),h=s[0],c=s[1];let f=0;for(let g=t;g<e;g+=n){const d=i[g]-h,m=i[g+1]-c;a[f++]=h+d*o-m*l,a[f++]=c+d*l+m*o;for(let y=g+2;y<g+n;++y)a[f++]=i[y]}return a&&a.length!=f&&(a.length=f),a}function tx(i,t,e,n,r,s,a,o){o=o||[];const l=a[0],h=a[1];let c=0;for(let f=t;f<e;f+=n){const g=i[f]-l,d=i[f+1]-h;o[c++]=l+r*g,o[c++]=h+s*d;for(let m=f+2;m<f+n;++m)o[c++]=i[m]}return o&&o.length!=c&&(o.length=c),o}function ex(i,t,e,n,r,s,a){a=a||[];let o=0;for(let l=t;l<e;l+=n){a[o++]=i[l]+r,a[o++]=i[l+1]+s;for(let h=l+2;h<l+n;++h)a[o++]=i[h]}return a&&a.length!=o&&(a.length=o),a}const Vp=Bi();class K2 extends Qn{constructor(){super(),this.extent_=Dn(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=T2((t,e,n)=>{if(!n)return this.getSimplifiedGeometry(e);const r=this.clone();return r.applyTransform(n),r.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return ae()}closestPointXY(t,e,n,r){return ae()}containsXY(t,e){const n=this.getClosestPoint([t,e]);return n[0]===t&&n[1]===e}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return ae()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&Fl(e),this.extentRevision_=this.getRevision()}return M5(this.extent_,t)}rotate(t,e){ae()}scale(t,e,n){ae()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return ae()}getType(){return ae()}applyTransform(t){ae()}intersectsExtent(t){return ae()}translate(t,e){ae()}transform(t,e){const n=ti(t),r=n.getUnits()=="tile-pixels"?function(s,a,o){const l=n.getExtent(),h=n.getWorldExtent(),c=en(h)/en(l);return Jn(Vp,h[0],h[3],c,-c,0,0,0),ga(s,0,s.length,o,Vp,a),Cl(n,e)(s,a,o)}:Cl(n,e);return this.applyTransform(r),this}}class Ma extends K2{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return j0(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return ae()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=ef(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){ae()}setLayout(t,e,n){let r;if(t)r=ef(t);else{for(let s=0;s<n;++s){if(e.length===0){this.layout="XY",this.stride=2;return}e=e[0]}r=e.length,t=ao(r)}this.layout=t,this.stride=r}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(t,e){const n=this.getFlatCoordinates();if(n){const r=this.getStride();Z0(n,0,n.length,r,t,e,n),this.changed()}}scale(t,e,n){e===void 0&&(e=t),n||(n=xa(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();tx(r,0,r.length,s,t,e,n,r),this.changed()}}translate(t,e){const n=this.getFlatCoordinates();if(n){const r=this.getStride();ex(n,0,n.length,r,t,e,n),this.changed()}}}function ao(i){let t;return i==2?t="XY":i==3?t="XYZ":i==4&&(t="XYZM"),t}function ef(i){let t;return i=="XY"?t=2:i=="XYZ"||i=="XYM"?t=3:i=="XYZM"&&(t=4),t}function ix(i,t,e){const n=i.getFlatCoordinates();if(!n)return null;const r=i.getStride();return ga(n,0,n.length,r,t,e)}function Hp(i,t,e,n,r,s,a){const o=i[t],l=i[t+1],h=i[e]-o,c=i[e+1]-l;let f;if(h===0&&c===0)f=t;else{const g=((r-o)*h+(s-l)*c)/(h*h+c*c);if(g>1)f=e;else if(g>0){for(let d=0;d<n;++d)a[d]=Zn(i[t+d],i[e+d],g);a.length=n;return}else f=t}for(let g=0;g<n;++g)a[g]=i[f+g];a.length=n}function K0(i,t,e,n,r){let s=i[t],a=i[t+1];for(t+=n;t<e;t+=n){const o=i[t],l=i[t+1],h=Ms(s,a,o,l);h>r&&(r=h),s=o,a=l}return r}function $0(i,t,e,n,r){for(let s=0,a=e.length;s<a;++s){const o=e[s];r=K0(i,t,o,n,r),t=o}return r}function nx(i,t,e,n,r){for(let s=0,a=e.length;s<a;++s){const o=e[s];r=$0(i,t,o,n,r),t=o[o.length-1]}return r}function J0(i,t,e,n,r,s,a,o,l,h,c){if(t==e)return h;let f,g;if(r===0){if(g=Ms(a,o,i[t],i[t+1]),g<h){for(f=0;f<n;++f)l[f]=i[t+f];return l.length=n,g}return h}c=c||[NaN,NaN];let d=t+n;for(;d<e;)if(Hp(i,d-n,d,n,a,o,c),g=Ms(a,o,c[0],c[1]),g<h){for(h=g,f=0;f<n;++f)l[f]=c[f];l.length=n,d+=n}else d+=n*Math.max((Math.sqrt(g)-Math.sqrt(h))/r|0,1);if(s&&(Hp(i,e-n,t,n,a,o,c),g=Ms(a,o,c[0],c[1]),g<h)){for(h=g,f=0;f<n;++f)l[f]=c[f];l.length=n}return h}function Q0(i,t,e,n,r,s,a,o,l,h,c){c=c||[NaN,NaN];for(let f=0,g=e.length;f<g;++f){const d=e[f];h=J0(i,t,d,n,r,s,a,o,l,h,c),t=d}return h}function rx(i,t,e,n,r,s,a,o,l,h,c){c=c||[NaN,NaN];for(let f=0,g=e.length;f<g;++f){const d=e[f];h=Q0(i,t,d,n,r,s,a,o,l,h,c),t=d[d.length-1]}return h}function $2(i,t,e,n){for(let r=0,s=e.length;r<s;++r)i[t++]=e[r];return t}function zf(i,t,e,n){for(let r=0,s=e.length;r<s;++r){const a=e[r];for(let o=0;o<n;++o)i[t++]=a[o]}return t}function mc(i,t,e,n,r){r=r||[];let s=0;for(let a=0,o=e.length;a<o;++a){const l=zf(i,t,e[a],n);r[s++]=l,t=l}return r.length=s,r}function J2(i,t,e,n,r){r=r||[];let s=0;for(let a=0,o=e.length;a<o;++a){const l=mc(i,t,e[a],n,r[s]);l.length===0&&(l[0]=t),r[s++]=l,t=l[l.length-1]}return r.length=s,r}function qf(i,t,e,n,r,s,a){const o=(e-t)/n;if(o<3){for(;t<e;t+=n)s[a++]=i[t],s[a++]=i[t+1];return a}const l=new Array(o);l[0]=1,l[o-1]=1;const h=[t,e-n];let c=0;for(;h.length>0;){const f=h.pop(),g=h.pop();let d=0;const m=i[g],y=i[g+1],b=i[f],x=i[f+1];for(let E=g+n;E<f;E+=n){const S=i[E],M=i[E+1],D=d5(S,M,m,y,b,x);D>d&&(c=E,d=D)}d>r&&(l[(c-t)/n]=1,g+n<c&&h.push(g,c),c+n<f&&h.push(c,f))}for(let f=0;f<o;++f)l[f]&&(s[a++]=i[t+f*n],s[a++]=i[t+f*n+1]);return a}function Q2(i,t,e,n,r,s,a,o){for(let l=0,h=e.length;l<h;++l){const c=e[l];a=qf(i,t,c,n,r,s,a),o.push(a),t=c}return a}function Ga(i,t){return t*Math.round(i/t)}function sx(i,t,e,n,r,s,a){if(t==e)return a;let o=Ga(i[t],r),l=Ga(i[t+1],r);t+=n,s[a++]=o,s[a++]=l;let h,c;do if(h=Ga(i[t],r),c=Ga(i[t+1],r),t+=n,t==e)return s[a++]=h,s[a++]=c,a;while(h==o&&c==l);for(;t<e;){const f=Ga(i[t],r),g=Ga(i[t+1],r);if(t+=n,f==h&&g==c)continue;const d=h-o,m=c-l,y=f-o,b=g-l;if(d*b==m*y&&(d<0&&y<d||d==y||d>0&&y>d)&&(m<0&&b<m||m==b||m>0&&b>m)){h=f,c=g;continue}s[a++]=h,s[a++]=c,o=h,l=c,h=f,c=g}return s[a++]=h,s[a++]=c,a}function t1(i,t,e,n,r,s,a,o){for(let l=0,h=e.length;l<h;++l){const c=e[l];a=sx(i,t,c,n,r,s,a),o.push(a),t=c}return a}function ax(i,t,e,n,r,s,a,o){for(let l=0,h=e.length;l<h;++l){const c=e[l],f=[];a=t1(i,t,c,n,r,s,a,f),o.push(f),t=c[c.length-1]}return a}function la(i,t,e,n,r){r=r!==void 0?r:[];let s=0;for(let a=t;a<e;a+=n)r[s++]=i.slice(a,a+n);return r.length=s,r}function Wh(i,t,e,n,r){r=r!==void 0?r:[];let s=0;for(let a=0,o=e.length;a<o;++a){const l=e[a];r[s++]=la(i,t,l,n,r[s]),t=l}return r.length=s,r}function Yg(i,t,e,n,r){r=r!==void 0?r:[];let s=0;for(let a=0,o=e.length;a<o;++a){const l=e[a];r[s++]=l.length===1&&l[0]===t?[]:Wh(i,t,l,n,r[s]),t=l[l.length-1]}return r.length=s,r}function t_(i,t,e,n){let r=0,s=i[e-n],a=i[e-n+1];for(;t<e;t+=n){const o=i[t],l=i[t+1];r+=a*o-s*l,s=o,a=l}return r/2}function e_(i,t,e,n){let r=0;for(let s=0,a=e.length;s<a;++s){const o=e[s];r+=t_(i,t,o,n),t=o}return r}function ox(i,t,e,n){let r=0;for(let s=0,a=e.length;s<a;++s){const o=e[s];r+=e_(i,t,o,n),t=o[o.length-1]}return r}class Vh extends Ma{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}clone(){return new Vh(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,n,r){return r<so(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(K0(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),J0(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,r))}getArea(){return t_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return la(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=qf(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Vh(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=zf(this.flatCoordinates,0,t,this.stride),this.changed()}}let lx=class i_ extends Ma{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new i_(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,r){const s=this.flatCoordinates,a=Ms(t,e,s[0],s[1]);if(a<r){const o=this.stride;for(let l=0;l<o;++l)n[l]=s[l];return n.length=o,a}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return N2(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return D0(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=$2(this.flatCoordinates,0,t,this.stride),this.changed()}};const Ir=lx;function hx(i,t,e,n,r){return!B0(r,function(a){return!Wa(i,t,e,n,a[0],a[1])})}function Wa(i,t,e,n,r,s){let a=0,o=i[e-n],l=i[e-n+1];for(;t<e;t+=n){const h=i[t],c=i[t+1];l<=s?c>s&&(h-o)*(s-l)-(r-o)*(c-l)>0&&a++:c<=s&&(h-o)*(s-l)-(r-o)*(c-l)<0&&a--,o=h,l=c}return a!==0}function e1(i,t,e,n,r,s){if(e.length===0||!Wa(i,t,e[0],n,r,s))return!1;for(let a=1,o=e.length;a<o;++a)if(Wa(i,e[a-1],e[a],n,r,s))return!1;return!0}function cx(i,t,e,n,r,s){if(e.length===0)return!1;for(let a=0,o=e.length;a<o;++a){const l=e[a];if(e1(i,t,l,n,r,s))return!0;t=l[l.length-1]}return!1}function i1(i,t,e,n,r,s,a){let o,l,h,c,f,g,d;const m=r[s+1],y=[];for(let E=0,S=e.length;E<S;++E){const M=e[E];for(c=i[M-n],g=i[M-n+1],o=t;o<M;o+=n)f=i[o],d=i[o+1],(m<=g&&d<=m||g<=m&&m<=d)&&(h=(m-g)/(d-g)*(f-c)+c,y.push(h)),c=f,g=d}let b=NaN,x=-1/0;for(y.sort(Rs),c=y[0],o=1,l=y.length;o<l;++o){f=y[o];const E=Math.abs(f-c);E>x&&(h=(c+f)/2,e1(i,t,e,n,h,m)&&(b=h,x=E)),c=f}return isNaN(b)&&(b=r[s]),a?(a.push(b,m,x),a):[b,m,x]}function n_(i,t,e,n,r){let s=[];for(let a=0,o=e.length;a<o;++a){const l=e[a];s=i1(i,t,l,n,r,2*a,s),t=l[l.length-1]}return s}function r_(i,t,e,n,r){let s;for(t+=n;t<e;t+=n)if(s=r(i.slice(t-n,t),i.slice(t,t+n)),s)return s;return!1}function Uf(i,t,e,n,r){const s=O2(Dn(),i,t,e,n);return ki(r,s)?As(r,s)||s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:r_(i,t,e,n,function(a,o){return T5(r,a,o)}):!1}function ux(i,t,e,n,r){for(let s=0,a=e.length;s<a;++s){if(Uf(i,t,e[s],n,r))return!0;t=e[s]}return!1}function s_(i,t,e,n,r){return!!(Uf(i,t,e,n,r)||Wa(i,t,e,n,r[0],r[1])||Wa(i,t,e,n,r[0],r[3])||Wa(i,t,e,n,r[2],r[1])||Wa(i,t,e,n,r[2],r[3]))}function a_(i,t,e,n,r){if(!s_(i,t,e[0],n,r))return!1;if(e.length===1)return!0;for(let s=1,a=e.length;s<a;++s)if(hx(i,e[s-1],e[s],n,r)&&!Uf(i,e[s-1],e[s],n,r))return!1;return!0}function fx(i,t,e,n,r){for(let s=0,a=e.length;s<a;++s){const o=e[s];if(a_(i,t,o,n,r))return!0;t=o[o.length-1]}return!1}function dx(i,t,e,n){for(;t<e-n;){for(let r=0;r<n;++r){const s=i[t+r];i[t+r]=i[e-n+r],i[e-n+r]=s}t+=n,e-=n}}function n1(i,t,e,n){let r=0,s=i[e-n],a=i[e-n+1];for(;t<e;t+=n){const o=i[t],l=i[t+1];r+=(o-s)*(l+a),s=o,a=l}return r===0?void 0:r>0}function r1(i,t,e,n,r){r=r!==void 0?r:!1;for(let s=0,a=e.length;s<a;++s){const o=e[s],l=n1(i,t,o,n);if(s===0){if(r&&l||!r&&!l)return!1}else if(r&&!l||!r&&l)return!1;t=o}return!0}function o_(i,t,e,n,r){for(let s=0,a=e.length;s<a;++s){const o=e[s];if(!r1(i,t,o,n,r))return!1;o.length&&(t=o[o.length-1])}return!0}function nf(i,t,e,n,r){r=r!==void 0?r:!1;for(let s=0,a=e.length;s<a;++s){const o=e[s],l=n1(i,t,o,n);(s===0?r&&l||!r&&!l:r&&!l||!r&&l)&&dx(i,t,o,n),t=o}return t}function Zg(i,t,e,n,r){for(let s=0,a=e.length;s<a;++s)t=nf(i,t,e[s],n,r);return t}function gx(i,t){const e=[];let n=0,r=0,s;for(let a=0,o=t.length;a<o;++a){const l=t[a],h=n1(i,n,l,2);if(s===void 0&&(s=h),h===s)e.push(t.slice(r,a+1));else{if(e.length===0)continue;e[e.length-1].push(t[r])}r=a+1,n=l}return e}class cr extends Ma{constructor(t,e,n){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,e!==void 0&&n?(this.setFlatCoordinates(e,t),this.ends_=n):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?$n(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new cr(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,r){return r<so(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt($0(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Q0(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,r))}containsXY(t,e){return e1(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return e_(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),nf(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,Wh(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=xa(this.getExtent());this.flatInteriorPoint_=i1(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Ir(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new Vh(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,n=this.ends_,r=[];let s=0;for(let a=0,o=n.length;a<o;++a){const l=n[a],h=new Vh(e.slice(s,l),t);r.push(h),s=l}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;r1(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=nf(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=t1(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,n),new cr(e,"XY",n)}getType(){return"Polygon"}intersectsExtent(t){return a_(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=mc(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=n.length===0?0:n[n.length-1],this.changed()}}function px(i,t,e,n){e=e||32;const r=[];for(let s=0;s<e;++s)$n(r,k5(i,t,2*Math.PI*s/e,n));return r.push(r[0],r[1]),new cr(r,"XY",[r.length])}function Kg(i){if(Ol(i))throw new Error("Cannot create polygon from empty extent");const t=i[0],e=i[1],n=i[2],r=i[3],s=[t,e,t,r,n,r,n,e,t,e];return new cr(s,"XY",[s.length])}const eg=0;class mx extends Qn{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=U0(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&W2(),t.center&&(t.center=Mr(t.center,this.projection_)),t.extent&&(t.extent=Yr(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const o in Sr)delete e[o];this.setProperties(e,!0);const n=vx(t);this.maxResolution_=n.maxResolution,this.minResolution_=n.minResolution,this.zoomFactor_=n.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=n.minZoom;const r=_x(t),s=n.constraint,a=yx(t);this.constraints_={center:r,resolution:s,rotation:a},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const n=this.getCenterInternal();if(n){const r=t||[0,0,0,0];e=e||[0,0,0,0];const s=this.getResolution(),a=s/2*(r[3]-e[3]+e[1]-r[1]),o=s/2*(r[0]-e[0]+e[2]-r[2]);this.setCenterInternal([n[0]+a,n[1]-o])}}getUpdatedOptions_(t){const e=this.getProperties();return e.resolution!==void 0?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let n=0;n<e.length;++n){let r=arguments[n];r.center&&(r=Object.assign({},r),r.center=Mr(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=Mr(r.anchor,this.getProjection())),e[n]=r}this.animateInternal.apply(this,e)}animateInternal(t){let e=arguments.length,n;e>1&&typeof arguments[e-1]=="function"&&(n=arguments[e-1],--e);let r=0;for(;r<e&&!this.isDef();++r){const c=arguments[r];c.center&&this.setCenterInternal(c.center),c.zoom!==void 0?this.setZoom(c.zoom):c.resolution&&this.setResolution(c.resolution),c.rotation!==void 0&&this.setRotation(c.rotation)}if(r===e){n&&vu(n,!0);return}let s=Date.now(),a=this.targetCenter_.slice(),o=this.targetResolution_,l=this.targetRotation_;const h=[];for(;r<e;++r){const c=arguments[r],f={start:s,complete:!1,anchor:c.anchor,duration:c.duration!==void 0?c.duration:1e3,easing:c.easing||Z5,callback:n};if(c.center&&(f.sourceCenter=a,f.targetCenter=c.center.slice(),a=f.targetCenter),c.zoom!==void 0?(f.sourceResolution=o,f.targetResolution=this.getResolutionForZoom(c.zoom),o=f.targetResolution):c.resolution&&(f.sourceResolution=o,f.targetResolution=c.resolution,o=f.targetResolution),c.rotation!==void 0){f.sourceRotation=l;const g=Za(c.rotation-l+Math.PI,2*Math.PI)-Math.PI;f.targetRotation=l+g,l=f.targetRotation}xx(f)?f.complete=!0:s+=f.duration,h.push(f)}this.animations_.push(h),this.setHint(ri.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[ri.ANIMATING]>0}getInteracting(){return this.hints_[ri.INTERACTING]>0}cancelAnimations(){this.setHint(ri.ANIMATING,-this.hints_[ri.ANIMATING]);let t;for(let e=0,n=this.animations_.length;e<n;++e){const r=this.animations_[e];if(r[0].callback&&vu(r[0].callback,!1),!t)for(let s=0,a=r.length;s<a;++s){const o=r[s];if(!o.complete){t=o.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let n=this.animations_.length-1;n>=0;--n){const r=this.animations_[n];let s=!0;for(let a=0,o=r.length;a<o;++a){const l=r[a];if(l.complete)continue;const h=t-l.start;let c=l.duration>0?h/l.duration:1;c>=1?(l.complete=!0,c=1):s=!1;const f=l.easing(c);if(l.sourceCenter){const g=l.sourceCenter[0],d=l.sourceCenter[1],m=l.targetCenter[0],y=l.targetCenter[1];this.nextCenter_=l.targetCenter;const b=g+f*(m-g),x=d+f*(y-d);this.targetCenter_=[b,x]}if(l.sourceResolution&&l.targetResolution){const g=f===1?l.targetResolution:l.sourceResolution+f*(l.targetResolution-l.sourceResolution);if(l.anchor){const d=this.getViewportSize_(this.getRotation()),m=this.constraints_.resolution(g,0,d,!0);this.targetCenter_=this.calculateCenterZoom(m,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=g,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const g=f===1?Za(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+f*(l.targetRotation-l.sourceRotation);if(l.anchor){const d=this.constraints_.rotation(g,!0);this.targetCenter_=this.calculateCenterRotate(d,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=g}if(this.applyTargetState_(!0),e=!0,!l.complete)break}if(s){this.animations_[n]=null,this.setHint(ri.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const a=r[0].callback;a&&vu(a,!0)}}this.animations_=this.animations_.filter(Boolean),e&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let n;const r=this.getCenterInternal();return r!==void 0&&(n=[r[0]-e[0],r[1]-e[1]],G0(n,t-this.getRotation()),R5(n,e)),n}calculateCenterZoom(t,e){let n;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const a=e[0]-t*(e[0]-r[0])/s,o=e[1]-t*(e[1]-r[1])/s;n=[a,o]}return n}getViewportSize_(t){const e=this.viewportSize_;if(t){const n=e[0],r=e[1];return[Math.abs(n*Math.cos(t))+Math.abs(r*Math.sin(t)),Math.abs(n*Math.sin(t))+Math.abs(r*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t&&Xg(t,this.getProjection())}getCenterInternal(){return this.get(Sr.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){const e=this.calculateExtentInternal(t);return W0(e,this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();Ce(e,"The view center is not defined");const n=this.getResolution();Ce(n!==void 0,"The view resolution is not defined");const r=this.getRotation();return Ce(r!==void 0,"The view rotation is not defined"),qg(e,n,r,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(Sr.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(Yr(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const n=Re(t)/e[0],r=en(t)/e[1];return Math.max(n,r)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,r=Math.log(e/n)/Math.log(t);return function(s){return e/Math.pow(t,s*r)}}getRotation(){return this.get(Sr.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(n/r)/e;return function(a){return Math.log(n/a)/e/s}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const n=this.padding_;return n&&(e=[e[0]-n[1]-n[3],e[1]-n[0]-n[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),n=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const a=this.getViewportSizeMinusPadding_();r=ig(r,this.getViewportSize_(),[a[0]/2+s[3],a[1]/2+s[0]],e,n)}return{center:r.slice(0),projection:t!==void 0?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return e!==void 0&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e=this.minZoom_||0,n,r;if(this.resolutions_){const s=F0(this.resolutions_,t,1);e=s,n=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=n/this.resolutions_[s+1]}else n=this.maxResolution_,r=this.zoomFactor_;return e+Math.log(n/t)/Math.log(r)}getResolutionForZoom(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const e=hi(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(n,hi(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let n;if(Ce(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(t)){Ce(!Ol(t),"Cannot fit empty extent provided as `geometry`");const r=Yr(t,this.getProjection());n=Kg(r)}else if(t.getType()==="Circle"){const r=Yr(t.getExtent(),this.getProjection());n=Kg(r),n.rotate(this.getRotation(),xa(r))}else n=t;this.fitInternal(n,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),n=Math.cos(e),r=Math.sin(-e),s=t.getFlatCoordinates(),a=t.getStride();let o=1/0,l=1/0,h=-1/0,c=-1/0;for(let f=0,g=s.length;f<g;f+=a){const d=s[f]*n-s[f+1]*r,m=s[f]*r+s[f+1]*n;o=Math.min(o,d),l=Math.min(l,m),h=Math.max(h,d),c=Math.max(c,m)}return[o,l,h,c]}fitInternal(t,e){e=e||{};let n=e.size;n||(n=this.getViewportSizeMinusPadding_());const r=e.padding!==void 0?e.padding:[0,0,0,0],s=e.nearest!==void 0?e.nearest:!1;let a;e.minResolution!==void 0?a=e.minResolution:e.maxZoom!==void 0?a=this.getResolutionForZoom(e.maxZoom):a=0;const o=this.rotatedExtentForGeometry(t);let l=this.getResolutionForExtentInternal(o,[n[0]-r[1]-r[3],n[1]-r[0]-r[2]]);l=isNaN(l)?a:Math.max(l,a),l=this.getConstrainedResolution(l,s?0:1);const h=this.getRotation(),c=Math.sin(h),f=Math.cos(h),g=xa(o);g[0]+=(r[1]-r[3])/2*l,g[1]+=(r[0]-r[2])/2*l;const d=g[0]*f-g[1]*c,m=g[1]*f+g[0]*c,y=this.getConstrainedCenter([d,m],l),b=e.callback?e.callback:Sl;e.duration!==void 0?this.animateInternal({resolution:l,center:y,duration:e.duration,easing:e.easing},b):(this.targetResolution_=l,this.targetCenter_=y,this.applyTargetState_(!1,!0),vu(b,!0))}centerOn(t,e,n){this.centerOnInternal(Mr(t,this.getProjection()),e,n)}centerOnInternal(t,e,n){this.setCenterInternal(ig(t,e,n,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,n,r){let s;const a=this.padding_;if(a&&t){const o=this.getViewportSizeMinusPadding_(-n),l=ig(t,r,[o[0]/2+a[3],o[1]/2+a[0]],e,n);s=[t[0]-l[0],t[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(t){const e=Xg(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&Mr(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const n=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*t,0,r,n);e&&(this.targetCenter_=this.calculateCenterZoom(s,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=Mr(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const n=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+t,n);e&&(this.targetCenter_=this.calculateCenterRotate(r,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&Mr(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const n=this.getAnimating()||this.getInteracting()||e,r=this.constraints_.rotation(this.targetRotation_,n),s=this.getViewportSize_(r),a=this.constraints_.resolution(this.targetResolution_,0,s,n),o=this.constraints_.center(this.targetCenter_,a,s,n,this.calculateCenterShift(this.targetCenter_,a,r,s));this.get(Sr.ROTATION)!==r&&this.set(Sr.ROTATION,r),this.get(Sr.RESOLUTION)!==a&&(this.set(Sr.RESOLUTION,a),this.set("zoom",this.getZoom(),!0)),(!o||!this.get(Sr.CENTER)||!tf(this.get(Sr.CENTER),o))&&this.set(Sr.CENTER,o),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,n){t=t!==void 0?t:200;const r=e||0,s=this.constraints_.rotation(this.targetRotation_),a=this.getViewportSize_(s),o=this.constraints_.resolution(this.targetResolution_,r,a),l=this.constraints_.center(this.targetCenter_,o,a,!1,this.calculateCenterShift(this.targetCenter_,o,s,a));if(t===0&&!this.cancelAnchor_){this.targetResolution_=o,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}n=n||(t===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==o||this.getRotation()!==s||!this.getCenterInternal()||!tf(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:o,duration:t,easing:kl,anchor:n}))}beginInteraction(){this.resolveConstraints(0),this.setHint(ri.INTERACTING,1)}endInteraction(t,e,n){n=n&&Mr(n,this.getProjection()),this.endInteractionInternal(t,e,n)}endInteractionInternal(t,e,n){this.getInteracting()&&(this.setHint(ri.INTERACTING,-1),this.resolveConstraints(t,e,n))}getConstrainedCenter(t,e){const n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),n)}getConstrainedZoom(t,e){const n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,e))}getConstrainedResolution(t,e){e=e||0;const n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,n)}}function vu(i,t){setTimeout(function(){i(t)},0)}function _x(i){if(i.extent!==void 0){const e=i.smoothExtentConstraint!==void 0?i.smoothExtentConstraint:!0;return Gp(i.extent,i.constrainOnlyCenter,e)}const t=U0(i.projection,"EPSG:3857");if(i.multiWorld!==!0&&t.isGlobal()){const e=t.getExtent().slice();return e[0]=-1/0,e[2]=1/0,Gp(e,!1,!1)}return W5}function vx(i){let t,e,n,a=i.minZoom!==void 0?i.minZoom:eg,o=i.maxZoom!==void 0?i.maxZoom:28;const l=i.zoomFactor!==void 0?i.zoomFactor:2,h=i.multiWorld!==void 0?i.multiWorld:!1,c=i.smoothResolutionConstraint!==void 0?i.smoothResolutionConstraint:!0,f=i.showFullExtent!==void 0?i.showFullExtent:!1,g=U0(i.projection,"EPSG:3857"),d=g.getExtent();let m=i.constrainOnlyCenter,y=i.extent;if(!h&&!y&&g.isGlobal()&&(m=!1,y=d),i.resolutions!==void 0){const b=i.resolutions;e=b[a],n=b[o]!==void 0?b[o]:b[b.length-1],i.constrainResolution?t=V5(b,c,!m&&y,f):t=zp(e,n,c,!m&&y,f)}else{const x=(d?Math.max(Re(d),en(d)):360*Uh.degrees/g.getMetersPerUnit())/O0/Math.pow(2,eg),E=x/Math.pow(2,28-eg);e=i.maxResolution,e!==void 0?a=0:e=x/Math.pow(l,a),n=i.minResolution,n===void 0&&(i.maxZoom!==void 0?i.maxResolution!==void 0?n=e/Math.pow(l,o):n=x/Math.pow(l,o):n=E),o=a+Math.floor(Math.log(e/n)/Math.log(l)),n=e/Math.pow(l,o-a),i.constrainResolution?t=H5(l,e,n,c,!m&&y,f):t=zp(e,n,c,!m&&y,f)}return{constraint:t,maxResolution:e,minResolution:n,minZoom:a,zoomFactor:l}}function yx(i){if(i.enableRotation!==void 0?i.enableRotation:!0){const e=i.constrainRotation;return e===void 0||e===!0?Y5():e===!1?qp:typeof e=="number"?X5(e):qp}return X0}function xx(i){return!(i.sourceCenter&&i.targetCenter&&!tf(i.sourceCenter,i.targetCenter)||i.sourceResolution!==i.targetResolution||i.sourceRotation!==i.targetRotation)}function ig(i,t,e,n,r){const s=Math.cos(-r);let a=Math.sin(-r),o=i[0]*s-i[1]*a,l=i[1]*s+i[0]*a;o+=(t[0]/2-e[0])*n,l+=(e[1]-t[1]/2)*n,a=-a;const h=o*s-l*a,c=l*s+o*a;return[h,c]}const or=mx;class Dl extends P2{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(Be.SOURCE,this.handleSourcePropertyChange_);const n=t.source?t.source:null;this.setSource(n)}getLayersArray(t){return t=t||[],t.push(this),t}getLayerStatesArray(t){return t=t||[],t.push(this.getLayerState()),t}getSource(){return this.get(Be.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Ke(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=_e(t,le.CHANGE,this.handleSourceChange_,this),t.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)}isVisible(t){let e;const n=this.getMapInternal();!t&&n&&(t=n.getView()),t instanceof or?e={viewState:t.getState(),extent:t.calculateExtent()}:e=t,!e.layerStatesArray&&n&&(e.layerStatesArray=n.getLayerGroup().getLayerStatesArray());let r;e.layerStatesArray?r=e.layerStatesArray.find(a=>a.layer===this):r=this.getLayerState();const s=this.getExtent();return s1(r,e.viewState)&&(!s||ki(s,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];let e;const n=this.getSource();if(n&&(e=n.getAttributions()),!e)return[];const r=t instanceof or?t.getViewStateAndExtent():t;let s=e(r);return Array.isArray(s)||(s=[s]),s}render(t,e){const n=this.getRenderer();return n.prepareFrame(t)?(this.rendered=!0,n.renderFrame(t,e)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(t,e){}renderDeferred(t){const e=this.getRenderer();e&&e.renderDeferred(t)}setMapInternal(t){t||this.unrender(),this.set(Be.MAP,t)}getMapInternal(){return this.get(Be.MAP)}setMap(t){this.mapPrecomposeKey_&&(Ke(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(Ke(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=_e(t,Zi.PRECOMPOSE,function(e){const r=e.frameState.layerStatesArray,s=this.getLayerState(!1);Ce(!r.some(function(a){return a.layer===s.layer}),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),r.push(s)},this),this.mapRenderKey_=_e(this,le.CHANGE,t.render,t),this.changed())}setSource(t){this.set(Be.SOURCE,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}}function s1(i,t){if(!i.visible)return!1;const e=t.resolution;if(e<i.minResolution||e>=i.maxResolution)return!1;const n=t.zoom;return n>i.minZoom&&n<=i.maxZoom}function bx(i,t,e,n,r){l_(i,t,e||0,n||i.length-1,r||wx)}function l_(i,t,e,n,r){for(;n>e;){if(n-e>600){var s=n-e+1,a=t-e+1,o=Math.log(s),l=.5*Math.exp(2*o/3),h=.5*Math.sqrt(o*l*(s-l)/s)*(a-s/2<0?-1:1),c=Math.max(e,Math.floor(t-a*l/s+h)),f=Math.min(n,Math.floor(t+(s-a)*l/s+h));l_(i,t,c,f,r)}var g=i[t],d=e,m=n;for(vh(i,e,t),r(i[n],g)>0&&vh(i,e,n);d<m;){for(vh(i,d,m),d++,m--;r(i[d],g)<0;)d++;for(;r(i[m],g)>0;)m--}r(i[e],g)===0?vh(i,e,m):(m++,vh(i,m,n)),m<=t&&(e=m+1),t<=m&&(n=m-1)}}function vh(i,t,e){var n=i[t];i[t]=i[e],i[e]=n}function wx(i,t){return i<t?-1:i>t?1:0}let h_=class{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data;const n=[];if(!xu(t,e))return n;const r=this.toBBox,s=[];for(;e;){for(let a=0;a<e.children.length;a++){const o=e.children[a],l=e.leaf?r(o):o;xu(t,l)&&(e.leaf?n.push(o):rg(t,l)?this._all(o,n):s.push(o))}e=s.pop()}return n}collides(t){let e=this.data;if(!xu(t,e))return!1;const n=[];for(;e;){for(let r=0;r<e.children.length;r++){const s=e.children[r],a=e.leaf?this.toBBox(s):s;if(xu(t,a)){if(e.leaf||rg(t,a))return!0;n.push(s)}}e=n.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let n=0;n<t.length;n++)this.insert(t[n]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=e;else if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const n=this.data;this.data=e,e=n}this._insert(e,this.data.height-e.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=Zo([]),this}remove(t,e){if(!t)return this;let n=this.data;const r=this.toBBox(t),s=[],a=[];let o,l,h;for(;n||s.length;){if(n||(n=s.pop(),l=s[s.length-1],o=a.pop(),h=!0),n.leaf){const c=Ex(t,n.children,e);if(c!==-1)return n.children.splice(c,1),s.push(n),this._condense(s),this}!h&&!n.leaf&&rg(n,r)?(s.push(n),a.push(o),o=0,l=n,n=n.children[0]):l?(o++,n=l.children[o],h=!1):n=null}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const n=[];for(;t;)t.leaf?e.push(...t.children):n.push(...t.children),t=n.pop();return e}_build(t,e,n,r){const s=n-e+1;let a=this._maxEntries,o;if(s<=a)return o=Zo(t.slice(e,n+1)),Bo(o,this.toBBox),o;r||(r=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,r-1))),o=Zo([]),o.leaf=!1,o.height=r;const l=Math.ceil(s/a),h=l*Math.ceil(Math.sqrt(a));Xp(t,e,n,h,this.compareMinX);for(let c=e;c<=n;c+=h){const f=Math.min(c+h-1,n);Xp(t,c,f,l,this.compareMinY);for(let g=c;g<=f;g+=l){const d=Math.min(g+l-1,f);o.children.push(this._build(t,g,d,r-1))}}return Bo(o,this.toBBox),o}_chooseSubtree(t,e,n,r){for(;r.push(e),!(e.leaf||r.length-1===n);){let s=1/0,a=1/0,o;for(let l=0;l<e.children.length;l++){const h=e.children[l],c=ng(h),f=Cx(t,h)-c;f<a?(a=f,s=c<s?c:s,o=h):f===a&&c<s&&(s=c,o=h)}e=o||e.children[0]}return e}_insert(t,e,n){const r=n?t:this.toBBox(t),s=[],a=this._chooseSubtree(r,this.data,e,s);for(a.children.push(t),Ch(a,r);e>=0&&s[e].children.length>this._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(r,s,e)}_split(t,e){const n=t[e],r=n.children.length,s=this._minEntries;this._chooseSplitAxis(n,s,r);const a=this._chooseSplitIndex(n,s,r),o=Zo(n.children.splice(a,n.children.length-a));o.height=n.height,o.leaf=n.leaf,Bo(n,this.toBBox),Bo(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(n,o)}_splitRoot(t,e){this.data=Zo([t,e]),this.data.height=t.height+1,this.data.leaf=!1,Bo(this.data,this.toBBox)}_chooseSplitIndex(t,e,n){let r,s=1/0,a=1/0;for(let o=e;o<=n-e;o++){const l=Lh(t,0,o,this.toBBox),h=Lh(t,o,n,this.toBBox),c=Ax(l,h),f=ng(l)+ng(h);c<s?(s=c,r=o,a=f<a?f:a):c===s&&f<a&&(a=f,r=o)}return r||n-e}_chooseSplitAxis(t,e,n){const r=t.leaf?this.compareMinX:Sx,s=t.leaf?this.compareMinY:Lx,a=this._allDistMargin(t,e,n,r),o=this._allDistMargin(t,e,n,s);a<o&&t.children.sort(r)}_allDistMargin(t,e,n,r){t.children.sort(r);const s=this.toBBox,a=Lh(t,0,e,s),o=Lh(t,n-e,n,s);let l=yu(a)+yu(o);for(let h=e;h<n-e;h++){const c=t.children[h];Ch(a,t.leaf?s(c):c),l+=yu(a)}for(let h=n-e-1;h>=e;h--){const c=t.children[h];Ch(o,t.leaf?s(c):c),l+=yu(o)}return l}_adjustParentBBoxes(t,e,n){for(let r=n;r>=0;r--)Ch(e[r],t)}_condense(t){for(let e=t.length-1,n;e>=0;e--)t[e].children.length===0?e>0?(n=t[e-1].children,n.splice(n.indexOf(t[e]),1)):this.clear():Bo(t[e],this.toBBox)}};function Ex(i,t,e){if(!e)return t.indexOf(i);for(let n=0;n<t.length;n++)if(e(i,t[n]))return n;return-1}function Bo(i,t){Lh(i,0,i.children.length,t,i)}function Lh(i,t,e,n,r){r||(r=Zo(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=t;s<e;s++){const a=i.children[s];Ch(r,i.leaf?n(a):a)}return r}function Ch(i,t){return i.minX=Math.min(i.minX,t.minX),i.minY=Math.min(i.minY,t.minY),i.maxX=Math.max(i.maxX,t.maxX),i.maxY=Math.max(i.maxY,t.maxY),i}function Sx(i,t){return i.minX-t.minX}function Lx(i,t){return i.minY-t.minY}function ng(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function yu(i){return i.maxX-i.minX+(i.maxY-i.minY)}function Cx(i,t){return(Math.max(t.maxX,i.maxX)-Math.min(t.minX,i.minX))*(Math.max(t.maxY,i.maxY)-Math.min(t.minY,i.minY))}function Ax(i,t){const e=Math.max(i.minX,t.minX),n=Math.max(i.minY,t.minY),r=Math.min(i.maxX,t.maxX),s=Math.min(i.maxY,t.maxY);return Math.max(0,r-e)*Math.max(0,s-n)}function rg(i,t){return i.minX<=t.minX&&i.minY<=t.minY&&t.maxX<=i.maxX&&t.maxY<=i.maxY}function xu(i,t){return t.minX<=i.maxX&&t.minY<=i.maxY&&t.maxX>=i.minX&&t.maxY>=i.minY}function Zo(i){return{children:i,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Xp(i,t,e,n,r){const s=[t,e];for(;s.length;){if(e=s.pop(),t=s.pop(),e-t<=n)continue;const a=t+Math.ceil((e-t)/n/2)*n;bx(i,a,t,e,r),s.push(t,a,a,e)}}const xe={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Yp(i){return i[0]>0&&i[1]>0}function Mx(i,t,e){return e===void 0&&(e=[0,0]),e[0]=i[0]*t+.5|0,e[1]=i[1]*t+.5|0,e}function kn(i,t){return Array.isArray(i)?i:(t===void 0?t=[i,i]:(t[0]=i,t[1]=i),t)}class Wf{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=kn(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new Wf({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return ae()}getImage(t){return ae()}getHitDetectionImage(){return ae()}getPixelRatio(t){return 1}getImageState(){return ae()}getImageSize(){return ae()}getOrigin(){return ae()}getSize(){return ae()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=kn(t)}listenImageChange(t){ae()}load(){ae()}unlistenImageChange(t){ae()}ready(){return Promise.resolve()}}const Hh={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]};var nn={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"]};nn.whitepoint={2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}};nn.max=nn.whitepoint[2].D65;nn.rgb=function(i,t){t=t||nn.whitepoint[2].E;var e=i[0]/t[0],n=i[1]/t[1],r=i[2]/t[2],s,a,o;return s=e*3.240969941904521+n*-1.537383177570093+r*-.498610760293,a=e*-.96924363628087+n*1.87596750150772+r*.041555057407175,o=e*.055630079696993+n*-.20397695888897+r*1.056971514242878,s=s>.0031308?1.055*Math.pow(s,1/2.4)-.055:s=s*12.92,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a=a*12.92,o=o>.0031308?1.055*Math.pow(o,1/2.4)-.055:o=o*12.92,s=Math.min(Math.max(0,s),1),a=Math.min(Math.max(0,a),1),o=Math.min(Math.max(0,o),1),[s*255,a*255,o*255]};Hh.xyz=function(i,t){var e=i[0]/255,n=i[1]/255,r=i[2]/255;e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92,r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92;var s=e*.41239079926595+n*.35758433938387+r*.18048078840183,a=e*.21263900587151+n*.71516867876775+r*.072192315360733,o=e*.019330818715591+n*.11919477979462+r*.95053215224966;return t=t||nn.whitepoint[2].E,[s*t[0],a*t[1],o*t[2]]};const a1={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(i,t,e){var n,r,s,a,o,l,h,c,f,g,d,m,y;if(s=i[0],a=i[1],o=i[2],s===0)return[0,0,0];var b=.0011070564598794539;return t=t||"D65",e=e||2,f=nn.whitepoint[e][t][0],g=nn.whitepoint[e][t][1],d=nn.whitepoint[e][t][2],m=4*f/(f+15*g+3*d),y=9*g/(f+15*g+3*d),n=a/(13*s)+m||0,r=o/(13*s)+y||0,h=s>8?g*Math.pow((s+16)/116,3):g*s*b,l=h*9*n/(4*r)||0,c=h*(12-3*n-20*r)/(4*r)||0,[l,h,c]}};nn.luv=function(i,t,e){var n,r,s,a,o,l,h,c,f,g,d,m,y,b=.008856451679035631,x=903.2962962962961;t=t||"D65",e=e||2,f=nn.whitepoint[e][t][0],g=nn.whitepoint[e][t][1],d=nn.whitepoint[e][t][2],m=4*f/(f+15*g+3*d),y=9*g/(f+15*g+3*d),l=i[0],h=i[1],c=i[2],n=4*l/(l+15*h+3*c)||0,r=9*h/(l+15*h+3*c)||0;var E=h/g;return s=E<=b?x*E:116*Math.pow(E,1/3)-16,a=13*s*(n-m),o=13*s*(r-y),[s,a,o]};var c_={name:"lchuv",channel:["lightness","chroma","hue"],alias:["LCHuv","cielchuv"],min:[0,0,0],max:[100,100,360],luv:function(i){var t=i[0],e=i[1],n=i[2],r,s,a;return a=n/360*2*Math.PI,r=e*Math.cos(a),s=e*Math.sin(a),[t,r,s]},xyz:function(i){return a1.xyz(c_.luv(i))}};a1.lchuv=function(i){var t=i[0],e=i[1],n=i[2],r=Math.sqrt(e*e+n*n),s=Math.atan2(n,e),a=s*360/2/Math.PI;return a<0&&(a+=360),[t,r,a]};nn.lchuv=function(i){return a1.lchuv(nn.luv(i))};var MP=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Tx(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Px={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};const Zp=Tx(Px);var Kp={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function Ix(i){var c,f;var t,e=[],n=1,r;if(typeof i=="number")return{space:"rgb",values:[i>>>16,(i&65280)>>>8,i&255],alpha:1};if(typeof i=="number")return{space:"rgb",values:[i>>>16,(i&65280)>>>8,i&255],alpha:1};if(i=String(i).toLowerCase(),Zp[i])e=Zp[i].slice(),r="rgb";else if(i==="transparent")n=0,r="rgb",e=[0,0,0];else if(i[0]==="#"){var s=i.slice(1),a=s.length,o=a<=4;n=1,o?(e=[parseInt(s[0]+s[0],16),parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16)],a===4&&(n=parseInt(s[3]+s[3],16)/255)):(e=[parseInt(s[0]+s[1],16),parseInt(s[2]+s[3],16),parseInt(s[4]+s[5],16)],a===8&&(n=parseInt(s[6]+s[7],16)/255)),e[0]||(e[0]=0),e[1]||(e[1]=0),e[2]||(e[2]=0),r="rgb"}else if(t=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(i)){var l=t[1];r=l.replace(/a$/,"");var h=r==="cmyk"?4:r==="gray"?1:3;e=t[2].trim().split(/\s*[,\/]\s*|\s+/),r==="color"&&(r=e.shift()),e=e.map(function(g,d){if(g[g.length-1]==="%")return g=parseFloat(g)/100,d===3?g:r==="rgb"?g*255:r[0]==="h"||r[0]==="l"&&!d?g*100:r==="lab"?g*125:r==="lch"?d<2?g*150:g*360:r[0]==="o"&&!d?g:r==="oklab"?g*.4:r==="oklch"?d<2?g*.4:g*360:g;if(r[d]==="h"||d===2&&r[r.length-1]==="h"){if(Kp[g]!==void 0)return Kp[g];if(g.endsWith("deg"))return parseFloat(g);if(g.endsWith("turn"))return parseFloat(g)*360;if(g.endsWith("grad"))return parseFloat(g)*360/400;if(g.endsWith("rad"))return parseFloat(g)*180/Math.PI}return g==="none"?0:parseFloat(g)}),n=e.length>h?e.pop():1}else/[0-9](?:\s|\/|,)/.test(i)&&(e=i.match(/([0-9]+)/g).map(function(g){return parseFloat(g)}),r=((f=(c=i.match(/([a-z])/ig))==null?void 0:c.join(""))==null?void 0:f.toLowerCase())||"rgb");return{space:r,values:e,alpha:n}}const sg={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(i){var t=i[0]/360,e=i[1]/100,n=i[2]/100,r,s,a,o,l,h=0;if(e===0)return l=n*255,[l,l,l];for(s=n<.5?n*(1+e):n+e-n*e,r=2*n-s,o=[0,0,0];h<3;)a=t+1/3*-(h-1),a<0?a++:a>1&&a--,l=6*a<1?r+(s-r)*6*a:2*a<1?s:3*a<2?r+(s-r)*(2/3-a)*6:r,o[h++]=l*255;return o}};Hh.hsl=function(i){var t=i[0]/255,e=i[1]/255,n=i[2]/255,r=Math.min(t,e,n),s=Math.max(t,e,n),a=s-r,o,l,h;return s===r?o=0:t===s?o=(e-n)/a:e===s?o=2+(n-t)/a:n===s&&(o=4+(t-e)/a),o=Math.min(o*60,360),o<0&&(o+=360),h=(r+s)/2,s===r?l=0:h<=.5?l=a/(s+r):l=a/(2-s-r),[o,l*100,h*100]};function Rx(i){Array.isArray(i)&&i.raw&&(i=String.raw(...arguments)),i instanceof Number&&(i=+i);var t,e=Ix(i);if(!e.space)return[];const n=e.space[0]==="h"?sg.min:Hh.min,r=e.space[0]==="h"?sg.max:Hh.max;return t=Array(3),t[0]=Math.min(Math.max(e.values[0],n[0]),r[0]),t[1]=Math.min(Math.max(e.values[1],n[1]),r[1]),t[2]=Math.min(Math.max(e.values[2],n[2]),r[2]),e.space[0]==="h"&&(t=sg.rgb(t)),t.push(Math.min(Math.max(e.alpha,0),1)),t}function Nx(i){return typeof i=="string"?i:f_(i)}const Fx=1024,yh={};let ag=0;function Ox(i){if(i.length===4)return i;const t=i.slice();return t[3]=1,t}function $p(i){const t=nn.lchuv(Hh.xyz(i));return t[3]=i[3],t}function kx(i){const t=nn.rgb(c_.xyz(i));return t[3]=i[3],t}function o1(i){if(yh.hasOwnProperty(i))return yh[i];if(ag>=Fx){let e=0;for(const n in yh)e++&3||(delete yh[n],--ag)}const t=Rx(i);if(t.length!==4)throw new Error('Failed to parse "'+i+'" as color');for(const e of t)if(isNaN(e))throw new Error('Failed to parse "'+i+'" as color');return u_(t),yh[i]=t,++ag,t}function Al(i){return Array.isArray(i)?i:o1(i)}function u_(i){return i[0]=hi(i[0]+.5|0,0,255),i[1]=hi(i[1]+.5|0,0,255),i[2]=hi(i[2]+.5|0,0,255),i[3]=hi(i[3],0,1),i}function f_(i){let t=i[0];t!=(t|0)&&(t=t+.5|0);let e=i[1];e!=(e|0)&&(e=e+.5|0);let n=i[2];n!=(n|0)&&(n=n+.5|0);const r=i[3]===void 0?1:Math.round(i[3]*1e3)/1e3;return"rgba("+t+","+e+","+n+","+r+")"}function Dx(i){try{return o1(i),!0}catch{return!1}}const wa=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",jx=wa.includes("firefox"),Bx=wa.includes("safari")&&!wa.includes("chrom"),Gx=Bx&&(wa.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(wa)),zx=wa.includes("webkit")&&!wa.includes("edge"),d_=wa.includes("macintosh"),g_=typeof devicePixelRatio<"u"?devicePixelRatio:1,p_=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,m_=typeof Image<"u"&&Image.prototype.decode,__=function(){let i=!1;try{const t=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return i}();function Ki(i,t,e,n){let r;return e&&e.length?r=e.shift():p_?r=new OffscreenCanvas(i||300,t||300):r=document.createElement("canvas"),i&&(r.width=i),t&&(r.height=t),r.getContext("2d",n)}let og;function $g(){return og||(og=Ki(1,1)),og}function Vf(i){const t=i.canvas;t.width=1,t.height=1,i.clearRect(0,0,1,1)}function qx(i){let t=i.offsetWidth;const e=getComputedStyle(i);return t+=parseInt(e.marginLeft,10)+parseInt(e.marginRight,10),t}function Ux(i){let t=i.offsetHeight;const e=getComputedStyle(i);return t+=parseInt(e.marginTop,10)+parseInt(e.marginBottom,10),t}function rf(i,t){const e=t.parentNode;e&&e.replaceChild(i,t)}function sf(i){return i&&i.parentNode?i.parentNode.removeChild(i):null}function v_(i){for(;i.lastChild;)i.removeChild(i.lastChild)}function Wx(i,t){const e=i.childNodes;for(let n=0;;++n){const r=e[n],s=t[n];if(!r&&!s)break;if(r!==s){if(!r){i.appendChild(s);continue}if(!s){i.removeChild(r),--n;continue}i.insertBefore(s,r)}}}function Vx(i,t,e){const n=i;let r=!0,s=!1,a=!1;const o=[Ju(n,le.LOAD,function(){a=!0,s||t()})];return n.src&&m_?(s=!0,n.decode().then(function(){r&&t()}).catch(function(l){r&&(a?t():e())})):o.push(Ju(n,le.ERROR,e)),function(){r=!1,o.forEach(Ke)}}function Hx(i,t){return new Promise((e,n)=>{function r(){a(),e(i)}function s(){a(),n(new Error("Image load error"))}function a(){i.removeEventListener("load",r),i.removeEventListener("error",s)}i.addEventListener("load",r),i.addEventListener("error",s),t&&(i.src=t)})}function Xx(i,t){return t&&(i.src=t),i.src&&m_?new Promise((e,n)=>i.decode().then(()=>e(i)).catch(r=>i.complete&&i.width?e(i):n(r))):Hx(i)}class Yx{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const n=this.cache_[e];!(t++&3)&&!n.hasListener()&&(delete this.cache_[e],delete this.patternCache_[e],--this.cacheSize_)}}}get(t,e,n){const r=lg(t,e,n);return r in this.cache_?this.cache_[r]:null}getPattern(t,e,n){const r=lg(t,e,n);return r in this.patternCache_?this.patternCache_[r]:null}set(t,e,n,r,s){const a=lg(t,e,n),o=a in this.cache_;this.cache_[a]=r,s&&(r.getImageState()===xe.IDLE&&r.load(),r.getImageState()===xe.LOADING?r.ready().then(()=>{this.patternCache_[a]=$g().createPattern(r.getImage(1),"repeat")}):this.patternCache_[a]=$g().createPattern(r.getImage(1),"repeat")),o||++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}}function lg(i,t,e){const n=e?Al(e):"null";return t+":"+i+":"+n}const Zr=new Yx;let xh=null;class Zx extends Nf{constructor(t,e,n,r,s){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=n,this.canvas_={},this.color_=s,this.imageState_=r===void 0?xe.IDLE:r,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===xe.LOADED){xh||(xh=Ki(1,1,void 0,{willReadFrequently:!0})),xh.drawImage(this.image_,0,0);try{xh.getImageData(0,0,1,1),this.tainted_=!1}catch{xh=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(le.CHANGE)}handleImageError_(){this.imageState_=xe.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=xe.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],n=Ki(t,e);n.fillRect(0,0,t,e),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===xe.IDLE){this.image_||this.initializeImage_(),this.imageState_=xe.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&Xx(this.image_,this.src_).then(t=>{this.image_=t,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==xe.LOADED)return;const e=this.image_,n=document.createElement("canvas");n.width=Math.ceil(e.width*t),n.height=Math.ceil(e.height*t);const r=n.getContext("2d");r.scale(t,t),r.drawImage(e,0,0),r.globalCompositeOperation="multiply",r.fillStyle=Nx(this.color_),r.fillRect(0,0,n.width/t,n.height/t),r.globalCompositeOperation="destination-in",r.drawImage(e,0,0),this.canvas_[t]=n}ready(){return this.ready_||(this.ready_=new Promise(t=>{this.imageState_===xe.LOADED||this.imageState_===xe.ERROR?t():this.addEventListener(le.CHANGE,function e(){(this.imageState_===xe.LOADED||this.imageState_===xe.ERROR)&&(this.removeEventListener(le.CHANGE,e),t())})})),this.ready_}}function l1(i,t,e,n,r,s){let a=t===void 0?void 0:Zr.get(t,e,r);return a||(a=new Zx(i,i instanceof HTMLImageElement?i.src||void 0:t,e,n,r),Zr.set(t,e,r,a,s)),s&&a&&!Zr.getPattern(t,e,r)&&Zr.set(t,e,r,a,s),a}function Kr(i){return i?Array.isArray(i)?f_(i):typeof i=="object"&&"src"in i?Kx(i):i:null}function Kx(i){if(!i.offset||!i.size)return Zr.getPattern(i.src,"anonymous",i.color);const t=i.src+":"+i.offset,e=Zr.getPattern(t,void 0,i.color);if(e)return e;const n=Zr.get(i.src,"anonymous",null);if(n.getImageState()!==xe.LOADED)return null;const r=Ki(i.size[0],i.size[1]);return r.drawImage(n.getImage(1),i.offset[0],i.offset[1],i.size[0],i.size[1],0,0,i.size[0],i.size[1]),l1(r.canvas,t,void 0,xe.LOADED,i.color,!0),Zr.getPattern(t,void 0,i.color)}const bu="ol-hidden",$x="ol-selectable",jl="ol-unselectable",Jp="ol-unsupported",_c="ol-control",Qp="ol-collapsed",Jx=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),tm=["style","variant","weight","size","lineHeight","family"],y_=function(i){const t=i.match(Jx);if(!t)return null;const e={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let n=0,r=tm.length;n<r;++n){const s=t[n+1];s!==void 0&&(e[tm[n]]=s)}return e.families=e.family.split(/,\s?/),e},x_="10px sans-serif",Fn="#000",Ml="round",Ps=[],Is=0,Tl="round",Xh=10,Yh="#000",Zh="center",af="middle",Va=[0,0,0,0],Kh=1,xs=new Qn;let Ko=null,Jg;const Qg={},Qx=function(){const t="32px ",e=["monospace","serif"],n=e.length,r="wmytzilWMYTZIL@#/&?$%10";let s,a;function o(h,c,f){let g=!0;for(let d=0;d<n;++d){const m=e[d];if(a=of(h+" "+c+" "+t+m,r),f!=m){const y=of(h+" "+c+" "+t+f+","+m,r);g=g&&y!=a}}return!!g}function l(){let h=!0;const c=xs.getKeys();for(let f=0,g=c.length;f<g;++f){const d=c[f];xs.get(d)<100&&(o.apply(this,d.split(`
`))?(ro(Qg),Ko=null,Jg=void 0,xs.set(d,100)):(xs.set(d,xs.get(d)+1,!0),h=!1))}h&&(clearInterval(s),s=void 0)}return function(h){const c=y_(h);if(!c)return;const f=c.families;for(let g=0,d=f.length;g<d;++g){const m=f[g],y=c.style+`
`+c.weight+`
`+m;xs.get(y)===void 0&&(xs.set(y,100,!0),o(c.style,c.weight,m)||(xs.set(y,0,!0),s===void 0&&(s=setInterval(l,32))))}}}(),tb=function(){let i;return function(t){let e=Qg[t];if(e==null){if(p_){const n=y_(t),r=b_(t,"Žg");e=(isNaN(Number(n.lineHeight))?1.2:Number(n.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else i||(i=document.createElement("div"),i.innerHTML="M",i.style.minHeight="0",i.style.maxHeight="none",i.style.height="auto",i.style.padding="0",i.style.border="none",i.style.position="absolute",i.style.display="block",i.style.left="-99999px"),i.style.font=t,document.body.appendChild(i),e=i.offsetHeight,document.body.removeChild(i);Qg[t]=e}return e}}();function b_(i,t){return Ko||(Ko=Ki(1,1)),i!=Jg&&(Ko.font=i,Jg=Ko.font),Ko.measureText(t)}function of(i,t){return b_(i,t).width}function em(i,t,e){if(t in e)return e[t];const n=t.split(`
`).reduce((r,s)=>Math.max(r,of(i,s)),0);return e[t]=n,n}function eb(i,t){const e=[],n=[],r=[];let s=0,a=0,o=0,l=0;for(let h=0,c=t.length;h<=c;h+=2){const f=t[h];if(f===`
`||h===c){s=Math.max(s,a),r.push(a),a=0,o+=l;continue}const g=t[h+1]||i.font,d=of(g,f);e.push(d),a+=d;const m=tb(g);n.push(m),l=Math.max(l,m)}return{width:s,height:o,widths:e,heights:n,lineWidths:r}}function ib(i,t,e,n,r,s,a,o,l,h,c){i.save(),e!==1&&(i.globalAlpha===void 0?i.globalAlpha=f=>f.globalAlpha*=e:i.globalAlpha*=e),t&&i.transform.apply(i,t),n.contextInstructions?(i.translate(l,h),i.scale(c[0],c[1]),nb(n,i)):c[0]<0||c[1]<0?(i.translate(l,h),i.scale(c[0],c[1]),i.drawImage(n,r,s,a,o,0,0,a,o)):i.drawImage(n,r,s,a,o,l,h,a*c[0],o*c[1]),i.restore()}function nb(i,t){const e=i.contextInstructions;for(let n=0,r=e.length;n<r;n+=2)Array.isArray(e[n+1])?t[e[n]].apply(t,e[n+1]):t[e[n]]=e[n+1]}class Hf extends Wf{constructor(t){super({opacity:1,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode}),this.canvases_,this.hitDetectionCanvas_=null,this.fill_=t.fill!==void 0?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius_=t.radius,this.radius2_=t.radius2,this.angle_=t.angle!==void 0?t.angle:0,this.stroke_=t.stroke!==void 0?t.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?xe.LOADING:xe.LOADED,this.imageState_===xe.LOADING&&this.ready().then(()=>this.imageState_=xe.LOADED),this.render()}clone(){const t=this.getScale(),e=new Hf({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),n=this.getScaleArray();return[t[0]/2-e[0]/n[0],t[1]/2+e[1]/n[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){let e=this.canvases_[t];if(!e){const n=this.renderOptions_,r=Ki(n.size*t,n.size*t);this.draw_(n,r,t),e=r.canvas,this.canvases_[t]=e}return e}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius_}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,n){if(e===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return e;let r=this.radius_,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const W=r;r=s,s=W}const a=this.radius2_===void 0?this.points_:this.points_*2,o=2*Math.PI/a,l=s*Math.sin(o),h=Math.sqrt(s*s-l*l),c=r-h,f=Math.sqrt(l*l+c*c),g=f/l;if(t==="miter"&&g<=n)return g*e;const d=e/2/g,m=e/2*(c/f),b=Math.sqrt((r+d)*(r+d)+m*m)-r;if(this.radius2_===void 0||t==="bevel")return b*2;const x=r*Math.sin(o),E=Math.sqrt(r*r-x*x),S=s-E,D=Math.sqrt(x*x+S*S)/x;if(D<=n){const W=D*e/2-s-r;return 2*Math.max(b,W)}return b*2}createRenderOptions(){let t=Ml,e=Tl,n=0,r=null,s=0,a,o=0;this.stroke_&&(a=Kr(this.stroke_.getColor()??Yh),o=this.stroke_.getWidth()??Kh,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,e=this.stroke_.getLineJoin()??Tl,t=this.stroke_.getLineCap()??Ml,n=this.stroke_.getMiterLimit()??Xh);const l=this.calculateLineJoinSize_(e,o,n),h=Math.max(this.radius_,this.radius2_||0),c=Math.ceil(2*h+l);return{strokeStyle:a,strokeWidth:o,size:c,lineCap:t,lineDash:r,lineDashOffset:s,lineJoin:e,miterLimit:n}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.canvases_={},this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,n){if(e.scale(n,n),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let r=this.fill_.getColor();r===null&&(r=Fn),e.fillStyle=Kr(r),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let n=this.fill_.getColor(),r=0;typeof n=="string"&&(n=Al(n)),n===null?r=1:Array.isArray(n)&&(r=n.length===4?n[3]:1),r===0&&(e=Ki(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const n=this.radius_;if(e===1/0)t.arc(0,0,n,0,2*Math.PI);else{const r=this.radius2_===void 0?n:this.radius2_;this.radius2_!==void 0&&(e*=2);const s=this.angle_-Math.PI/2,a=2*Math.PI/e;for(let o=0;o<e;o++){const l=s+o*a,h=o%2===0?n:r;t.lineTo(h*Math.cos(l),h*Math.sin(l))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=Fn,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class h1 extends Hf{constructor(t){t=t||{radius:5},super({points:1/0,fill:t.fill,radius:t.radius,stroke:t.stroke,scale:t.scale!==void 0?t.scale:1,rotation:t.rotation!==void 0?t.rotation:0,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new h1({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius_=t,this.render()}}const Ta=h1;class bi{constructor(t){t=t||{},this.patternImage_=null,this.color_=null,t.color!==void 0&&this.setColor(t.color)}clone(){const t=this.getColor();return new bi({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){if(t!==null&&typeof t=="object"&&"src"in t){const e=l1(null,t.src,"anonymous",void 0,t.offset?null:t.color?t.color:null,!(t.offset&&t.size));e.ready().then(()=>{this.patternImage_=null}),e.getImageState()===xe.IDLE&&e.load(),e.getImageState()===xe.LOADING&&(this.patternImage_=e)}this.color_=t}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class si{constructor(t){t=t||{},this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new si({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}class ha{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=im,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&typeof t=="object"&&(t=t.clone()),new ha({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){typeof t=="function"?this.geometryFunction_=t:typeof t=="string"?this.geometryFunction_=function(e){return e.get(t)}:t?t!==void 0&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=im,this.geometry_=t}setZIndex(t){this.zIndex_=t}}function rb(i){let t;if(typeof i=="function")t=i;else{let e;Array.isArray(i)?e=i:(Ce(typeof i.getZIndex=="function","Expected an `Style` or an array of `Style`"),e=[i]),t=function(){return e}}return t}let hg=null;function sb(i,t){if(!hg){const e=new bi({color:"rgba(255,255,255,0.4)"}),n=new si({color:"#3399CC",width:1.25});hg=[new ha({image:new Ta({fill:e,stroke:n,radius:5}),fill:e,stroke:n})]}return hg}function w_(){const i={},t=[255,255,255,1],e=[0,153,255,1],n=3;return i.Polygon=[new ha({fill:new bi({color:[255,255,255,.5]})})],i.MultiPolygon=i.Polygon,i.LineString=[new ha({stroke:new si({color:t,width:n+2})}),new ha({stroke:new si({color:e,width:n})})],i.MultiLineString=i.LineString,i.Circle=i.Polygon.concat(i.LineString),i.Point=[new ha({image:new Ta({radius:n*2,fill:new bi({color:e}),stroke:new si({color:t,width:n/2})}),zIndex:1/0})],i.MultiPoint=i.Point,i.GeometryCollection=i.Polygon.concat(i.LineString,i.Point),i}function im(i){return i.getGeometry()}const Fe=ha;function nm(i,t,e,n){return e!==void 0&&n!==void 0?[e/i,n/t]:e!==void 0?e/i:n!==void 0?n/t:1}class Bn extends Wf{constructor(t){t=t||{};const e=t.opacity!==void 0?t.opacity:1,n=t.rotation!==void 0?t.rotation:0,r=t.scale!==void 0?t.scale:1,s=t.rotateWithView!==void 0?t.rotateWithView:!1;super({opacity:e,rotation:n,scale:r,displacement:t.displacement!==void 0?t.displacement:[0,0],rotateWithView:s,declutterMode:t.declutterMode}),this.anchor_=t.anchor!==void 0?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=t.anchorOrigin!==void 0?t.anchorOrigin:"top-left",this.anchorXUnits_=t.anchorXUnits!==void 0?t.anchorXUnits:"fraction",this.anchorYUnits_=t.anchorYUnits!==void 0?t.anchorYUnits:"fraction",this.crossOrigin_=t.crossOrigin!==void 0?t.crossOrigin:null;const a=t.img!==void 0?t.img:null;let o=t.src;Ce(!(o!==void 0&&a),"`image` and `src` cannot be provided at the same time"),(o===void 0||o.length===0)&&a&&(o=a.src||Qt(a)),Ce(o!==void 0&&o.length>0,"A defined and non-empty `src` or `image` must be provided"),Ce(!((t.width!==void 0||t.height!==void 0)&&t.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(t.src!==void 0?l=xe.IDLE:a!==void 0&&(a instanceof HTMLImageElement?a.complete?l=a.src?xe.LOADED:xe.IDLE:l=xe.LOADING:l=xe.LOADED),this.color_=t.color!==void 0?Al(t.color):null,this.iconImage_=l1(a,o,this.crossOrigin_,l,this.color_),this.offset_=t.offset!==void 0?t.offset:[0,0],this.offsetOrigin_=t.offsetOrigin!==void 0?t.offsetOrigin:"top-left",this.origin_=null,this.size_=t.size!==void 0?t.size:null,t.width!==void 0||t.height!==void 0){let h,c;if(t.size)[h,c]=t.size;else{const f=this.getImage(1);if(f.width&&f.height)h=f.width,c=f.height;else if(f instanceof HTMLImageElement){this.initialOptions_=t;const g=()=>{if(this.unlistenImageChange(g),!this.initialOptions_)return;const d=this.iconImage_.getSize();this.setScale(nm(d[0],d[1],t.width,t.height))};this.listenImageChange(g);return}}h!==void 0&&this.setScale(nm(h,c,t.width,t.height))}}clone(){let t,e,n;return this.initialOptions_?(e=this.initialOptions_.width,n=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new Bn({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:n,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;t=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(t[0]*=r[0]),this.anchorYUnits_=="fraction"&&(t[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(t[0]=-t[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(t[1]=-t[1]+r[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),n=this.getScaleArray();return[t[0]-e[0]/n[0],t[1]+e[1]/n[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if(this.offsetOrigin_!="top-left"){const e=this.getSize(),n=this.iconImage_.getSize();if(!e||!n)return null;t=t.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(t[0]=n[0]-e[0]-t[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(t[1]=n[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();if(this.size_)return this.size_[0]*t[0];if(this.iconImage_.getImageState()==xe.LOADED)return this.iconImage_.getSize()[0]*t[0]}getHeight(){const t=this.getScaleArray();if(this.size_)return this.size_[1]*t[1];if(this.iconImage_.getImageState()==xe.LOADED)return this.iconImage_.getSize()[1]*t[1]}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(le.CHANGE,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(le.CHANGE,t)}ready(){return this.iconImage_.ready()}}const ab="#333";class c1{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=kn(t.scale!==void 0?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=t.fill!==void 0?t.fill:new bi({color:ab}),this.maxAngle_=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.placement_=t.placement!==void 0?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=t.stroke!==void 0?t.stroke:null,this.offsetX_=t.offsetX!==void 0?t.offsetX:0,this.offsetY_=t.offsetY!==void 0?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=t.padding===void 0?null:t.padding,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new c1({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=kn(t!==void 0?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}const Xf=c1;let Bl=0;const Gl=0,Ci=1<<Bl++,Yt=1<<Bl++,Pr=1<<Bl++,mn=1<<Bl++,Ns=1<<Bl++,dn=Math.pow(2,Bl)-1,E_={[Ci]:"boolean",[Yt]:"number",[Pr]:"string",[mn]:"color",[Ns]:"number[]"},ob=Object.keys(E_).map(Number).sort(Rs);function _n(i){const t=[];for(const e of ob)lb(i,e)&&t.push(E_[e]);return t.length===0?"untyped":t.length<3?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t[t.length-1]}function lb(i,t){return(i&t)===t}function Qr(i,t){return!!(i&t)}function Yf(i,t){return i===t}class ca{constructor(t,e){this.type=t,this.value=e}}class hb{constructor(t,e,...n){this.type=t,this.operator=e,this.args=n}}function S_(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,style:{}}}function cb(i){switch(i){case"string":return Pr;case"color":return mn;case"number":return Yt;case"boolean":return Ci;case"number[]":return Ns;default:throw new Error(`Unrecognized type hint: ${i}`)}}function qe(i,t,e){switch(typeof i){case"boolean":return new ca(Ci,i);case"number":return new ca(Yt,i);case"string":{let r=Pr;return Dx(i)&&(r|=mn),Yf(r&e,Gl)||(r&=e),new ca(r,i)}}if(!Array.isArray(i))throw new Error("Expression must be an array or a primitive value");if(i.length===0)throw new Error("Empty expression");if(typeof i[0]=="string")return wb(i,t,e);for(const r of i)if(typeof r!="number")throw new Error("Expected an array of numbers");let n=Ns;return(i.length===3||i.length===4)&&(n|=mn),e&&(n&=e),new ca(n,i)}const bt={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette"},ub={[bt.Get]:fe(([i,t])=>t!==void 0?cb(t.value):dn,be(1,2),fb),[bt.Var]:fe(([i])=>i.type,be(1,1),db),[bt.Id]:fe(Yt|Pr,bh,gb),[bt.Concat]:fe(Pr,be(2,1/0),Ne(dn)),[bt.GeometryType]:fe(Pr,bh,pb),[bt.Resolution]:fe(Yt,bh),[bt.Zoom]:fe(Yt,bh),[bt.Time]:fe(Yt,bh),[bt.Any]:fe(Ci,be(2,1/0),Ne(Ci)),[bt.All]:fe(Ci,be(2,1/0),Ne(Ci)),[bt.Not]:fe(Ci,be(1,1),Ne(Ci)),[bt.Equal]:fe(Ci,be(2,2),Ne(dn),ta),[bt.NotEqual]:fe(Ci,be(2,2),Ne(dn),ta),[bt.GreaterThan]:fe(Ci,be(2,2),Ne(dn),ta),[bt.GreaterThanOrEqualTo]:fe(Ci,be(2,2),Ne(dn),ta),[bt.LessThan]:fe(Ci,be(2,2),Ne(dn),ta),[bt.LessThanOrEqualTo]:fe(Ci,be(2,2),Ne(dn),ta),[bt.Multiply]:fe(i=>{let t=Yt|mn;for(let e=0;e<i.length;e++)t&=i[e].type;return t},be(2,1/0),Ne(Yt|mn),ta),[bt.Coalesce]:fe(i=>{let t=dn;for(let e=1;e<i.length;e+=2)t&=i[e].type;return t&=i[i.length-1].type,t},be(2,1/0),Ne(dn),ta),[bt.Divide]:fe(Yt,be(2,2),Ne(Yt)),[bt.Add]:fe(Yt,be(2,1/0),Ne(Yt)),[bt.Subtract]:fe(Yt,be(2,2),Ne(Yt)),[bt.Clamp]:fe(Yt,be(3,3),Ne(Yt)),[bt.Mod]:fe(Yt,be(2,2),Ne(Yt)),[bt.Pow]:fe(Yt,be(2,2),Ne(Yt)),[bt.Abs]:fe(Yt,be(1,1),Ne(Yt)),[bt.Floor]:fe(Yt,be(1,1),Ne(Yt)),[bt.Ceil]:fe(Yt,be(1,1),Ne(Yt)),[bt.Round]:fe(Yt,be(1,1),Ne(Yt)),[bt.Sin]:fe(Yt,be(1,1),Ne(Yt)),[bt.Cos]:fe(Yt,be(1,1),Ne(Yt)),[bt.Atan]:fe(Yt,be(1,2),Ne(Yt)),[bt.Sqrt]:fe(Yt,be(1,1),Ne(Yt)),[bt.Match]:fe(i=>{let t=dn;for(let e=2;e<i.length;e+=2)t&=i[e].type;return t&=i[i.length-1].type,t},be(4,1/0),rm,_b),[bt.Between]:fe(Ci,be(3,3),Ne(Yt)),[bt.Interpolate]:fe(i=>{let t=mn|Yt;for(let e=3;e<i.length;e+=2)t&=i[e].type;return t},be(6,1/0),rm,vb),[bt.Case]:fe(i=>{let t=dn;for(let e=1;e<i.length;e+=2)t&=i[e].type;return t&=i[i.length-1].type,t},be(3,1/0),mb,yb),[bt.In]:fe(Ci,be(2,2),xb),[bt.Number]:fe(Yt,be(1,1/0),Ne(dn)),[bt.String]:fe(Pr,be(1,1/0),Ne(dn)),[bt.Array]:fe(i=>i.length===3||i.length===4?Ns|mn:Ns,be(1,1/0),Ne(Yt)),[bt.Color]:fe(mn,be(1,4),Ne(Yt)),[bt.Band]:fe(Yt,be(1,3),Ne(Yt)),[bt.Palette]:fe(mn,be(2,2),bb)};function fb(i,t){const e=qe(i[1],t);if(!(e instanceof ca))throw new Error("Expected a literal argument for get operation");if(typeof e.value!="string")throw new Error("Expected a string argument for get operation");if(t.properties.add(e.value),i.length===3){const n=qe(i[2],t);return[e,n]}return[e]}function db(i,t,e,n){const r=i[1];if(typeof r!="string")throw new Error("Expected a string argument for var operation");if(t.variables.add(r),!("variables"in t.style)||t.style.variables[r]===void 0)return[new ca(dn,r)];const s=t.style.variables[r],a=qe(s,t);if(a.value=r,n&&!Qr(n,a.type))throw new Error(`The variable ${r} has type ${_n(a.type)} but the following type was expected: ${_n(n)}`);return[a]}function gb(i,t){t.featureId=!0}function pb(i,t){t.geometryType=!0}function bh(i,t){const e=i[0];if(i.length!==1)throw new Error(`Expected no arguments for ${e} operation`);return[]}function be(i,t){return function(e,n){const r=e[0],s=e.length-1;if(i===t){if(s!==i){const a=i===1?"":"s";throw new Error(`Expected ${i} argument${a} for ${r}, got ${s}`)}}else if(s<i||s>t){const a=t===1/0?`${i} or more`:`${i} to ${t}`;throw new Error(`Expected ${a} arguments for ${r}, got ${s}`)}}}function Ne(i){return function(t,e){const n=t[0],r=t.length-1,s=new Array(r);for(let a=0;a<r;++a){const o=qe(t[a+1],e);if(!Qr(i,o.type)){const l=_n(i),h=_n(o.type);throw new Error(`Unexpected type for argument ${a} of ${n} operation, got ${l} but expected ${h}`)}o.type&=i,s[a]=o}return s}}function ta(i,t,e){const n=i[0],r=i.length-1;let s=dn;for(let o=0;o<e.length;++o)s&=e[o].type;if(s===Gl)throw new Error(`No common type could be found for arguments of ${n} operation`);const a=new Array(r);for(let o=0;o<r;++o)a[o]=qe(i[o+1],t,s);return a}function mb(i,t){const e=i[0],n=i.length-1;if(n%2===0)throw new Error(`An odd amount of arguments was expected for operation ${e}, got ${JSON.stringify(n)} instead`)}function rm(i,t){const e=i[0],n=i.length-1;if(n%2===1)throw new Error(`An even amount of arguments was expected for operation ${e}, got ${JSON.stringify(n)} instead`)}function _b(i,t,e,n){const r=i.length-1;let a=qe(i[1],t).type;const o=qe(i[i.length-1],t);let l=n!==void 0?n&o.type:o.type;const h=new Array(r-2);for(let f=0;f<r-2;f+=2){const g=qe(i[f+2],t),d=qe(i[f+3],t);a&=g.type,l&=d.type,h[f]=g,h[f+1]=d}const c=Pr|Yt|Ci;if(!Qr(c,a))throw new Error(`Expected an input of type ${_n(c)} for the interpolate operation, got ${_n(a)} instead`);if(Yf(l,Gl))throw new Error("Could not find a common output type for the following match operation: "+JSON.stringify(i));for(let f=0;f<r-2;f+=2){const g=qe(i[f+2],t,a),d=qe(i[f+3],t,l);h[f]=g,h[f+1]=d}return[qe(i[1],t,a),...h,qe(i[i.length-1],t,l)]}function vb(i,t,e,n){const r=i[1];let s;switch(r[0]){case"linear":s=1;break;case"exponential":if(s=r[1],typeof s!="number")throw new Error(`Expected a number base for exponential interpolation, got ${JSON.stringify(s)} instead`);break;default:s=null}if(!s)throw new Error(`Invalid interpolation type: ${JSON.stringify(r)}`);s=qe(s,t);let a=qe(i[2],t);if(!Qr(Yt,a.type))throw new Error(`Expected an input of type number for the interpolate operation, got ${_n(a.type)} instead`);a=qe(i[2],t,Yt);const o=new Array(i.length-3);for(let l=0;l<o.length;l+=2){let h=qe(i[l+3],t);if(!Qr(Yt,h.type))throw new Error(`Expected all stop input values in the interpolate operation to be of type number, got ${_n(h.type)} at position ${l+2} instead`);let c=qe(i[l+4],t);if(!Qr(Yt|mn,c.type))throw new Error(`Expected all stop output values in the interpolate operation to be a number or color, got ${_n(c.type)} at position ${l+3} instead`);h=qe(i[l+3],t,Yt),c=qe(i[l+4],t,Yt|mn),o[l]=h,o[l+1]=c}return[s,a,...o]}function yb(i,t,e,n){const r=qe(i[i.length-1],t);let s=n!==void 0?n&r.type:r.type;const a=new Array(i.length-1);for(let o=0;o<a.length-1;o+=2){const l=qe(i[o+1],t),h=qe(i[o+2],t);if(!Qr(Ci,l.type))throw new Error(`Expected all conditions in the case operation to be of type boolean, got ${_n(l.type)} at position ${o} instead`);s&=h.type,a[o]=l,a[o+1]=h}if(Yf(s,Gl))throw new Error("Could not find a common output type for the following case operation: "+JSON.stringify(i));for(let o=0;o<a.length-1;o+=2)a[o+1]=qe(i[o+2],t,s);return a[a.length-1]=qe(i[i.length-1],t,s),a}function xb(i,t){let e=i[2];if(!Array.isArray(e))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');if(typeof e[0]=="string"){if(e[0]!=="literal")throw new Error('For the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions.');if(!Array.isArray(e[1]))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');e=e[1]}let n=Pr|Yt;const r=new Array(e.length);for(let a=0;a<r.length;a++){const o=qe(e[a],t);n&=o.type,r[a]=o}if(Yf(n,Gl))throw new Error("Could not find a common type for the following in operation: "+JSON.stringify(i));return[qe(i[1],t,n),...r]}function bb(i,t){const e=qe(i[1],t,Yt);if(e.type!==Yt)throw new Error(`The first argument of palette must be an number, got ${_n(e.type)} instead`);const n=i[2];if(!Array.isArray(n))throw new Error("The second argument of palette must be an array");const r=new Array(n.length);for(let s=0;s<r.length;s++){const a=qe(n[s],t,mn);if(!(a instanceof ca))throw new Error(`The palette color at index ${s} must be a literal value`);if(!Qr(a.type,mn))throw new Error(`The palette color at index ${s} should be of type color, got ${_n(a.type)} instead`);r[s]=a}return[e,...r]}function fe(i,...t){return function(e,n,r){const s=e[0];let a=[];for(let l=0;l<t.length;l++)a=t[l](e,n,a,r)||a;let o=typeof i=="function"?i(a):i;if(r!==void 0){if(!Qr(o,r))throw new Error(`The following expression was expected to return ${_n(r)}, but returns ${_n(o)} instead: ${JSON.stringify(e)}`);o&=r}if(o===Gl)throw new Error(`No matching type was found for the following expression: ${JSON.stringify(e)}`);return new hb(o,s,...a)}}function wb(i,t,e){const n=i[0],r=ub[n];if(!r)throw new Error(`Unknown operator: ${n}`);return r(i,t,e)}function L_(i){if(!i)return"";const t=i.getType();switch(t){case"Point":case"LineString":case"Polygon":return t;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return t.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return L_(i.getGeometries()[0]);default:return""}}function C_(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function ks(i,t,e){const n=qe(i,e);if(!Qr(t,n.type)){const r=_n(t),s=_n(n.type);throw new Error(`Expected expression to be of type ${r}, got ${s}`)}return ns(n)}function ns(i,t){if(i instanceof ca){if(i.type===mn&&typeof i.value=="string"){const n=o1(i.value);return function(){return n}}return function(){return i.value}}const e=i.operator;switch(e){case bt.Number:case bt.String:case bt.Coalesce:return Eb(i);case bt.Get:case bt.Var:return Sb(i);case bt.Id:return n=>n.featureId;case bt.GeometryType:return n=>n.geometryType;case bt.Concat:{const n=i.args.map(r=>ns(r));return r=>"".concat(...n.map(s=>s(r).toString()))}case bt.Resolution:return n=>n.resolution;case bt.Any:case bt.All:case bt.Not:return Cb(i);case bt.Equal:case bt.NotEqual:case bt.LessThan:case bt.LessThanOrEqualTo:case bt.GreaterThan:case bt.GreaterThanOrEqualTo:return Lb(i);case bt.Multiply:case bt.Divide:case bt.Add:case bt.Subtract:case bt.Clamp:case bt.Mod:case bt.Pow:case bt.Abs:case bt.Floor:case bt.Ceil:case bt.Round:case bt.Sin:case bt.Cos:case bt.Atan:case bt.Sqrt:return Ab(i);case bt.Case:return Mb(i);case bt.Match:return Tb(i);case bt.Interpolate:return Pb(i);default:throw new Error(`Unsupported operator ${e}`)}}function Eb(i,t){const e=i.operator,n=i.args.length,r=new Array(n);for(let s=0;s<n;++s)r[s]=ns(i.args[s]);switch(e){case bt.Coalesce:return s=>{for(let a=0;a<n;++a){const o=r[a](s);if(typeof o<"u"&&o!==null)return o}throw new Error("Expected one of the values to be non-null")};case bt.Number:case bt.String:return s=>{for(let a=0;a<n;++a){const o=r[a](s);if(typeof o===e)return o}throw new Error(`Expected one of the values to be a ${e}`)};default:throw new Error(`Unsupported assertion operator ${e}`)}}function Sb(i,t){const n=i.args[0].value;switch(i.operator){case bt.Get:return r=>r.properties[n];case bt.Var:return r=>r.variables[n];default:throw new Error(`Unsupported accessor operator ${i.operator}`)}}function Lb(i,t){const e=i.operator,n=ns(i.args[0]),r=ns(i.args[1]);switch(e){case bt.Equal:return s=>n(s)===r(s);case bt.NotEqual:return s=>n(s)!==r(s);case bt.LessThan:return s=>n(s)<r(s);case bt.LessThanOrEqualTo:return s=>n(s)<=r(s);case bt.GreaterThan:return s=>n(s)>r(s);case bt.GreaterThanOrEqualTo:return s=>n(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${e}`)}}function Cb(i,t){const e=i.operator,n=i.args.length,r=new Array(n);for(let s=0;s<n;++s)r[s]=ns(i.args[s]);switch(e){case bt.Any:return s=>{for(let a=0;a<n;++a)if(r[a](s))return!0;return!1};case bt.All:return s=>{for(let a=0;a<n;++a)if(!r[a](s))return!1;return!0};case bt.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${e}`)}}function Ab(i,t){const e=i.operator,n=i.args.length,r=new Array(n);for(let s=0;s<n;++s)r[s]=ns(i.args[s]);switch(e){case bt.Multiply:return s=>{let a=1;for(let o=0;o<n;++o)a*=r[o](s);return a};case bt.Divide:return s=>r[0](s)/r[1](s);case bt.Add:return s=>{let a=0;for(let o=0;o<n;++o)a+=r[o](s);return a};case bt.Subtract:return s=>r[0](s)-r[1](s);case bt.Clamp:return s=>{const a=r[0](s),o=r[1](s);if(a<o)return o;const l=r[2](s);return a>l?l:a};case bt.Mod:return s=>r[0](s)%r[1](s);case bt.Pow:return s=>Math.pow(r[0](s),r[1](s));case bt.Abs:return s=>Math.abs(r[0](s));case bt.Floor:return s=>Math.floor(r[0](s));case bt.Ceil:return s=>Math.ceil(r[0](s));case bt.Round:return s=>Math.round(r[0](s));case bt.Sin:return s=>Math.sin(r[0](s));case bt.Cos:return s=>Math.cos(r[0](s));case bt.Atan:return n===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case bt.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${e}`)}}function Mb(i,t){const e=i.args.length,n=new Array(e);for(let r=0;r<e;++r)n[r]=ns(i.args[r]);return r=>{for(let s=0;s<e-1;s+=2)if(n[s](r))return n[s+1](r);return n[e-1](r)}}function Tb(i,t){const e=i.args.length,n=new Array(e);for(let r=0;r<e;++r)n[r]=ns(i.args[r]);return r=>{const s=n[0](r);for(let a=1;a<e;a+=2)if(s===n[a](r))return n[a+1](r);return n[e-1](r)}}function Pb(i,t){const e=i.args.length,n=new Array(e);for(let r=0;r<e;++r)n[r]=ns(i.args[r]);return r=>{const s=n[0](r),a=n[1](r);let o,l;for(let h=2;h<e;h+=2){const c=n[h](r);let f=n[h+1](r);const g=Array.isArray(f);if(g&&(f=Ox(f)),c>=a)return h===2?f:g?Ib(s,a,o,l,c,f):Ah(s,a,o,l,c,f);o=c,l=f}return l}}function Ah(i,t,e,n,r,s){const a=r-e;if(a===0)return n;const o=t-e,l=i===1?o/a:(Math.pow(i,o)-1)/(Math.pow(i,a)-1);return n+l*(s-n)}function Ib(i,t,e,n,r,s){if(r-e===0)return n;const o=$p(n),l=$p(s);let h=l[2]-o[2];h>180?h-=360:h<-180&&(h+=360);const c=[Ah(i,t,e,o[0],r,l[0]),Ah(i,t,e,o[1],r,l[1]),o[2]+Ah(i,t,e,0,r,h),Ah(i,t,e,n[3],r,s[3])];return u_(kx(c))}function Rb(i){return!0}function Nb(i){const t=S_(),e=Fb(i,t),n=C_();return function(r,s){if(n.properties=r.getPropertiesInternal(),n.resolution=s,t.featureId){const a=r.getId();a!==void 0?n.featureId=a:n.featureId=null}return t.geometryType&&(n.geometryType=L_(r.getGeometry())),e(n)}}function sm(i){const t=S_(),e=i.length,n=new Array(e);for(let a=0;a<e;++a)n[a]=t0(i[a],t);const r=C_(),s=new Array(e);return function(a,o){if(r.properties=a.getPropertiesInternal(),r.resolution=o,t.featureId){const h=a.getId();h!==void 0?r.featureId=h:r.featureId=null}let l=0;for(let h=0;h<e;++h){const c=n[h](r);c&&(s[l]=c,l+=1)}return s.length=l,s}}function Fb(i,t){const e=i.length,n=new Array(e);for(let r=0;r<e;++r){const s=i[r],a="filter"in s?ks(s.filter,Ci,t):Rb;let o;if(Array.isArray(s.style)){const l=s.style.length;o=new Array(l);for(let h=0;h<l;++h)o[h]=t0(s.style[h],t)}else o=[t0(s.style,t)];n[r]={filter:a,styles:o}}return function(r){const s=[];let a=!1;for(let o=0;o<e;++o){const l=n[o].filter;if(l(r)&&!(i[o].else&&a)){a=!0;for(const h of n[o].styles){const c=h(r);c&&s.push(c)}}}return s}}function t0(i,t){const e=$h(i,"",t),n=Jh(i,"",t),r=Ob(i,t),s=kb(i,t),a=On(i,"z-index",t);if(!e&&!n&&!r&&!s&&!Qa(i))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(i));const o=new Fe;return function(l){let h=!0;if(e){const c=e(l);c&&(h=!1),o.setFill(c)}if(n){const c=n(l);c&&(h=!1),o.setStroke(c)}if(r){const c=r(l);c&&(h=!1),o.setText(c)}if(s){const c=s(l);c&&(h=!1),o.setImage(c)}return a&&o.setZIndex(a(l)),h?null:o}}function $h(i,t,e){let n;if(t+"fill-pattern-src"in i?n=Gb(i,t+"fill-",e):n=u1(i,t+"fill-color",e),!n)return null;const r=new bi;return function(s){const a=n(s);return a==="none"?null:(r.setColor(a),r)}}function Jh(i,t,e){const n=On(i,t+"stroke-width",e),r=u1(i,t+"stroke-color",e);if(!n&&!r)return null;const s=Ss(i,t+"stroke-line-cap",e),a=Ss(i,t+"stroke-line-join",e),o=A_(i,t+"stroke-line-dash",e),l=On(i,t+"stroke-line-dash-offset",e),h=On(i,t+"stroke-miter-limit",e),c=new si;return function(f){if(r){const g=r(f);if(g==="none")return null;c.setColor(g)}if(n&&c.setWidth(n(f)),s){const g=s(f);if(g!=="butt"&&g!=="round"&&g!=="square")throw new Error("Expected butt, round, or square line cap");c.setLineCap(g)}if(a){const g=a(f);if(g!=="bevel"&&g!=="round"&&g!=="miter")throw new Error("Expected bevel, round, or miter line join");c.setLineJoin(g)}return o&&c.setLineDash(o(f)),l&&c.setLineDashOffset(l(f)),h&&c.setMiterLimit(h(f)),c}}function Ob(i,t){const e="text-",n=Ss(i,e+"value",t);if(!n)return null;const r=$h(i,e,t),s=$h(i,e+"background-",t),a=Jh(i,e,t),o=Jh(i,e+"background-",t),l=Ss(i,e+"font",t),h=On(i,e+"max-angle",t),c=On(i,e+"offset-x",t),f=On(i,e+"offset-y",t),g=Qh(i,e+"overflow",t),d=Ss(i,e+"placement",t),m=On(i,e+"repeat",t),y=Zf(i,e+"scale",t),b=Qh(i,e+"rotate-with-view",t),x=On(i,e+"rotation",t),E=Ss(i,e+"align",t),S=Ss(i,e+"justify",t),M=Ss(i,e+"baseline",t),D=A_(i,e+"padding",t),W=Kf(i,e+"declutter-mode"),j=new Xf({declutterMode:W});return function(P){if(j.setText(n(P)),r&&j.setFill(r(P)),s&&j.setBackgroundFill(s(P)),a&&j.setStroke(a(P)),o&&j.setBackgroundStroke(o(P)),l&&j.setFont(l(P)),h&&j.setMaxAngle(h(P)),c&&j.setOffsetX(c(P)),f&&j.setOffsetY(f(P)),g&&j.setOverflow(g(P)),d){const H=d(P);if(H!=="point"&&H!=="line")throw new Error("Expected point or line for text-placement");j.setPlacement(H)}if(m&&j.setRepeat(m(P)),y&&j.setScale(y(P)),b&&j.setRotateWithView(b(P)),x&&j.setRotation(x(P)),E){const H=E(P);if(H!=="left"&&H!=="center"&&H!=="right"&&H!=="end"&&H!=="start")throw new Error("Expected left, right, center, start, or end for text-align");j.setTextAlign(H)}if(S){const H=S(P);if(H!=="left"&&H!=="right"&&H!=="center")throw new Error("Expected left, right, or center for text-justify");j.setJustify(H)}if(M){const H=M(P);if(H!=="bottom"&&H!=="top"&&H!=="middle"&&H!=="alphabetic"&&H!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");j.setTextBaseline(H)}return D&&j.setPadding(D(P)),j}}function kb(i,t){return"icon-src"in i?Db(i,t):"shape-points"in i?jb(i,t):"circle-radius"in i?Bb(i,t):null}function Db(i,t){const e="icon-",n=e+"src",r=M_(i[n],n),s=lf(i,e+"anchor",t),a=Zf(i,e+"scale",t),o=On(i,e+"opacity",t),l=lf(i,e+"displacement",t),h=On(i,e+"rotation",t),c=Qh(i,e+"rotate-with-view",t),f=om(i,e+"anchor-origin"),g=lm(i,e+"anchor-x-units"),d=lm(i,e+"anchor-y-units"),m=Wb(i,e+"color"),y=qb(i,e+"cross-origin"),b=Ub(i,e+"offset"),x=om(i,e+"offset-origin"),E=hf(i,e+"width"),S=hf(i,e+"height"),M=zb(i,e+"size"),D=Kf(i,e+"declutter-mode"),W=new Bn({src:r,anchorOrigin:f,anchorXUnits:g,anchorYUnits:d,color:m,crossOrigin:y,offset:b,offsetOrigin:x,height:S,width:E,size:M,declutterMode:D});return function(j){return o&&W.setOpacity(o(j)),l&&W.setDisplacement(l(j)),h&&W.setRotation(h(j)),c&&W.setRotateWithView(c(j)),a&&W.setScale(a(j)),s&&W.setAnchor(s(j)),W}}function jb(i,t){const e="shape-",n=e+"points",r=e+"radius",s=e0(i[n],n),a=e0(i[r],r),o=$h(i,e,t),l=Jh(i,e,t),h=Zf(i,e+"scale",t),c=lf(i,e+"displacement",t),f=On(i,e+"rotation",t),g=Qh(i,e+"rotate-with-view",t),d=hf(i,e+"radius2"),m=hf(i,e+"angle"),y=Kf(i,e+"declutter-mode"),b=new Hf({points:s,radius:a,radius2:d,angle:m,declutterMode:y});return function(x){return o&&b.setFill(o(x)),l&&b.setStroke(l(x)),c&&b.setDisplacement(c(x)),f&&b.setRotation(f(x)),g&&b.setRotateWithView(g(x)),h&&b.setScale(h(x)),b}}function Bb(i,t){const e="circle-",n=$h(i,e,t),r=Jh(i,e,t),s=On(i,e+"radius",t),a=Zf(i,e+"scale",t),o=lf(i,e+"displacement",t),l=On(i,e+"rotation",t),h=Qh(i,e+"rotate-with-view",t),c=Kf(i,e+"declutter-mode"),f=new Ta({radius:5,declutterMode:c});return function(g){return s&&f.setRadius(s(g)),n&&f.setFill(n(g)),r&&f.setStroke(r(g)),o&&f.setDisplacement(o(g)),l&&f.setRotation(l(g)),h&&f.setRotateWithView(h(g)),a&&f.setScale(a(g)),f}}function On(i,t,e){if(!(t in i))return;const n=ks(i[t],Yt,e);return function(r){return e0(n(r),t)}}function Ss(i,t,e){if(!(t in i))return null;const n=ks(i[t],Pr,e);return function(r){return M_(n(r),t)}}function Gb(i,t,e){const n=Ss(i,t+"pattern-src",e),r=am(i,t+"pattern-offset",e),s=am(i,t+"pattern-size",e),a=u1(i,t+"color",e);return function(o){return{src:n(o),offset:r&&r(o),size:s&&s(o),color:a&&a(o)}}}function Qh(i,t,e){if(!(t in i))return null;const n=ks(i[t],Ci,e);return function(r){const s=n(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${t}`);return s}}function u1(i,t,e){if(!(t in i))return null;const n=ks(i[t],mn|Pr,e);return function(r){return T_(n(r),t)}}function A_(i,t,e){if(!(t in i))return null;const n=ks(i[t],Ns,e);return function(r){return vc(n(r),t)}}function lf(i,t,e){if(!(t in i))return null;const n=ks(i[t],Ns,e);return function(r){const s=vc(n(r),t);if(s.length!==2)throw new Error(`Expected two numbers for ${t}`);return s}}function am(i,t,e){if(!(t in i))return null;const n=ks(i[t],Ns,e);return function(r){return P_(n(r),t)}}function Zf(i,t,e){if(!(t in i))return null;const n=ks(i[t],Ns|Yt,e);return function(r){return Vb(n(r),t)}}function hf(i,t){const e=i[t];if(e!==void 0){if(typeof e!="number")throw new Error(`Expected a number for ${t}`);return e}}function zb(i,t){const e=i[t];if(e!==void 0){if(typeof e=="number")return kn(e);if(!Array.isArray(e))throw new Error(`Expected a number or size array for ${t}`);if(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number")throw new Error(`Expected a number or size array for ${t}`);return e}}function qb(i,t){const e=i[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);return e}}function om(i,t){const e=i[t];if(e!==void 0){if(e!=="bottom-left"&&e!=="bottom-right"&&e!=="top-left"&&e!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${t}`);return e}}function lm(i,t){const e=i[t];if(e!==void 0){if(e!=="pixels"&&e!=="fraction")throw new Error(`Expected pixels or fraction for ${t}`);return e}}function Ub(i,t){const e=i[t];if(e!==void 0)return vc(e,t)}function Kf(i,t){const e=i[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);if(e!=="declutter"&&e!=="obstacle"&&e!=="none")throw new Error(`Expected declutter, obstacle, or none for ${t}`);return e}}function Wb(i,t){const e=i[t];if(e!==void 0)return T_(e,t)}function vc(i,t){if(!Array.isArray(i))throw new Error(`Expected an array for ${t}`);const e=i.length;for(let n=0;n<e;++n)if(typeof i[n]!="number")throw new Error(`Expected an array of numbers for ${t}`);return i}function M_(i,t){if(typeof i!="string")throw new Error(`Expected a string for ${t}`);return i}function e0(i,t){if(typeof i!="number")throw new Error(`Expected a number for ${t}`);return i}function T_(i,t){if(typeof i=="string")return i;const e=vc(i,t),n=e.length;if(n<3||n>4)throw new Error(`Expected a color with 3 or 4 values for ${t}`);return e}function P_(i,t){const e=vc(i,t);if(e.length!==2)throw new Error(`Expected an array of two numbers for ${t}`);return e}function Vb(i,t){return typeof i=="number"?i:P_(i,t)}const hm={RENDER_ORDER:"renderOrder"};class yc extends Dl{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=t.declutter?String(t.declutter):void 0,this.renderBuffer_=t.renderBuffer!==void 0?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=t.updateWhileAnimating!==void 0?t.updateWhileAnimating:!1,this.updateWhileInteracting_=t.updateWhileInteracting!==void 0?t.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(hm.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t,e){const n=this.getDeclutter();n in t.declutter||(t.declutter[n]=new h_(9)),this.getRenderer().renderDeclutter(t,e)}setRenderOrder(t){this.set(hm.RENDER_ORDER,t)}setStyle(t){this.style_=Hb(t),this.styleFunction_=t===null?void 0:rb(this.style_),this.changed()}}function Hb(i){if(i===void 0)return sb;if(!i)return null;if(typeof i=="function"||i instanceof Fe)return i;if(!Array.isArray(i))return sm([i]);if(i.length===0)return[];const t=i.length,e=i[0];if(e instanceof Fe){const r=new Array(t);for(let s=0;s<t;++s){const a=i[s];if(!(a instanceof Fe))throw new Error("Expected a list of style instances");r[s]=a}return r}if("style"in e){const r=new Array(t);for(let s=0;s<t;++s){const a=i[s];if(!("style"in a))throw new Error("Expected a list of rules with a style property");r[s]=a}return Nb(r)}return sm(i)}class Xb extends Rf{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){ae()}calculateMatrices2D(t){const e=t.viewState,n=t.coordinateToPixelTransform,r=t.pixelToCoordinateTransform;Jn(n,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),pc(r,n)}forEachFeatureAtCoordinate(t,e,n,r,s,a,o,l){let h;const c=e.viewState;function f(M,D,W,j){return s.call(a,D,M?W:null,j)}const g=c.projection,d=Df(t.slice(),g),m=[[0,0]];if(g.canWrapX()&&r){const M=g.getExtent(),D=Re(M);m.push([-D,0],[D,0])}const y=e.layerStatesArray,b=y.length,x=[],E=[];for(let M=0;M<m.length;M++)for(let D=b-1;D>=0;--D){const W=y[D],j=W.layer;if(j.hasRenderer()&&s1(W,c)&&o.call(l,j)){const P=j.getRenderer(),H=j.getSource();if(P&&H){const et=H.getWrapX()?d:t,R=f.bind(null,W.managed);E[0]=et[0]+m[M][0],E[1]=et[1]+m[M][1],h=P.forEachFeatureAtCoordinate(E,e,n,R,x)}if(h)return h}}if(x.length===0)return;const S=1/x.length;return x.forEach((M,D)=>M.distanceSq+=D*S),x.sort((M,D)=>M.distanceSq-D.distanceSq),x.some(M=>h=M.callback(M.feature,M.layer,M.geometry)),h}hasFeatureAtCoordinate(t,e,n,r,s,a){return this.forEachFeatureAtCoordinate(t,e,n,r,_a,this,s,a)!==void 0}getMap(){return this.map_}renderFrame(t){ae()}scheduleExpireIconCache(t){Zr.canExpireCache()&&t.postRenderFunctions.push(Yb)}}function Yb(i,t){Zr.expire()}class Nh extends Nr{constructor(t,e,n,r){super(t),this.inversePixelTransform=e,this.frameState=n,this.context=r}}class Zb extends Xb{constructor(t){super(t),this.fontChangeListenerKey_=_e(xs,El.PROPERTYCHANGE,t.redrawText.bind(t)),this.element_=document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=jl+" ol-layers";const n=t.getViewport();n.insertBefore(this.element_,n.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(t,e){const n=this.getMap();if(n.hasListener(t)){const r=new Nh(t,void 0,e);n.dispatchEvent(r)}}disposeInternal(){Ke(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(Zi.PRECOMPOSE,t);const e=t.layerStatesArray.sort(function(o,l){return o.zIndex-l.zIndex});e.some(o=>o.layer instanceof yc&&o.layer.getDeclutter())&&(t.declutter={});const r=t.viewState;this.children_.length=0;const s=[];let a=null;for(let o=0,l=e.length;o<l;++o){const h=e[o];t.layerIndex=o;const c=h.layer,f=c.getSourceState();if(!s1(h,r)||f!="ready"&&f!="undefined"){c.unrender();continue}const g=c.render(t,a);g&&(g!==a&&(this.children_.push(g),a=g),s.push(h))}this.declutter(t,s),Wx(this.element_,this.children_),this.dispatchRenderEvent(Zi.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}declutter(t,e){for(let n=e.length-1;n>=0;--n){const r=e[n],s=r.layer;s.getDeclutter()&&s.renderDeclutter(t,r)}e.forEach(n=>n.layer.renderDeferred(t))}}class oa extends Nr{constructor(t,e){super(t),this.layer=e}}const cg={LAYERS:"layers"};class Cn extends P2{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let n=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(cg.LAYERS,this.handleLayersChanged_),n?Array.isArray(n)?n=new Tr(n.slice(),{unique:!0}):Ce(typeof n.getArray=="function","Expected `layers` to be an array or a `Collection`"):n=new Tr(void 0,{unique:!0}),this.setLayers(n)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Ke),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(_e(t,Yi.ADD,this.handleLayersAdd_,this),_e(t,Yi.REMOVE,this.handleLayersRemove_,this));for(const n in this.listenerKeys_)this.listenerKeys_[n].forEach(Ke);ro(this.listenerKeys_);const e=t.getArray();for(let n=0,r=e.length;n<r;n++){const s=e[n];this.registerLayerListeners_(s),this.dispatchEvent(new oa("addlayer",s))}this.changed()}registerLayerListeners_(t){const e=[_e(t,El.PROPERTYCHANGE,this.handleLayerChange_,this),_e(t,le.CHANGE,this.handleLayerChange_,this)];t instanceof Cn&&e.push(_e(t,"addlayer",this.handleLayerGroupAdd_,this),_e(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[Qt(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new oa("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new oa("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new oa("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,n=Qt(e);this.listenerKeys_[n].forEach(Ke),delete this.listenerKeys_[n],this.dispatchEvent(new oa("removelayer",e)),this.changed()}getLayers(){return this.get(cg.LAYERS)}setLayers(t){const e=this.getLayers();if(e){const n=e.getArray();for(let r=0,s=n.length;r<s;++r)this.dispatchEvent(new oa("removelayer",n[r]))}this.set(cg.LAYERS,t)}getLayersArray(t){return t=t!==void 0?t:[],this.getLayers().forEach(function(e){e.getLayersArray(t)}),t}getLayerStatesArray(t){const e=t!==void 0?t:[],n=e.length;this.getLayers().forEach(function(a){a.getLayerStatesArray(e)});const r=this.getLayerState();let s=r.zIndex;!t&&r.zIndex===void 0&&(s=0);for(let a=n,o=e.length;a<o;a++){const l=e[a];l.opacity*=r.opacity,l.visible=l.visible&&r.visible,l.maxResolution=Math.min(l.maxResolution,r.maxResolution),l.minResolution=Math.max(l.minResolution,r.minResolution),l.minZoom=Math.max(l.minZoom,r.minZoom),l.maxZoom=Math.min(l.maxZoom,r.maxZoom),r.extent!==void 0&&(l.extent!==void 0?l.extent=Ka(l.extent,r.extent):l.extent=r.extent),l.zIndex===void 0&&(l.zIndex=s)}return e}getSourceState(){return"ready"}}class $o extends Nr{constructor(t,e,n){super(t),this.map=e,this.frameState=n!==void 0?n:null}}class ws extends $o{constructor(t,e,n,r,s,a){super(t,e,s),this.originalEvent=n,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=a}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const ke={SINGLECLICK:"singleclick",CLICK:le.CLICK,DBLCLICK:le.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},tc={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};class Kb extends Nf{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=e===void 0?1:e,this.down_=null;const n=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=n,this.pointerdownListenerKey_=_e(n,tc.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=_e(n,tc.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(le.TOUCHMOVE,this.boundHandleTouchMove_,__?{passive:!1}:!1)}emulateClick_(t){let e=new ws(ke.CLICK,this.map_,t);this.dispatchEvent(e),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new ws(ke.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const n=new ws(ke.SINGLECLICK,this.map_,t);this.dispatchEvent(n)},250)}updateActivePointers_(t){const e=t,n=e.pointerId;if(e.type==ke.POINTERUP||e.type==ke.POINTERCANCEL){delete this.trackedTouches_[n];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==e.target){delete this.trackedTouches_[r];break}}else(e.type==ke.POINTERDOWN||e.type==ke.POINTERMOVE)&&(this.trackedTouches_[n]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new ws(ke.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Ke),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return t.button===0}handlePointerDown_(t){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(t);const e=new ws(ke.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),this.dragListenerKeys_.length===0){const n=this.map_.getOwnerDocument();this.dragListenerKeys_.push(_e(n,ke.POINTERMOVE,this.handlePointerMove_,this),_e(n,ke.POINTERUP,this.handlePointerUp_,this),_e(this.element_,ke.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==n&&this.dragListenerKeys_.push(_e(this.element_.getRootNode(),ke.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new ws(ke.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new ws(ke.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;(!e||e.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Ke(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(le.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Ke(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Ke),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Es={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Vi={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},cf=1/0;class $b{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,ro(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,n=t[0];t.length==1?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const r=this.keyFunction_(n);return delete this.queuedElements_[r],n}enqueue(t){Ce(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const e=this.priorityFunction_(t);return e!=cf?(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(t){return t*2+1}getRightChildIndex_(t){return t*2+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return this.elements_.length===0}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,n=this.priorities_,r=e.length,s=e[t],a=n[t],o=t;for(;t<r>>1;){const l=this.getLeftChildIndex_(t),h=this.getRightChildIndex_(t),c=h<r&&n[h]<n[l]?h:l;e[t]=e[c],n[t]=n[c],t=c}e[t]=s,n[t]=a,this.siftDown_(o,t)}siftDown_(t,e){const n=this.elements_,r=this.priorities_,s=n[e],a=r[e];for(;e>t;){const o=this.getParentIndex_(e);if(r[o]>a)n[e]=n[o],r[e]=r[o],e=o;else break}n[e]=s,r[e]=a}reprioritize(){const t=this.priorityFunction_,e=this.elements_,n=this.priorities_;let r=0;const s=e.length;let a,o,l;for(o=0;o<s;++o)a=e[o],l=t(a),l==cf?delete this.queuedElements_[this.keyFunction_(a)]:(n[r]=l,e[r++]=a);e.length=r,n.length=r,this.heapify_()}}const Zt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class Jb extends $b{constructor(t,e){super(function(n){return t.apply(null,n)},function(n){return n[0].getKey()}),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener(le.CHANGE,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,n=e.getState();if(n===Zt.LOADED||n===Zt.ERROR||n===Zt.EMPTY){n!==Zt.ERROR&&e.removeEventListener(le.CHANGE,this.boundHandleTileChange_);const r=e.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let n=0,r,s,a;for(;this.tilesLoading_<t&&n<e&&this.getCount()>0;)s=this.dequeue()[0],a=s.getKey(),r=s.getState(),r===Zt.IDLE&&!(a in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[a]=!0,++this.tilesLoading_,++n,s.load())}}function Qb(i,t,e,n,r){if(!i||!(e in i.wantedTiles)||!i.wantedTiles[e][t.getKey()])return cf;const s=i.viewState.center,a=n[0]-s[0],o=n[1]-s[1];return 65536*Math.log(r)+Math.sqrt(a*a+o*o)/r}class ur extends Qn{constructor(t){super();const e=t.element;e&&!t.target&&!e.style.pointerEvents&&(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){sf(this.element),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&sf(this.element);for(let e=0,n=this.listenerKeys.length;e<n;++e)Ke(this.listenerKeys[e]);this.listenerKeys.length=0,this.map_=t,t&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==Sl&&this.listenerKeys.push(_e(t,Es.POSTRENDER,this.render,this)),t.render())}render(t){}setTarget(t){this.target_=typeof t=="string"?document.getElementById(t):t}}class I_ extends ur{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=t.collapsed!==void 0?t.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=t.collapsible!==void 0,this.collapsible_=t.collapsible!==void 0?t.collapsible:!0,this.collapsible_||(this.collapsed_=!1);const e=t.className!==void 0?t.className:"ol-attribution",n=t.tipLabel!==void 0?t.tipLabel:"Attributions",r=t.expandClassName!==void 0?t.expandClassName:e+"-expand",s=t.collapseLabel!==void 0?t.collapseLabel:"›",a=t.collapseClassName!==void 0?t.collapseClassName:e+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=a):this.collapseLabel_=s;const o=t.label!==void 0?t.label:"i";typeof o=="string"?(this.label_=document.createElement("span"),this.label_.textContent=o,this.label_.className=r):this.label_=o;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=n,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(le.CLICK,this.handleClick_.bind(this),!1);const h=e+" "+jl+" "+_c+(this.collapsed_&&this.collapsible_?" "+Qp:"")+(this.collapsible_?"":" ol-uncollapsible"),c=this.element;c.className=h,c.appendChild(this.toggleButton_),c.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=Array.from(new Set(this.getMap().getAllLayers().flatMap(r=>r.getAttributions(t)))),n=!this.getMap().getAllLayers().some(r=>r.getSource()&&r.getSource().getAttributionsCollapsible()===!1);return this.overrideCollapsible_||this.setCollapsible(n),e}updateElement_(t){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const e=this.collectSourceAttributions_(t),n=e.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!Os(e,this.renderedAttributions_)){v_(this.ulElement_);for(let r=0,s=e.length;r<s;++r){const a=document.createElement("li");a.innerHTML=e[r],this.ulElement_.appendChild(a)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(Qp),this.collapsed_?rf(this.collapseLabel_,this.label_):rf(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,!(!this.collapsible_||this.collapsed_===t)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}}class tw extends ur{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=t.className!==void 0?t.className:"ol-rotate",n=t.label!==void 0?t.label:"⇧",r=t.compassClassName!==void 0?t.compassClassName:"ol-compass";this.label_=null,typeof n=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=n):(this.label_=n,this.label_.classList.add(r));const s=t.tipLabel?t.tipLabel:"Reset rotation",a=document.createElement("button");a.className=e+"-reset",a.setAttribute("type","button"),a.title=s,a.appendChild(this.label_),a.addEventListener(le.CLICK,this.handleClick_.bind(this),!1);const o=e+" "+jl+" "+_c,l=this.element;l.className=o,l.appendChild(a),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=t.duration!==void 0?t.duration:250,this.autoHide_=t.autoHide!==void 0?t.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(bu)}handleClick_(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const e=this.getMap().getView();if(!e)return;const n=e.getRotation();n!==void 0&&(this.duration_>0&&n%(2*Math.PI)!==0?e.animate({rotation:0,duration:this.duration_,easing:kl}):e.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const n=e.viewState.rotation;if(n!=this.rotation_){const r="rotate("+n+"rad)";if(this.autoHide_){const s=this.element.classList.contains(bu);!s&&n===0?this.element.classList.add(bu):s&&n!==0&&this.element.classList.remove(bu)}this.label_.style.transform=r}this.rotation_=n}}const ew=tw;class iw extends ur{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=t.className!==void 0?t.className:"ol-zoom",n=t.delta!==void 0?t.delta:1,r=t.zoomInClassName!==void 0?t.zoomInClassName:e+"-in",s=t.zoomOutClassName!==void 0?t.zoomOutClassName:e+"-out",a=t.zoomInLabel!==void 0?t.zoomInLabel:"+",o=t.zoomOutLabel!==void 0?t.zoomOutLabel:"–",l=t.zoomInTipLabel!==void 0?t.zoomInTipLabel:"Zoom in",h=t.zoomOutTipLabel!==void 0?t.zoomOutTipLabel:"Zoom out",c=document.createElement("button");c.className=r,c.setAttribute("type","button"),c.title=l,c.appendChild(typeof a=="string"?document.createTextNode(a):a),c.addEventListener(le.CLICK,this.handleClick_.bind(this,n),!1);const f=document.createElement("button");f.className=s,f.setAttribute("type","button"),f.title=h,f.appendChild(typeof o=="string"?document.createTextNode(o):o),f.addEventListener(le.CLICK,this.handleClick_.bind(this,-n),!1);const g=e+" "+jl+" "+_c,d=this.element;d.className=g,d.appendChild(c),d.appendChild(f),this.duration_=t.duration!==void 0?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const n=this.getMap().getView();if(!n)return;const r=n.getZoom();if(r!==void 0){const s=n.getConstrainedZoom(r+t);this.duration_>0?(n.getAnimating()&&n.cancelAnimations(),n.animate({zoom:s,duration:this.duration_,easing:kl})):n.setZoom(s)}}}const nw=iw;function R_(i){i=i||{};const t=new Tr;return(i.zoom!==void 0?i.zoom:!0)&&t.push(new nw(i.zoomOptions)),(i.rotate!==void 0?i.rotate:!0)&&t.push(new ew(i.rotateOptions)),(i.attribution!==void 0?i.attribution:!0)&&t.push(new I_(i.attributionOptions)),t}const i0={ACTIVE:"active"};class zl extends Qn{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(i0.ACTIVE)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(i0.ACTIVE,t)}setMap(t){this.map_=t}}function rw(i,t,e){const n=i.getCenterInternal();if(n){const r=[n[0]+t[0],n[1]+t[1]];i.animateInternal({duration:e!==void 0?e:250,easing:K5,center:i.getConstrainedCenter(r)})}}function f1(i,t,e,n){const r=i.getZoom();if(r===void 0)return;const s=i.getConstrainedZoom(r+t),a=i.getResolutionForZoom(s);i.getAnimating()&&i.cancelAnimations(),i.animate({resolution:a,anchor:e,duration:n!==void 0?n:250,easing:kl})}class sw extends zl{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:250}handleEvent(t){let e=!1;if(t.type==ke.DBLCLICK){const n=t.originalEvent,r=t.map,s=t.coordinate,a=n.shiftKey?-this.delta_:this.delta_,o=r.getView();f1(o,a,s,this.duration_),n.preventDefault(),e=!0}return!e}}const aw=sw;class oo extends zl{constructor(t){t=t||{},super(t),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==ke.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==ke.POINTERUP){const n=this.handleUpEvent(t);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(t.type==ke.POINTERDOWN){const n=this.handleDownEvent(t);this.handlingDownUpSequence=n,e=this.stopDown(n)}else t.type==ke.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}}function d1(i){const t=i.length;let e=0,n=0;for(let r=0;r<t;r++)e+=i[r].clientX,n+=i[r].clientY;return{clientX:e/t,clientY:n/t}}function n0(i){const t=arguments;return function(e){let n=!0;for(let r=0,s=t.length;r<s&&(n=n&&t[r](e),!!n);++r);return n}}const ow=function(i){const t=i.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},lw=function(i){const t=i.map.getTargetElement(),e=i.map.getOwnerDocument().activeElement;return t.contains(e)},N_=function(i){return i.map.getTargetElement().hasAttribute("tabindex")?lw(i):!0},r0=_a,F_=function(i){const t=i.originalEvent;return t.button==0&&!(zx&&d_&&t.ctrlKey)},s0=Nl,O_=function(i){return i.type==ke.SINGLECLICK},g1=function(i){const t=i.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},hw=function(i){const t=i.originalEvent;return d_?t.metaKey:t.ctrlKey},$f=function(i){const t=i.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},k_=function(i){const t=i.originalEvent,e=t.target.tagName;return e!=="INPUT"&&e!=="SELECT"&&e!=="TEXTAREA"&&!t.target.isContentEditable},gl=function(i){const t=i.originalEvent;return Ce(t!==void 0,"mapBrowserEvent must originate from a pointer event"),t.pointerType=="mouse"},cw=function(i){const t=i.originalEvent;return Ce(t!==void 0,"mapBrowserEvent must originate from a pointer event"),t.isPrimary&&t.button===0};class uw extends oo{constructor(t){super({stopDown:Nl}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:n0(g1,cw);this.condition_=t.onFocusOnly?n0(N_,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const n=this.targetPointers,r=e.getEventPixel(d1(n));if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],o=t.map.getView();F5(s,o.getResolution()),G0(s,o.getRotation()),o.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=n.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,n=e.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),a=n.getCenterInternal(),o=e.getPixelFromCoordinateInternal(a),l=e.getCoordinateFromPixelInternal([o[0]-r*Math.cos(s),o[1]-r*Math.sin(s)]);n.animateInternal({center:n.getConstrainedCenter(l),duration:500,easing:kl})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const n=t.map.getView();return this.lastCentroid=null,n.getAnimating()&&n.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}const fw=uw;class dw extends oo{constructor(t){t=t||{},super({stopDown:Nl}),this.condition_=t.condition?t.condition:ow,this.lastAngle_=void 0,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){if(!gl(t))return;const e=t.map,n=e.getView();if(n.getConstraints().rotation===X0)return;const r=e.getSize(),s=t.pixel,a=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const o=a-this.lastAngle_;n.adjustRotationInternal(-o)}this.lastAngle_=a}handleUpEvent(t){return gl(t)?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){return gl(t)&&F_(t)&&this.condition_(t)?(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class gw extends Rf{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,n="px",r=this.element_.style;r.left=Math.min(t[0],e[0])+n,r.top=Math.min(t[1],e[1])+n,r.width=Math.abs(e[0]-t[0])+n,r.height=Math.abs(e[1]-t[1])+n}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){const t=this.startPixel_,e=this.endPixel_,r=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new cr([r])}getGeometry(){return this.geometry_}}const wu={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class ug extends Nr{constructor(t,e,n){super(t),this.coordinate=e,this.mapBrowserEvent=n}}class pw extends oo{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.box_=new gw(t.className||"ol-dragbox"),this.minArea_=t.minArea!==void 0?t.minArea:64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition?t.condition:F_,this.boxEndCondition_=t.boxEndCondition?t.boxEndCondition:this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,n){const r=n[0]-e[0],s=n[1]-e[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new ug(wu.BOXDRAG,t.coordinate,t))}handleUpEvent(t){this.box_.setMap(null);const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new ug(e?wu.BOXEND:wu.BOXCANCEL,t.coordinate,t)),!1}handleDownEvent(t){return this.condition_(t)?(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new ug(wu.BOXSTART,t.coordinate,t)),!0):!1}onBoxEnd(t){}}class mw extends pw{constructor(t){t=t||{};const e=t.condition?t.condition:$f;super({condition:e,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=t.duration!==void 0?t.duration:200,this.out_=t.out!==void 0?t.out:!1}onBoxEnd(t){const n=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=n.rotatedExtentForGeometry(r),a=n.getResolutionForExtentInternal(s),o=n.getResolution()/a;r=r.clone(),r.scale(o*o)}n.fitInternal(r,{duration:this.duration_,easing:kl})}}const _w=mw,Ba={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class vw extends zl{constructor(t){super(),t=t||{},this.defaultCondition_=function(e){return g1(e)&&k_(e)},this.condition_=t.condition!==void 0?t.condition:this.defaultCondition_,this.duration_=t.duration!==void 0?t.duration:100,this.pixelDelta_=t.pixelDelta!==void 0?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==le.KEYDOWN){const n=t.originalEvent,r=n.key;if(this.condition_(t)&&(r==Ba.DOWN||r==Ba.LEFT||r==Ba.RIGHT||r==Ba.UP)){const a=t.map.getView(),o=a.getResolution()*this.pixelDelta_;let l=0,h=0;r==Ba.DOWN?h=-o:r==Ba.LEFT?l=-o:r==Ba.RIGHT?l=o:h=o;const c=[l,h];G0(c,a.getRotation()),rw(a,c,this.duration_),n.preventDefault(),e=!0}}return!e}}class yw extends zl{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(e){return!hw(e)&&k_(e)},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:100}handleEvent(t){let e=!1;if(t.type==le.KEYDOWN||t.type==le.KEYPRESS){const n=t.originalEvent,r=n.key;if(this.condition_(t)&&(r==="+"||r==="-")){const s=t.map,a=r==="+"?this.delta_:-this.delta_,o=s.getView();f1(o,a,void 0,this.duration_),n.preventDefault(),e=!0}}return!e}}const xw=yw;class bw{constructor(t,e,n){this.decay_=t,this.minVelocity_=e,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let n=e-3;for(;n>0&&this.points_[n+2]>t;)n-=3;const r=this.points_[e+2]-this.points_[n+2];if(r<1e3/60)return!1;const s=this.points_[e]-this.points_[n],a=this.points_[e+1]-this.points_[n+1];return this.angle_=Math.atan2(a,s),this.initialVelocity_=Math.sqrt(s*s+a*a)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}class ww extends zl{constructor(t){t=t||{},super(t),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=t.maxDelta!==void 0?t.maxDelta:1,this.duration_=t.duration!==void 0?t.duration:250,this.timeout_=t.timeout!==void 0?t.timeout:80,this.useAnchor_=t.useAnchor!==void 0?t.useAnchor:!0,this.constrainResolution_=t.constrainResolution!==void 0?t.constrainResolution:!1;const e=t.condition?t.condition:r0;this.condition_=t.onFocusOnly?n0(N_,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();if(!t)return;t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(t){if(!this.condition_(t)||t.type!==le.WHEEL)return!0;const n=t.map,r=t.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate);let s;if(t.type==le.WHEEL&&(s=r.deltaY,jx&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(s/=g_),r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(s*=40)),s===0)return!1;this.lastDelta_=s;const a=Date.now();this.startTime_===void 0&&(this.startTime_=a),(!this.mode_||a-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const o=n.getView();if(this.mode_==="trackpad"&&!(o.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=a,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(a-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),l),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let n=-hi(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),f1(e,n,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}}const Ew=ww;class Sw extends oo{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=Nl),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=t.threshold!==void 0?t.threshold:.3,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){let e=0;const n=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-n.clientY,r.clientX-n.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=l}this.lastAngle_=s;const a=t.map,o=a.getView();o.getConstraints().rotation!==X0&&(this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(d1(this.targetPointers))),this.rotating_&&(a.render(),o.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return this.targetPointers.length<2?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}class Lw extends oo{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=Nl),super(e),this.anchor_=null,this.duration_=t.duration!==void 0?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const n=this.targetPointers[0],r=this.targetPointers[1],s=n.clientX-r.clientX,a=n.clientY-r.clientY,o=Math.sqrt(s*s+a*a);this.lastDistance_!==void 0&&(e=this.lastDistance_/o),this.lastDistance_=o;const l=t.map,h=l.getView();e!=1&&(this.lastScaleDelta_=e),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(d1(this.targetPointers))),l.render(),h.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const n=t.map.getView(),r=this.lastScaleDelta_>1?1:-1;return n.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}const Cw=Lw;function D_(i){i=i||{};const t=new Tr,e=new bw(-.005,.05,100);return(i.altShiftDragRotate!==void 0?i.altShiftDragRotate:!0)&&t.push(new dw),(i.doubleClickZoom!==void 0?i.doubleClickZoom:!0)&&t.push(new aw({delta:i.zoomDelta,duration:i.zoomDuration})),(i.dragPan!==void 0?i.dragPan:!0)&&t.push(new fw({onFocusOnly:i.onFocusOnly,kinetic:e})),(i.pinchRotate!==void 0?i.pinchRotate:!0)&&t.push(new Sw),(i.pinchZoom!==void 0?i.pinchZoom:!0)&&t.push(new Cw({duration:i.zoomDuration})),(i.keyboard!==void 0?i.keyboard:!0)&&(t.push(new vw),t.push(new xw({delta:i.zoomDelta,duration:i.zoomDuration}))),(i.mouseWheelZoom!==void 0?i.mouseWheelZoom:!0)&&t.push(new Ew({onFocusOnly:i.onFocusOnly,duration:i.zoomDuration})),(i.shiftDragZoom!==void 0?i.shiftDragZoom:!0)&&t.push(new _w({duration:i.zoomDuration})),t}function j_(i){if(i instanceof Dl){i.setMapInternal(null);return}i instanceof Cn&&i.getLayers().forEach(j_)}function B_(i,t){if(i instanceof Dl){i.setMapInternal(t);return}if(i instanceof Cn){const e=i.getLayers().getArray();for(let n=0,r=e.length;n<r;++n)B_(e[n],t)}}class Aw extends Qn{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=Mw(t);this.renderComplete_,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,this.pixelRatio_=t.pixelRatio!==void 0?t.pixelRatio:g_,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Bi(),this.pixelToCoordinateTransform_=Bi(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=e.controls||R_(),this.interactions=e.interactions||D_({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new Jb(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Vi.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Vi.VIEW,this.handleViewChanged_),this.addChangeListener(Vi.SIZE,this.handleSizeChanged_),this.addChangeListener(Vi.TARGET,this.handleTargetChanged_),this.setProperties(e.values);const n=this;t.view&&!(t.view instanceof or)&&t.view.then(function(r){n.setView(new or(r))}),this.controls.addEventListener(Yi.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(Yi.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(Yi.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(Yi.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(Yi.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(Yi.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){B_(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();e!==void 0&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,n){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(t);n=n!==void 0?n:{};const s=n.hitTolerance!==void 0?n.hitTolerance:0,a=n.layerFilter!==void 0?n.layerFilter:_a,o=n.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,o,e,null,a,null)}getFeaturesAtPixel(t,e){const n=[];return this.forEachFeatureAtPixel(t,function(r){n.push(r)},e),n}getAllLayers(){const t=[];function e(n){n.forEach(function(r){r instanceof Cn?e(r.getLayers()):t.push(r)})}return e(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const n=this.getCoordinateFromPixelInternal(t);e=e!==void 0?e:{};const r=e.layerFilter!==void 0?e.layerFilter:_a,s=e.hitTolerance!==void 0?e.hitTolerance:0,a=e.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,s,a,r,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const n=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=n.width/r[0],a=n.height/r[1],o="changedTouches"in t?t.changedTouches[0]:t;return[(o.clientX-n.left)/s,(o.clientY-n.top)/a]}getTarget(){return this.get(Vi.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return Xg(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?xi(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return e!==void 0?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Vi.LAYERGROUP)}setLayers(t){const e=this.getLayerGroup();if(t instanceof Tr){e.setLayers(t);return}const n=e.getLayers();n.clear(),n.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,n=t.length;e<n;++e){const r=t[e];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const a=r.layer.getSource();if(a&&a.loading)return!0}return!1}getPixelFromCoordinate(t){const e=Mr(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?xi(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Vi.SIZE)}getView(){return this.get(Vi.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,n,r){return Qb(this.frameState_,t,e,n,r)}handleBrowserEvent(t,e){e=e||t.type;const n=new ws(e,this,t);this.handleMapBrowserEvent(n)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,n=e.type;if(n===tc.POINTERDOWN||n===le.WHEEL||n===le.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,a=e.target;if(this.overlayContainerStopEvent_.contains(a)||!(s===r?r.documentElement:s).contains(a))return}if(t.frameState=this.frameState_,this.dispatchEvent(t)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const a=r[s];if(a.getMap()!==this||!a.getActive()||!this.getTargetElement())continue;if(!a.handleEvent(t)||t.propagationStopped)break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let r=this.maxTilesLoading_,s=r;if(t){const a=t.viewHints;if(a[ri.ANIMATING]||a[ri.INTERACTING]){const o=Date.now()-t.time>8;r=o?0:8,s=o?0:2}}e.getTilesLoading()<r&&(e.reprioritize(),e.loadMoreTiles(r,s))}t&&this.renderer_&&!t.animate&&(this.renderComplete_===!0?(this.hasListener(Zi.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Zi.RENDERCOMPLETE,t),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new $o(Es.LOADEND,this,t)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new $o(Es.LOADSTART,this,t))));const n=this.postRenderFunctions_;for(let r=0,s=n.length;r<s;++r)n[r](this,t);n.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let n=0,r=this.targetChangeHandlerKeys_.length;n<r;++n)Ke(this.targetChangeHandlerKeys_[n]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(le.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(le.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,sf(this.viewport_)}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const n=this.targetElement_.getRootNode();n instanceof ShadowRoot&&this.resizeObserver_.unobserve(n.host),this.setSize(void 0)}const t=this.getTarget(),e=typeof t=="string"?document.getElementById(t):t;if(this.targetElement_=e,!e)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new Zb(this)),this.mapBrowserEventHandler_=new Kb(this,this.moveTolerance_);for(const s in ke)this.mapBrowserEventHandler_.addEventListener(ke[s],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(le.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(le.WHEEL,this.boundHandleBrowserEvent_,__?{passive:!1}:!1);const n=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.targetChangeHandlerKeys_=[_e(n,le.KEYDOWN,this.handleBrowserEvent,this),_e(n,le.KEYPRESS,this.handleBrowserEvent,this)];const r=e.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_.observe(e)}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Ke(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Ke(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=_e(t,El.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=_e(t,le.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Ke),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new oa("addlayer",t)),this.layerGroupPropertyListenerKeys_=[_e(t,El.PROPERTYCHANGE,this.render,this),_e(t,le.CHANGE,this.render,this),_e(t,"addlayer",this.handleLayerAdd_,this),_e(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,n=t.length;e<n;++e){const r=t[e].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){j_(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),n=this.getView(),r=this.frameState_;let s=null;if(e!==void 0&&Yp(e)&&n&&n.isDef()){const a=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),o=n.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:qg(o.center,o.resolution,o.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:o,viewHints:a,wantedTiles:{},mapId:Qt(this),renderTargets:{}},o.nextCenter&&o.nextResolution){const l=isNaN(o.nextRotation)?o.rotation:o.nextRotation;s.nextExtent=qg(o.nextCenter,o.nextResolution,l,e)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!Ol(this.previousExtent_)&&!to(s.extent,this.previousExtent_))&&(this.dispatchEvent(new $o(Es.MOVESTART,this,r)),this.previousExtent_=Fl(this.previousExtent_)),this.previousExtent_&&!s.viewHints[ri.ANIMATING]&&!s.viewHints[ri.INTERACTING]&&!to(s.extent,this.previousExtent_)&&(this.dispatchEvent(new $o(Es.MOVEEND,this,s)),R2(s.extent,this.previousExtent_))),this.dispatchEvent(new $o(Es.POSTRENDER,this,s)),this.renderComplete_=this.hasListener(Es.LOADSTART)||this.hasListener(Es.LOADEND)||this.hasListener(Zi.RENDERCOMPLETE)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new oa("removelayer",e)),this.set(Vi.LAYERGROUP,t)}setSize(t){this.set(Vi.SIZE,t)}setTarget(t){this.set(Vi.TARGET,t)}setView(t){if(!t||t instanceof or){this.set(Vi.VIEW,t);return}this.set(Vi.VIEW,new or);const e=this;t.then(function(n){e.setView(new or(n))})}updateSize(){const t=this.getTargetElement();let e;if(t){const r=getComputedStyle(t),s=t.offsetWidth-parseFloat(r.borderLeftWidth)-parseFloat(r.paddingLeft)-parseFloat(r.paddingRight)-parseFloat(r.borderRightWidth),a=t.offsetHeight-parseFloat(r.borderTopWidth)-parseFloat(r.paddingTop)-parseFloat(r.paddingBottom)-parseFloat(r.borderBottomWidth);!isNaN(s)&&!isNaN(a)&&(e=[s,a],!Yp(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&U2("No map visible because the map container's width or height are 0."))}const n=this.getSize();e&&(!n||!Os(e,n))&&(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){const e=this.getView();e&&e.setViewportSize(t)}}function Mw(i){let t=null;i.keyboardEventTarget!==void 0&&(t=typeof i.keyboardEventTarget=="string"?document.getElementById(i.keyboardEventTarget):i.keyboardEventTarget);const e={},n=i.layers&&typeof i.layers.getLayers=="function"?i.layers:new Cn({layers:i.layers});e[Vi.LAYERGROUP]=n,e[Vi.TARGET]=i.target,e[Vi.VIEW]=i.view instanceof or?i.view:new or;let r;i.controls!==void 0&&(Array.isArray(i.controls)?r=new Tr(i.controls.slice()):(Ce(typeof i.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=i.controls));let s;i.interactions!==void 0&&(Array.isArray(i.interactions)?s=new Tr(i.interactions.slice()):(Ce(typeof i.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=i.interactions));let a;return i.overlays!==void 0?Array.isArray(i.overlays)?a=new Tr(i.overlays.slice()):(Ce(typeof i.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),a=i.overlays):a=new Tr,{controls:r,interactions:s,keyboardEventTarget:t,overlays:a,values:e}}const Tw=Aw;class p1 extends Qn{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new p1(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const n=this.getStyle();return n&&t.setStyle(n),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Ke(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=_e(t,le.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?Pw(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function Pw(i){if(typeof i=="function")return i;let t;return Array.isArray(i)?t=i:(Ce(typeof i.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),t=[i]),function(){return t}}const lr=p1;class Jf extends Ma{constructor(t,e,n){super(),n!==void 0&&e===void 0?this.setFlatCoordinates(n,t):(e=e||0,this.setCenterAndRadius(t,e,n))}clone(){const t=new Jf(this.flatCoordinates.slice(),void 0,this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,r){const s=this.flatCoordinates,a=t-s[0],o=e-s[1],l=a*a+o*o;if(l<r){if(l===0)for(let h=0;h<this.stride;++h)n[h]=s[h];else{const h=this.getRadius()/Math.sqrt(l);n[0]=s[0]+h*a,n[1]=s[1]+h*o;for(let c=2;c<this.stride;++c)n[c]=s[c]}return n.length=this.stride,l}return r}containsXY(t,e){const n=this.flatCoordinates,r=t-n[0],s=e-n[1];return r*r+s*s<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(t){const e=this.flatCoordinates,n=e[this.stride]-e[0];return is(e[0]-n,e[1]-n,e[0]+n,e[1]+n,t)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e}getType(){return"Circle"}intersectsExtent(t){const e=this.getExtent();if(ki(t,e)){const n=this.getCenter();return t[0]<=n[0]&&t[2]>=n[0]||t[1]<=n[1]&&t[3]>=n[1]?!0:B0(t,this.intersectsCoordinate.bind(this))}return!1}setCenter(t){const e=this.stride,n=this.flatCoordinates[e]-this.flatCoordinates[0],r=t.slice();r[e]=r[0]+n;for(let s=1;s<e;++s)r[e+s]=t[s];this.setFlatCoordinates(this.layout,r),this.changed()}setCenterAndRadius(t,e,n){this.setLayout(n,t,0),this.flatCoordinates||(this.flatCoordinates=[]);const r=this.flatCoordinates;let s=$2(r,0,t,this.stride);r[s++]=r[0]+e;for(let a=1,o=this.stride;a<o;++a)r[s++]=r[a];r.length=s,this.changed()}getCoordinates(){return null}setCoordinates(t,e){}setRadius(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()}rotate(t,e){const n=this.getCenter(),r=this.getStride();this.setCenter(Z0(n,0,n.length,r,t,e,n)),this.changed()}}Jf.prototype.transform;class uf extends K2{constructor(t){super(),this.geometries_=t,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(Ke),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const t=this.geometries_;for(let e=0,n=t.length;e<n;++e)this.changeEventsKeys_.push(_e(t[e],le.CHANGE,this.changed,this))}clone(){const t=new uf(fg(this.geometries_));return t.applyProperties(this),t}closestPointXY(t,e,n,r){if(r<so(this.getExtent(),t,e))return r;const s=this.geometries_;for(let a=0,o=s.length;a<o;++a)r=s[a].closestPointXY(t,e,n,r);return r}containsXY(t,e){const n=this.geometries_;for(let r=0,s=n.length;r<s;++r)if(n[r].containsXY(t,e))return!0;return!1}computeExtent(t){Fl(t);const e=this.geometries_;for(let n=0,r=e.length;n<r;++n)F2(t,e[n].getExtent());return t}getGeometries(){return fg(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let n=0,r=e.length;n<r;++n)e[n].getType()===this.getType()?t=t.concat(e[n].getGeometriesArrayRecursive()):t.push(e[n]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],n=this.geometries_;let r=!1;for(let s=0,a=n.length;s<a;++s){const o=n[s],l=o.getSimplifiedGeometry(t);e.push(l),l!==o&&(r=!0)}return r?new uf(e):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let n=0,r=e.length;n<r;++n)if(e[n].intersectsExtent(t))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(t,e){const n=this.geometries_;for(let r=0,s=n.length;r<s;++r)n[r].rotate(t,e);this.changed()}scale(t,e,n){n||(n=xa(this.getExtent()));const r=this.geometries_;for(let s=0,a=r.length;s<a;++s)r[s].scale(t,e,n);this.changed()}setGeometries(t){this.setGeometriesArray(fg(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let n=0,r=e.length;n<r;++n)e[n].applyTransform(t);this.changed()}translate(t,e){const n=this.geometries_;for(let r=0,s=n.length;r<s;++r)n[r].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function fg(i){return i.map(t=>t.clone())}const G_=uf;function ff(i,t,e,n,r,s,a){let o,l;const h=(e-t)/n;if(h===1)o=t;else if(h===2)o=t,l=r;else if(h!==0){let c=i[t],f=i[t+1],g=0;const d=[0];for(let b=t+n;b<e;b+=n){const x=i[b],E=i[b+1];g+=Math.sqrt((x-c)*(x-c)+(E-f)*(E-f)),d.push(g),c=x,f=E}const m=r*g,y=h5(d,m);y<0?(l=(m-d[-y-2])/(d[-y-1]-d[-y-2]),o=t+(-y-2)*n):o=t+y*n}a=a>1?a:2,s=s||new Array(a);for(let c=0;c<a;++c)s[c]=o===void 0?NaN:l===void 0?i[o+c]:Zn(i[o+c],i[o+n+c],l);return s}function a0(i,t,e,n,r,s){if(e==t)return null;let a;if(r<i[t+n-1])return s?(a=i.slice(t,t+n),a[n-1]=r,a):null;if(i[e-1]<r)return s?(a=i.slice(e-n,e),a[n-1]=r,a):null;if(r==i[t+n-1])return i.slice(t,t+n);let o=t/n,l=e/n;for(;o<l;){const g=o+l>>1;r<i[(g+1)*n-1]?l=g:o=g+1}const h=i[o*n-1];if(r==h)return i.slice((o-1)*n,(o-1)*n+n);const c=i[(o+1)*n-1],f=(r-h)/(c-h);a=[];for(let g=0;g<n-1;++g)a.push(Zn(i[(o-1)*n+g],i[o*n+g],f));return a.push(r),a}function Iw(i,t,e,n,r,s,a){if(a)return a0(i,t,e[e.length-1],n,r,s);let o;if(r<i[n-1])return s?(o=i.slice(0,n),o[n-1]=r,o):null;if(i[i.length-1]<r)return s?(o=i.slice(i.length-n),o[n-1]=r,o):null;for(let l=0,h=e.length;l<h;++l){const c=e[l];if(t!=c){if(r<i[t+n-1])return null;if(r<=i[c-1])return a0(i,t,c,n,r,!1);t=c}}return null}function z_(i,t,e,n){let r=i[t],s=i[t+1],a=0;for(let o=t+n;o<e;o+=n){const l=i[o],h=i[o+1];a+=Math.sqrt((l-r)*(l-r)+(h-s)*(h-s)),r=l,s=h}return a}class df extends Ma{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendCoordinate(t){$n(this.flatCoordinates,t),this.changed()}clone(){const t=new df(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,r){return r<so(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(K0(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),J0(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,n,r))}forEachSegment(t){return r_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return this.layout!="XYM"&&this.layout!="XYZM"?null:(e=e!==void 0?e:!1,a0(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return la(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return ff(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return z_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=qf(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new df(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return Uf(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=zf(this.flatCoordinates,0,t,this.stride),this.changed()}}const pa=df;class gf extends Ma{constructor(t,e,n){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(e!==void 0&&n)this.setFlatCoordinates(e,t),this.ends_=n;else{const r=t,s=[],a=[];for(let l=0,h=r.length;l<h;++l){const c=r[l];$n(s,c.getFlatCoordinates()),a.push(s.length)}const o=r.length===0?this.getLayout():r[0].getLayout();this.setFlatCoordinates(o,s),this.ends_=a}}appendLineString(t){$n(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new gf(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,r){return r<so(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt($0(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Q0(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,n,r))}getCoordinateAtM(t,e,n){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(e=e!==void 0?e:!1,n=n!==void 0?n:!1,Iw(this.flatCoordinates,0,this.ends_,this.stride,t,e,n))}getCoordinates(){return Wh(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new pa(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,n=this.layout,r=[];let s=0;for(let a=0,o=e.length;a<o;++a){const l=e[a],h=new pa(t.slice(s,l),n);r.push(h),s=l}return r}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let n=0;const r=this.ends_,s=this.stride;for(let a=0,o=r.length;a<o;++a){const l=r[a],h=ff(e,n,l,s,.5);$n(t,h),n=l}return t}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=Q2(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,n),new gf(e,"XY",n)}getType(){return"MultiLineString"}intersectsExtent(t){return ux(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=mc(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=n.length===0?0:n[n.length-1],this.changed()}}const m1=gf;class _1 extends Ma{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){$n(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}clone(){const t=new _1(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,r){if(r<so(this.getExtent(),t,e))return r;const s=this.flatCoordinates,a=this.stride;for(let o=0,l=s.length;o<l;o+=a){const h=Ms(t,e,s[o],s[o+1]);if(h<r){r=h;for(let c=0;c<a;++c)n[c]=s[o+c];n.length=a}}return r}getCoordinates(){return la(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates.length/this.stride;return t<0||e<=t?null:new Ir(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,n=this.stride,r=[];for(let s=0,a=t.length;s<a;s+=n){const o=new Ir(t.slice(s,s+n),e);r.push(o)}return r}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,n=this.stride;for(let r=0,s=e.length;r<s;r+=n){const a=e[r],o=e[r+1];if(D0(t,a,o))return!0}return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=zf(this.flatCoordinates,0,t,this.stride),this.changed()}}const Qf=_1;function q_(i,t,e,n){const r=[];let s=Dn();for(let a=0,o=e.length;a<o;++a){const l=e[a];s=j0(i,t,l[0],n),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),t=l[l.length-1]}return r}class pf extends Ma{constructor(t,e,n){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!n&&!Array.isArray(t[0])){const r=t,s=[],a=[];for(let o=0,l=r.length;o<l;++o){const h=r[o],c=s.length,f=h.getEnds();for(let g=0,d=f.length;g<d;++g)f[g]+=c;$n(s,h.getFlatCoordinates()),a.push(f)}e=r.length===0?this.getLayout():r[0].getLayout(),t=s,n=a}e!==void 0&&n?(this.setFlatCoordinates(e,t),this.endss_=n):this.setCoordinates(t,e)}appendPolygon(t){let e;if(!this.flatCoordinates)this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();else{const n=this.flatCoordinates.length;$n(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let r=0,s=e.length;r<s;++r)e[r]+=n}this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let r=0;r<t;++r)e[r]=this.endss_[r].slice();const n=new pf(this.flatCoordinates.slice(),this.layout,e);return n.applyProperties(this),n}closestPointXY(t,e,n,r){return r<so(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(nx(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),rx(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,n,r))}containsXY(t,e){return cx(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return ox(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),Zg(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,Yg(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=q_(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=n_(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new Qf(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;o_(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Zg(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=ax(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,n),new pf(e,"XY",n)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(t===0)e=0;else{const s=this.endss_[t-1];e=s[s.length-1]}const n=this.endss_[t].slice(),r=n[n.length-1];if(e!==0)for(let s=0,a=n.length;s<a;++s)n[s]-=e;return new cr(this.flatCoordinates.slice(e,r),this.layout,n)}getPolygons(){const t=this.layout,e=this.flatCoordinates,n=this.endss_,r=[];let s=0;for(let a=0,o=n.length;a<o;++a){const l=n[a].slice(),h=l[l.length-1];if(s!==0)for(let f=0,g=l.length;f<g;++f)l[f]-=s;const c=new cr(e.slice(s,h),t,l);r.push(c),s=h}return r}getType(){return"MultiPolygon"}intersectsExtent(t){return fx(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const n=J2(this.flatCoordinates,0,t,this.stride,this.endss_);if(n.length===0)this.flatCoordinates.length=0;else{const r=n[n.length-1];this.flatCoordinates.length=r.length===0?0:r[r.length-1]}this.changed()}}const v1=pf,cm=Bi();class Nn{constructor(t,e,n,r,s,a){this.styleFunction,this.extent_,this.id_=a,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=n||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?N2(this.flatCoordinates_):j0(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=xa(this.getExtent());this.flatInteriorPoints_=i1(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=gx(this.flatCoordinates_,this.ends_),e=q_(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=n_(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=ff(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const n=this.ends_;for(let r=0,s=n.length;r<s;++r){const a=n[r],o=ff(t,e,a,2,.5);$n(this.flatMidpoints_,o),e=a}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){t=ti(t);const e=t.getExtent(),n=t.getWorldExtent();if(e&&n){const r=en(n)/en(e);Jn(cm,n[0],n[3],r,-r,0,0,0),ga(this.flatCoordinates_,0,this.flatCoordinates_.length,2,cm,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){var t;return new Nn(this.type_,this.flatCoordinates_.slice(),(t=this.ends_)==null?void 0:t.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=T2((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const n=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":n.length=qf(n,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,n,0),r=[n.length];break;case"MultiLineString":r=[],n.length=Q2(n,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,n,0,r);break;case"Polygon":r=[],n.length=t1(n,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),n,0,r);break}return r&&(this.simplifiedGeometry_=new Nn(this.type_,n,r,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_}),this}}Nn.prototype.getFlatCoordinates=Nn.prototype.getOrientedFlatCoordinates;class Rw{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=lr,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let n=e.dataProjection?ti(e.dataProjection):this.readProjection(t);e.extent&&n&&n.getUnits()==="tile-pixels"&&(n=ti(n),n.setWorldExtent(e.extent)),e={dataProjection:n,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},t)}getType(){return ae()}readFeature(t,e){return ae()}readFeatures(t,e){return ae()}readGeometry(t,e){return ae()}readProjection(t){return ae()}writeFeature(t,e){return ae()}writeFeatures(t,e){return ae()}writeGeometry(t,e){return ae()}}function y1(i,t,e){const n=e?ti(e.featureProjection):null,r=e?ti(e.dataProjection):null;let s=i;if(n&&r&&!qa(n,r)){t&&(s=i.clone());const a=t?n:r,o=t?r:n;a.getUnits()==="tile-pixels"?s.transform(a,o):s.applyTransform(Cl(a,o))}if(t&&e&&e.decimals!==void 0){const a=Math.pow(10,e.decimals),o=function(l){for(let h=0,c=l.length;h<c;++h)l[h]=Math.round(l[h]*a)/a;return l};s===i&&(s=i.clone()),s.applyTransform(o)}return s}const Nw={Point:Ir,LineString:pa,Polygon:cr,MultiPoint:Qf,MultiLineString:m1,MultiPolygon:v1};function Fw(i,t,e){return Array.isArray(t[0])?(o_(i,0,t,e)||(i=i.slice(),Zg(i,0,t,e)),i):(r1(i,0,t,e)||(i=i.slice(),nf(i,0,t,e)),i)}function U_(i,t){var s;const e=i.geometry;if(!e)return[];if(Array.isArray(e))return e.map(a=>U_({...i,geometry:a})).flat();const n=e.type==="MultiPolygon"?"Polygon":e.type;if(n==="GeometryCollection"||n==="Circle")throw new Error("Unsupported geometry type: "+n);const r=e.layout.length;return y1(new Nn(n,n==="Polygon"?Fw(e.flatCoordinates,e.ends,r):e.flatCoordinates,(s=e.ends)==null?void 0:s.flat(),r,i.properties||{},i.id).enableSimplifyTransformed(),!1,t)}function x1(i,t){if(!i)return null;if(Array.isArray(i)){const n=i.map(r=>x1(r,t));return new G_(n)}const e=Nw[i.type];return y1(new e(i.flatCoordinates,i.layout,i.ends),!1,t)}class Ow extends Rw{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(Eu(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(Eu(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return ae()}readFeaturesFromObject(t,e){return ae()}readGeometry(t,e){return this.readGeometryFromObject(Eu(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return ae()}readProjection(t){return this.readProjectionFromObject(Eu(t))}readProjectionFromObject(t){return ae()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return ae()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return ae()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return ae()}}function Eu(i){if(typeof i=="string"){const t=JSON.parse(i);return t||null}return i!==null?i:null}class pi extends Ow{constructor(t){t=t||{},super(),this.dataProjection=ti(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=ti(t.featureProjection)),t.featureClass&&(this.featureClass=t.featureClass),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let n=null;t.type==="Feature"?n=t:n={type:"Feature",geometry:t,properties:null};const r=b1(n.geometry);if(this.featureClass===Nn)return U_({geometry:r,id:n.id,properties:n.properties},e);const s=new lr;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&n.geometry_name&&s.setGeometryName(n.geometry_name),s.setGeometry(x1(r,e)),"id"in n&&s.setId(n.id),n.properties&&s.setProperties(n.properties,!0),s}readFeaturesFromObject(t,e){const n=t;let r=null;if(n.type==="FeatureCollection"){const s=t;r=[];const a=s.features;for(let o=0,l=a.length;o<l;++o){const h=this.readFeatureFromObject(a[o],e);h&&r.push(h)}}else r=[this.readFeatureFromObject(t,e)];return r.flat()}readGeometryFromObject(t,e){return kw(t,e)}readProjectionFromObject(t){const e=t.crs;let n;if(e)if(e.type=="name")n=ti(e.properties.name);else if(e.type==="EPSG")n=ti("EPSG:"+e.properties.code);else throw new Error("Unknown SRS type");else n=this.dataProjection;return n}writeFeatureObject(t,e){e=this.adaptOptions(e);const n={type:"Feature",geometry:null,properties:null},r=t.getId();if(r!==void 0&&(n.id=r),!t.hasProperties())return n;const s=t.getProperties(),a=t.getGeometry();return a&&(n.geometry=o0(a,e),delete s[t.getGeometryName()]),Qa(s)||(n.properties=s),n}writeFeaturesObject(t,e){e=this.adaptOptions(e);const n=[];for(let r=0,s=t.length;r<s;++r)n.push(this.writeFeatureObject(t[r],e));return{type:"FeatureCollection",features:n}}writeGeometryObject(t,e){return o0(t,this.adaptOptions(e))}}function b1(i,t){if(!i)return null;let e;switch(i.type){case"Point":{e=jw(i);break}case"LineString":{e=Bw(i);break}case"Polygon":{e=Uw(i);break}case"MultiPoint":{e=zw(i);break}case"MultiLineString":{e=Gw(i);break}case"MultiPolygon":{e=qw(i);break}case"GeometryCollection":{e=Dw(i);break}default:throw new Error("Unsupported GeoJSON type: "+i.type)}return e}function kw(i,t){const e=b1(i);return x1(e,t)}function Dw(i,t){return i.geometries.map(function(n){return b1(n)})}function jw(i){const t=i.coordinates;return{type:"Point",flatCoordinates:t,layout:ao(t.length)}}function Bw(i){var n;const t=i.coordinates,e=t.flat();return{type:"LineString",flatCoordinates:e,ends:[e.length],layout:ao(((n=t[0])==null?void 0:n.length)||2)}}function Gw(i){var s,a;const t=i.coordinates,e=((a=(s=t[0])==null?void 0:s[0])==null?void 0:a.length)||2,n=[],r=mc(n,0,t,e);return{type:"MultiLineString",flatCoordinates:n,ends:r,layout:ao(e)}}function zw(i){var e;const t=i.coordinates;return{type:"MultiPoint",flatCoordinates:t.flat(),layout:ao(((e=t[0])==null?void 0:e.length)||2)}}function qw(i){var s,a;const t=i.coordinates,e=[],n=((a=(s=t[0])==null?void 0:s[0])==null?void 0:a[0].length)||2,r=J2(e,0,t,n);return{type:"MultiPolygon",flatCoordinates:e,ends:r,layout:ao(n)}}function Uw(i){var s,a;const t=i.coordinates,e=[],n=(a=(s=t[0])==null?void 0:s[0])==null?void 0:a.length,r=mc(e,0,t,n);return{type:"Polygon",flatCoordinates:e,ends:r,layout:ao(n)}}function o0(i,t){i=y1(i,!0,t);const e=i.getType();let n;switch(e){case"Point":{n=Zw(i);break}case"LineString":{n=Vw(i);break}case"Polygon":{n=Kw(i,t);break}case"MultiPoint":{n=Xw(i);break}case"MultiLineString":{n=Hw(i);break}case"MultiPolygon":{n=Yw(i,t);break}case"GeometryCollection":{n=Ww(i,t);break}case"Circle":{n={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+e)}return n}function Ww(i,t){return t=Object.assign({},t),delete t.featureProjection,{type:"GeometryCollection",geometries:i.getGeometriesArray().map(function(n){return o0(n,t)})}}function Vw(i,t){return{type:"LineString",coordinates:i.getCoordinates()}}function Hw(i,t){return{type:"MultiLineString",coordinates:i.getCoordinates()}}function Xw(i,t){return{type:"MultiPoint",coordinates:i.getCoordinates()}}function Yw(i,t){let e;return t&&(e=t.rightHanded),{type:"MultiPolygon",coordinates:i.getCoordinates(e)}}function Zw(i,t){return{type:"Point",coordinates:i.getCoordinates()}}function Kw(i,t){let e;return t&&(e=t.rightHanded),{type:"Polygon",coordinates:i.getCoordinates(e)}}function $w(i,t){return[[-1/0,-1/0,1/0,1/0]]}function Gi(i,t){return[i]}const ln={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class Jw extends Qn{constructor(t){super(),this.on,this.once,this.un,this.options=t,this.id=t.id,this.insertFirst=t.insertFirst!==void 0?t.insertFirst:!0,this.stopEvent=t.stopEvent!==void 0?t.stopEvent:!0,this.element=document.createElement("div"),this.element.className=t.className!==void 0?t.className:"ol-overlay-container "+$x,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=t.autoPan===!0?{}:t.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(ln.ELEMENT,this.handleElementChanged),this.addChangeListener(ln.MAP,this.handleMapChanged),this.addChangeListener(ln.OFFSET,this.handleOffsetChanged),this.addChangeListener(ln.POSITION,this.handlePositionChanged),this.addChangeListener(ln.POSITIONING,this.handlePositioningChanged),t.element!==void 0&&this.setElement(t.element),this.setOffset(t.offset!==void 0?t.offset:[0,0]),this.setPositioning(t.positioning||"top-left"),t.position!==void 0&&this.setPosition(t.position)}getElement(){return this.get(ln.ELEMENT)}getId(){return this.id}getMap(){return this.get(ln.MAP)||null}getOffset(){return this.get(ln.OFFSET)}getPosition(){return this.get(ln.POSITION)}getPositioning(){return this.get(ln.POSITIONING)}handleElementChanged(){v_(this.element);const t=this.getElement();t&&this.element.appendChild(t)}handleMapChanged(){this.mapPostrenderListenerKey&&(sf(this.element),Ke(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const t=this.getMap();if(t){this.mapPostrenderListenerKey=_e(t,Es.POSTRENDER,this.render,this),this.updatePixelPosition();const e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(t){this.set(ln.ELEMENT,t)}setMap(t){this.set(ln.MAP,t)}setOffset(t){this.set(ln.OFFSET,t)}setPosition(t){this.set(ln.POSITION,t)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(t){const e=this.getMap();if(!e||!e.getTargetElement()||!this.get(ln.POSITION))return;const n=this.getRect(e.getTargetElement(),e.getSize()),r=this.getElement(),s=this.getRect(r,[qx(r),Ux(r)]);t=t||{};const a=t.margin===void 0?20:t.margin;if(!As(n,s)){const o=s[0]-n[0],l=n[2]-s[2],h=s[1]-n[1],c=n[3]-s[3],f=[0,0];if(o<0?f[0]=o-a:l<0&&(f[0]=Math.abs(l)+a),h<0?f[1]=h-a:c<0&&(f[1]=Math.abs(c)+a),f[0]!==0||f[1]!==0){const g=e.getView().getCenterInternal(),d=e.getPixelFromCoordinateInternal(g);if(!d)return;const m=[d[0]+f[0],d[1]+f[1]],y=t.animation||{};e.getView().animateInternal({center:e.getCoordinateFromPixelInternal(m),duration:y.duration,easing:y.easing})}}}getRect(t,e){const n=t.getBoundingClientRect(),r=n.left+window.pageXOffset,s=n.top+window.pageYOffset;return[r,s,r+e[0],s+e[1]]}setPositioning(t){this.set(ln.POSITIONING,t)}setVisible(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)}updatePixelPosition(){const t=this.getMap(),e=this.getPosition();if(!t||!t.isRendered()||!e){this.setVisible(!1);return}const n=t.getPixelFromCoordinate(e),r=t.getSize();this.updateRenderedPosition(n,r)}updateRenderedPosition(t,e){const n=this.element.style,r=this.getOffset(),s=this.getPositioning();this.setVisible(!0);const a=Math.round(t[0]+r[0])+"px",o=Math.round(t[1]+r[1])+"px";let l="0%",h="0%";s=="bottom-right"||s=="center-right"||s=="top-right"?l="-100%":(s=="bottom-center"||s=="center-center"||s=="top-center")&&(l="-50%"),s=="bottom-left"||s=="bottom-center"||s=="bottom-right"?h="-100%":(s=="center-left"||s=="center-center"||s=="center-right")&&(h="-50%");const c=`translate(${l}, ${h}) translate(${a}, ${o})`;this.rendered.transform_!=c&&(this.rendered.transform_=c,n.transform=c)}getOptions(){return this.options}}const w1=Jw,ee={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Su=[ee.FILL],ua=[ee.STROKE],Ha=[ee.BEGIN_PATH],um=[ee.CLOSE_PATH];class W_{drawCustom(t,e,n,r,s){}drawGeometry(t){}setStyle(t){}drawCircle(t,e,n){}drawFeature(t,e,n){}drawGeometryCollection(t,e,n){}drawLineString(t,e,n){}drawMultiLineString(t,e,n){}drawMultiPoint(t,e,n){}drawMultiPolygon(t,e,n){}drawPoint(t,e,n){}drawPolygon(t,e,n){}drawText(t,e,n){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}}class xc extends W_{constructor(t,e,n,r){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=n,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return e==1?t:t.map(function(n){return n*e})}appendFlatPointCoordinates(t,e){const n=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let a=s.length;for(let o=0,l=t.length;o<l;o+=e)r[0]=t[o],r[1]=t[o+1],ya(n,r)&&(s[a++]=r[0],s[a++]=r[1]);return a}appendFlatLineCoordinates(t,e,n,r,s,a){const o=this.coordinates;let l=o.length;const h=this.getBufferedMaxExtent();a&&(e+=r);let c=t[e],f=t[e+1];const g=this.tmpCoordinate_;let d=!0,m,y,b;for(m=e+r;m<n;m+=r)g[0]=t[m],g[1]=t[m+1],b=Gg(h,g),b!==y?(d&&(o[l++]=c,o[l++]=f,d=!1),o[l++]=g[0],o[l++]=g[1]):b===Hi.INTERSECTING?(o[l++]=g[0],o[l++]=g[1],d=!1):d=!0,c=g[0],f=g[1],y=b;return(s&&d||m===e+r)&&(o[l++]=c,o[l++]=f),l}drawCustomCoordinates_(t,e,n,r,s){for(let a=0,o=n.length;a<o;++a){const l=n[a],h=this.appendFlatLineCoordinates(t,e,l,r,!1,!1);s.push(h),e=l}return e}drawCustom(t,e,n,r,s){this.beginGeometry(t,e,s);const a=t.getType(),o=t.getStride(),l=this.coordinates.length;let h,c,f,g,d;switch(a){case"MultiPolygon":h=t.getOrientedFlatCoordinates(),g=[];const m=t.getEndss();d=0;for(let y=0,b=m.length;y<b;++y){const x=[];d=this.drawCustomCoordinates_(h,d,m[y],o,x),g.push(x)}this.instructions.push([ee.CUSTOM,l,g,t,n,Yg,s]),this.hitDetectionInstructions.push([ee.CUSTOM,l,g,t,r||n,Yg,s]);break;case"Polygon":case"MultiLineString":f=[],h=a=="Polygon"?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),d=this.drawCustomCoordinates_(h,0,t.getEnds(),o,f),this.instructions.push([ee.CUSTOM,l,f,t,n,Wh,s]),this.hitDetectionInstructions.push([ee.CUSTOM,l,f,t,r||n,Wh,s]);break;case"LineString":case"Circle":h=t.getFlatCoordinates(),c=this.appendFlatLineCoordinates(h,0,h.length,o,!1,!1),this.instructions.push([ee.CUSTOM,l,c,t,n,la,s]),this.hitDetectionInstructions.push([ee.CUSTOM,l,c,t,r||n,la,s]);break;case"MultiPoint":h=t.getFlatCoordinates(),c=this.appendFlatPointCoordinates(h,o),c>l&&(this.instructions.push([ee.CUSTOM,l,c,t,n,la,s]),this.hitDetectionInstructions.push([ee.CUSTOM,l,c,t,r||n,la,s]));break;case"Point":h=t.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),c=this.coordinates.length,this.instructions.push([ee.CUSTOM,l,c,t,n,void 0,s]),this.hitDetectionInstructions.push([ee.CUSTOM,l,c,t,r||n,void 0,s]);break}this.endGeometry(e)}beginGeometry(t,e,n){this.beginGeometryInstruction1_=[ee.BEGIN_GEOMETRY,e,0,t,n],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[ee.BEGIN_GEOMETRY,e,0,t,n],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;t.reverse();let e;const n=t.length;let r,s,a=-1;for(e=0;e<n;++e)r=t[e],s=r[0],s==ee.END_GEOMETRY?a=e:s==ee.BEGIN_GEOMETRY&&(r[2]=e,c5(this.hitDetectionInstructions,a,e),a=-1)}setFillStrokeStyle(t,e){const n=this.state;if(t){const r=t.getColor();n.fillPatternScale=r&&typeof r=="object"&&"src"in r?this.pixelRatio:1,n.fillStyle=Kr(r||Fn)}else n.fillStyle=void 0;if(e){const r=e.getColor();n.strokeStyle=Kr(r||Yh);const s=e.getLineCap();n.lineCap=s!==void 0?s:Ml;const a=e.getLineDash();n.lineDash=a?a.slice():Ps;const o=e.getLineDashOffset();n.lineDashOffset=o||Is;const l=e.getLineJoin();n.lineJoin=l!==void 0?l:Tl;const h=e.getWidth();n.lineWidth=h!==void 0?h:Kh;const c=e.getMiterLimit();n.miterLimit=c!==void 0?c:Xh,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0}createFill(t){const e=t.fillStyle,n=[ee.SET_FILL_STYLE,e];return typeof e!="string"&&n.push(t.fillPatternScale),n}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[ee.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const n=t.fillStyle;(typeof n!="string"||t.currentFillStyle!=n)&&(n!==void 0&&this.instructions.push(e.call(this,t)),t.currentFillStyle=n)}updateStrokeStyle(t,e){const n=t.strokeStyle,r=t.lineCap,s=t.lineDash,a=t.lineDashOffset,o=t.lineJoin,l=t.lineWidth,h=t.miterLimit;(t.currentStrokeStyle!=n||t.currentLineCap!=r||s!=t.currentLineDash&&!Os(t.currentLineDash,s)||t.currentLineDashOffset!=a||t.currentLineJoin!=o||t.currentLineWidth!=l||t.currentMiterLimit!=h)&&(n!==void 0&&e.call(this,t),t.currentStrokeStyle=n,t.currentLineCap=r,t.currentLineDash=s,t.currentLineDashOffset=a,t.currentLineJoin=o,t.currentLineWidth=l,t.currentMiterLimit=h)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[ee.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=R2(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;va(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class Qw extends xc{constructor(t,e,n,r){super(t,e,n,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e,n){if(!this.image_||this.maxExtent&&!ya(this.maxExtent,t.getFlatCoordinates()))return;this.beginGeometry(t,e,n);const r=t.getFlatCoordinates(),s=t.getStride(),a=this.coordinates.length,o=this.appendFlatPointCoordinates(r,s);this.instructions.push([ee.DRAW_IMAGE,a,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([ee.DRAW_IMAGE,a,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e,n){if(!this.image_)return;this.beginGeometry(t,e,n);const r=t.getFlatCoordinates(),s=[];for(let l=0,h=r.length;l<h;l+=t.getStride())(!this.maxExtent||ya(this.maxExtent,r.slice(l,l+2)))&&s.push(r[l],r[l+1]);const a=this.coordinates.length,o=this.appendFlatPointCoordinates(s,2);this.instructions.push([ee.DRAW_IMAGE,a,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([ee.DRAW_IMAGE,a,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const n=t.getAnchor(),r=t.getSize(),s=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=n[0],this.anchorY_=n[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=t.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=r[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}const t3=Qw;class e3 extends xc{constructor(t,e,n,r){super(t,e,n,r)}drawFlatCoordinates_(t,e,n,r){const s=this.coordinates.length,a=this.appendFlatLineCoordinates(t,e,n,r,!1,!1),o=[ee.MOVE_TO_LINE_TO,s,a];return this.instructions.push(o),this.hitDetectionInstructions.push(o),n}drawLineString(t,e,n){const r=this.state,s=r.strokeStyle,a=r.lineWidth;if(s===void 0||a===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,e,n),this.hitDetectionInstructions.push([ee.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ps,Is],Ha);const o=t.getFlatCoordinates(),l=t.getStride();this.drawFlatCoordinates_(o,0,o.length,l),this.hitDetectionInstructions.push(ua),this.endGeometry(e)}drawMultiLineString(t,e,n){const r=this.state,s=r.strokeStyle,a=r.lineWidth;if(s===void 0||a===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,e,n),this.hitDetectionInstructions.push([ee.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ps,Is],Ha);const o=t.getEnds(),l=t.getFlatCoordinates(),h=t.getStride();let c=0;for(let f=0,g=o.length;f<g;++f)c=this.drawFlatCoordinates_(l,c,o[f],h);this.hitDetectionInstructions.push(ua),this.endGeometry(e)}finish(){const t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(ua),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(ua),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(Ha)}}const i3=e3;class n3 extends xc{constructor(t,e,n,r){super(t,e,n,r)}drawFlatCoordinatess_(t,e,n,r){const s=this.state,a=s.fillStyle!==void 0,o=s.strokeStyle!==void 0,l=n.length;this.instructions.push(Ha),this.hitDetectionInstructions.push(Ha);for(let h=0;h<l;++h){const c=n[h],f=this.coordinates.length,g=this.appendFlatLineCoordinates(t,e,c,r,!0,!o),d=[ee.MOVE_TO_LINE_TO,f,g];this.instructions.push(d),this.hitDetectionInstructions.push(d),o&&(this.instructions.push(um),this.hitDetectionInstructions.push(um)),e=c}return a&&(this.instructions.push(Su),this.hitDetectionInstructions.push(Su)),o&&(this.instructions.push(ua),this.hitDetectionInstructions.push(ua)),e}drawCircle(t,e,n){const r=this.state,s=r.fillStyle,a=r.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,n),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([ee.SET_FILL_STYLE,Fn]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ee.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ps,Is]);const o=t.getFlatCoordinates(),l=t.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,l,!1,!1);const c=[ee.CIRCLE,h];this.instructions.push(Ha,c),this.hitDetectionInstructions.push(Ha,c),r.fillStyle!==void 0&&(this.instructions.push(Su),this.hitDetectionInstructions.push(Su)),r.strokeStyle!==void 0&&(this.instructions.push(ua),this.hitDetectionInstructions.push(ua)),this.endGeometry(e)}drawPolygon(t,e,n){const r=this.state,s=r.fillStyle,a=r.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,n),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([ee.SET_FILL_STYLE,Fn]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ee.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ps,Is]);const o=t.getEnds(),l=t.getOrientedFlatCoordinates(),h=t.getStride();this.drawFlatCoordinatess_(l,0,o,h),this.endGeometry(e)}drawMultiPolygon(t,e,n){const r=this.state,s=r.fillStyle,a=r.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,n),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([ee.SET_FILL_STYLE,Fn]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ee.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ps,Is]);const o=t.getEndss(),l=t.getOrientedFlatCoordinates(),h=t.getStride();let c=0;for(let f=0,g=o.length;f<g;++f)c=this.drawFlatCoordinatess_(l,c,o[f],h);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(t!==0){const e=this.coordinates;for(let n=0,r=e.length;n<r;++n)e[n]=Ga(e[n],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;t.fillStyle!==void 0&&this.updateFillStyle(t,this.createFill),t.strokeStyle!==void 0&&this.updateStrokeStyle(t,this.applyStroke)}}const fm=n3;function r3(i,t,e,n,r){const s=[];let a=e,o=0,l=t.slice(e,2);for(;o<i&&a+r<n;){const[h,c]=l.slice(-2),f=t[a+r],g=t[a+r+1],d=Math.sqrt((f-h)*(f-h)+(g-c)*(g-c));if(o+=d,o>=i){const m=(i-o+d)/d,y=Zn(h,f,m),b=Zn(c,g,m);l.push(y,b),s.push(l),l=[y,b],o==i&&(a+=r),o=0}else if(o<i)l.push(t[a+r],t[a+r+1]),a+=r;else{const m=d-o,y=Zn(h,f,m/d),b=Zn(c,g,m/d);l.push(y,b),s.push(l),l=[y,b],o=0,a+=r}}return o>0&&s.push(l),s}function s3(i,t,e,n,r){let s=e,a=e,o=0,l=0,h=e,c,f,g,d,m,y,b,x,E,S;for(f=e;f<n;f+=r){const M=t[f],D=t[f+1];m!==void 0&&(E=M-m,S=D-y,d=Math.sqrt(E*E+S*S),b!==void 0&&(l+=g,c=Math.acos((b*E+x*S)/(g*d)),c>i&&(l>o&&(o=l,s=h,a=f),l=0,h=f-r)),g=d,b=E,x=S),m=M,y=D}return l+=d,l>o?[h,f]:[s,a]}const mf={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class a3 extends xc{constructor(t,e,n,r){super(t,e,n,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[Fn]={fillStyle:Fn},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e,n){const r=this.textFillState_,s=this.textStrokeState_,a=this.textState_;if(this.text_===""||!a||!r&&!s)return;const o=this.coordinates;let l=o.length;const h=t.getType();let c=null,f=t.getStride();if(a.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!ki(this.maxExtent,t.getExtent()))return;let g;if(c=t.getFlatCoordinates(),h=="LineString")g=[c.length];else if(h=="MultiLineString")g=t.getEnds();else if(h=="Polygon")g=t.getEnds().slice(0,1);else if(h=="MultiPolygon"){const b=t.getEndss();g=[];for(let x=0,E=b.length;x<E;++x)g.push(b[x][0])}this.beginGeometry(t,e,n);const d=a.repeat,m=d?void 0:a.textAlign;let y=0;for(let b=0,x=g.length;b<x;++b){let E;d?E=r3(d*this.resolution,c,y,g[b],f):E=[c.slice(y,g[b])];for(let S=0,M=E.length;S<M;++S){const D=E[S];let W=0,j=D.length;if(m==null){const H=s3(a.maxAngle,D,0,D.length,2);W=H[0],j=H[1]}for(let H=W;H<j;H+=f)o.push(D[H],D[H+1]);const P=o.length;y=g[b],this.drawChars_(l,P),l=P}}this.endGeometry(e)}else{let g=a.overflow?null:[];switch(h){case"Point":case"MultiPoint":c=t.getFlatCoordinates();break;case"LineString":c=t.getFlatMidpoint();break;case"Circle":c=t.getCenter();break;case"MultiLineString":c=t.getFlatMidpoints(),f=2;break;case"Polygon":c=t.getFlatInteriorPoint(),a.overflow||g.push(c[2]/this.resolution),f=3;break;case"MultiPolygon":const E=t.getFlatInteriorPoints();c=[];for(let S=0,M=E.length;S<M;S+=3)a.overflow||g.push(E[S+2]/this.resolution),c.push(E[S],E[S+1]);if(c.length===0)return;f=2;break}const d=this.appendFlatPointCoordinates(c,f);if(d===l)return;if(g&&(d-l)/2!==c.length/f){let E=l/2;g=g.filter((S,M)=>{const D=o[(E+M)*2]===c[M*f]&&o[(E+M)*2+1]===c[M*f+1];return D||--E,D})}this.saveTextStates_(),(a.backgroundFill||a.backgroundStroke)&&(this.setFillStrokeStyle(a.backgroundFill,a.backgroundStroke),a.backgroundFill&&this.updateFillStyle(this.state,this.createFill),a.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e,n);let m=a.padding;if(m!=Va&&(a.scale[0]<0||a.scale[1]<0)){let E=a.padding[0],S=a.padding[1],M=a.padding[2],D=a.padding[3];a.scale[0]<0&&(S=-S,D=-D),a.scale[1]<0&&(E=-E,M=-M),m=[E,S,M,D]}const y=this.pixelRatio;this.instructions.push([ee.DRAW_IMAGE,l,d,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,m==Va?Va:m.map(function(E){return E*y}),!!a.backgroundFill,!!a.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,g]);const b=1/y,x=this.state.fillStyle;a.backgroundFill&&(this.state.fillStyle=Fn,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([ee.DRAW_IMAGE,l,d,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[b,b],NaN,this.declutterMode_,this.declutterImageWithText_,m,!!a.backgroundFill,!!a.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?Fn:this.fillKey_,this.textOffsetX_,this.textOffsetY_,g]),a.backgroundFill&&(this.state.fillStyle=x,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,n=this.textFillState_,r=this.strokeKey_;t&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:e.font,textAlign:e.textAlign||Zh,justify:e.justify,textBaseline:e.textBaseline||af,scale:e.scale});const a=this.fillKey_;n&&(a in this.fillStates||(this.fillStates[a]={fillStyle:n.fillStyle}))}drawChars_(t,e){const n=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,a=this.textKey_,o=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,h=mf[r.textBaseline],c=this.textOffsetY_*l,f=this.text_,g=n?n.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([ee.DRAW_CHARS,t,e,h,r.overflow,o,r.maxAngle,l,c,s,g*l,f,a,1,this.declutterMode_]),this.hitDetectionInstructions.push([ee.DRAW_CHARS,t,e,h,r.overflow,o&&Fn,r.maxAngle,l,c,s,g*l,f,a,1/l,this.declutterMode_])}setTextStyle(t,e){let n,r,s;if(!t)this.text_="";else{const a=t.getFill();a?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=Kr(a.getColor()||Fn)):(r=null,this.textFillState_=r);const o=t.getStroke();if(!o)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const m=o.getLineDash(),y=o.getLineDashOffset(),b=o.getWidth(),x=o.getMiterLimit();s.lineCap=o.getLineCap()||Ml,s.lineDash=m?m.slice():Ps,s.lineDashOffset=y===void 0?Is:y,s.lineJoin=o.getLineJoin()||Tl,s.lineWidth=b===void 0?Kh:b,s.miterLimit=x===void 0?Xh:x,s.strokeStyle=Kr(o.getColor()||Yh)}n=this.textState_;const l=t.getFont()||x_;Qx(l);const h=t.getScaleArray();n.overflow=t.getOverflow(),n.font=l,n.maxAngle=t.getMaxAngle(),n.placement=t.getPlacement(),n.textAlign=t.getTextAlign(),n.repeat=t.getRepeat(),n.justify=t.getJustify(),n.textBaseline=t.getTextBaseline()||af,n.backgroundFill=t.getBackgroundFill(),n.backgroundStroke=t.getBackgroundStroke(),n.padding=t.getPadding()||Va,n.scale=h===void 0?[1,1]:h;const c=t.getOffsetX(),f=t.getOffsetY(),g=t.getRotateWithView(),d=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=c===void 0?0:c,this.textOffsetY_=f===void 0?0:f,this.textRotateWithView_=g===void 0?!1:g,this.textRotation_=d===void 0?0:d,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:Qt(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=n.font+n.scale+(n.textAlign||"?")+(n.repeat||"?")+(n.justify||"?")+(n.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+Qt(r.fillStyle):""}this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}const o3={Circle:fm,Default:xc,Image:t3,LineString:i3,Polygon:fm,Text:a3};class V_{constructor(t,e,n,r){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=r,this.resolution_=n,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const n=this.buildersByZIndex_[e];for(const r in n){const s=n[r].finish();t[e][r]=s}}return t}getBuilder(t,e){const n=t!==void 0?t.toString():"0";let r=this.buildersByZIndex_[n];r===void 0&&(r={},this.buildersByZIndex_[n]=r);let s=r[e];if(s===void 0){const a=o3[e];s=new a(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[e]=s}return s}}class H_ extends uc{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.declutterExecutorGroup=null}getFeatures(t){return ae()}getData(t){return null}prepareFrame(t){return ae()}renderFrame(t,e){return ae()}loadedTileCallback(t,e,n){t[e]||(t[e]={}),t[e][n.tileCoord.toString()]=n}createLoadedTileFinder(t,e,n){return(r,s)=>{const a=this.loadedTileCallback.bind(this,n,r);return t.forEachLoadedTile(e,r,s,a)}}forEachFeatureAtCoordinate(t,e,n,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;(e.getState()===xe.LOADED||e.getState()===xe.ERROR)&&this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=xe.LOADED&&e!=xe.ERROR&&t.addEventListener(le.CHANGE,this.boundHandleImageChange_),e==xe.IDLE&&(t.load(),e=t.getState()),e==xe.LOADED}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()}renderDeferred(t){}disposeInternal(){delete this.layer_,super.disposeInternal()}}class E1{constructor(){Tp(this,"pushMethodArgs_",(...t)=>(this.instructions_[this.zIndex+this.offset_].push(t),this));this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(CanvasRenderingContext2D.prototype,{get:(t,e)=>{if(typeof $g()[e]=="function")return this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(e),this.pushMethodArgs_},set:(t,e,n)=>(this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(e,n),!0)})}getContext(){return this.context_}draw(t){this.instructions_.forEach(e=>{for(let n=0,r=e.length;n<r;n+=2){const s=e[n],a=e[n+1];if(typeof t[s]=="function")t[s](...a);else{if(typeof a=="function"){t[s]=a(t);continue}t[s]=a}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const dm=[];let Jo=null;function l3(){Jo=Ki(1,1,void 0,{willReadFrequently:!0})}class S1 extends H_{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=Bi(),this.pixelTransform=Bi(),this.inversePixelTransform=Bi(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(t,e,n){Jo||l3(),Jo.clearRect(0,0,1,1);let r;try{Jo.drawImage(t,e,n,1,1,0,0,1,1),r=Jo.getImageData(0,0,1,1).data}catch{return Jo=null,null}return r}getBackground(t){let n=this.getLayer().getBackground();return typeof n=="function"&&(n=n(t.viewState.resolution)),n||void 0}useContainer(t,e,n){const r=this.getLayer().getClassName();let s,a;if(t&&t.className===r&&(!n||t&&t.style.backgroundColor&&Os(Al(t.style.backgroundColor),Al(n)))){const o=t.firstElementChild;o instanceof HTMLCanvasElement&&(a=o.getContext("2d"))}if(a&&a.canvas.style.transform===e?(this.container=t,this.context=a,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=document.createElement("div"),s.className=r;let o=s.style;o.position="absolute",o.width="100%",o.height="100%",a=Ki();const l=a.canvas;s.appendChild(l),o=l.style,o.position="absolute",o.left="0",o.transformOrigin="top left",this.container=s,this.context=a}!this.containerReused&&n&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=n)}clipUnrotated(t,e,n){const r=Aa(n),s=kf(n),a=Of(n),o=Ff(n);xi(e.coordinateToPixelTransform,r),xi(e.coordinateToPixelTransform,s),xi(e.coordinateToPixelTransform,a),xi(e.coordinateToPixelTransform,o);const l=this.inversePixelTransform;xi(l,r),xi(l,s),xi(l,a),xi(l,o),t.save(),t.beginPath(),t.moveTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.clip()}dispatchRenderEvent_(t,e,n){const r=this.getLayer();if(r.hasListener(t)){const s=new Nh(t,this.inversePixelTransform,n,e);r.dispatchEvent(s)}}preRender(t,e){this.frameState=e,!e.declutter&&this.dispatchRenderEvent_(Zi.PRERENDER,t,e)}postRender(t,e){e.declutter||this.dispatchRenderEvent_(Zi.POSTRENDER,t,e)}renderDeferredInternal(t){}getRenderContext(t){return t.declutter&&!this.deferredContext_&&(this.deferredContext_=new E1),t.declutter?this.deferredContext_.getContext():this.context}renderDeferred(t){t.declutter&&(this.dispatchRenderEvent_(Zi.PRERENDER,this.context,t),t.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(t),this.dispatchRenderEvent_(Zi.POSTRENDER,this.context,t))}getRenderTransform(t,e,n,r,s,a,o){const l=s/2,h=a/2,c=r/e,f=-c,g=-t[0]+o,d=-t[1];return Jn(this.tempTransform,l,h,c,f,-n,g,d)}disposeInternal(){delete this.frameState,super.disposeInternal()}}function h3(i,t,e,n,r,s,a,o,l,h,c,f){let g=i[t],d=i[t+1],m=0,y=0,b=0,x=0;function E(){m=g,y=d,t+=n,g=i[t],d=i[t+1],x+=b,b=Math.sqrt((g-m)*(g-m)+(d-y)*(d-y))}do E();while(t<e-n&&x+b<s);let S=b===0?0:(s-x)/b;const M=Zn(m,g,S),D=Zn(y,d,S),W=t-n,j=x,P=s+o*l(h,r,c);for(;t<e-n&&x+b<P;)E();S=b===0?0:(P-x)/b;const H=Zn(m,g,S),et=Zn(y,d,S);let R;if(f){const Y=[M,D,H,et];Z0(Y,0,4,2,f,Y,Y),R=Y[0]>Y[2]}else R=M>H;const F=Math.PI,U=[],z=W+n===t;t=W,b=0,x=j,g=i[t],d=i[t+1];let it;if(z){E(),it=Math.atan2(d-y,g-m),R&&(it+=it>0?-F:F);const Y=(H+M)/2,st=(et+D)/2;return U[0]=[Y,st,(P-s)/2,it,r],U}r=r.replace(/\n/g," ");for(let Y=0,st=r.length;Y<st;){E();let Q=Math.atan2(d-y,g-m);if(R&&(Q+=Q>0?-F:F),it!==void 0){let O=Q-it;if(O+=O>F?-2*F:O<-F?2*F:0,Math.abs(O)>a)return null}it=Q;const gt=Y;let lt=0;for(;Y<st;++Y){const O=R?st-Y-1:Y,X=o*l(h,r[O],c);if(t+n<e&&x+b<s+lt+X/2)break;lt+=X}if(Y===gt)continue;const Et=R?r.substring(st-gt,st-Y):r.substring(gt,Y);S=b===0?0:(s+lt/2-x)/b;const A=Zn(m,g,S),G=Zn(y,d,S);U.push([A,G,lt/2,Q,Et]),s+=lt}return U}const Go=Dn(),ea=[],_s=[],vs=[],ia=[];function gm(i){return i[3].declutterBox}const pm=new RegExp("[֑-ࣿיִ-﷿ﹰ-ﻼࠀ-࿿-]");function dg(i,t){return t==="start"?t=pm.test(i)?"right":"left":t==="end"&&(t=pm.test(i)?"left":"right"),mf[t]}function c3(i,t,e){return e>0&&i.push(`
`,""),i.push(t,""),i}class u3{constructor(t,e,n,r,s){this.overlaps=n,this.pixelRatio=e,this.resolution=t,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=Bi(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new E1:null}getZIndexContext(){return this.zIndexContext_}createLabel(t,e,n,r){const s=t+e+n+r;if(this.labels_[s])return this.labels_[s];const a=r?this.strokeStates[r]:null,o=n?this.fillStates[n]:null,l=this.textStates[e],h=this.pixelRatio,c=[l.scale[0]*h,l.scale[1]*h],f=Array.isArray(t),g=l.justify?mf[l.justify]:dg(Array.isArray(t)?t[0]:t,l.textAlign||Zh),d=r&&a.lineWidth?a.lineWidth:0,m=f?t:t.split(`
`).reduce(c3,[]),{width:y,height:b,widths:x,heights:E,lineWidths:S}=eb(l,m),M=y+d,D=[],W=(M+2)*c[0],j=(b+d)*c[1],P={width:W<0?Math.floor(W):Math.ceil(W),height:j<0?Math.floor(j):Math.ceil(j),contextInstructions:D};(c[0]!=1||c[1]!=1)&&D.push("scale",c),r&&(D.push("strokeStyle",a.strokeStyle),D.push("lineWidth",d),D.push("lineCap",a.lineCap),D.push("lineJoin",a.lineJoin),D.push("miterLimit",a.miterLimit),D.push("setLineDash",[a.lineDash]),D.push("lineDashOffset",a.lineDashOffset)),n&&D.push("fillStyle",o.fillStyle),D.push("textBaseline","middle"),D.push("textAlign","center");const H=.5-g;let et=g*M+H*d;const R=[],F=[];let U=0,z=0,it=0,Y=0,st;for(let Q=0,gt=m.length;Q<gt;Q+=2){const lt=m[Q];if(lt===`
`){z+=U,U=0,et=g*M+H*d,++Y;continue}const Et=m[Q+1]||l.font;Et!==st&&(r&&R.push("font",Et),n&&F.push("font",Et),st=Et),U=Math.max(U,E[it]);const A=[lt,et+H*x[it]+g*(x[it]-S[Y]),.5*(d+U)+z];et+=x[it],r&&R.push("strokeText",A),n&&F.push("fillText",A),++it}return Array.prototype.push.apply(D,R),Array.prototype.push.apply(D,F),this.labels_[s]=P,P}replayTextBackground_(t,e,n,r,s,a,o){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,n),t.lineTo.apply(t,r),t.lineTo.apply(t,s),t.lineTo.apply(t,e),a&&(this.alignAndScaleFill_=a[2],this.fill_(t)),o&&(this.setStrokeStyle_(t,o),t.stroke())}calculateImageOrLabelDimensions_(t,e,n,r,s,a,o,l,h,c,f,g,d,m,y,b){o*=g[0],l*=g[1];let x=n-o,E=r-l;const S=s+h>t?t-h:s,M=a+c>e?e-c:a,D=m[3]+S*g[0]+m[1],W=m[0]+M*g[1]+m[2],j=x-m[3],P=E-m[0];(y||f!==0)&&(ea[0]=j,ia[0]=j,ea[1]=P,_s[1]=P,_s[0]=j+D,vs[0]=_s[0],vs[1]=P+W,ia[1]=vs[1]);let H;return f!==0?(H=Jn(Bi(),n,r,1,1,f,-n,-r),xi(H,ea),xi(H,_s),xi(H,vs),xi(H,ia),is(Math.min(ea[0],_s[0],vs[0],ia[0]),Math.min(ea[1],_s[1],vs[1],ia[1]),Math.max(ea[0],_s[0],vs[0],ia[0]),Math.max(ea[1],_s[1],vs[1],ia[1]),Go)):is(Math.min(j,j+D),Math.min(P,P+W),Math.max(j,j+D),Math.max(P,P+W),Go),d&&(x=Math.round(x),E=Math.round(E)),{drawImageX:x,drawImageY:E,drawImageW:S,drawImageH:M,originX:h,originY:c,declutterBox:{minX:Go[0],minY:Go[1],maxX:Go[2],maxY:Go[3],value:b},canvasTransform:H,scale:g}}replayImageOrLabel_(t,e,n,r,s,a,o){const l=!!(a||o),h=r.declutterBox,c=o?o[2]*r.scale[0]/2:0;return h.minX-c<=e[0]&&h.maxX+c>=0&&h.minY-c<=e[1]&&h.maxY+c>=0&&(l&&this.replayTextBackground_(t,ea,_s,vs,ia,a,o),ib(t,r.canvasTransform,s,n,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(t){const e=this.alignAndScaleFill_;if(e){const n=xi(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;t.save(),t.translate(n[0]%r,n[1]%r),e!==1&&t.scale(e,e),t.rotate(this.viewRotation_)}t.fill(),e&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,n,r){const s=this.textStates[e],a=this.createLabel(t,e,r,n),o=this.strokeStates[n],l=this.pixelRatio,h=dg(Array.isArray(t)?t[0]:t,s.textAlign||Zh),c=mf[s.textBaseline||af],f=o&&o.lineWidth?o.lineWidth:0,g=a.width/l-2*s.scale[0],d=h*g+2*(.5-h)*f,m=c*a.height/l+2*(.5-c)*f;return{label:a,anchorX:d,anchorY:m}}execute_(t,e,n,r,s,a,o,l){const h=this.zIndexContext_;let c;this.pixelCoordinates_&&Os(n,this.renderedTransform_)?c=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),c=ga(this.coordinates,0,this.coordinates.length,2,n,this.pixelCoordinates_),$5(this.renderedTransform_,n));let f=0;const g=r.length;let d=0,m,y,b,x,E,S,M,D,W,j,P,H,et,R=0,F=0,U=null,z=null;const it=this.coordinateCache_,Y=this.viewRotation_,st=Math.round(Math.atan2(-n[1],n[0])*1e12)/1e12,Q={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:Y},gt=this.instructions!=r||this.overlaps?0:200;let lt,Et,A,G;for(;f<g;){const O=r[f];switch(O[0]){case ee.BEGIN_GEOMETRY:lt=O[1],G=O[3],lt.getGeometry()?o!==void 0&&!ki(o,G.getExtent())?f=O[2]+1:++f:f=O[2],h&&(h.zIndex=O[4]);break;case ee.BEGIN_PATH:R>gt&&(this.fill_(t),R=0),F>gt&&(t.stroke(),F=0),!R&&!F&&(t.beginPath(),E=NaN,S=NaN),++f;break;case ee.CIRCLE:d=O[1];const nt=c[d],at=c[d+1],ht=c[d+2],dt=c[d+3],St=ht-nt,At=dt-at,Rt=Math.sqrt(St*St+At*At);t.moveTo(nt+Rt,at),t.arc(nt,at,Rt,0,2*Math.PI,!0),++f;break;case ee.CLOSE_PATH:t.closePath(),++f;break;case ee.CUSTOM:d=O[1],m=O[2];const Dt=O[3],$t=O[4],mt=O[5];Q.geometry=Dt,Q.feature=lt,f in it||(it[f]=[]);const V=it[f];mt?mt(c,d,m,2,V):(V[0]=c[d],V[1]=c[d+1],V.length=2),h&&(h.zIndex=O[6]),$t(V,Q),++f;break;case ee.DRAW_IMAGE:d=O[1],m=O[2],W=O[3],y=O[4],b=O[5];let ne=O[6];const qt=O[7],Lt=O[8],It=O[9],Ft=O[10];let Tt=O[11];const zt=O[12];let Kt=O[13];x=O[14]||"declutter";const te=O[15];if(!W&&O.length>=20){j=O[19],P=O[20],H=O[21],et=O[22];const Ii=this.drawLabelWithPointPlacement_(j,P,H,et);W=Ii.label,O[3]=W;const ai=O[23];y=(Ii.anchorX-ai)*this.pixelRatio,O[4]=y;const ui=O[24];b=(Ii.anchorY-ui)*this.pixelRatio,O[5]=b,ne=W.height,O[6]=ne,Kt=W.width,O[13]=Kt}let he;O.length>25&&(he=O[25]);let ve,we,Xt;O.length>17?(ve=O[16],we=O[17],Xt=O[18]):(ve=Va,we=!1,Xt=!1),Ft&&st?Tt+=Y:!Ft&&!st&&(Tt-=Y);let me=0;for(;d<m;d+=2){if(he&&he[me++]<Kt/this.pixelRatio)continue;const Ii=this.calculateImageOrLabelDimensions_(W.width,W.height,c[d],c[d+1],Kt,ne,y,b,Lt,It,Tt,zt,s,ve,we||Xt,lt),ai=[t,e,W,Ii,qt,we?U:null,Xt?z:null];if(l){let ui,wi,Wt;if(te){const Ee=m-d;if(!te[Ee]){te[Ee]={args:ai,declutterMode:x};continue}const Ae=te[Ee];ui=Ae.args,wi=Ae.declutterMode,delete te[Ee],Wt=gm(ui)}let Ei,Ri;if(ui&&(wi!=="declutter"||!l.collides(Wt))&&(Ei=!0),(x!=="declutter"||!l.collides(Ii.declutterBox))&&(Ri=!0),wi==="declutter"&&x==="declutter"){const Ee=Ei&&Ri;Ei=Ee,Ri=Ee}Ei&&(wi!=="none"&&l.insert(Wt),this.replayImageOrLabel_.apply(this,ui)),Ri&&(x!=="none"&&l.insert(Ii.declutterBox),this.replayImageOrLabel_.apply(this,ai))}else this.replayImageOrLabel_.apply(this,ai)}++f;break;case ee.DRAW_CHARS:const Pt=O[1],Di=O[2],Se=O[3],qn=O[4];et=O[5];const We=O[6],$e=O[7],Un=O[8];H=O[9];const Me=O[10];j=O[11],P=O[12];const kr=[O[13],O[13]];x=O[14]||"declutter";const ei=this.textStates[P],Ji=ei.font,vn=[ei.scale[0]*$e,ei.scale[1]*$e];let Ye;Ji in this.widths_?Ye=this.widths_[Ji]:(Ye={},this.widths_[Ji]=Ye);const oe=z_(c,Pt,Di,2),Pe=Math.abs(vn[0])*em(Ji,j,Ye);if(qn||Pe<=oe){const Ii=this.textStates[P].textAlign,ai=(oe-Pe)*dg(j,Ii),ui=h3(c,Pt,Di,2,j,ai,We,Math.abs(vn[0]),em,Ji,Ye,st?0:this.viewRotation_);t:if(ui){const wi=[];let Wt,Ei,Ri,Ee,Ae;if(H)for(Wt=0,Ei=ui.length;Wt<Ei;++Wt){Ae=ui[Wt],Ri=Ae[4],Ee=this.createLabel(Ri,P,"",H),y=Ae[2]+(vn[0]<0?-Me:Me),b=Se*Ee.height+(.5-Se)*2*Me*vn[1]/vn[0]-Un;const je=this.calculateImageOrLabelDimensions_(Ee.width,Ee.height,Ae[0],Ae[1],Ee.width,Ee.height,y,b,0,0,Ae[3],kr,!1,Va,!1,lt);if(l&&x==="declutter"&&l.collides(je.declutterBox))break t;wi.push([t,e,Ee,je,1,null,null])}if(et)for(Wt=0,Ei=ui.length;Wt<Ei;++Wt){Ae=ui[Wt],Ri=Ae[4],Ee=this.createLabel(Ri,P,et,""),y=Ae[2],b=Se*Ee.height-Un;const je=this.calculateImageOrLabelDimensions_(Ee.width,Ee.height,Ae[0],Ae[1],Ee.width,Ee.height,y,b,0,0,Ae[3],kr,!1,Va,!1,lt);if(l&&x==="declutter"&&l.collides(je.declutterBox))break t;wi.push([t,e,Ee,je,1,null,null])}l&&x!=="none"&&l.load(wi.map(gm));for(let je=0,yn=wi.length;je<yn;++je)this.replayImageOrLabel_.apply(this,wi[je])}}++f;break;case ee.END_GEOMETRY:if(a!==void 0){lt=O[1];const Ii=a(lt,G);if(Ii)return Ii}++f;break;case ee.FILL:gt?R++:this.fill_(t),++f;break;case ee.MOVE_TO_LINE_TO:for(d=O[1],m=O[2],Et=c[d],A=c[d+1],M=Et+.5|0,D=A+.5|0,(M!==E||D!==S)&&(t.moveTo(Et,A),E=M,S=D),d+=2;d<m;d+=2)Et=c[d],A=c[d+1],M=Et+.5|0,D=A+.5|0,(d==m-2||M!==E||D!==S)&&(t.lineTo(Et,A),E=M,S=D);++f;break;case ee.SET_FILL_STYLE:U=O,this.alignAndScaleFill_=O[2],R&&(this.fill_(t),R=0,F&&(t.stroke(),F=0)),t.fillStyle=O[1],++f;break;case ee.SET_STROKE_STYLE:z=O,F&&(t.stroke(),F=0),this.setStrokeStyle_(t,O),++f;break;case ee.STROKE:gt?F++:t.stroke(),++f;break;default:++f;break}}R&&this.fill_(t),F&&t.stroke()}execute(t,e,n,r,s,a){this.viewRotation_=r,this.execute_(t,e,n,this.instructions,s,void 0,void 0,a)}executeHitDetection(t,e,n,r,s){return this.viewRotation_=n,this.execute_(t,[t.canvas.width,t.canvas.height],e,this.hitDetectionInstructions,!0,r,s)}}const Fh=["Polygon","Circle","LineString","Image","Text","Default"],_f=["Image","Text"],f3=Fh.filter(i=>!_f.includes(i));class X_{constructor(t,e,n,r,s,a,o){this.maxExtent_=t,this.overlaps_=r,this.pixelRatio_=n,this.resolution_=e,this.renderBuffer_=a,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Bi(),this.renderedContext_=null,this.deferredZIndexContexts_=[],this.createExecutors_(s,o)}clip(t,e){const n=this.getClipCoords(e);t.beginPath(),t.moveTo(n[0],n[1]),t.lineTo(n[2],n[3]),t.lineTo(n[4],n[5]),t.lineTo(n[6],n[7]),t.clip()}createExecutors_(t,e){for(const n in t){let r=this.executorsByZIndex_[n];r===void 0&&(r={},this.executorsByZIndex_[n]=r);const s=t[n];for(const a in s){const o=s[a];r[a]=new u3(this.resolution_,this.pixelRatio_,this.overlaps_,o,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const n=this.executorsByZIndex_[e];for(let r=0,s=t.length;r<s;++r)if(t[r]in n)return!0}return!1}forEachFeatureAtCoordinate(t,e,n,r,s,a){r=Math.round(r);const o=r*2+1,l=Jn(this.hitDetectionTransform_,r+.5,r+.5,1/e,-1/e,-n,-t[0],-t[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=Ki(o,o,void 0,{willReadFrequently:!0}));const c=this.hitDetectionContext_;c.canvas.width!==o||c.canvas.height!==o?(c.canvas.width=o,c.canvas.height=o):h||c.clearRect(0,0,o,o);let f;this.renderBuffer_!==void 0&&(f=Dn(),Rh(f,t),va(f,e*(this.renderBuffer_+r),f));const g=d3(r);let d;function m(D,W){const j=c.getImageData(0,0,o,o).data;for(let P=0,H=g.length;P<H;P++)if(j[g[P]]>0){if(!a||d!=="Image"&&d!=="Text"||a.includes(D)){const et=(g[P]-3)/4,R=r-et%o,F=r-(et/o|0),U=s(D,W,R*R+F*F);if(U)return U}c.clearRect(0,0,o,o);break}}const y=Object.keys(this.executorsByZIndex_).map(Number);y.sort(Rs);let b,x,E,S,M;for(b=y.length-1;b>=0;--b){const D=y[b].toString();for(E=this.executorsByZIndex_[D],x=Fh.length-1;x>=0;--x)if(d=Fh[x],S=E[d],S!==void 0&&(M=S.executeHitDetection(c,l,n,m,f),M))return M}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const n=e[0],r=e[1],s=e[2],a=e[3],o=[n,r,n,a,s,a,s,r];return ga(o,0,8,2,t,o),o}isEmpty(){return Qa(this.executorsByZIndex_)}execute(t,e,n,r,s,a,o){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(Rs),a=a||Fh;let h,c,f,g,d,m;for(o&&l.reverse(),h=0,c=l.length;h<c;++h){const y=l[h].toString();for(d=this.executorsByZIndex_[y],f=0,g=a.length;f<g;++f){const b=a[f];if(m=d[b],m!==void 0){const x=o===null?void 0:m.getZIndexContext(),E=x?x.getContext():t,S=this.maxExtent_&&b!=="Image"&&b!=="Text";if(S&&(E.save(),this.clip(E,n)),m.execute(E,e,n,r,s,o),S&&E.restore(),x){x.offset();const M=l[h];this.deferredZIndexContexts_[M]||(this.deferredZIndexContexts_[M]=[]),this.deferredZIndexContexts_[M].push(x)}}}}this.renderedContext_=t}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){this.deferredZIndexContexts_.forEach(t=>{t.forEach(e=>{e.draw(this.renderedContext_),e.clear()})})}}const gg={};function d3(i){if(gg[i]!==void 0)return gg[i];const t=i*2+1,e=i*i,n=new Array(e+1);for(let s=0;s<=i;++s)for(let a=0;a<=i;++a){const o=s*s+a*a;if(o>e)break;let l=n[o];l||(l=[],n[o]=l),l.push(((i+s)*t+(i+a))*4+3),s>0&&l.push(((i-s)*t+(i+a))*4+3),a>0&&(l.push(((i+s)*t+(i-a))*4+3),s>0&&l.push(((i-s)*t+(i-a))*4+3))}const r=[];for(let s=0,a=n.length;s<a;++s)n[s]&&r.push(...n[s]);return gg[i]=r,r}class g3 extends W_{constructor(t,e,n,r,s,a,o){super(),this.context_=t,this.pixelRatio_=e,this.extent_=n,this.transform_=r,this.transformRotation_=r?fc(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=a,this.userTransform_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Bi()}drawImages_(t,e,n,r){if(!this.image_)return;const s=ga(t,e,n,r,this.transform_,this.pixelCoordinates_),a=this.context_,o=this.tmpLocalTransform_,l=a.globalAlpha;this.imageOpacity_!=1&&(a.globalAlpha=l*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let c=0,f=s.length;c<f;c+=2){const g=s[c]-this.imageAnchorX_,d=s[c+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const m=g+this.imageAnchorX_,y=d+this.imageAnchorY_;Jn(o,m,y,1,1,h,-m,-y),a.save(),a.transform.apply(a,o),a.translate(m,y),a.scale(this.imageScale_[0],this.imageScale_[1]),a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),a.restore()}else a.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,g,d,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(a.globalAlpha=l)}drawText_(t,e,n,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=ga(t,e,n,r,this.transform_,this.pixelCoordinates_),a=this.context_;let o=this.textRotation_;for(this.transformRotation_===0&&(o-=this.viewRotation_),this.textRotateWithView_&&(o+=this.viewRotation_);e<n;e+=r){const l=s[e]+this.textOffsetX_,h=s[e+1]+this.textOffsetY_;o!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(a.save(),a.translate(l-this.textOffsetX_,h-this.textOffsetY_),a.rotate(o),a.translate(this.textOffsetX_,this.textOffsetY_),a.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&a.strokeText(this.text_,0,0),this.textFillState_&&a.fillText(this.text_,0,0),a.restore()):(this.textStrokeState_&&a.strokeText(this.text_,l,h),this.textFillState_&&a.fillText(this.text_,l,h))}}moveToLineTo_(t,e,n,r,s){const a=this.context_,o=ga(t,e,n,r,this.transform_,this.pixelCoordinates_);a.moveTo(o[0],o[1]);let l=o.length;s&&(l-=2);for(let h=2;h<l;h+=2)a.lineTo(o[h],o[h+1]);return s&&a.closePath(),n}drawRings_(t,e,n,r){for(let s=0,a=n.length;s<a;++s)e=this.moveToLineTo_(t,e,n[s],r,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ki(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=ix(t,this.transform_,this.pixelCoordinates_),n=e[2]-e[0],r=e[3]-e[1],s=Math.sqrt(n*n+r*r),a=this.context_;a.beginPath(),a.arc(e[0],e[1],s,0,2*Math.PI),this.fillState_&&a.fill(),this.strokeState_&&a.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t);break}}drawFeature(t,e){const n=e.getGeometryFunction()(t);n&&(this.setStyle(e),this.drawGeometry(n))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let n=0,r=e.length;n<r;++n)this.drawGeometry(e[n])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),this.text_!==""&&this.drawText_(e,0,e.length,n)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),this.text_!==""&&this.drawText_(e,0,e.length,n)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ki(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,n=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(n,0,n.length,t.getStride(),!1),e.stroke()}if(this.text_!==""){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(ki(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const n=this.context_,r=t.getFlatCoordinates();let s=0;const a=t.getEnds(),o=t.getStride();n.beginPath();for(let l=0,h=a.length;l<h;++l)s=this.moveToLineTo_(r,s,a[l],o,!1);n.stroke()}if(this.text_!==""){const n=t.getFlatMidpoints();this.drawText_(n,0,n.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ki(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ki(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,n=t.getOrientedFlatCoordinates();let r=0;const s=t.getEndss(),a=t.getStride();e.beginPath();for(let o=0,l=s.length;o<l;++o){const h=s[o];r=this.drawRings_(n,r,h,a)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,n=this.contextFillState_;n?n.fillStyle!=t.fillStyle&&(n.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,n=this.contextStrokeState_;n?(n.lineCap!=t.lineCap&&(n.lineCap=t.lineCap,e.lineCap=t.lineCap),Os(n.lineDash,t.lineDash)||e.setLineDash(n.lineDash=t.lineDash),n.lineDashOffset!=t.lineDashOffset&&(n.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),n.lineJoin!=t.lineJoin&&(n.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),n.lineWidth!=t.lineWidth&&(n.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),n.miterLimit!=t.miterLimit&&(n.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),n.strokeStyle!=t.strokeStyle&&(n.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,n=this.contextTextState_,r=t.textAlign?t.textAlign:Zh;n?(n.font!=t.font&&(n.font=t.font,e.font=t.font),n.textAlign!=r&&(n.textAlign=r,e.textAlign=r),n.textBaseline!=t.textBaseline&&(n.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=r,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:r,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(!t)this.fillState_=null;else{const n=t.getColor();this.fillState_={fillStyle:Kr(n||Fn)}}if(!e)this.strokeState_=null;else{const n=e.getColor(),r=e.getLineCap(),s=e.getLineDash(),a=e.getLineDashOffset(),o=e.getLineJoin(),l=e.getWidth(),h=e.getMiterLimit(),c=s||Ps;this.strokeState_={lineCap:r!==void 0?r:Ml,lineDash:this.pixelRatio_===1?c:c.map(f=>f*this.pixelRatio_),lineDashOffset:(a||Is)*this.pixelRatio_,lineJoin:o!==void 0?o:Tl,lineWidth:(l!==void 0?l:Kh)*this.pixelRatio_,miterLimit:h!==void 0?h:Xh,strokeStyle:Kr(n||Yh)}}}setImageStyle(t){let e;if(!t||!(e=t.getSize())){this.image_=null;return}const n=t.getPixelRatio(this.pixelRatio_),r=t.getAnchor(),s=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*n,this.imageAnchorY_=r[1]*n,this.imageHeight_=e[1]*n,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const a=t.getScaleArray();this.imageScale_=[a[0]*this.pixelRatio_/n,a[1]*this.pixelRatio_/n],this.imageWidth_=e[0]*n}setTextStyle(t){if(!t)this.text_="";else{const e=t.getFill();if(!e)this.textFillState_=null;else{const d=e.getColor();this.textFillState_={fillStyle:Kr(d||Fn)}}const n=t.getStroke();if(!n)this.textStrokeState_=null;else{const d=n.getColor(),m=n.getLineCap(),y=n.getLineDash(),b=n.getLineDashOffset(),x=n.getLineJoin(),E=n.getWidth(),S=n.getMiterLimit();this.textStrokeState_={lineCap:m!==void 0?m:Ml,lineDash:y||Ps,lineDashOffset:b||Is,lineJoin:x!==void 0?x:Tl,lineWidth:E!==void 0?E:Kh,miterLimit:S!==void 0?S:Xh,strokeStyle:Kr(d||Yh)}}const r=t.getFont(),s=t.getOffsetX(),a=t.getOffsetY(),o=t.getRotateWithView(),l=t.getRotation(),h=t.getScaleArray(),c=t.getText(),f=t.getTextAlign(),g=t.getTextBaseline();this.textState_={font:r!==void 0?r:x_,textAlign:f!==void 0?f:Zh,textBaseline:g!==void 0?g:af},this.text_=c!==void 0?Array.isArray(c)?c.reduce((d,m,y)=>d+=y%2?" ":m,""):c:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=a!==void 0?this.pixelRatio_*a:0,this.textRotateWithView_=o!==void 0?o:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const p3=g3,Kn=.5;function Y_(i,t,e,n,r,s,a,o,l){const h=l?W0(r):r,c=i[0]*Kn,f=i[1]*Kn,g=Ki(c,f);g.imageSmoothingEnabled=!1;const d=g.canvas,m=new p3(g,Kn,r,null,a,o,l?gc(q5(),l):null),y=e.length,b=Math.floor((256*256*256-1)/y),x={};for(let S=1;S<=y;++S){const M=e[S-1],D=M.getStyleFunction()||n;if(!D)continue;let W=D(M,s);if(!W)continue;Array.isArray(W)||(W=[W]);const P=(S*b).toString(16).padStart(7,"#00000");for(let H=0,et=W.length;H<et;++H){const R=W[H],F=R.getGeometryFunction()(M);if(!F||!ki(h,F.getExtent()))continue;const U=R.clone(),z=U.getFill();z&&z.setColor(P);const it=U.getStroke();it&&(it.setColor(P),it.setLineDash(null)),U.setText(void 0);const Y=R.getImage();if(Y){const lt=Y.getImageSize();if(!lt)continue;const Et=Ki(lt[0],lt[1],void 0,{alpha:!1}),A=Et.canvas;Et.fillStyle=P,Et.fillRect(0,0,A.width,A.height),U.setImage(new Bn({img:A,anchor:Y.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:Y.getOrigin(),opacity:1,size:Y.getSize(),scale:Y.getScale(),rotation:Y.getRotation(),rotateWithView:Y.getRotateWithView()}))}const st=U.getZIndex()||0;let Q=x[st];Q||(Q={},x[st]=Q,Q.Polygon=[],Q.Circle=[],Q.LineString=[],Q.Point=[]);const gt=F.getType();if(gt==="GeometryCollection"){const lt=F.getGeometriesArrayRecursive();for(let Et=0,A=lt.length;Et<A;++Et){const G=lt[Et];Q[G.getType().replace("Multi","")].push(G,U)}}else Q[gt.replace("Multi","")].push(F,U)}}const E=Object.keys(x).map(Number).sort(Rs);for(let S=0,M=E.length;S<M;++S){const D=x[E[S]];for(const W in D){const j=D[W];for(let P=0,H=j.length;P<H;P+=2){m.setStyle(j[P+1]);for(let et=0,R=t.length;et<R;++et)m.setTransform(t[et]),m.drawGeometry(j[P])}}}return g.getImageData(0,0,d.width,d.height)}function Z_(i,t,e){const n=[];if(e){const r=Math.floor(Math.round(i[0])*Kn),s=Math.floor(Math.round(i[1])*Kn),a=(hi(r,0,e.width-1)+hi(s,0,e.height-1)*e.width)*4,o=e.data[a],l=e.data[a+1],c=e.data[a+2]+256*(l+256*o),f=Math.floor((256*256*256-1)/t.length);c&&c%f===0&&n.push(t[c/f-1])}return n}const m3=.5,K_={Point:S3,LineString:b3,Polygon:C3,MultiPoint:L3,MultiLineString:w3,MultiPolygon:E3,GeometryCollection:x3,Circle:v3};function _3(i,t){return parseInt(Qt(i),10)-parseInt(Qt(t),10)}function l0(i,t){const e=$_(i,t);return e*e}function $_(i,t){return m3*i/t}function v3(i,t,e,n){const r=e.getFill(),s=e.getStroke();if(r||s){const o=i.getBuilder(e.getZIndex(),"Circle");o.setFillStrokeStyle(r,s),o.drawCircle(t,n)}const a=e.getText();if(a&&a.getText()){const o=i.getBuilder(e.getZIndex(),"Text");o.setTextStyle(a),o.drawText(t,n)}}function vf(i,t,e,n,r,s,a,o){const l=[],h=e.getImage();if(h){let g=!0;const d=h.getImageState();d==xe.LOADED||d==xe.ERROR?g=!1:d==xe.IDLE&&h.load(),g&&l.push(h.ready())}const c=e.getFill();c&&c.loading()&&l.push(c.ready());const f=l.length>0;return f&&Promise.all(l).then(()=>r(null)),y3(i,t,e,n,s,a,o),f}function y3(i,t,e,n,r,s,a){const o=e.getGeometryFunction()(t);if(!o)return;const l=o.simplifyTransformed(n,r);if(e.getRenderer())J_(i,l,e,t,a);else{const c=K_[l.getType()];c(i,l,e,t,a,s)}}function J_(i,t,e,n,r){if(t.getType()=="GeometryCollection"){const a=t.getGeometries();for(let o=0,l=a.length;o<l;++o)J_(i,a[o],e,n,r);return}i.getBuilder(e.getZIndex(),"Default").drawCustom(t,n,e.getRenderer(),e.getHitDetectionRenderer(),r)}function x3(i,t,e,n,r,s){const a=t.getGeometriesArray();let o,l;for(o=0,l=a.length;o<l;++o){const h=K_[a[o].getType()];h(i,a[o],e,n,r,s)}}function b3(i,t,e,n,r){const s=e.getStroke();if(s){const o=i.getBuilder(e.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawLineString(t,n,r)}const a=e.getText();if(a&&a.getText()){const o=i.getBuilder(e.getZIndex(),"Text");o.setTextStyle(a),o.drawText(t,n,r)}}function w3(i,t,e,n,r){const s=e.getStroke();if(s){const o=i.getBuilder(e.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawMultiLineString(t,n,r)}const a=e.getText();if(a&&a.getText()){const o=i.getBuilder(e.getZIndex(),"Text");o.setTextStyle(a),o.drawText(t,n,r)}}function E3(i,t,e,n,r){const s=e.getFill(),a=e.getStroke();if(a||s){const l=i.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(s,a),l.drawMultiPolygon(t,n,r)}const o=e.getText();if(o&&o.getText()){const l=i.getBuilder(e.getZIndex(),"Text");l.setTextStyle(o),l.drawText(t,n,r)}}function S3(i,t,e,n,r,s){const a=e.getImage(),o=e.getText(),l=o&&o.getText(),h=s&&a&&l?{}:void 0;if(a){if(a.getImageState()!=xe.LOADED)return;const c=i.getBuilder(e.getZIndex(),"Image");c.setImageStyle(a,h),c.drawPoint(t,n,r)}if(l){const c=i.getBuilder(e.getZIndex(),"Text");c.setTextStyle(o,h),c.drawText(t,n,r)}}function L3(i,t,e,n,r,s){const a=e.getImage(),o=a&&a.getOpacity()!==0,l=e.getText(),h=l&&l.getText(),c=s&&o&&h?{}:void 0;if(o){if(a.getImageState()!=xe.LOADED)return;const f=i.getBuilder(e.getZIndex(),"Image");f.setImageStyle(a,c),f.drawMultiPoint(t,n,r)}if(h){const f=i.getBuilder(e.getZIndex(),"Text");f.setTextStyle(l,c),f.drawText(t,n,r)}}function C3(i,t,e,n,r){const s=e.getFill(),a=e.getStroke();if(s||a){const l=i.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(s,a),l.drawPolygon(t,n,r)}const o=e.getText();if(o&&o.getText()){const l=i.getBuilder(e.getZIndex(),"Text");l.setTextStyle(o),l.drawText(t,n,r)}}class A3 extends S1{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Dn(),this.wrappedRenderedExtent_=Dn(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.compositionContext_=null,this.opacity_=1}renderWorlds(t,e,n){const r=e.extent,s=e.viewState,a=s.center,o=s.resolution,l=s.projection,h=s.rotation,c=l.getExtent(),f=this.getLayer().getSource(),g=this.getLayer().getDeclutter(),d=e.pixelRatio,m=e.viewHints,y=!(m[ri.ANIMATING]||m[ri.INTERACTING]),b=this.compositionContext_,x=Math.round(e.size[0]*d),E=Math.round(e.size[1]*d),S=f.getWrapX()&&l.canWrapX(),M=S?Re(c):null,D=S?Math.ceil((r[2]-c[2])/M)+1:1;let W=S?Math.floor((r[0]-c[0])/M):0;do{const j=this.getRenderTransform(a,o,h,d,x,E,W*M);t.execute(b,[b.canvas.width,b.canvas.height],j,h,y,n===void 0?Fh:n?_f:f3,n?g&&e.declutter[g]:void 0)}while(++W<D)}setupCompositionContext_(){if(this.opacity_!==1){const t=Ki(this.context.canvas.width,this.context.canvas.height,dm);this.compositionContext_=t}else this.compositionContext_=this.context}releaseCompositionContext_(){if(this.opacity_!==1){const t=this.context.globalAlpha;this.context.globalAlpha=this.opacity_,this.context.drawImage(this.compositionContext_.canvas,0,0),this.context.globalAlpha=t,Vf(this.compositionContext_),dm.push(this.compositionContext_.canvas),this.compositionContext_=null}}renderDeclutter(t){this.getLayer().getDeclutter()&&(this.setupCompositionContext_(),this.renderWorlds(this.replayGroup_,t,!0),this.releaseCompositionContext_())}renderDeferredInternal(t){this.replayGroup_.renderDeferred()}renderFrame(t,e){const n=t.pixelRatio,r=t.layerStatesArray[t.layerIndex];J5(this.pixelTransform,1/n,1/n),pc(this.inversePixelTransform,this.pixelTransform);const s=Y0(this.pixelTransform);this.useContainer(e,s,this.getBackground(t));const a=this.context,o=a.canvas,l=this.replayGroup_;let h=l&&!l.isEmpty();if(!h&&!(this.getLayer().hasListener(Zi.PRERENDER)||this.getLayer().hasListener(Zi.POSTRENDER)))return null;const c=Math.round(t.size[0]*n),f=Math.round(t.size[1]*n);o.width!=c||o.height!=f?(o.width=c,o.height=f,o.style.transform!==s&&(o.style.transform=s)):this.containerReused||a.clearRect(0,0,c,f),this.preRender(a,t);const g=t.viewState;g.projection,this.opacity_=r.opacity,this.setupCompositionContext_();let d=!1;if(h&&r.extent&&this.clipping){const m=Yr(r.extent);h=ki(m,t.extent),d=h&&!As(m,t.extent),d&&this.clipUnrotated(this.compositionContext_,t,m)}return h&&this.renderWorlds(l,t,this.getLayer().getDeclutter()?!1:void 0),d&&this.compositionContext_.restore(),this.releaseCompositionContext_(),this.postRender(a,t),this.renderedRotation_!==g.rotation&&(this.renderedRotation_=g.rotation,this.hitDetectionImageData_=null),this.container}getFeatures(t){return new Promise(e=>{if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const n=[this.context.canvas.width,this.context.canvas.height];xi(this.pixelTransform,n);const r=this.renderedCenter_,s=this.renderedResolution_,a=this.renderedRotation_,o=this.renderedProjection_,l=this.wrappedRenderedExtent_,h=this.getLayer(),c=[],f=n[0]*Kn,g=n[1]*Kn;c.push(this.getRenderTransform(r,s,a,Kn,f,g,0).slice());const d=h.getSource(),m=o.getExtent();if(d.getWrapX()&&o.canWrapX()&&!As(m,l)){let y=l[0];const b=Re(m);let x=0,E;for(;y<m[0];)--x,E=b*x,c.push(this.getRenderTransform(r,s,a,Kn,f,g,E).slice()),y+=b;for(x=0,y=l[2];y>m[2];)++x,E=b*x,c.push(this.getRenderTransform(r,s,a,Kn,f,g,E).slice()),y-=b}this.hitDetectionImageData_=Y_(n,c,this.renderedFeatures_,h.getStyleFunction(),l,s,a,l0(s,this.renderedPixelRatio_),null)}e(Z_(t,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(t,e,n,r,s){if(!this.replayGroup_)return;const a=e.viewState.resolution,o=e.viewState.rotation,l=this.getLayer(),h={},c=function(m,y,b){const x=Qt(m),E=h[x];if(E){if(E!==!0&&b<E.distanceSq){if(b===0)return h[x]=!0,s.splice(s.lastIndexOf(E),1),r(m,l,y);E.geometry=y,E.distanceSq=b}}else{if(b===0)return h[x]=!0,r(m,l,y);s.push(h[x]={feature:m,layer:l,geometry:y,distanceSq:b,callback:r})}};let f;const g=[this.replayGroup_],d=this.getLayer().getDeclutter();return g.some(m=>f=m.forEachFeatureAtCoordinate(t,a,o,n,c,d&&e.declutter[d]?e.declutter[d].all().map(y=>y.value):null)),f}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),n=e.getSource();if(!n)return!1;const r=t.viewHints[ri.ANIMATING],s=t.viewHints[ri.INTERACTING],a=e.getUpdateWhileAnimating(),o=e.getUpdateWhileInteracting();if(this.ready&&!a&&r||!o&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=t.extent,h=t.viewState,c=h.projection,f=h.resolution,g=t.pixelRatio,d=e.getRevision(),m=e.getRenderBuffer();let y=e.getRenderOrder();y===void 0&&(y=_3);const b=h.center.slice(),x=va(l,m*f),E=x.slice(),S=[x.slice()],M=c.getExtent();if(n.getWrapX()&&c.canWrapX()&&!As(M,t.extent)){const z=Re(M),it=Math.max(Re(x)/2,z);x[0]=M[0]-it,x[2]=M[2]+it,Df(b,c);const Y=k2(S[0],c);Y[0]<M[0]&&Y[2]<M[2]?S.push([Y[0]+z,Y[1],Y[2]+z,Y[3]]):Y[0]>M[0]&&Y[2]>M[2]&&S.push([Y[0]-z,Y[1],Y[2]-z,Y[3]])}if(this.ready&&this.renderedResolution_==f&&this.renderedRevision_==d&&this.renderedRenderOrder_==y&&As(this.wrappedRenderedExtent_,x))return Os(this.renderedExtent_,E)||(this.hitDetectionImageData_=null,this.renderedExtent_=E),this.renderedCenter_=b,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const D=new V_($_(f,g),x,f,g);let W;for(let z=0,it=S.length;z<it;++z)n.loadFeatures(S[z],f,c);const j=l0(f,g);let P=!0;const H=(z,it)=>{let Y;const st=z.getStyleFunction()||e.getStyleFunction();if(st&&(Y=st(z,f)),Y){const Q=this.renderFeature(z,j,Y,D,W,this.getLayer().getDeclutter(),it);P=P&&!Q}},et=W0(x),R=n.getFeaturesInExtent(et);y&&R.sort(y);for(let z=0,it=R.length;z<it;++z)H(R[z],z);this.renderedFeatures_=R,this.ready=P;const F=D.finish(),U=new X_(x,f,g,n.getOverlaps(),F,e.getRenderBuffer(),!!t.declutter);return this.renderedResolution_=f,this.renderedRevision_=d,this.renderedRenderOrder_=y,this.renderedExtent_=E,this.wrappedRenderedExtent_=x,this.renderedCenter_=b,this.renderedProjection_=c,this.renderedPixelRatio_=g,this.replayGroup_=U,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,n,r,s,a,o){if(!n)return!1;let l=!1;if(Array.isArray(n))for(let h=0,c=n.length;h<c;++h)l=vf(r,t,n[h],e,this.boundHandleStyleImageChange_,s,a,o)||l;else l=vf(r,t,n,e,this.boundHandleStyleImageChange_,s,a,o);return l}}class M3 extends yc{constructor(t){super(t)}createRenderer(){return new A3(this)}}const li=M3;class mm{constructor(t){this.rbush_=new h_(t),this.items_={}}insert(t,e){const n={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(n),this.items_[Qt(e)]=n}load(t,e){const n=new Array(e.length);for(let r=0,s=e.length;r<s;r++){const a=t[r],o=e[r],l={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],value:o};n[r]=l,this.items_[Qt(o)]=l}this.rbush_.load(n)}remove(t){const e=Qt(t),n=this.items_[e];return delete this.items_[e],this.rbush_.remove(n)!==null}update(t,e){const n=this.items_[Qt(e)],r=[n.minX,n.minY,n.maxX,n.maxY];to(r,t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map(function(e){return e.value})}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(r){return r.value})}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let n;for(let r=0,s=t.length;r<s;r++)if(n=e(t[r]),n)return n;return n}isEmpty(){return Qa(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return is(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}}class L1 extends Qn{constructor(t){super(),this.projection=ti(t.projection),this.attributions_=_m(t.attributions),this.attributionsCollapsible_=t.attributionsCollapsible!==void 0?t.attributionsCollapsible:!0,this.loading=!1,this.state_=t.state!==void 0?t.state:"ready",this.wrapX_=t.wrapX!==void 0?t.wrapX:!1,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise(function(n,r){e.viewResolver=n,e.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=_m(t),this.changed()}setState(t){this.state_=t,this.changed()}}function _m(i){return i?Array.isArray(i)?function(t){return i}:typeof i=="function"?i:function(t){return[i]}:null}const bn={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};let T3=!1;function P3(i,t,e,n,r,s,a){const o=new XMLHttpRequest;o.open("GET",typeof i=="function"?i(e,n,r):i,!0),t.getType()=="arraybuffer"&&(o.responseType="arraybuffer"),o.withCredentials=T3,o.onload=function(l){if(!o.status||o.status>=200&&o.status<300){const h=t.getType();let c;h=="json"?c=JSON.parse(o.responseText):h=="text"?c=o.responseText:h=="xml"?(c=o.responseXML,c||(c=new DOMParser().parseFromString(o.responseText,"application/xml"))):h=="arraybuffer"&&(c=o.response),c?s(t.readFeatures(c,{extent:e,featureProjection:r}),t.readProjection(c)):a()}else a()},o.onerror=a,o.send()}function vm(i,t){return function(e,n,r,s,a){const o=this;P3(i,t,e,n,r,function(l,h){o.addFeatures(l),s!==void 0&&s(l)},a||Sl)}}class na extends Nr{constructor(t,e,n){super(t),this.feature=e,this.features=n}}class mi extends L1{constructor(t){t=t||{},super({attributions:t.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:t.wrapX!==void 0?t.wrapX:!0}),this.on,this.once,this.un,this.loader_=Sl,this.format_=t.format,this.overlaps_=t.overlaps===void 0?!0:t.overlaps,this.url_=t.url,t.loader!==void 0?this.loader_=t.loader:this.url_!==void 0&&(Ce(this.format_,"`format` must be set when `url` is set"),this.loader_=vm(this.url_,this.format_)),this.strategy_=t.strategy!==void 0?t.strategy:$w;const e=t.useSpatialIndex!==void 0?t.useSpatialIndex:!0;this.featuresRtree_=e?new mm:null,this.loadedExtentsRtree_=new mm,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let n,r;Array.isArray(t.features)?r=t.features:t.features&&(n=t.features,r=n.getArray()),!e&&n===void 0&&(n=new Tr(r)),r!==void 0&&this.addFeaturesInternal(r),n!==void 0&&this.bindFeaturesCollection_(n)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=Qt(t);if(!this.addToIndex_(e,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(e,t);const n=t.getGeometry();if(n){const r=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new na(bn.ADDFEATURE,t))}setupChangeEvents_(t,e){e instanceof Nn||(this.featureChangeKeys_[t]=[_e(e,le.CHANGE,this.handleFeatureChange_,this),_e(e,El.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(t,e){let n=!0;if(e.getId()!==void 0){const r=String(e.getId());if(!(r in this.idIndex_))this.idIndex_[r]=e;else if(e instanceof Nn){const s=this.idIndex_[r];s instanceof Nn?Array.isArray(s)?s.push(e):this.idIndex_[r]=[s,e]:n=!1}else n=!1}return n&&(Ce(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),n}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],n=[],r=[];for(let s=0,a=t.length;s<a;s++){const o=t[s],l=Qt(o);this.addToIndex_(l,o)&&n.push(o)}for(let s=0,a=n.length;s<a;s++){const o=n[s],l=Qt(o);this.setupChangeEvents_(l,o);const h=o.getGeometry();if(h){const c=h.getExtent();e.push(c),r.push(o)}else this.nullGeometryFeatures_[l]=o}if(this.featuresRtree_&&this.featuresRtree_.load(e,r),this.hasListener(bn.ADDFEATURE))for(let s=0,a=n.length;s<a;s++)this.dispatchEvent(new na(bn.ADDFEATURE,n[s]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(bn.ADDFEATURE,function(n){e||(e=!0,t.push(n.feature),e=!1)}),this.addEventListener(bn.REMOVEFEATURE,function(n){e||(e=!0,t.remove(n.feature),e=!1)}),t.addEventListener(Yi.ADD,n=>{e||(e=!0,this.addFeature(n.element),e=!1)}),t.addEventListener(Yi.REMOVE,n=>{e||(e=!0,this.removeFeature(n.element),e=!1)}),this.featuresCollection_=t}clear(t){if(t){for(const n in this.featureChangeKeys_)this.featureChangeKeys_[n].forEach(Ke);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){const n=r=>{this.removeFeatureInternal(r)};this.featuresRtree_.forEach(n);for(const r in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new na(bn.CLEAR);this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const n=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(n,function(r){const s=r.getGeometry();if(s instanceof Nn||s.intersectsCoordinate(t))return e(r)})}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,function(n){const r=n.getGeometry();if(r instanceof Nn||r.intersectsExtent(t)){const s=e(n);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),Qa(this.nullGeometryFeatures_)||$n(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,function(n){e.push(n)}),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const r=I5(t,e);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const n=t[0],r=t[1];let s=null;const a=[NaN,NaN];let o=1/0;const l=[-1/0,-1/0,1/0,1/0];return e=e||_a,this.featuresRtree_.forEachInExtent(l,function(h){if(e(h)){const c=h.getGeometry(),f=o;if(o=c instanceof Nn?0:c.closestPointXY(n,r,a,o),o<f){s=h;const g=Math.sqrt(o);l[0]=n-g,l[1]=r-g,l[2]=n+g,l[3]=r+g}}}),s}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return e!==void 0?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return e!==void 0?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,n=Qt(e),r=e.getGeometry();if(!r)n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[n]=e);else{const a=r.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(a,e)):this.featuresRtree_&&this.featuresRtree_.update(a,e)}const s=e.getId();if(s!==void 0){const a=s.toString();this.idIndex_[a]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[a]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[n]=e;this.changed(),this.dispatchEvent(new na(bn.CHANGEFEATURE,e))}hasFeature(t){const e=t.getId();return e!==void 0?e in this.idIndex_:Qt(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&Qa(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(t,e,n){const r=this.loadedExtentsRtree_,s=this.strategy_(t,e,n);for(let a=0,o=s.length;a<o;++a){const l=s[a];r.forEachInExtent(l,function(c){return As(c.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new na(bn.FEATURESLOADSTART)),this.loader_.call(this,l,e,n,c=>{--this.loadingExtentsCount_,this.dispatchEvent(new na(bn.FEATURESLOADEND,void 0,c))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new na(bn.FEATURESLOADERROR))}),r.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_;let n;e.forEachInExtent(t,function(r){if(to(r.extent,t))return n=r,!0}),n&&e.remove(n)}removeFeature(t){if(!t)return;const e=Qt(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=Qt(t),n=this.featureChangeKeys_[e];if(!n)return;n.forEach(Ke),delete this.featureChangeKeys_[e];const r=t.getId();return r!==void 0&&delete this.idIndex_[r.toString()],delete this.uidIndex_[e],this.dispatchEvent(new na(bn.REMOVEFEATURE,t)),t}removeFromIdIndex_(t){let e=!1;for(const n in this.idIndex_){const r=this.idIndex_[n];if(t instanceof Nn&&Array.isArray(r)&&r.includes(t))r.splice(r.indexOf(t),1);else if(this.idIndex_[n]===t){delete this.idIndex_[n],e=!0;break}}return e}setLoader(t){this.loader_=t}setUrl(t){Ce(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(vm(t,this.format_))}}const Lu={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"};class Cu extends Nr{constructor(t,e){super(t),this.feature=e}}function I3(i,t){const e=[];for(let n=0;n<t.length;++n){const s=t[n].getGeometry();Q_(i,s,e)}return e}function Au(i,t){return Ms(i[0],i[1],t[0],t[1])}function nl(i,t){const e=i.length;return t<0?i[t+e]:t>=e?i[t-e]:i[t]}function Mu(i,t,e){let n,r;t<e?(n=t,r=e):(n=e,r=t);const s=Math.ceil(n),a=Math.floor(r);if(s>a){const l=rl(i,n),h=rl(i,r);return Au(l,h)}let o=0;if(n<s){const l=rl(i,n),h=nl(i,s);o+=Au(l,h)}if(a<r){const l=nl(i,a),h=rl(i,r);o+=Au(l,h)}for(let l=s;l<a-1;++l){const h=nl(i,l),c=nl(i,l+1);o+=Au(h,c)}return o}function Q_(i,t,e){if(t instanceof pa){Tu(i,t.getCoordinates(),!1,e);return}if(t instanceof m1){const n=t.getCoordinates();for(let r=0,s=n.length;r<s;++r)Tu(i,n[r],!1,e);return}if(t instanceof cr){const n=t.getCoordinates();for(let r=0,s=n.length;r<s;++r)Tu(i,n[r],!0,e);return}if(t instanceof v1){const n=t.getCoordinates();for(let r=0,s=n.length;r<s;++r){const a=n[r];for(let o=0,l=a.length;o<l;++o)Tu(i,a[o],!0,e)}return}if(t instanceof G_){const n=t.getGeometries();for(let r=0;r<n.length;++r)Q_(i,n[r],e);return}}const pg={index:-1,endIndex:NaN};function R3(i,t,e,n){const r=i[0],s=i[1];let a=1/0,o=-1,l=NaN;for(let f=0;f<t.targets.length;++f){const g=t.targets[f],d=g.coordinates;let m=1/0,y;for(let b=0;b<d.length-1;++b){const x=d[b],E=d[b+1],S=tv(r,s,x,E);S.squaredDistance<m&&(m=S.squaredDistance,y=b+S.along)}m<a&&(a=m,g.ring&&t.targetIndex===f&&(g.endIndex>g.startIndex?y<g.startIndex&&(y+=d.length):g.endIndex<g.startIndex&&y>g.startIndex&&(y-=d.length)),l=y,o=f)}const h=t.targets[o];let c=h.ring;if(t.targetIndex===o&&c){const f=rl(h.coordinates,l),g=e.getPixelFromCoordinate(f);B2(g,t.startPx)>n&&(c=!1)}if(c){const f=h.coordinates,g=f.length,d=h.startIndex,m=l;if(d<m){const y=Mu(f,d,m);Mu(f,d,m-g)<y&&(l-=g)}else{const y=Mu(f,d,m);Mu(f,d,m+g)<y&&(l+=g)}}return pg.index=o,pg.endIndex=l,pg}function Tu(i,t,e,n){const r=i[0],s=i[1];for(let a=0,o=t.length-1;a<o;++a){const l=t[a],h=t[a+1],c=tv(r,s,l,h);if(c.squaredDistance===0){const f=a+c.along;n.push({coordinates:t,ring:e,startIndex:f,endIndex:f});return}}}const mg={along:0,squaredDistance:0};function tv(i,t,e,n){const r=e[0],s=e[1],a=n[0],o=n[1],l=a-r,h=o-s;let c=0,f=r,g=s;return(l!==0||h!==0)&&(c=hi(((i-r)*l+(t-s)*h)/(l*l+h*h),0,1),f+=l*c,g+=h*c),mg.along=c,mg.squaredDistance=fc(Ms(i,t,f,g),10),mg}function rl(i,t){const e=i.length;let n=Math.floor(t);const r=t-n;n>=e?n-=e:n<0&&(n+=e);let s=n+1;s>=e&&(s-=e);const a=i[n],o=a[0],l=a[1],h=i[s],c=h[0]-o,f=h[1]-l;return[o+c*r,l+f*r]}class N3 extends oo{constructor(t){const e=t;e.stopDown||(e.stopDown=Nl),super(e),this.on,this.once,this.un,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=t.source?t.source:null,this.features_=t.features?t.features:null,this.snapTolerance_=t.snapTolerance?t.snapTolerance:12,this.type_=t.type,this.mode_=O3(this.type_),this.stopClick_=!!t.stopClick,this.minPoints_=t.minPoints?t.minPoints:this.mode_==="Polygon"?3:2,this.maxPoints_=this.mode_==="Circle"?2:t.maxPoints?t.maxPoints:1/0,this.finishCondition_=t.finishCondition?t.finishCondition:_a,this.geometryLayout_=t.geometryLayout?t.geometryLayout:"XY";let n=t.geometryFunction;if(!n){const r=this.mode_;if(r==="Circle")n=function(s,a,o){const l=a||new Jf([NaN,NaN]),h=Mr(s[0]),c=j2(h,Mr(s[s.length-1]));return l.setCenterAndRadius(h,Math.sqrt(c),this.geometryLayout_),l};else{let s;r==="Point"?s=Ir:r==="LineString"?s=pa:r==="Polygon"&&(s=cr),n=function(a,o,l){return o?r==="Polygon"?a[0].length?o.setCoordinates([a[0].concat([a[0][0]])],this.geometryLayout_):o.setCoordinates([],this.geometryLayout_):o.setCoordinates(a,this.geometryLayout_):o=new s(a,this.geometryLayout_),o}}}this.geometryFunction_=n,this.dragVertexDelay_=t.dragVertexDelay!==void 0?t.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,this.overlay_=new li({source:new mi({useSpatialIndex:!1,wrapX:t.wrapX?t.wrapX:!1}),style:t.style?t.style:F3(),updateWhileInteracting:!0}),this.geometryName_=t.geometryName,this.condition_=t.condition?t.condition:g1,this.freehandCondition_,t.freehand?this.freehandCondition_=r0:this.freehandCondition_=t.freehandCondition?t.freehandCondition:$f,this.traceCondition_,this.setTrace(t.trace||!1),this.traceState_={active:!1},this.traceSource_=t.traceSource||t.source||null,this.addChangeListener(i0.ACTIVE,this.updateState_)}setTrace(t){let e;t?t===!0?e=r0:e=t:e=s0,this.traceCondition_=e}setMap(t){super.setMap(t),this.updateState_()}getOverlay(){return this.overlay_}handleEvent(t){t.originalEvent.type===le.CONTEXTMENU&&t.originalEvent.preventDefault(),this.freehand_=this.mode_!=="Point"&&this.freehandCondition_(t);let e=t.type===ke.POINTERMOVE,n=!0;return!this.freehand_&&this.lastDragTime_&&t.type===ke.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=t.pixel,this.shouldHandle_=!this.freehand_,e=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_!==void 0&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&t.type===ke.POINTERDRAG&&this.sketchFeature_!==null?(this.addToDrawing_(t.coordinate),n=!1):this.freehand_&&t.type===ke.POINTERDOWN?n=!1:e&&this.getPointerCount()<2?(n=t.type===ke.POINTERMOVE,n&&this.freehand_?(this.handlePointerMove_(t),this.shouldHandle_&&t.originalEvent.preventDefault()):(t.originalEvent.pointerType==="mouse"||t.type===ke.POINTERDRAG&&this.downTimeout_===void 0)&&this.handlePointerMove_(t)):t.type===ke.DBLCLICK&&(n=!1),super.handleEvent(t)&&n}handleDownEvent(t){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t.coordinate),!0):this.condition_(t)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new ws(ke.POINTERMOVE,t.map,t.originalEvent,!1,t.frameState))},this.dragVertexDelay_),this.downPx_=t.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(t){if(!this.traceSource_||!this.traceCondition_(t))return;if(this.traceState_.active){this.deactivateTrace_();return}const e=this.getMap(),n=e.getCoordinateFromPixel([t.pixel[0]-this.snapTolerance_,t.pixel[1]+this.snapTolerance_]),r=e.getCoordinateFromPixel([t.pixel[0]+this.snapTolerance_,t.pixel[1]-this.snapTolerance_]),s=Qu([n,r]),a=this.traceSource_.getFeaturesInExtent(s);if(a.length===0)return;const o=I3(t.coordinate,a);o.length&&(this.traceState_={active:!0,startPx:t.pixel.slice(),targets:o,targetIndex:-1})}addOrRemoveTracedCoordinates_(t,e){const n=t.startIndex<=t.endIndex,r=t.startIndex<=e;n===r?n&&e>t.endIndex||!n&&e<t.endIndex?this.addTracedCoordinates_(t,t.endIndex,e):(n&&e<t.endIndex||!n&&e>t.endIndex)&&this.removeTracedCoordinates_(e,t.endIndex):(this.removeTracedCoordinates_(t.startIndex,t.endIndex),this.addTracedCoordinates_(t,t.startIndex,e))}removeTracedCoordinates_(t,e){if(t===e)return;let n=0;if(t<e){const r=Math.ceil(t);let s=Math.floor(e);s===e&&(s-=1),n=s-r+1}else{const r=Math.floor(t);let s=Math.ceil(e);s===e&&(s+=1),n=r-s+1}n>0&&this.removeLastPoints_(n)}addTracedCoordinates_(t,e,n){if(e===n)return;const r=[];if(e<n){const s=Math.ceil(e);let a=Math.floor(n);a===n&&(a-=1);for(let o=s;o<=a;++o)r.push(nl(t.coordinates,o))}else{const s=Math.floor(e);let a=Math.ceil(n);a===n&&(a+=1);for(let o=s;o>=a;--o)r.push(nl(t.coordinates,o))}r.length&&this.appendCoordinates(r)}updateTrace_(t){const e=this.traceState_;if(!e.active||e.targetIndex===-1&&B2(e.startPx,t.pixel)<this.snapTolerance_)return;const n=R3(t.coordinate,e,this.getMap(),this.snapTolerance_);if(e.targetIndex!==n.index){if(e.targetIndex!==-1){const l=e.targets[e.targetIndex];this.removeTracedCoordinates_(l.startIndex,l.endIndex)}const o=e.targets[n.index];this.addTracedCoordinates_(o,o.startIndex,n.endIndex)}else{const o=e.targets[e.targetIndex];this.addOrRemoveTracedCoordinates_(o,n.endIndex)}e.targetIndex=n.index;const r=e.targets[e.targetIndex];r.endIndex=n.endIndex;const s=rl(r.coordinates,r.endIndex),a=this.getMap().getPixelFromCoordinate(s);t.coordinate=s,t.pixel=[Math.round(a[0]),Math.round(a[1])]}handleUpEvent(t){let e=!0;if(this.getPointerCount()===0){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t);const n=this.traceState_.active;if(this.toggleTraceState_(t),this.shouldHandle_){const r=!this.finishCoordinate_;r&&this.startDrawing_(t.coordinate),!r&&this.freehand_?this.finishDrawing():!this.freehand_&&(!r||this.mode_==="Point")&&(this.atFinish_(t.pixel,n)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t.coordinate)),e=!1}else this.freehand_&&this.abortDrawing()}return!e&&this.stopClick_&&t.preventDefault(),e}handlePointerMove_(t){if(this.pointerType_=t.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const e=this.downPx_,n=t.pixel,r=e[0]-n[0],s=e[1]-n[1],a=r*r+s*s;if(this.shouldHandle_=this.freehand_?a>this.squaredClickTolerance_:a<=this.squaredClickTolerance_,!this.shouldHandle_)return}if(!this.finishCoordinate_){this.createOrUpdateSketchPoint_(t.coordinate.slice());return}this.updateTrace_(t),this.modifyDrawing_(t.coordinate)}atFinish_(t,e){let n=!1;if(this.sketchFeature_){let r=!1,s=[this.finishCoordinate_];const a=this.mode_;if(a==="Point")n=!0;else if(a==="Circle")n=this.sketchCoords_.length===2;else if(a==="LineString")r=!e&&this.sketchCoords_.length>this.minPoints_;else if(a==="Polygon"){const o=this.sketchCoords_;r=o[0].length>this.minPoints_,s=[o[0][0],o[0][o[0].length-2]],e?s=[o[0][0]]:s=[o[0][0],o[0][o[0].length-2]]}if(r){const o=this.getMap();for(let l=0,h=s.length;l<h;l++){const c=s[l],f=o.getPixelFromCoordinate(c),g=t[0]-f[0],d=t[1]-f[1],m=this.freehand_?1:this.snapTolerance_;if(n=Math.sqrt(g*g+d*d)<=m,n){this.finishCoordinate_=c;break}}}}return n}createOrUpdateSketchPoint_(t){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(t):(this.sketchPoint_=new lr(new Ir(t)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(t){this.sketchLine_||(this.sketchLine_=new lr);const e=t.getLinearRing(0);let n=this.sketchLine_.getGeometry();n?(n.setFlatCoordinates(e.getLayout(),e.getFlatCoordinates()),n.changed()):(n=new pa(e.getFlatCoordinates(),e.getLayout()),this.sketchLine_.setGeometry(n))}startDrawing_(t){const e=this.getMap().getView().getProjection(),n=ef(this.geometryLayout_);for(;t.length<n;)t.push(0);this.finishCoordinate_=t,this.mode_==="Point"?this.sketchCoords_=t.slice():this.mode_==="Polygon"?(this.sketchCoords_=[[t.slice(),t.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[t.slice(),t.slice()],this.sketchLineCoords_&&(this.sketchLine_=new lr(new pa(this.sketchLineCoords_)));const r=this.geometryFunction_(this.sketchCoords_,void 0,e);this.sketchFeature_=new lr,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(r),this.updateSketchFeatures_(),this.dispatchEvent(new Cu(Lu.DRAWSTART,this.sketchFeature_))}modifyDrawing_(t){const e=this.getMap(),n=this.sketchFeature_.getGeometry(),r=e.getView().getProjection(),s=ef(this.geometryLayout_);let a,o;for(;t.length<s;)t.push(0);this.mode_==="Point"?o=this.sketchCoords_:this.mode_==="Polygon"?(a=this.sketchCoords_[0],o=a[a.length-1],this.atFinish_(e.getPixelFromCoordinate(t))&&(t=this.finishCoordinate_.slice())):(a=this.sketchCoords_,o=a[a.length-1]),o[0]=t[0],o[1]=t[1],this.geometryFunction_(this.sketchCoords_,n,r),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(t),n.getType()==="Polygon"&&this.mode_!=="Polygon"?this.createOrUpdateCustomSketchLine_(n):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(t){const e=this.sketchFeature_.getGeometry(),n=this.getMap().getView().getProjection();let r,s;const a=this.mode_;return a==="LineString"||a==="Circle"?(this.finishCoordinate_=t.slice(),s=this.sketchCoords_,s.length>=this.maxPoints_&&(this.freehand_?s.pop():r=!0),s.push(t.slice()),this.geometryFunction_(s,e,n)):a==="Polygon"&&(s=this.sketchCoords_[0],s.length>=this.maxPoints_&&(this.freehand_?s.pop():r=!0),s.push(t.slice()),r&&(this.finishCoordinate_=s[0]),this.geometryFunction_(this.sketchCoords_,e,n)),this.createOrUpdateSketchPoint_(t.slice()),this.updateSketchFeatures_(),r?this.finishDrawing():this.sketchFeature_}removeLastPoints_(t){if(!this.sketchFeature_)return;const e=this.sketchFeature_.getGeometry(),n=this.getMap().getView().getProjection(),r=this.mode_;for(let s=0;s<t;++s){let a;if(r==="LineString"||r==="Circle"){if(a=this.sketchCoords_,a.splice(-2,1),a.length>=2){this.finishCoordinate_=a[a.length-2].slice();const o=this.finishCoordinate_.slice();a[a.length-1]=o,this.createOrUpdateSketchPoint_(o)}this.geometryFunction_(a,e,n),e.getType()==="Polygon"&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(e)}else if(r==="Polygon"){a=this.sketchCoords_[0],a.splice(-2,1);const o=this.sketchLine_.getGeometry();if(a.length>=2){const l=a[a.length-2].slice();a[a.length-1]=l,this.createOrUpdateSketchPoint_(l)}o.setCoordinates(a),this.geometryFunction_(this.sketchCoords_,e,n)}if(a.length===1){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const t=this.abortDrawing_();if(!t)return null;let e=this.sketchCoords_;const n=t.getGeometry(),r=this.getMap().getView().getProjection();return this.mode_==="LineString"?(e.pop(),this.geometryFunction_(e,n,r)):this.mode_==="Polygon"&&(e[0].pop(),this.geometryFunction_(e,n,r),e=n.getCoordinates()),this.type_==="MultiPoint"?t.setGeometry(new Qf([e])):this.type_==="MultiLineString"?t.setGeometry(new m1([e])):this.type_==="MultiPolygon"&&t.setGeometry(new v1([e])),this.dispatchEvent(new Cu(Lu.DRAWEND,t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t),t}abortDrawing_(){this.finishCoordinate_=null;const t=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),t}abortDrawing(){const t=this.abortDrawing_();t&&this.dispatchEvent(new Cu(Lu.DRAWABORT,t))}appendCoordinates(t){const e=this.mode_,n=!this.sketchFeature_;n&&this.startDrawing_(t[0]);let r;if(e==="LineString"||e==="Circle")r=this.sketchCoords_;else if(e==="Polygon")r=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[];else return;n&&r.shift(),r.pop();for(let a=0;a<t.length;a++)this.addToDrawing_(t[a]);const s=t[t.length-1];this.sketchFeature_=this.addToDrawing_(s),this.modifyDrawing_(s)}extend(t){const n=t.getGeometry();this.sketchFeature_=t,this.sketchCoords_=n.getCoordinates();const r=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=r.slice(),this.sketchCoords_.push(r.slice()),this.sketchPoint_=new lr(new Ir(r)),this.updateSketchFeatures_(),this.dispatchEvent(new Cu(Lu.DRAWSTART,this.sketchFeature_))}updateSketchFeatures_(){const t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);const e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)}updateState_(){const t=this.getMap(),e=this.getActive();(!t||!e)&&this.abortDrawing(),this.overlay_.setMap(e?t:null)}}function F3(){const i=w_();return function(t,e){return i[t.getGeometry().getType()]}}function O3(i){switch(i){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+i)}}const k3="modulepreload",D3=function(i){return"/"+i},ym={},h0=function(t,e,n){let r=Promise.resolve();if(e&&e.length>0){const s=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));r=Promise.all(e.map(l=>{if(l=D3(l),l in ym)return;ym[l]=!0;const h=l.endsWith(".css"),c=h?'[rel="stylesheet"]':"";if(!!n)for(let d=s.length-1;d>=0;d--){const m=s[d];if(m.href===l&&(!h||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${c}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":k3,h||(g.as="script",g.crossOrigin=""),g.href=l,o&&g.setAttribute("nonce",o),document.head.appendChild(g),h)return new Promise((d,m)=>{g.addEventListener("load",d),g.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}return r.then(()=>t()).catch(s=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s})};function Xe(i){"@babel/helpers - typeof";return Xe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xe(i)}var En=Uint8Array,Sn=Uint16Array,ec=Uint32Array,td=new En([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ed=new En([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),c0=new En([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ev=function(i,t){for(var e=new Sn(31),n=0;n<31;++n)e[n]=t+=1<<i[n-1];for(var r=new ec(e[30]),n=1;n<30;++n)for(var s=e[n];s<e[n+1];++s)r[s]=s-e[n]<<5|n;return[e,r]},iv=ev(td,2),nv=iv[0],u0=iv[1];nv[28]=258,u0[258]=28;var rv=ev(ed,0),j3=rv[0],xm=rv[1],f0=new Sn(32768);for(var oi=0;oi<32768;++oi){var ra=(oi&43690)>>>1|(oi&21845)<<1;ra=(ra&52428)>>>2|(ra&13107)<<2,ra=(ra&61680)>>>4|(ra&3855)<<4,f0[oi]=((ra&65280)>>>8|(ra&255)<<8)>>>1}var ts=function(i,t,e){for(var n=i.length,r=0,s=new Sn(t);r<n;++r)++s[i[r]-1];var a=new Sn(t);for(r=0;r<t;++r)a[r]=a[r-1]+s[r-1]<<1;var o;if(e){o=new Sn(1<<t);var l=15-t;for(r=0;r<n;++r)if(i[r])for(var h=r<<4|i[r],c=t-i[r],f=a[i[r]-1]++<<c,g=f|(1<<c)-1;f<=g;++f)o[f0[f]>>>l]=h}else for(o=new Sn(n),r=0;r<n;++r)o[r]=f0[a[i[r]-1]++]>>>15-i[r];return o},Ea=new En(288);for(var oi=0;oi<144;++oi)Ea[oi]=8;for(var oi=144;oi<256;++oi)Ea[oi]=9;for(var oi=256;oi<280;++oi)Ea[oi]=7;for(var oi=280;oi<288;++oi)Ea[oi]=8;var ic=new En(32);for(var oi=0;oi<32;++oi)ic[oi]=5;var B3=ts(Ea,9,0),G3=ts(Ea,9,1),z3=ts(ic,5,0),q3=ts(ic,5,1),_g=function(i){for(var t=i[0],e=1;e<i.length;++e)i[e]>t&&(t=i[e]);return t},Lr=function(i,t,e){var n=t/8>>0;return(i[n]|i[n+1]<<8)>>>(t&7)&e},vg=function(i,t){var e=t/8>>0;return(i[e]|i[e+1]<<8|i[e+2]<<16)>>>(t&7)},C1=function(i){return(i/8>>0)+(i&7&&1)},sv=function(i,t,e){(t==null||t<0)&&(t=0),(e==null||e>i.length)&&(e=i.length);var n=new(i instanceof Sn?Sn:i instanceof ec?ec:En)(e-t);return n.set(i.subarray(t,e)),n},U3=function(i,t,e){var n=i.length,r=!t||e,s=!e||e.i;e||(e={}),t||(t=new En(n*3));var a=function(nt){var at=t.length;if(nt>at){var ht=new En(Math.max(at*2,nt));ht.set(t),t=ht}},o=e.f||0,l=e.p||0,h=e.b||0,c=e.l,f=e.d,g=e.m,d=e.n,m=n*8;do{if(!c){e.f=o=Lr(i,l,1);var y=Lr(i,l+1,3);if(l+=3,y)if(y==1)c=G3,f=q3,g=9,d=5;else if(y==2){var S=Lr(i,l,31)+257,M=Lr(i,l+10,15)+4,D=S+Lr(i,l+5,31)+1;l+=14;for(var W=new En(D),j=new En(19),P=0;P<M;++P)j[c0[P]]=Lr(i,l+P*3,7);l+=M*3;var H=_g(j),et=(1<<H)-1;if(!s&&l+D*(H+7)>m)break;for(var R=ts(j,H,1),P=0;P<D;){var F=R[Lr(i,l,et)];l+=F&15;var b=F>>>4;if(b<16)W[P++]=b;else{var U=0,z=0;for(b==16?(z=3+Lr(i,l,3),l+=2,U=W[P-1]):b==17?(z=3+Lr(i,l,7),l+=3):b==18&&(z=11+Lr(i,l,127),l+=7);z--;)W[P++]=U}}var it=W.subarray(0,S),Y=W.subarray(S);g=_g(it),d=_g(Y),c=ts(it,g,1),f=ts(Y,d,1)}else throw"invalid block type";else{var b=C1(l)+4,x=i[b-4]|i[b-3]<<8,E=b+x;if(E>n){if(s)throw"unexpected EOF";break}r&&a(h+x),t.set(i.subarray(b,E),h),e.b=h+=x,e.p=l=E*8;continue}if(l>m)throw"unexpected EOF"}r&&a(h+131072);for(var st=(1<<g)-1,Q=(1<<d)-1,gt=g+d+18;s||l+gt<m;){var U=c[vg(i,l)&st],lt=U>>>4;if(l+=U&15,l>m)throw"unexpected EOF";if(!U)throw"invalid length/literal";if(lt<256)t[h++]=lt;else if(lt==256){c=null;break}else{var Et=lt-254;if(lt>264){var P=lt-257,A=td[P];Et=Lr(i,l,(1<<A)-1)+nv[P],l+=A}var G=f[vg(i,l)&Q],O=G>>>4;if(!G)throw"invalid distance";l+=G&15;var Y=j3[O];if(O>3){var A=ed[O];Y+=vg(i,l)&(1<<A)-1,l+=A}if(l>m)throw"unexpected EOF";r&&a(h+131072);for(var X=h+Et;h<X;h+=4)t[h]=t[h-Y],t[h+1]=t[h+1-Y],t[h+2]=t[h+2-Y],t[h+3]=t[h+3-Y];h=X}}e.l=c,e.p=l,e.b=h,c&&(o=1,e.m=g,e.d=f,e.n=d)}while(!o);return h==t.length?t:sv(t,0,h)},ys=function(i,t,e){e<<=t&7;var n=t/8>>0;i[n]|=e,i[n+1]|=e>>>8},wh=function(i,t,e){e<<=t&7;var n=t/8>>0;i[n]|=e,i[n+1]|=e>>>8,i[n+2]|=e>>>16},yg=function(i,t){for(var e=[],n=0;n<i.length;++n)i[n]&&e.push({s:n,f:i[n]});var r=e.length,s=e.slice();if(!r)return[new En(0),0];if(r==1){var a=new En(e[0].s+1);return a[e[0].s]=1,[a,1]}e.sort(function(D,W){return D.f-W.f}),e.push({s:-1,f:25001});var o=e[0],l=e[1],h=0,c=1,f=2;for(e[0]={s:-1,f:o.f+l.f,l:o,r:l};c!=r-1;)o=e[e[h].f<e[f].f?h++:f++],l=e[h!=c&&e[h].f<e[f].f?h++:f++],e[c++]={s:-1,f:o.f+l.f,l:o,r:l};for(var g=s[0].s,n=1;n<r;++n)s[n].s>g&&(g=s[n].s);var d=new Sn(g+1),m=d0(e[c-1],d,0);if(m>t){var n=0,y=0,b=m-t,x=1<<b;for(s.sort(function(W,j){return d[j.s]-d[W.s]||W.f-j.f});n<r;++n){var E=s[n].s;if(d[E]>t)y+=x-(1<<m-d[E]),d[E]=t;else break}for(y>>>=b;y>0;){var S=s[n].s;d[S]<t?y-=1<<t-d[S]++-1:++n}for(;n>=0&&y;--n){var M=s[n].s;d[M]==t&&(--d[M],++y)}m=t}return[new En(d),m]},d0=function(i,t,e){return i.s==-1?Math.max(d0(i.l,t,e+1),d0(i.r,t,e+1)):t[i.s]=e},bm=function(i){for(var t=i.length;t&&!i[--t];);for(var e=new Sn(++t),n=0,r=i[0],s=1,a=function(l){e[n++]=l},o=1;o<=t;++o)if(i[o]==r&&o!=t)++s;else{if(!r&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(r),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(r);s=1,r=i[o]}return[e.subarray(0,n),t]},Eh=function(i,t){for(var e=0,n=0;n<t.length;++n)e+=i[n]*t[n];return e},Uu=function(i,t,e){var n=e.length,r=C1(t+2);i[r]=n&255,i[r+1]=n>>>8,i[r+2]=i[r]^255,i[r+3]=i[r+1]^255;for(var s=0;s<n;++s)i[r+s+4]=e[s];return(r+4+n)*8},wm=function(i,t,e,n,r,s,a,o,l,h,c){ys(t,c++,e),++r[256];for(var f=yg(r,15),g=f[0],d=f[1],m=yg(s,15),y=m[0],b=m[1],x=bm(g),E=x[0],S=x[1],M=bm(y),D=M[0],W=M[1],j=new Sn(19),P=0;P<E.length;++P)j[E[P]&31]++;for(var P=0;P<D.length;++P)j[D[P]&31]++;for(var H=yg(j,7),et=H[0],R=H[1],F=19;F>4&&!et[c0[F-1]];--F);var U=h+5<<3,z=Eh(r,Ea)+Eh(s,ic)+a,it=Eh(r,g)+Eh(s,y)+a+14+3*F+Eh(j,et)+(2*j[16]+3*j[17]+7*j[18]);if(U<=z&&U<=it)return Uu(t,c,i.subarray(l,l+h));var Y,st,Q,gt;if(ys(t,c,1+(it<z)),c+=2,it<z){Y=ts(g,d,0),st=g,Q=ts(y,b,0),gt=y;var lt=ts(et,R,0);ys(t,c,S-257),ys(t,c+5,W-1),ys(t,c+10,F-4),c+=14;for(var P=0;P<F;++P)ys(t,c+3*P,et[c0[P]]);c+=3*F;for(var Et=[E,D],A=0;A<2;++A)for(var G=Et[A],P=0;P<G.length;++P){var O=G[P]&31;ys(t,c,lt[O]),c+=et[O],O>15&&(ys(t,c,G[P]>>>5&127),c+=G[P]>>>12)}}else Y=B3,st=Ea,Q=z3,gt=ic;for(var P=0;P<o;++P)if(n[P]>255){var O=n[P]>>>18&31;wh(t,c,Y[O+257]),c+=st[O+257],O>7&&(ys(t,c,n[P]>>>23&31),c+=td[O]);var X=n[P]&31;wh(t,c,Q[X]),c+=gt[X],X>3&&(wh(t,c,n[P]>>>5&8191),c+=ed[X])}else wh(t,c,Y[n[P]]),c+=st[n[P]];return wh(t,c,Y[256]),c+st[256]},W3=new ec([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),V3=new En(0),H3=function(i,t,e,n,r,s){var a=i.length,o=new En(n+a+5*(1+Math.floor(a/7e3))+r),l=o.subarray(n,o.length-r),h=0;if(!t||a<8)for(var c=0;c<=a;c+=65535){var f=c+65535;f<a?h=Uu(l,h,i.subarray(c,f)):(l[c]=s,h=Uu(l,h,i.subarray(c,a)))}else{for(var g=W3[t-1],d=g>>>13,m=g&8191,y=(1<<e)-1,b=new Sn(32768),x=new Sn(y+1),E=Math.ceil(e/3),S=2*E,M=function($t){return(i[$t]^i[$t+1]<<E^i[$t+2]<<S)&y},D=new ec(25e3),W=new Sn(288),j=new Sn(32),P=0,H=0,c=0,et=0,R=0,F=0;c<a;++c){var U=M(c),z=c&32767,it=x[U];if(b[z]=it,x[U]=z,R<=c){var Y=a-c;if((P>7e3||et>24576)&&Y>423){h=wm(i,l,0,D,W,j,H,et,F,c-F,h),et=P=H=0,F=c;for(var st=0;st<286;++st)W[st]=0;for(var st=0;st<30;++st)j[st]=0}var Q=2,gt=0,lt=m,Et=z-it&32767;if(Y>2&&U==M(c-Et))for(var A=Math.min(d,Y)-1,G=Math.min(32767,c),O=Math.min(258,Y);Et<=G&&--lt&&z!=it;){if(i[c+Q]==i[c+Q-Et]){for(var X=0;X<O&&i[c+X]==i[c+X-Et];++X);if(X>Q){if(Q=X,gt=Et,X>A)break;for(var nt=Math.min(Et,X-2),at=0,st=0;st<nt;++st){var ht=c-Et+st+32768&32767,dt=b[ht],St=ht-dt+32768&32767;St>at&&(at=St,it=ht)}}}z=it,it=b[z],Et+=z-it+32768&32767}if(gt){D[et++]=268435456|u0[Q]<<18|xm[gt];var At=u0[Q]&31,Rt=xm[gt]&31;H+=td[At]+ed[Rt],++W[257+At],++j[Rt],R=c+Q,++P}else D[et++]=i[c],++W[i[c]]}}h=wm(i,l,s,D,W,j,H,et,F,c-F,h),s||(h=Uu(l,h,V3))}return sv(o,0,n+C1(h)+r)},X3=function(){var i=1,t=0;return{p:function(e){for(var n=i,r=t,s=e.length,a=0;a!=s;){for(var o=Math.min(a+5552,s);a<o;++a)n+=e[a],r+=n;n%=65521,r%=65521}i=n,t=r},d:function(){return(i>>>8<<16|(t&255)<<8|t>>>8)+((i&255)<<23)*2}}},Y3=function(i,t,e,n,r){return H3(i,t.level==null?6:t.level,t.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(i.length)))*1.5):12+t.mem,e,n,!r)},Z3=function(i,t,e){for(;e;++t)i[t]=e,e>>>=8},K3=function(i,t){var e=t.level,n=e==0?0:e<6?1:e==9?3:2;i[0]=120,i[1]=n<<6|(n?32-2*n:1)},$3=function(i){if((i[0]&15)!=8||i[0]>>>4>7||(i[0]<<8|i[1])%31)throw"invalid zlib data";if(i[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function g0(i,t){t===void 0&&(t={});var e=X3();e.p(i);var n=Y3(i,t,2,4);return K3(n,t),Z3(n,n.length-4,e.d()),n}function J3(i,t){return U3(($3(i),i.subarray(2,-4)),t)}var se=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function xg(){se.console&&typeof se.console.log=="function"&&se.console.log.apply(se.console,arguments)}var Qe={log:xg,warn:function(i){se.console&&(typeof se.console.warn=="function"?se.console.warn.apply(se.console,arguments):xg.call(null,arguments))},error:function(i){se.console&&(typeof se.console.error=="function"?se.console.error.apply(se.console,arguments):xg(i))}};function bg(i,t,e){var n=new XMLHttpRequest;n.open("GET",i),n.responseType="blob",n.onload=function(){za(n.response,t,e)},n.onerror=function(){Qe.error("could not download file")},n.send()}function Em(i){var t=new XMLHttpRequest;t.open("HEAD",i,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function Pu(i){try{i.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),i.dispatchEvent(t)}}var Oh,p0,za=se.saveAs||((typeof window>"u"?"undefined":Xe(window))!=="object"||window!==se?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(i,t,e){var n=se.URL||se.webkitURL,r=document.createElement("a");t=t||i.name||"download",r.download=t,r.rel="noopener",typeof i=="string"?(r.href=i,r.origin!==location.origin?Em(r.href)?bg(i,t,e):Pu(r,r.target="_blank"):Pu(r)):(r.href=n.createObjectURL(i),setTimeout(function(){n.revokeObjectURL(r.href)},4e4),setTimeout(function(){Pu(r)},0))}:"msSaveOrOpenBlob"in navigator?function(i,t,e){if(t=t||i.name||"download",typeof i=="string")if(Em(i))bg(i,t,e);else{var n=document.createElement("a");n.href=i,n.target="_blank",setTimeout(function(){Pu(n)})}else navigator.msSaveOrOpenBlob(function(r,s){return s===void 0?s={autoBom:!1}:Xe(s)!=="object"&&(Qe.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\uFEFF",r],{type:r.type}):r}(i,e),t)}:function(i,t,e,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof i=="string")return bg(i,t,e);var r=i.type==="application/octet-stream",s=/constructor/i.test(se.HTMLElement)||se.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||r&&s)&&(typeof FileReader>"u"?"undefined":Xe(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var c=o.result;c=a?c:c.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=c:location=c,n=null},o.readAsDataURL(i)}else{var l=se.URL||se.webkitURL,h=l.createObjectURL(i);n?n.location=h:location.href=h,n=null,setTimeout(function(){l.revokeObjectURL(h)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function av(i){var t;i=i||"",this.ok=!1,i.charAt(0)=="#"&&(i=i.substr(1,6)),i={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[i=(i=i.replace(/ /g,"")).toLowerCase()]||i;for(var e=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<e.length;n++){var r=e[n].re,s=e[n].process,a=r.exec(i);a&&(t=s(a),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),h=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),h.length==1&&(h="0"+h),"#"+o+l+h}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function wg(i,t){var e=i[0],n=i[1],r=i[2],s=i[3];e=hn(e,n,r,s,t[0],7,-680876936),s=hn(s,e,n,r,t[1],12,-389564586),r=hn(r,s,e,n,t[2],17,606105819),n=hn(n,r,s,e,t[3],22,-1044525330),e=hn(e,n,r,s,t[4],7,-176418897),s=hn(s,e,n,r,t[5],12,1200080426),r=hn(r,s,e,n,t[6],17,-1473231341),n=hn(n,r,s,e,t[7],22,-45705983),e=hn(e,n,r,s,t[8],7,1770035416),s=hn(s,e,n,r,t[9],12,-1958414417),r=hn(r,s,e,n,t[10],17,-42063),n=hn(n,r,s,e,t[11],22,-1990404162),e=hn(e,n,r,s,t[12],7,1804603682),s=hn(s,e,n,r,t[13],12,-40341101),r=hn(r,s,e,n,t[14],17,-1502002290),e=cn(e,n=hn(n,r,s,e,t[15],22,1236535329),r,s,t[1],5,-165796510),s=cn(s,e,n,r,t[6],9,-1069501632),r=cn(r,s,e,n,t[11],14,643717713),n=cn(n,r,s,e,t[0],20,-373897302),e=cn(e,n,r,s,t[5],5,-701558691),s=cn(s,e,n,r,t[10],9,38016083),r=cn(r,s,e,n,t[15],14,-660478335),n=cn(n,r,s,e,t[4],20,-405537848),e=cn(e,n,r,s,t[9],5,568446438),s=cn(s,e,n,r,t[14],9,-1019803690),r=cn(r,s,e,n,t[3],14,-187363961),n=cn(n,r,s,e,t[8],20,1163531501),e=cn(e,n,r,s,t[13],5,-1444681467),s=cn(s,e,n,r,t[2],9,-51403784),r=cn(r,s,e,n,t[7],14,1735328473),e=un(e,n=cn(n,r,s,e,t[12],20,-1926607734),r,s,t[5],4,-378558),s=un(s,e,n,r,t[8],11,-2022574463),r=un(r,s,e,n,t[11],16,1839030562),n=un(n,r,s,e,t[14],23,-35309556),e=un(e,n,r,s,t[1],4,-1530992060),s=un(s,e,n,r,t[4],11,1272893353),r=un(r,s,e,n,t[7],16,-155497632),n=un(n,r,s,e,t[10],23,-1094730640),e=un(e,n,r,s,t[13],4,681279174),s=un(s,e,n,r,t[0],11,-358537222),r=un(r,s,e,n,t[3],16,-722521979),n=un(n,r,s,e,t[6],23,76029189),e=un(e,n,r,s,t[9],4,-640364487),s=un(s,e,n,r,t[12],11,-421815835),r=un(r,s,e,n,t[15],16,530742520),e=fn(e,n=un(n,r,s,e,t[2],23,-995338651),r,s,t[0],6,-198630844),s=fn(s,e,n,r,t[7],10,1126891415),r=fn(r,s,e,n,t[14],15,-1416354905),n=fn(n,r,s,e,t[5],21,-57434055),e=fn(e,n,r,s,t[12],6,1700485571),s=fn(s,e,n,r,t[3],10,-1894986606),r=fn(r,s,e,n,t[10],15,-1051523),n=fn(n,r,s,e,t[1],21,-2054922799),e=fn(e,n,r,s,t[8],6,1873313359),s=fn(s,e,n,r,t[15],10,-30611744),r=fn(r,s,e,n,t[6],15,-1560198380),n=fn(n,r,s,e,t[13],21,1309151649),e=fn(e,n,r,s,t[4],6,-145523070),s=fn(s,e,n,r,t[11],10,-1120210379),r=fn(r,s,e,n,t[2],15,718787259),n=fn(n,r,s,e,t[9],21,-343485551),i[0]=fa(e,i[0]),i[1]=fa(n,i[1]),i[2]=fa(r,i[2]),i[3]=fa(s,i[3])}function id(i,t,e,n,r,s){return t=fa(fa(t,i),fa(n,s)),fa(t<<r|t>>>32-r,e)}function hn(i,t,e,n,r,s,a){return id(t&e|~t&n,i,t,r,s,a)}function cn(i,t,e,n,r,s,a){return id(t&n|e&~n,i,t,r,s,a)}function un(i,t,e,n,r,s,a){return id(t^e^n,i,t,r,s,a)}function fn(i,t,e,n,r,s,a){return id(e^(t|~n),i,t,r,s,a)}function ov(i){var t,e=i.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=i.length;t+=64)wg(n,Q3(i.substring(t-64,t)));i=i.substring(t-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i.length;t++)r[t>>2]|=i.charCodeAt(t)<<(t%4<<3);if(r[t>>2]|=128<<(t%4<<3),t>55)for(wg(n,r),t=0;t<16;t++)r[t]=0;return r[14]=8*e,wg(n,r),n}function Q3(i){var t,e=[];for(t=0;t<64;t+=4)e[t>>2]=i.charCodeAt(t)+(i.charCodeAt(t+1)<<8)+(i.charCodeAt(t+2)<<16)+(i.charCodeAt(t+3)<<24);return e}Oh=se.atob.bind(se),p0=se.btoa.bind(se);var Sm="0123456789abcdef".split("");function tE(i){for(var t="",e=0;e<4;e++)t+=Sm[i>>8*e+4&15]+Sm[i>>8*e&15];return t}function eE(i){return String.fromCharCode((255&i)>>0,(65280&i)>>8,(16711680&i)>>16,(4278190080&i)>>24)}function m0(i){return ov(i).map(eE).join("")}var iE=function(i){for(var t=0;t<i.length;t++)i[t]=tE(i[t]);return i.join("")}(ov("hello"))!="5d41402abc4b2a76b9719d911017c592";function fa(i,t){if(iE){var e=(65535&i)+(65535&t);return(i>>16)+(t>>16)+(e>>16)<<16|65535&e}return i+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function _0(i,t){var e,n,r,s;if(i!==e){for(var a=(r=i,s=1+(256/i.length>>0),new Array(s+1).join(r)),o=[],l=0;l<256;l++)o[l]=l;var h=0;for(l=0;l<256;l++){var c=o[l];h=(h+c+a.charCodeAt(l))%256,o[l]=o[h],o[h]=c}e=i,n=o}else o=n;var f=t.length,g=0,d=0,m="";for(l=0;l<f;l++)d=(d+(c=o[g=(g+1)%256]))%256,o[g]=o[d],o[d]=c,a=o[(o[g]+o[d])%256],m+=String.fromCharCode(t.charCodeAt(l)^a);return m}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Lm={print:4,modify:8,copy:16,"annot-forms":32};function Qo(i,t,e,n){this.v=1,this.r=2;var r=192;i.forEach(function(o){if(Lm.perm!==void 0)throw new Error("Invalid permission: "+o);r+=Lm[o]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var s=(t+this.padding).substr(0,32),a=(e+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,a),this.P=-(1+(255^r)),this.encryptionKey=m0(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=_0(this.encryptionKey,this.padding)}function tl(i){if(/[^\u0000-\u00ff]/.test(i))throw new Error("Invalid PDF Name Object: "+i+", Only accept ASCII characters.");for(var t="",e=i.length,n=0;n<e;n++){var r=i.charCodeAt(n);r<33||r===35||r===37||r===40||r===41||r===47||r===60||r===62||r===91||r===93||r===123||r===125||r>126?t+="#"+("0"+r.toString(16)).slice(-2):t+=i[n]}return t}function Cm(i){if(Xe(i)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(e,n,r){if(r=r||!1,typeof e!="string"||typeof n!="function"||typeof r!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(e)||(t[e]={});var s=Math.random().toString(35);return t[e][s]=[n,!!r],s},this.unsubscribe=function(e){for(var n in t)if(t[n][e])return delete t[n][e],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(e){if(t.hasOwnProperty(e)){var n=Array.prototype.slice.call(arguments,1),r=[];for(var s in t[e]){var a=t[e][s];try{a[0].apply(i,n)}catch(o){se.console&&Qe.error("jsPDF PubSub Error",o.message,o)}a[1]&&r.push(s)}r.length&&r.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function yf(i){if(!(this instanceof yf))return new yf(i);var t="opacity,stroke-opacity".split(",");for(var e in i)i.hasOwnProperty(e)&&t.indexOf(e)>=0&&(this[e]=i[e]);this.id="",this.objectNumber=-1}function lv(i,t){this.gState=i,this.matrix=t,this.id="",this.objectNumber=-1}function Ua(i,t,e,n,r){if(!(this instanceof Ua))return new Ua(i,t,e,n,r);this.type=i==="axial"?2:3,this.coords=t,this.colors=e,lv.call(this,n,r)}function sl(i,t,e,n,r){if(!(this instanceof sl))return new sl(i,t,e,n,r);this.boundingBox=i,this.xStep=t,this.yStep=e,this.stream="",this.cloneIndex=0,lv.call(this,n,r)}function re(i){var t,e=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],r=arguments[2],s=arguments[3],a=[],o=1,l=16,h="S",c=null;Xe(i=i||{})==="object"&&(e=i.orientation,n=i.unit||n,r=i.format||r,s=i.compress||i.compressPdf||s,(c=i.encryption||null)!==null&&(c.userPassword=c.userPassword||"",c.ownerPassword=c.ownerPassword||"",c.userPermissions=c.userPermissions||[]),o=typeof i.userUnit=="number"?Math.abs(i.userUnit):1,i.precision!==void 0&&(t=i.precision),i.floatPrecision!==void 0&&(l=i.floatPrecision),h=i.defaultPathOperation||"S"),a=i.filters||(s===!0?["FlateEncode"]:a),n=n||"mm",e=(""+(e||"P")).toLowerCase();var f=i.putOnlyUsedFonts||!1,g={},d={internal:{},__private__:{}};d.__private__.PubSub=Cm;var m="1.3",y=d.__private__.getPdfVersion=function(){return m};d.__private__.setPdfVersion=function(_){m=_};var b={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};d.__private__.getPageFormats=function(){return b};var x=d.__private__.getPageFormat=function(_){return b[_]};r=r||"a4";var E={COMPAT:"compat",ADVANCED:"advanced"},S=E.COMPAT;function M(){this.saveGraphicsState(),V(new Wt(Pt,0,0,-Pt,0,zs()*Pt).toString()+" cm"),this.setFontSize(this.getFontSize()/Pt),h="n",S=E.ADVANCED}function D(){this.restoreGraphicsState(),h="S",S=E.COMPAT}var W=d.__private__.combineFontStyleAndFontWeight=function(_,C){if(_=="bold"&&C=="normal"||_=="bold"&&C==400||_=="normal"&&C=="italic"||_=="bold"&&C=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return C&&(_=C==400||C==="normal"?_==="italic"?"italic":"normal":C!=700&&C!=="bold"||_!=="normal"?(C==700?"bold":C)+""+_:"bold"),_};d.advancedAPI=function(_){var C=S===E.COMPAT;return C&&M.call(this),typeof _!="function"||(_(this),C&&D.call(this)),this},d.compatAPI=function(_){var C=S===E.ADVANCED;return C&&D.call(this),typeof _!="function"||(_(this),C&&M.call(this)),this},d.isAdvancedAPI=function(){return S===E.ADVANCED};var j,P=function(_){if(S!==E.ADVANCED)throw new Error(_+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},H=d.roundToPrecision=d.__private__.roundToPrecision=function(_,C){var q=t||C;if(isNaN(_)||isNaN(q))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return _.toFixed(q).replace(/0+$/,"")};j=d.hpf=d.__private__.hpf=typeof l=="number"?function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.hpf");return H(_,l)}:l==="smart"?function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.hpf");return H(_,_>-1&&_<1?16:5)}:function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.hpf");return H(_,16)};var et=d.f2=d.__private__.f2=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.f2");return H(_,2)},R=d.__private__.f3=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.f3");return H(_,3)},F=d.scale=d.__private__.scale=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.scale");return S===E.COMPAT?_*Pt:S===E.ADVANCED?_:void 0},U=function(_){return S===E.COMPAT?zs()-_:S===E.ADVANCED?_:void 0},z=function(_){return F(U(_))};d.__private__.setPrecision=d.setPrecision=function(_){typeof parseInt(_,10)=="number"&&(t=parseInt(_,10))};var it,Y="00000000000000000000000000000000",st=d.__private__.getFileId=function(){return Y},Q=d.__private__.setFileId=function(_){return Y=_!==void 0&&/^[a-fA-F0-9]{32}$/.test(_)?_.toUpperCase():Y.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),c!==null&&(an=new Qo(c.userPermissions,c.userPassword,c.ownerPassword,Y)),Y};d.setFileId=function(_){return Q(_),this},d.getFileId=function(){return st()};var gt=d.__private__.convertDateToPDFDate=function(_){var C=_.getTimezoneOffset(),q=C<0?"+":"-",Z=Math.floor(Math.abs(C/60)),ot=Math.abs(C%60),_t=[q,O(Z),"'",O(ot),"'"].join("");return["D:",_.getFullYear(),O(_.getMonth()+1),O(_.getDate()),O(_.getHours()),O(_.getMinutes()),O(_.getSeconds()),_t].join("")},lt=d.__private__.convertPDFDateToDate=function(_){var C=parseInt(_.substr(2,4),10),q=parseInt(_.substr(6,2),10)-1,Z=parseInt(_.substr(8,2),10),ot=parseInt(_.substr(10,2),10),_t=parseInt(_.substr(12,2),10),Ct=parseInt(_.substr(14,2),10);return new Date(C,q,Z,ot,_t,Ct,0)},Et=d.__private__.setCreationDate=function(_){var C;if(_===void 0&&(_=new Date),_ instanceof Date)C=gt(_);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(_))throw new Error("Invalid argument passed to jsPDF.setCreationDate");C=_}return it=C},A=d.__private__.getCreationDate=function(_){var C=it;return _==="jsDate"&&(C=lt(it)),C};d.setCreationDate=function(_){return Et(_),this},d.getCreationDate=function(_){return A(_)};var G,O=d.__private__.padd2=function(_){return("0"+parseInt(_)).slice(-2)},X=d.__private__.padd2Hex=function(_){return("00"+(_=_.toString())).substr(_.length)},nt=0,at=[],ht=[],dt=0,St=[],At=[],Rt=!1,Dt=ht,$t=function(){nt=0,dt=0,ht=[],at=[],St=[],as=je(),fr=je()};d.__private__.setCustomOutputDestination=function(_){Rt=!0,Dt=_};var mt=function(_){Rt||(Dt=_)};d.__private__.resetCustomOutputDestination=function(){Rt=!1,Dt=ht};var V=d.__private__.out=function(_){return _=_.toString(),dt+=_.length+1,Dt.push(_),Dt},ne=d.__private__.write=function(_){return V(arguments.length===1?_.toString():Array.prototype.join.call(arguments," "))},qt=d.__private__.getArrayBuffer=function(_){for(var C=_.length,q=new ArrayBuffer(C),Z=new Uint8Array(q);C--;)Z[C]=_.charCodeAt(C);return q},Lt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];d.__private__.getStandardFonts=function(){return Lt};var It=i.fontSize||16;d.__private__.setFontSize=d.setFontSize=function(_){return It=S===E.ADVANCED?_/Pt:_,this};var Ft,Tt=d.__private__.getFontSize=d.getFontSize=function(){return S===E.COMPAT?It:It*Pt},zt=i.R2L||!1;d.__private__.setR2L=d.setR2L=function(_){return zt=_,this},d.__private__.getR2L=d.getR2L=function(){return zt};var Kt,te=d.__private__.setZoomMode=function(_){var C=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(_))Ft=_;else if(isNaN(_)){if(C.indexOf(_)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+_+'" is not recognized.');Ft=_}else Ft=parseInt(_,10)};d.__private__.getZoomMode=function(){return Ft};var he,ve=d.__private__.setPageMode=function(_){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(_)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+_+'" is not recognized.');Kt=_};d.__private__.getPageMode=function(){return Kt};var we=d.__private__.setLayoutMode=function(_){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(_)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+_+'" is not recognized.');he=_};d.__private__.getLayoutMode=function(){return he},d.__private__.setDisplayMode=d.setDisplayMode=function(_,C,q){return te(_),we(C),ve(q),this};var Xt={title:"",subject:"",author:"",keywords:"",creator:""};d.__private__.getDocumentProperty=function(_){if(Object.keys(Xt).indexOf(_)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Xt[_]},d.__private__.getDocumentProperties=function(){return Xt},d.__private__.setDocumentProperties=d.setProperties=d.setDocumentProperties=function(_){for(var C in Xt)Xt.hasOwnProperty(C)&&_[C]&&(Xt[C]=_[C]);return this},d.__private__.setDocumentProperty=function(_,C){if(Object.keys(Xt).indexOf(_)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Xt[_]=C};var me,Pt,Di,Se,qn,We={},$e={},Un=[],Me={},kr={},ei={},Ji={},vn=null,Ye=0,oe=[],Pe=new Cm(d),Ii=i.hotfixes||[],ai={},ui={},wi=[],Wt=function _(C,q,Z,ot,_t,Ct){if(!(this instanceof _))return new _(C,q,Z,ot,_t,Ct);isNaN(C)&&(C=1),isNaN(q)&&(q=0),isNaN(Z)&&(Z=0),isNaN(ot)&&(ot=1),isNaN(_t)&&(_t=0),isNaN(Ct)&&(Ct=0),this._matrix=[C,q,Z,ot,_t,Ct]};Object.defineProperty(Wt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(_){this._matrix[0]=_}}),Object.defineProperty(Wt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(_){this._matrix[1]=_}}),Object.defineProperty(Wt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(_){this._matrix[2]=_}}),Object.defineProperty(Wt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(_){this._matrix[3]=_}}),Object.defineProperty(Wt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(_){this._matrix[4]=_}}),Object.defineProperty(Wt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(_){this._matrix[5]=_}}),Object.defineProperty(Wt.prototype,"a",{get:function(){return this._matrix[0]},set:function(_){this._matrix[0]=_}}),Object.defineProperty(Wt.prototype,"b",{get:function(){return this._matrix[1]},set:function(_){this._matrix[1]=_}}),Object.defineProperty(Wt.prototype,"c",{get:function(){return this._matrix[2]},set:function(_){this._matrix[2]=_}}),Object.defineProperty(Wt.prototype,"d",{get:function(){return this._matrix[3]},set:function(_){this._matrix[3]=_}}),Object.defineProperty(Wt.prototype,"e",{get:function(){return this._matrix[4]},set:function(_){this._matrix[4]=_}}),Object.defineProperty(Wt.prototype,"f",{get:function(){return this._matrix[5]},set:function(_){this._matrix[5]=_}}),Object.defineProperty(Wt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Wt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Wt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Wt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Wt.prototype.join=function(_){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(j).join(_)},Wt.prototype.multiply=function(_){var C=_.sx*this.sx+_.shy*this.shx,q=_.sx*this.shy+_.shy*this.sy,Z=_.shx*this.sx+_.sy*this.shx,ot=_.shx*this.shy+_.sy*this.sy,_t=_.tx*this.sx+_.ty*this.shx+this.tx,Ct=_.tx*this.shy+_.ty*this.sy+this.ty;return new Wt(C,q,Z,ot,_t,Ct)},Wt.prototype.decompose=function(){var _=this.sx,C=this.shy,q=this.shx,Z=this.sy,ot=this.tx,_t=this.ty,Ct=Math.sqrt(_*_+C*C),jt=(_/=Ct)*q+(C/=Ct)*Z;q-=_*jt,Z-=C*jt;var Jt=Math.sqrt(q*q+Z*Z);return jt/=Jt,_*(Z/=Jt)<C*(q/=Jt)&&(_=-_,C=-C,jt=-jt,Ct=-Ct),{scale:new Wt(Ct,0,0,Jt,0,0),translate:new Wt(1,0,0,1,ot,_t),rotate:new Wt(_,C,-C,_,0,0),skew:new Wt(1,0,jt,1,0,0)}},Wt.prototype.toString=function(_){return this.join(" ")},Wt.prototype.inversed=function(){var _=this.sx,C=this.shy,q=this.shx,Z=this.sy,ot=this.tx,_t=this.ty,Ct=1/(_*Z-C*q),jt=Z*Ct,Jt=-C*Ct,ge=-q*Ct,ye=_*Ct;return new Wt(jt,Jt,ge,ye,-jt*ot-ge*_t,-Jt*ot-ye*_t)},Wt.prototype.applyToPoint=function(_){var C=_.x*this.sx+_.y*this.shx+this.tx,q=_.x*this.shy+_.y*this.sy+this.ty;return new Eo(C,q)},Wt.prototype.applyToRectangle=function(_){var C=this.applyToPoint(_),q=this.applyToPoint(new Eo(_.x+_.w,_.y+_.h));return new Ql(C.x,C.y,q.x-C.x,q.y-C.y)},Wt.prototype.clone=function(){var _=this.sx,C=this.shy,q=this.shx,Z=this.sy,ot=this.tx,_t=this.ty;return new Wt(_,C,q,Z,ot,_t)},d.Matrix=Wt;var Ei=d.matrixMult=function(_,C){return C.multiply(_)},Ri=new Wt(1,0,0,1,0,0);d.unitMatrix=d.identityMatrix=Ri;var Ee=function(_,C){if(!kr[_]){var q=(C instanceof Ua?"Sh":"P")+(Object.keys(Me).length+1).toString(10);C.id=q,kr[_]=q,Me[q]=C,Pe.publish("addPattern",C)}};d.ShadingPattern=Ua,d.TilingPattern=sl,d.addShadingPattern=function(_,C){return P("addShadingPattern()"),Ee(_,C),this},d.beginTilingPattern=function(_){P("beginTilingPattern()"),Wc(_.boundingBox[0],_.boundingBox[1],_.boundingBox[2]-_.boundingBox[0],_.boundingBox[3]-_.boundingBox[1],_.matrix)},d.endTilingPattern=function(_,C){P("endTilingPattern()"),C.stream=At[G].join(`
`),Ee(_,C),Pe.publish("endTilingPattern",C),wi.pop().restore()};var Ae=d.__private__.newObject=function(){var _=je();return yn(_,!0),_},je=d.__private__.newObjectDeferred=function(){return nt++,at[nt]=function(){return dt},nt},yn=function(_,C){return C=typeof C=="boolean"&&C,at[_]=dt,C&&V(_+" 0 obj"),_},ho=d.__private__.newAdditionalObject=function(){var _={objId:je(),content:""};return St.push(_),_},as=je(),fr=je(),dr=d.__private__.decodeColorString=function(_){var C=_.split(" ");if(C.length!==2||C[1]!=="g"&&C[1]!=="G")C.length===5&&(C[4]==="k"||C[4]==="K")&&(C=[(1-C[0])*(1-C[3]),(1-C[1])*(1-C[3]),(1-C[2])*(1-C[3]),"r"]);else{var q=parseFloat(C[0]);C=[q,q,q,"r"]}for(var Z="#",ot=0;ot<3;ot++)Z+=("0"+Math.floor(255*parseFloat(C[ot])).toString(16)).slice(-2);return Z},gr=d.__private__.encodeColorString=function(_){var C;typeof _=="string"&&(_={ch1:_});var q=_.ch1,Z=_.ch2,ot=_.ch3,_t=_.ch4,Ct=_.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof q=="string"&&q.charAt(0)!=="#"){var jt=new av(q);if(jt.ok)q=jt.toHex();else if(!/^\d*\.?\d*$/.test(q))throw new Error('Invalid color "'+q+'" passed to jsPDF.encodeColorString.')}if(typeof q=="string"&&/^#[0-9A-Fa-f]{3}$/.test(q)&&(q="#"+q[1]+q[1]+q[2]+q[2]+q[3]+q[3]),typeof q=="string"&&/^#[0-9A-Fa-f]{6}$/.test(q)){var Jt=parseInt(q.substr(1),16);q=Jt>>16&255,Z=Jt>>8&255,ot=255&Jt}if(Z===void 0||_t===void 0&&q===Z&&Z===ot)if(typeof q=="string")C=q+" "+Ct[0];else switch(_.precision){case 2:C=et(q/255)+" "+Ct[0];break;case 3:default:C=R(q/255)+" "+Ct[0]}else if(_t===void 0||Xe(_t)==="object"){if(_t&&!isNaN(_t.a)&&_t.a===0)return C=["1.","1.","1.",Ct[1]].join(" ");if(typeof q=="string")C=[q,Z,ot,Ct[1]].join(" ");else switch(_.precision){case 2:C=[et(q/255),et(Z/255),et(ot/255),Ct[1]].join(" ");break;default:case 3:C=[R(q/255),R(Z/255),R(ot/255),Ct[1]].join(" ")}}else if(typeof q=="string")C=[q,Z,ot,_t,Ct[2]].join(" ");else switch(_.precision){case 2:C=[et(q),et(Z),et(ot),et(_t),Ct[2]].join(" ");break;case 3:default:C=[R(q),R(Z),R(ot),R(_t),Ct[2]].join(" ")}return C},Dr=d.__private__.getFilters=function(){return a},tr=d.__private__.putStream=function(_){var C=(_=_||{}).data||"",q=_.filters||Dr(),Z=_.alreadyAppliedFilters||[],ot=_.addLength1||!1,_t=C.length,Ct=_.objectId,jt=function(on){return on};if(c!==null&&Ct===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");c!==null&&(jt=an.encryptor(Ct,0));var Jt={};q===!0&&(q=["FlateEncode"]);var ge=_.additionalKeyValues||[],ye=(Jt=re.API.processDataByFilters!==void 0?re.API.processDataByFilters(C,q):{data:C,reverseChain:[]}).reverseChain+(Array.isArray(Z)?Z.join(" "):Z.toString());if(Jt.data.length!==0&&(ge.push({key:"Length",value:Jt.data.length}),ot===!0&&ge.push({key:"Length1",value:_t})),ye.length!=0)if(ye.split("/").length-1==1)ge.push({key:"Filter",value:ye});else{ge.push({key:"Filter",value:"["+ye+"]"});for(var Te=0;Te<ge.length;Te+=1)if(ge[Te].key==="DecodeParms"){for(var fi=[],_i=0;_i<Jt.reverseChain.split("/").length-1;_i+=1)fi.push("null");fi.push(ge[Te].value),ge[Te].value="["+fi.join(" ")+"]"}}V("<<");for(var Ni=0;Ni<ge.length;Ni++)V("/"+ge[Ni].key+" "+ge[Ni].value);V(">>"),Jt.data.length!==0&&(V("stream"),V(jt(Jt.data)),V("endstream"))},jr=d.__private__.putPage=function(_){var C=_.number,q=_.data,Z=_.objId,ot=_.contentsObjId;yn(Z,!0),V("<</Type /Page"),V("/Parent "+_.rootDictionaryObjId+" 0 R"),V("/Resources "+_.resourceDictionaryObjId+" 0 R"),V("/MediaBox ["+parseFloat(j(_.mediaBox.bottomLeftX))+" "+parseFloat(j(_.mediaBox.bottomLeftY))+" "+j(_.mediaBox.topRightX)+" "+j(_.mediaBox.topRightY)+"]"),_.cropBox!==null&&V("/CropBox ["+j(_.cropBox.bottomLeftX)+" "+j(_.cropBox.bottomLeftY)+" "+j(_.cropBox.topRightX)+" "+j(_.cropBox.topRightY)+"]"),_.bleedBox!==null&&V("/BleedBox ["+j(_.bleedBox.bottomLeftX)+" "+j(_.bleedBox.bottomLeftY)+" "+j(_.bleedBox.topRightX)+" "+j(_.bleedBox.topRightY)+"]"),_.trimBox!==null&&V("/TrimBox ["+j(_.trimBox.bottomLeftX)+" "+j(_.trimBox.bottomLeftY)+" "+j(_.trimBox.topRightX)+" "+j(_.trimBox.topRightY)+"]"),_.artBox!==null&&V("/ArtBox ["+j(_.artBox.bottomLeftX)+" "+j(_.artBox.bottomLeftY)+" "+j(_.artBox.topRightX)+" "+j(_.artBox.topRightY)+"]"),typeof _.userUnit=="number"&&_.userUnit!==1&&V("/UserUnit "+_.userUnit),Pe.publish("putPage",{objId:Z,pageContext:oe[C],pageNumber:C,page:q}),V("/Contents "+ot+" 0 R"),V(">>"),V("endobj");var _t=q.join(`
`);return S===E.ADVANCED&&(_t+=`
Q`),yn(ot,!0),tr({data:_t,filters:Dr(),objectId:ot}),V("endobj"),Z},Pa=d.__private__.putPages=function(){var _,C,q=[];for(_=1;_<=Ye;_++)oe[_].objId=je(),oe[_].contentsObjId=je();for(_=1;_<=Ye;_++)q.push(jr({number:_,data:At[_],objId:oe[_].objId,contentsObjId:oe[_].contentsObjId,mediaBox:oe[_].mediaBox,cropBox:oe[_].cropBox,bleedBox:oe[_].bleedBox,trimBox:oe[_].trimBox,artBox:oe[_].artBox,userUnit:oe[_].userUnit,rootDictionaryObjId:as,resourceDictionaryObjId:fr}));yn(as,!0),V("<</Type /Pages");var Z="/Kids [";for(C=0;C<Ye;C++)Z+=q[C]+" 0 R ";V(Z+"]"),V("/Count "+Ye),V(">>"),V("endobj"),Pe.publish("postPutPages")},co=function(_){Pe.publish("putFont",{font:_,out:V,newObject:Ae,putStream:tr}),_.isAlreadyPutted!==!0&&(_.objectNumber=Ae(),V("<<"),V("/Type /Font"),V("/BaseFont /"+tl(_.postScriptName)),V("/Subtype /Type1"),typeof _.encoding=="string"&&V("/Encoding /"+_.encoding),V("/FirstChar 32"),V("/LastChar 255"),V(">>"),V("endobj"))},uo=function(){for(var _ in We)We.hasOwnProperty(_)&&(f===!1||f===!0&&g.hasOwnProperty(_))&&co(We[_])},fo=function(_){_.objectNumber=Ae();var C=[];C.push({key:"Type",value:"/XObject"}),C.push({key:"Subtype",value:"/Form"}),C.push({key:"BBox",value:"["+[j(_.x),j(_.y),j(_.x+_.width),j(_.y+_.height)].join(" ")+"]"}),C.push({key:"Matrix",value:"["+_.matrix.toString()+"]"});var q=_.pages[1].join(`
`);tr({data:q,additionalKeyValues:C,objectId:_.objectNumber}),V("endobj")},go=function(){for(var _ in ai)ai.hasOwnProperty(_)&&fo(ai[_])},Cc=function(_,C){var q,Z=[],ot=1/(C-1);for(q=0;q<1;q+=ot)Z.push(q);if(Z.push(1),_[0].offset!=0){var _t={offset:0,color:_[0].color};_.unshift(_t)}if(_[_.length-1].offset!=1){var Ct={offset:1,color:_[_.length-1].color};_.push(Ct)}for(var jt="",Jt=0,ge=0;ge<Z.length;ge++){for(q=Z[ge];q>_[Jt+1].offset;)Jt++;var ye=_[Jt].offset,Te=(q-ye)/(_[Jt+1].offset-ye),fi=_[Jt].color,_i=_[Jt+1].color;jt+=X(Math.round((1-Te)*fi[0]+Te*_i[0]).toString(16))+X(Math.round((1-Te)*fi[1]+Te*_i[1]).toString(16))+X(Math.round((1-Te)*fi[2]+Te*_i[2]).toString(16))}return jt.trim()},hd=function(_,C){C||(C=21);var q=Ae(),Z=Cc(_.colors,C),ot=[];ot.push({key:"FunctionType",value:"0"}),ot.push({key:"Domain",value:"[0.0 1.0]"}),ot.push({key:"Size",value:"["+C+"]"}),ot.push({key:"BitsPerSample",value:"8"}),ot.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ot.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),tr({data:Z,additionalKeyValues:ot,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:q}),V("endobj"),_.objectNumber=Ae(),V("<< /ShadingType "+_.type),V("/ColorSpace /DeviceRGB");var _t="/Coords ["+j(parseFloat(_.coords[0]))+" "+j(parseFloat(_.coords[1]))+" ";_.type===2?_t+=j(parseFloat(_.coords[2]))+" "+j(parseFloat(_.coords[3])):_t+=j(parseFloat(_.coords[2]))+" "+j(parseFloat(_.coords[3]))+" "+j(parseFloat(_.coords[4]))+" "+j(parseFloat(_.coords[5])),V(_t+="]"),_.matrix&&V("/Matrix ["+_.matrix.toString()+"]"),V("/Function "+q+" 0 R"),V("/Extend [true true]"),V(">>"),V("endobj")},cd=function(_,C){var q=je(),Z=Ae();C.push({resourcesOid:q,objectOid:Z}),_.objectNumber=Z;var ot=[];ot.push({key:"Type",value:"/Pattern"}),ot.push({key:"PatternType",value:"1"}),ot.push({key:"PaintType",value:"1"}),ot.push({key:"TilingType",value:"1"}),ot.push({key:"BBox",value:"["+_.boundingBox.map(j).join(" ")+"]"}),ot.push({key:"XStep",value:j(_.xStep)}),ot.push({key:"YStep",value:j(_.yStep)}),ot.push({key:"Resources",value:q+" 0 R"}),_.matrix&&ot.push({key:"Matrix",value:"["+_.matrix.toString()+"]"}),tr({data:_.stream,additionalKeyValues:ot,objectId:_.objectNumber}),V("endobj")},po=function(_){var C;for(C in Me)Me.hasOwnProperty(C)&&(Me[C]instanceof Ua?hd(Me[C]):Me[C]instanceof sl&&cd(Me[C],_))},Ac=function(_){for(var C in _.objectNumber=Ae(),V("<<"),_)switch(C){case"opacity":V("/ca "+et(_[C]));break;case"stroke-opacity":V("/CA "+et(_[C]))}V(">>"),V("endobj")},ud=function(){var _;for(_ in ei)ei.hasOwnProperty(_)&&Ac(ei[_])},Ul=function(){for(var _ in V("/XObject <<"),ai)ai.hasOwnProperty(_)&&ai[_].objectNumber>=0&&V("/"+_+" "+ai[_].objectNumber+" 0 R");Pe.publish("putXobjectDict"),V(">>")},fd=function(){an.oid=Ae(),V("<<"),V("/Filter /Standard"),V("/V "+an.v),V("/R "+an.r),V("/U <"+an.toHexString(an.U)+">"),V("/O <"+an.toHexString(an.O)+">"),V("/P "+an.P),V(">>"),V("endobj")},Mc=function(){for(var _ in V("/Font <<"),We)We.hasOwnProperty(_)&&(f===!1||f===!0&&g.hasOwnProperty(_))&&V("/"+_+" "+We[_].objectNumber+" 0 R");V(">>")},dd=function(){if(Object.keys(Me).length>0){for(var _ in V("/Shading <<"),Me)Me.hasOwnProperty(_)&&Me[_]instanceof Ua&&Me[_].objectNumber>=0&&V("/"+_+" "+Me[_].objectNumber+" 0 R");Pe.publish("putShadingPatternDict"),V(">>")}},mo=function(_){if(Object.keys(Me).length>0){for(var C in V("/Pattern <<"),Me)Me.hasOwnProperty(C)&&Me[C]instanceof d.TilingPattern&&Me[C].objectNumber>=0&&Me[C].objectNumber<_&&V("/"+C+" "+Me[C].objectNumber+" 0 R");Pe.publish("putTilingPatternDict"),V(">>")}},gd=function(){if(Object.keys(ei).length>0){var _;for(_ in V("/ExtGState <<"),ei)ei.hasOwnProperty(_)&&ei[_].objectNumber>=0&&V("/"+_+" "+ei[_].objectNumber+" 0 R");Pe.publish("putGStateDict"),V(">>")}},Si=function(_){yn(_.resourcesOid,!0),V("<<"),V("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Mc(),dd(),mo(_.objectOid),gd(),Ul(),V(">>"),V("endobj")},Tc=function(){var _=[];uo(),ud(),go(),po(_),Pe.publish("putResources"),_.forEach(Si),Si({resourcesOid:fr,objectOid:Number.MAX_SAFE_INTEGER}),Pe.publish("postPutResources")},Pc=function(){Pe.publish("putAdditionalObjects");for(var _=0;_<St.length;_++){var C=St[_];yn(C.objId,!0),V(C.content),V("endobj")}Pe.publish("postPutAdditionalObjects")},Ic=function(_){$e[_.fontName]=$e[_.fontName]||{},$e[_.fontName][_.fontStyle]=_.id},Wl=function(_,C,q,Z,ot){var _t={id:"F"+(Object.keys(We).length+1).toString(10),postScriptName:_,fontName:C,fontStyle:q,encoding:Z,isStandardFont:ot||!1,metadata:{}};return Pe.publish("addFont",{font:_t,instance:this}),We[_t.id]=_t,Ic(_t),_t.id},pd=function(_){for(var C=0,q=Lt.length;C<q;C++){var Z=Wl.call(this,_[C][0],_[C][1],_[C][2],Lt[C][3],!0);f===!1&&(g[Z]=!0);var ot=_[C][0].split("-");Ic({id:Z,fontName:ot[0],fontStyle:ot[1]||""})}Pe.publish("addFonts",{fonts:We,dictionary:$e})},pr=function(_){return _.foo=function(){try{return _.apply(this,arguments)}catch(Z){var C=Z.stack||"";~C.indexOf(" at ")&&(C=C.split(" at ")[1]);var q="Error in function "+C.split(`
`)[0].split("<")[0]+": "+Z.message;if(!se.console)throw new Error(q);se.console.error(q,Z),se.alert&&alert(q)}},_.foo.bar=_,_.foo},_o=function(_,C){var q,Z,ot,_t,Ct,jt,Jt,ge,ye;if(ot=(C=C||{}).sourceEncoding||"Unicode",Ct=C.outputEncoding,(C.autoencode||Ct)&&We[me].metadata&&We[me].metadata[ot]&&We[me].metadata[ot].encoding&&(_t=We[me].metadata[ot].encoding,!Ct&&We[me].encoding&&(Ct=We[me].encoding),!Ct&&_t.codePages&&(Ct=_t.codePages[0]),typeof Ct=="string"&&(Ct=_t[Ct]),Ct)){for(Jt=!1,jt=[],q=0,Z=_.length;q<Z;q++)(ge=Ct[_.charCodeAt(q)])?jt.push(String.fromCharCode(ge)):jt.push(_[q]),jt[q].charCodeAt(0)>>8&&(Jt=!0);_=jt.join("")}for(q=_.length;Jt===void 0&&q!==0;)_.charCodeAt(q-1)>>8&&(Jt=!0),q--;if(!Jt)return _;for(jt=C.noBOM?[]:[254,255],q=0,Z=_.length;q<Z;q++){if((ye=(ge=_.charCodeAt(q))>>8)>>8)throw new Error("Character at position "+q+" of string '"+_+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");jt.push(ye),jt.push(ge-(ye<<8))}return String.fromCharCode.apply(void 0,jt)},An=d.__private__.pdfEscape=d.pdfEscape=function(_,C){return _o(_,C).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Vl=d.__private__.beginPage=function(_){At[++Ye]=[],oe[Ye]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(_[0]),topRightY:Number(_[1])}},Nc(Ye),mt(At[G])},Rc=function(_,C){var q,Z,ot;switch(e=C||e,typeof _=="string"&&(q=x(_.toLowerCase()),Array.isArray(q)&&(Z=q[0],ot=q[1])),Array.isArray(_)&&(Z=_[0]*Pt,ot=_[1]*Pt),isNaN(Z)&&(Z=r[0],ot=r[1]),(Z>14400||ot>14400)&&(Qe.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Z=Math.min(14400,Z),ot=Math.min(14400,ot)),r=[Z,ot],e.substr(0,1)){case"l":ot>Z&&(r=[ot,Z]);break;case"p":Z>ot&&(r=[ot,Z])}Vl(r),Bc(Zl),V(mr),$l!==0&&V($l+" J"),Jl!==0&&V(Jl+" j"),Pe.publish("addPage",{pageNumber:Ye})},md=function(_){_>0&&_<=Ye&&(At.splice(_,1),oe.splice(_,1),Ye--,G>Ye&&(G=Ye),this.setPage(G))},Nc=function(_){_>0&&_<=Ye&&(G=_)},_d=d.__private__.getNumberOfPages=d.getNumberOfPages=function(){return At.length-1},Fc=function(_,C,q){var Z,ot=void 0;return q=q||{},_=_!==void 0?_:We[me].fontName,C=C!==void 0?C:We[me].fontStyle,Z=_.toLowerCase(),$e[Z]!==void 0&&$e[Z][C]!==void 0?ot=$e[Z][C]:$e[_]!==void 0&&$e[_][C]!==void 0?ot=$e[_][C]:q.disableWarning===!1&&Qe.warn("Unable to look up font label for font '"+_+"', '"+C+"'. Refer to getFontList() for available fonts."),ot||q.noFallback||(ot=$e.times[C])==null&&(ot=$e.times.normal),ot},vd=d.__private__.putInfo=function(){var _=Ae(),C=function(Z){return Z};for(var q in c!==null&&(C=an.encryptor(_,0)),V("<<"),V("/Producer ("+An(C("jsPDF "+re.version))+")"),Xt)Xt.hasOwnProperty(q)&&Xt[q]&&V("/"+q.substr(0,1).toUpperCase()+q.substr(1)+" ("+An(C(Xt[q]))+")");V("/CreationDate ("+An(C(it))+")"),V(">>"),V("endobj")},Hl=d.__private__.putCatalog=function(_){var C=(_=_||{}).rootDictionaryObjId||as;switch(Ae(),V("<<"),V("/Type /Catalog"),V("/Pages "+C+" 0 R"),Ft||(Ft="fullwidth"),Ft){case"fullwidth":V("/OpenAction [3 0 R /FitH null]");break;case"fullheight":V("/OpenAction [3 0 R /FitV null]");break;case"fullpage":V("/OpenAction [3 0 R /Fit]");break;case"original":V("/OpenAction [3 0 R /XYZ null null 1]");break;default:var q=""+Ft;q.substr(q.length-1)==="%"&&(Ft=parseInt(Ft)/100),typeof Ft=="number"&&V("/OpenAction [3 0 R /XYZ null null "+et(Ft)+"]")}switch(he||(he="continuous"),he){case"continuous":V("/PageLayout /OneColumn");break;case"single":V("/PageLayout /SinglePage");break;case"two":case"twoleft":V("/PageLayout /TwoColumnLeft");break;case"tworight":V("/PageLayout /TwoColumnRight")}Kt&&V("/PageMode /"+Kt),Pe.publish("putCatalog"),V(">>"),V("endobj")},yd=d.__private__.putTrailer=function(){V("trailer"),V("<<"),V("/Size "+(nt+1)),V("/Root "+nt+" 0 R"),V("/Info "+(nt-1)+" 0 R"),c!==null&&V("/Encrypt "+an.oid+" 0 R"),V("/ID [ <"+Y+"> <"+Y+"> ]"),V(">>")},xd=d.__private__.putHeader=function(){V("%PDF-"+m),V("%ºß¬à")},bd=d.__private__.putXRef=function(){var _="0000000000";V("xref"),V("0 "+(nt+1)),V("0000000000 65535 f ");for(var C=1;C<=nt;C++)typeof at[C]=="function"?V((_+at[C]()).slice(-10)+" 00000 n "):at[C]!==void 0?V((_+at[C]).slice(-10)+" 00000 n "):V("0000000000 00000 n ")},os=d.__private__.buildDocument=function(){$t(),mt(ht),Pe.publish("buildDocument"),xd(),Pa(),Pc(),Tc(),c!==null&&fd(),vd(),Hl();var _=dt;return bd(),yd(),V("startxref"),V(""+_),V("%%EOF"),mt(At[G]),ht.join(`
`)},vo=d.__private__.getBlob=function(_){return new Blob([qt(_)],{type:"application/pdf"})},yo=d.output=d.__private__.output=pr(function(_,C){switch(typeof(C=C||{})=="string"?C={filename:C}:C.filename=C.filename||"generated.pdf",_){case void 0:return os();case"save":d.save(C.filename);break;case"arraybuffer":return qt(os());case"blob":return vo(os());case"bloburi":case"bloburl":if(se.URL!==void 0&&typeof se.URL.createObjectURL=="function")return se.URL&&se.URL.createObjectURL(vo(os()))||void 0;Qe.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var q="",Z=os();try{q=p0(Z)}catch{q=p0(unescape(encodeURIComponent(Z)))}return"data:application/pdf;filename="+C.filename+";base64,"+q;case"pdfobjectnewwindow":if(Object.prototype.toString.call(se)==="[object Window]"){var ot="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",_t=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';C.pdfObjectUrl&&(ot=C.pdfObjectUrl,_t="");var Ct='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ot+'"'+_t+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(C)+");<\/script></body></html>",jt=se.open();return jt!==null&&jt.document.write(Ct),jt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(se)==="[object Window]"){var Jt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(C.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+C.filename+'" width="500px" height="400px" /></body></html>',ge=se.open();if(ge!==null){ge.document.write(Jt);var ye=this;ge.document.documentElement.querySelector("#pdfViewer").onload=function(){ge.document.title=C.filename,ge.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(ye.output("bloburl"))}}return ge}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(se)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Te='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",C)+'"></iframe></body></html>',fi=se.open();if(fi!==null&&(fi.document.write(Te),fi.document.title=C.filename),fi||typeof safari>"u")return fi;break;case"datauri":case"dataurl":return se.document.location.href=this.output("datauristring",C);default:return null}}),Oc=function(_){return Array.isArray(Ii)===!0&&Ii.indexOf(_)>-1};switch(n){case"pt":Pt=1;break;case"mm":Pt=72/25.4;break;case"cm":Pt=72/2.54;break;case"in":Pt=72;break;case"px":Pt=Oc("px_scaling")==1?.75:96/72;break;case"pc":case"em":Pt=12;break;case"ex":Pt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Pt=n}var an=null;Et(),Q();var wd=function(_){return c!==null?an.encryptor(_,0):function(C){return C}},kc=d.__private__.getPageInfo=d.getPageInfo=function(_){if(isNaN(_)||_%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:oe[_].objId,pageNumber:_,pageContext:oe[_]}},ce=d.__private__.getPageInfoByObjId=function(_){if(isNaN(_)||_%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var C in oe)if(oe[C].objId===_)break;return kc(C)},Ed=d.__private__.getCurrentPageInfo=d.getCurrentPageInfo=function(){return{objId:oe[G].objId,pageNumber:G,pageContext:oe[G]}};d.addPage=function(){return Rc.apply(this,arguments),this},d.setPage=function(){return Nc.apply(this,arguments),mt.call(this,At[G]),this},d.insertPage=function(_){return this.addPage(),this.movePage(G,_),this},d.movePage=function(_,C){var q,Z;if(_>C){q=At[_],Z=oe[_];for(var ot=_;ot>C;ot--)At[ot]=At[ot-1],oe[ot]=oe[ot-1];At[C]=q,oe[C]=Z,this.setPage(C)}else if(_<C){q=At[_],Z=oe[_];for(var _t=_;_t<C;_t++)At[_t]=At[_t+1],oe[_t]=oe[_t+1];At[C]=q,oe[C]=Z,this.setPage(C)}return this},d.deletePage=function(){return md.apply(this,arguments),this},d.__private__.text=d.text=function(_,C,q,Z,ot){var _t,Ct,jt,Jt,ge,ye,Te,fi,_i,Ni=(Z=Z||{}).scope||this;if(typeof _=="number"&&typeof C=="number"&&(typeof q=="string"||Array.isArray(q))){var on=q;q=C,C=_,_=on}if(arguments[3]instanceof Wt?(P("The transform parameter of text() with a Matrix value"),_i=ot):(jt=arguments[4],Jt=arguments[5],Xe(Te=arguments[3])==="object"&&Te!==null||(typeof jt=="string"&&(Jt=jt,jt=null),typeof Te=="string"&&(Jt=Te,Te=null),typeof Te=="number"&&(jt=Te,Te=null),Z={flags:Te,angle:jt,align:Jt})),isNaN(C)||isNaN(q)||_==null)throw new Error("Invalid arguments passed to jsPDF.text");if(_.length===0)return Ni;var qi="",_r=!1,Wn=typeof Z.lineHeightFactor=="number"?Z.lineHeightFactor:Ra,hs=Ni.internal.scaleFactor;function Vc(ii){return ii=ii.split("	").join(Array(Z.TabLen||9).join(" ")),An(ii,Te)}function nh(ii){for(var ni,Li=ii.concat(),ji=[],ds=Li.length;ds--;)typeof(ni=Li.shift())=="string"?ji.push(ni):Array.isArray(ii)&&(ni.length===1||ni[1]===void 0&&ni[2]===void 0)?ji.push(ni[0]):ji.push([ni[0],ni[1],ni[2]]);return ji}function rh(ii,ni){var Li;if(typeof ii=="string")Li=ni(ii)[0];else if(Array.isArray(ii)){for(var ji,ds,Hs=ii.concat(),No=[],Xc=Hs.length;Xc--;)typeof(ji=Hs.shift())=="string"?No.push(ni(ji)[0]):Array.isArray(ji)&&typeof ji[0]=="string"&&(ds=ni(ji[0],ji[1],ji[2]),No.push([ds[0],ds[1],ds[2]]));Li=No}return Li}var Lo=!1,sh=!0;if(typeof _=="string")Lo=!0;else if(Array.isArray(_)){var ah=_.concat();Ct=[];for(var Co,Mn=ah.length;Mn--;)(typeof(Co=ah.shift())!="string"||Array.isArray(Co)&&typeof Co[0]!="string")&&(sh=!1);Lo=sh}if(Lo===!1)throw new Error('Type of text must be string or Array. "'+_+'" is not recognized.');typeof _=="string"&&(_=_.match(/[\r?\n]/)?_.split(/\r\n|\r|\n/g):[_]);var Ao=It/Ni.internal.scaleFactor,Mo=Ao*(Wn-1);switch(Z.baseline){case"bottom":q-=Mo;break;case"top":q+=Ao-Mo;break;case"hanging":q+=Ao-2*Mo;break;case"middle":q+=Ao/2-Mo}if((ye=Z.maxWidth||0)>0&&(typeof _=="string"?_=Ni.splitTextToSize(_,ye):Object.prototype.toString.call(_)==="[object Array]"&&(_=_.reduce(function(ii,ni){return ii.concat(Ni.splitTextToSize(ni,ye))},[]))),_t={text:_,x:C,y:q,options:Z,mutex:{pdfEscape:An,activeFontKey:me,fonts:We,activeFontSize:It}},Pe.publish("preProcessText",_t),_=_t.text,jt=(Z=_t.options).angle,!(_i instanceof Wt)&&jt&&typeof jt=="number"){jt*=Math.PI/180,Z.rotationDirection===0&&(jt=-jt),S===E.ADVANCED&&(jt=-jt);var To=Math.cos(jt),oh=Math.sin(jt);_i=new Wt(To,oh,-oh,To,0,0)}else jt&&jt instanceof Wt&&(_i=jt);S!==E.ADVANCED||_i||(_i=Ri),(ge=Z.charSpace||wo)!==void 0&&(qi+=j(F(ge))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(fi=Z.horizontalScale)!==void 0&&(qi+=j(100*fi)+` Tz
`),Z.lang;var Tn=-1,Nd=Z.renderingMode!==void 0?Z.renderingMode:Z.stroke,lh=Ni.internal.getCurrentPageInfo().pageContext;switch(Nd){case 0:case!1:case"fill":Tn=0;break;case 1:case!0:case"stroke":Tn=1;break;case 2:case"fillThenStroke":Tn=2;break;case 3:case"invisible":Tn=3;break;case 4:case"fillAndAddForClipping":Tn=4;break;case 5:case"strokeAndAddPathForClipping":Tn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Tn=6;break;case 7:case"addToPathForClipping":Tn=7}var Hc=lh.usedRenderingMode!==void 0?lh.usedRenderingMode:-1;Tn!==-1?qi+=Tn+` Tr
`:Hc!==-1&&(qi+=`0 Tr
`),Tn!==-1&&(lh.usedRenderingMode=Tn),Jt=Z.align||"left";var vr,hh=It*Wn,Fd=Ni.internal.pageSize.getWidth(),Od=We[me];ge=Z.charSpace||wo,ye=Z.maxWidth||0,Te=Object.assign({autoencode:!0,noBOM:!0},Z.flags);var qs=[];if(Object.prototype.toString.call(_)==="[object Array]"){var er;Ct=nh(_),Jt!=="left"&&(vr=Ct.map(function(ii){return Ni.getStringUnitWidth(ii,{font:Od,charSpace:ge,fontSize:It,doKerning:!1})*It/hs}));var yr,Us=0;if(Jt==="right"){C-=vr[0],_=[],Mn=Ct.length;for(var Gr=0;Gr<Mn;Gr++)Gr===0?(yr=ls(C),er=Bs(q)):(yr=F(Us-vr[Gr]),er=-hh),_.push([Ct[Gr],yr,er]),Us=vr[Gr]}else if(Jt==="center"){C-=vr[0]/2,_=[],Mn=Ct.length;for(var cs=0;cs<Mn;cs++)cs===0?(yr=ls(C),er=Bs(q)):(yr=F((Us-vr[cs])/2),er=-hh),_.push([Ct[cs],yr,er]),Us=vr[cs]}else if(Jt==="left"){_=[],Mn=Ct.length;for(var Po=0;Po<Mn;Po++)_.push(Ct[Po])}else{if(Jt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');_=[],Mn=Ct.length,ye=ye!==0?ye:Fd;for(var xr=0;xr<Mn;xr++)er=xr===0?Bs(q):-hh,yr=xr===0?ls(C):0,xr<Mn-1?qs.push(j(F((ye-vr[xr])/(Ct[xr].split(" ").length-1)))):qs.push(0),_.push([Ct[xr],yr,er])}}var Io=typeof Z.R2L=="boolean"?Z.R2L:zt;Io===!0&&(_=rh(_,function(ii,ni,Li){return[ii.split("").reverse().join(""),ni,Li]})),_t={text:_,x:C,y:q,options:Z,mutex:{pdfEscape:An,activeFontKey:me,fonts:We,activeFontSize:It}},Pe.publish("postProcessText",_t),_=_t.text,_r=_t.mutex.isHex||!1;var ch=We[me].encoding;ch!=="WinAnsiEncoding"&&ch!=="StandardEncoding"||(_=rh(_,function(ii,ni,Li){return[Vc(ii),ni,Li]})),Ct=nh(_),_=[];for(var Ws,br,us,Oa=0,Ro=1,ka=Array.isArray(Ct[0])?Ro:Oa,Vs="",uh=function(ii,ni,Li){var ji="";return Li instanceof Wt?(Li=typeof Z.angle=="number"?Ei(Li,new Wt(1,0,0,1,ii,ni)):Ei(new Wt(1,0,0,1,ii,ni),Li),S===E.ADVANCED&&(Li=Ei(new Wt(1,0,0,-1,0,0),Li)),ji=Li.join(" ")+` Tm
`):ji=j(ii)+" "+j(ni)+` Td
`,ji},ir=0;ir<Ct.length;ir++){switch(Vs="",ka){case Ro:us=(_r?"<":"(")+Ct[ir][0]+(_r?">":")"),Ws=parseFloat(Ct[ir][1]),br=parseFloat(Ct[ir][2]);break;case Oa:us=(_r?"<":"(")+Ct[ir]+(_r?">":")"),Ws=ls(C),br=Bs(q)}qs!==void 0&&qs[ir]!==void 0&&(Vs=qs[ir]+` Tw
`),ir===0?_.push(Vs+uh(Ws,br,_i)+us):ka===Oa?_.push(Vs+us):ka===Ro&&_.push(Vs+uh(Ws,br,_i)+us)}_=ka===Oa?_.join(` Tj
T* `):_.join(` Tj
`),_+=` Tj
`;var fs=`BT
/`;return fs+=me+" "+It+` Tf
`,fs+=j(It*Wn)+` TL
`,fs+=Na+`
`,fs+=qi,fs+=_,V(fs+="ET"),g[me]=!0,Ni};var Sd=d.__private__.clip=d.clip=function(_){return V(_==="evenodd"?"W*":"W"),this};d.clipEvenOdd=function(){return Sd("evenodd")},d.__private__.discardPath=d.discardPath=function(){return V("n"),this};var Br=d.__private__.isValidStyle=function(_){var C=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(_)!==-1&&(C=!0),C};d.__private__.setDefaultPathOperation=d.setDefaultPathOperation=function(_){return Br(_)&&(h=_),this};var Dc=d.__private__.getStyle=d.getStyle=function(_){var C=h;switch(_){case"D":case"S":C="S";break;case"F":C="f";break;case"FD":case"DF":C="B";break;case"f":case"f*":case"B":case"B*":C=_}return C},jc=d.close=function(){return V("h"),this};d.stroke=function(){return V("S"),this},d.fill=function(_){return xo("f",_),this},d.fillEvenOdd=function(_){return xo("f*",_),this},d.fillStroke=function(_){return xo("B",_),this},d.fillStrokeEvenOdd=function(_){return xo("B*",_),this};var xo=function(_,C){Xe(C)==="object"?Cd(C,_):V(_)},Xl=function(_){_===null||S===E.ADVANCED&&_===void 0||(_=Dc(_),V(_))};function Ld(_,C,q,Z,ot){var _t=new sl(C||this.boundingBox,q||this.xStep,Z||this.yStep,this.gState,ot||this.matrix);_t.stream=this.stream;var Ct=_+"$$"+this.cloneIndex+++"$$";return Ee(Ct,_t),_t}var Cd=function(_,C){var q=kr[_.key],Z=Me[q];if(Z instanceof Ua)V("q"),V(Ad(C)),Z.gState&&d.setGState(Z.gState),V(_.matrix.toString()+" cm"),V("/"+q+" sh"),V("Q");else if(Z instanceof sl){var ot=new Wt(1,0,0,-1,0,zs());_.matrix&&(ot=ot.multiply(_.matrix||Ri),q=Ld.call(Z,_.key,_.boundingBox,_.xStep,_.yStep,ot).id),V("q"),V("/Pattern cs"),V("/"+q+" scn"),Z.gState&&d.setGState(Z.gState),V(C),V("Q")}},Ad=function(_){switch(_){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Yl=d.moveTo=function(_,C){return V(j(F(_))+" "+j(z(C))+" m"),this},Ia=d.lineTo=function(_,C){return V(j(F(_))+" "+j(z(C))+" l"),this},js=d.curveTo=function(_,C,q,Z,ot,_t){return V([j(F(_)),j(z(C)),j(F(q)),j(z(Z)),j(F(ot)),j(z(_t)),"c"].join(" ")),this};d.__private__.line=d.line=function(_,C,q,Z,ot){if(isNaN(_)||isNaN(C)||isNaN(q)||isNaN(Z)||!Br(ot))throw new Error("Invalid arguments passed to jsPDF.line");return S===E.COMPAT?this.lines([[q-_,Z-C]],_,C,[1,1],ot||"S"):this.lines([[q-_,Z-C]],_,C,[1,1]).stroke()},d.__private__.lines=d.lines=function(_,C,q,Z,ot,_t){var Ct,jt,Jt,ge,ye,Te,fi,_i,Ni,on,qi,_r;if(typeof _=="number"&&(_r=q,q=C,C=_,_=_r),Z=Z||[1,1],_t=_t||!1,isNaN(C)||isNaN(q)||!Array.isArray(_)||!Array.isArray(Z)||!Br(ot)||typeof _t!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Yl(C,q),Ct=Z[0],jt=Z[1],ge=_.length,on=C,qi=q,Jt=0;Jt<ge;Jt++)(ye=_[Jt]).length===2?(on=ye[0]*Ct+on,qi=ye[1]*jt+qi,Ia(on,qi)):(Te=ye[0]*Ct+on,fi=ye[1]*jt+qi,_i=ye[2]*Ct+on,Ni=ye[3]*jt+qi,on=ye[4]*Ct+on,qi=ye[5]*jt+qi,js(Te,fi,_i,Ni,on,qi));return _t&&jc(),Xl(ot),this},d.path=function(_){for(var C=0;C<_.length;C++){var q=_[C],Z=q.c;switch(q.op){case"m":Yl(Z[0],Z[1]);break;case"l":Ia(Z[0],Z[1]);break;case"c":js.apply(this,Z);break;case"h":jc()}}return this},d.__private__.rect=d.rect=function(_,C,q,Z,ot){if(isNaN(_)||isNaN(C)||isNaN(q)||isNaN(Z)||!Br(ot))throw new Error("Invalid arguments passed to jsPDF.rect");return S===E.COMPAT&&(Z=-Z),V([j(F(_)),j(z(C)),j(F(q)),j(F(Z)),"re"].join(" ")),Xl(ot),this},d.__private__.triangle=d.triangle=function(_,C,q,Z,ot,_t,Ct){if(isNaN(_)||isNaN(C)||isNaN(q)||isNaN(Z)||isNaN(ot)||isNaN(_t)||!Br(Ct))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[q-_,Z-C],[ot-q,_t-Z],[_-ot,C-_t]],_,C,[1,1],Ct,!0),this},d.__private__.roundedRect=d.roundedRect=function(_,C,q,Z,ot,_t,Ct){if(isNaN(_)||isNaN(C)||isNaN(q)||isNaN(Z)||isNaN(ot)||isNaN(_t)||!Br(Ct))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var jt=4/3*(Math.SQRT2-1);return ot=Math.min(ot,.5*q),_t=Math.min(_t,.5*Z),this.lines([[q-2*ot,0],[ot*jt,0,ot,_t-_t*jt,ot,_t],[0,Z-2*_t],[0,_t*jt,-ot*jt,_t,-ot,_t],[2*ot-q,0],[-ot*jt,0,-ot,-_t*jt,-ot,-_t],[0,2*_t-Z],[0,-_t*jt,ot*jt,-_t,ot,-_t]],_+ot,C,[1,1],Ct,!0),this},d.__private__.ellipse=d.ellipse=function(_,C,q,Z,ot){if(isNaN(_)||isNaN(C)||isNaN(q)||isNaN(Z)||!Br(ot))throw new Error("Invalid arguments passed to jsPDF.ellipse");var _t=4/3*(Math.SQRT2-1)*q,Ct=4/3*(Math.SQRT2-1)*Z;return Yl(_+q,C),js(_+q,C-Ct,_+_t,C-Z,_,C-Z),js(_-_t,C-Z,_-q,C-Ct,_-q,C),js(_-q,C+Ct,_-_t,C+Z,_,C+Z),js(_+_t,C+Z,_+q,C+Ct,_+q,C),Xl(ot),this},d.__private__.circle=d.circle=function(_,C,q,Z){if(isNaN(_)||isNaN(C)||isNaN(q)||!Br(Z))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(_,C,q,q,Z)},d.setFont=function(_,C,q){return q&&(C=W(C,q)),me=Fc(_,C,{disableWarning:!1}),this};var Md=d.__private__.getFont=d.getFont=function(){return We[Fc.apply(d,arguments)]};d.__private__.getFontList=d.getFontList=function(){var _,C,q={};for(_ in $e)if($e.hasOwnProperty(_))for(C in q[_]=[],$e[_])$e[_].hasOwnProperty(C)&&q[_].push(C);return q},d.addFont=function(_,C,q,Z,ot){var _t=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&_t.indexOf(arguments[3])!==-1?ot=arguments[3]:arguments[3]&&_t.indexOf(arguments[3])==-1&&(q=W(q,Z)),ot=ot||"Identity-H",Wl.call(this,_,C,q,ot)};var Ra,Zl=i.lineWidth||.200025,bo=d.__private__.getLineWidth=d.getLineWidth=function(){return Zl},Bc=d.__private__.setLineWidth=d.setLineWidth=function(_){return Zl=_,V(j(F(_))+" w"),this};d.__private__.setLineDash=re.API.setLineDash=re.API.setLineDashPattern=function(_,C){if(_=_||[],C=C||0,isNaN(C)||!Array.isArray(_))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return _=_.map(function(q){return j(F(q))}).join(" "),C=j(F(C)),V("["+_+"] "+C+" d"),this};var Gc=d.__private__.getLineHeight=d.getLineHeight=function(){return It*Ra};d.__private__.getLineHeight=d.getLineHeight=function(){return It*Ra};var zc=d.__private__.setLineHeightFactor=d.setLineHeightFactor=function(_){return typeof(_=_||1.15)=="number"&&(Ra=_),this},qc=d.__private__.getLineHeightFactor=d.getLineHeightFactor=function(){return Ra};zc(i.lineHeight);var ls=d.__private__.getHorizontalCoordinate=function(_){return F(_)},Bs=d.__private__.getVerticalCoordinate=function(_){return S===E.ADVANCED?_:oe[G].mediaBox.topRightY-oe[G].mediaBox.bottomLeftY-F(_)},Td=d.__private__.getHorizontalCoordinateString=d.getHorizontalCoordinateString=function(_){return j(ls(_))},Gs=d.__private__.getVerticalCoordinateString=d.getVerticalCoordinateString=function(_){return j(Bs(_))},mr=i.strokeColor||"0 G";d.__private__.getStrokeColor=d.getDrawColor=function(){return dr(mr)},d.__private__.setStrokeColor=d.setDrawColor=function(_,C,q,Z){return mr=gr({ch1:_,ch2:C,ch3:q,ch4:Z,pdfColorType:"draw",precision:2}),V(mr),this};var Kl=i.fillColor||"0 g";d.__private__.getFillColor=d.getFillColor=function(){return dr(Kl)},d.__private__.setFillColor=d.setFillColor=function(_,C,q,Z){return Kl=gr({ch1:_,ch2:C,ch3:q,ch4:Z,pdfColorType:"fill",precision:2}),V(Kl),this};var Na=i.textColor||"0 g",Pd=d.__private__.getTextColor=d.getTextColor=function(){return dr(Na)};d.__private__.setTextColor=d.setTextColor=function(_,C,q,Z){return Na=gr({ch1:_,ch2:C,ch3:q,ch4:Z,pdfColorType:"text",precision:3}),this};var wo=i.charSpace,Id=d.__private__.getCharSpace=d.getCharSpace=function(){return parseFloat(wo||0)};d.__private__.setCharSpace=d.setCharSpace=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return wo=_,this};var $l=0;d.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},d.__private__.setLineCap=d.setLineCap=function(_){var C=d.CapJoinStyles[_];if(C===void 0)throw new Error("Line cap style of '"+_+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return $l=C,V(C+" J"),this};var Jl=0;d.__private__.setLineJoin=d.setLineJoin=function(_){var C=d.CapJoinStyles[_];if(C===void 0)throw new Error("Line join style of '"+_+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Jl=C,V(C+" j"),this},d.__private__.setLineMiterLimit=d.__private__.setMiterLimit=d.setLineMiterLimit=d.setMiterLimit=function(_){if(_=_||0,isNaN(_))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return V(j(F(_))+" M"),this},d.GState=yf,d.setGState=function(_){(_=typeof _=="string"?ei[Ji[_]]:Uc(null,_)).equals(vn)||(V("/"+_.id+" gs"),vn=_)};var Uc=function(_,C){if(!_||!Ji[_]){var q=!1;for(var Z in ei)if(ei.hasOwnProperty(Z)&&ei[Z].equals(C)){q=!0;break}if(q)C=ei[Z];else{var ot="GS"+(Object.keys(ei).length+1).toString(10);ei[ot]=C,C.id=ot}return _&&(Ji[_]=C.id),Pe.publish("addGState",C),C}};d.addGState=function(_,C){return Uc(_,C),this},d.saveGraphicsState=function(){return V("q"),Un.push({key:me,size:It,color:Na}),this},d.restoreGraphicsState=function(){V("Q");var _=Un.pop();return me=_.key,It=_.size,Na=_.color,vn=null,this},d.setCurrentTransformationMatrix=function(_){return V(_.toString()+" cm"),this},d.comment=function(_){return V("#"+_),this};var Eo=function(_,C){var q=_||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return q},set:function(_t){isNaN(_t)||(q=parseFloat(_t))}});var Z=C||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Z},set:function(_t){isNaN(_t)||(Z=parseFloat(_t))}});var ot="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ot},set:function(_t){ot=_t.toString()}}),this},Ql=function(_,C,q,Z){Eo.call(this,_,C),this.type="rect";var ot=q||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ot},set:function(Ct){isNaN(Ct)||(ot=parseFloat(Ct))}});var _t=Z||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return _t},set:function(Ct){isNaN(Ct)||(_t=parseFloat(Ct))}}),this},th=function(){this.page=Ye,this.currentPage=G,this.pages=At.slice(0),this.pagesContext=oe.slice(0),this.x=Di,this.y=Se,this.matrix=qn,this.width=Fa(G),this.height=zs(G),this.outputDestination=Dt,this.id="",this.objectNumber=-1};th.prototype.restore=function(){Ye=this.page,G=this.currentPage,oe=this.pagesContext,At=this.pages,Di=this.x,Se=this.y,qn=this.matrix,eh(G,this.width),ih(G,this.height),Dt=this.outputDestination};var Wc=function(_,C,q,Z,ot){wi.push(new th),Ye=G=0,At=[],Di=_,Se=C,qn=ot,Vl([q,Z])},Rd=function(_){if(ui[_])wi.pop().restore();else{var C=new th,q="Xo"+(Object.keys(ai).length+1).toString(10);C.id=q,ui[_]=q,ai[q]=C,Pe.publish("addFormObject",C),wi.pop().restore()}};for(var So in d.beginFormObject=function(_,C,q,Z,ot){return Wc(_,C,q,Z,ot),this},d.endFormObject=function(_){return Rd(_),this},d.doFormObject=function(_,C){var q=ai[ui[_]];return V("q"),V(C.toString()+" cm"),V("/"+q.id+" Do"),V("Q"),this},d.getFormObject=function(_){var C=ai[ui[_]];return{x:C.x,y:C.y,width:C.width,height:C.height,matrix:C.matrix}},d.save=function(_,C){return _=_||"generated.pdf",(C=C||{}).returnPromise=C.returnPromise||!1,C.returnPromise===!1?(za(vo(os()),_),typeof za.unload=="function"&&se.setTimeout&&setTimeout(za.unload,911),this):new Promise(function(q,Z){try{var ot=za(vo(os()),_);typeof za.unload=="function"&&se.setTimeout&&setTimeout(za.unload,911),q(ot)}catch(_t){Z(_t.message)}})},re.API)re.API.hasOwnProperty(So)&&(So==="events"&&re.API.events.length?function(_,C){var q,Z,ot;for(ot=C.length-1;ot!==-1;ot--)q=C[ot][0],Z=C[ot][1],_.subscribe.apply(_,[q].concat(typeof Z=="function"?[Z]:Z))}(Pe,re.API.events):d[So]=re.API[So]);var Fa=d.getPageWidth=function(_){return(oe[_=_||G].mediaBox.topRightX-oe[_].mediaBox.bottomLeftX)/Pt},eh=d.setPageWidth=function(_,C){oe[_].mediaBox.topRightX=C*Pt+oe[_].mediaBox.bottomLeftX},zs=d.getPageHeight=function(_){return(oe[_=_||G].mediaBox.topRightY-oe[_].mediaBox.bottomLeftY)/Pt},ih=d.setPageHeight=function(_,C){oe[_].mediaBox.topRightY=C*Pt+oe[_].mediaBox.bottomLeftY};return d.internal={pdfEscape:An,getStyle:Dc,getFont:Md,getFontSize:Tt,getCharSpace:Id,getTextColor:Pd,getLineHeight:Gc,getLineHeightFactor:qc,getLineWidth:bo,write:ne,getHorizontalCoordinate:ls,getVerticalCoordinate:Bs,getCoordinateString:Td,getVerticalCoordinateString:Gs,collections:{},newObject:Ae,newAdditionalObject:ho,newObjectDeferred:je,newObjectDeferredBegin:yn,getFilters:Dr,putStream:tr,events:Pe,scaleFactor:Pt,pageSize:{getWidth:function(){return Fa(G)},setWidth:function(_){eh(G,_)},getHeight:function(){return zs(G)},setHeight:function(_){ih(G,_)}},encryptionOptions:c,encryption:an,getEncryptor:wd,output:yo,getNumberOfPages:_d,pages:At,out:V,f2:et,f3:R,getPageInfo:kc,getPageInfoByObjId:ce,getCurrentPageInfo:Ed,getPDFVersion:y,Point:Eo,Rectangle:Ql,Matrix:Wt,hasHotfix:Oc},Object.defineProperty(d.internal.pageSize,"width",{get:function(){return Fa(G)},set:function(_){eh(G,_)},enumerable:!0,configurable:!0}),Object.defineProperty(d.internal.pageSize,"height",{get:function(){return zs(G)},set:function(_){ih(G,_)},enumerable:!0,configurable:!0}),pd.call(d,Lt),me="F1",Rc(r,e),Pe.publish("initialized"),d}Qo.prototype.lsbFirstWord=function(i){return String.fromCharCode(i>>0&255,i>>8&255,i>>16&255,i>>24&255)},Qo.prototype.toHexString=function(i){return i.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Qo.prototype.hexToBytes=function(i){for(var t=[],e=0;e<i.length;e+=2)t.push(String.fromCharCode(parseInt(i.substr(e,2),16)));return t.join("")},Qo.prototype.processOwnerPassword=function(i,t){return _0(m0(t).substr(0,5),i)},Qo.prototype.encryptor=function(i,t){var e=m0(this.encryptionKey+String.fromCharCode(255&i,i>>8&255,i>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return _0(e,n)}},yf.prototype.equals=function(i){var t,e="id,objectNumber,equals";if(!i||Xe(i)!==Xe(this))return!1;var n=0;for(t in this)if(!(e.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!i.hasOwnProperty(t)||this[t]!==i[t])return!1;n++}for(t in i)i.hasOwnProperty(t)&&e.indexOf(t)<0&&n--;return n===0},re.API={events:[]},re.version="2.5.1";var yi=re.API,A1=1,lo=function(i){return i.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},zo=function(i){return i.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},de=function(i){return i.toFixed(2)},sa=function(i){return i.toFixed(5)};yi.__acroform__={};var Gn=function(i,t){i.prototype=Object.create(t.prototype),i.prototype.constructor=i},Am=function(i){return i*A1},Vr=function(i){var t=new cv,e=Ut.internal.getHeight(i)||0,n=Ut.internal.getWidth(i)||0;return t.BBox=[0,0,Number(de(n)),Number(de(e))],t},nE=yi.__acroform__.setBit=function(i,t){if(i=i||0,t=t||0,isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return i|=1<<t},rE=yi.__acroform__.clearBit=function(i,t){if(i=i||0,t=t||0,isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return i&=~(1<<t)},sE=yi.__acroform__.getBit=function(i,t){if(isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return i&1<<t?1:0},Mi=yi.__acroform__.getBitForPdf=function(i,t){if(isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return sE(i,t-1)},Ti=yi.__acroform__.setBitForPdf=function(i,t){if(isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return nE(i,t-1)},Pi=yi.__acroform__.clearBitForPdf=function(i,t){if(isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return rE(i,t-1)},aE=yi.__acroform__.calculateCoordinates=function(i,t){var e=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,r=i[0],s=i[1],a=i[2],o=i[3],l={};return l.lowerLeft_X=e(r)||0,l.lowerLeft_Y=n(s+o)||0,l.upperRight_X=e(r+a)||0,l.upperRight_Y=n(s)||0,[Number(de(l.lowerLeft_X)),Number(de(l.lowerLeft_Y)),Number(de(l.upperRight_X)),Number(de(l.upperRight_Y))]},oE=function(i){if(i.appearanceStreamContent)return i.appearanceStreamContent;if(i.V||i.DV){var t=[],e=i._V||i.DV,n=v0(i,e),r=i.scope.internal.getFont(i.fontName,i.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(i.scope.__private__.encodeColorString(i.color)),t.push("/"+r+" "+de(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=Vr(i);return s.scope=i.scope,s.stream=t.join(`
`),s}},v0=function(i,t){var e=i.fontSize===0?i.maxFontSize:i.fontSize,n={text:"",fontSize:""},r=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");r=i.multiline?r.map(function(R){return R.split(`
`)}):r.map(function(R){return[R]});var s=e,a=Ut.internal.getHeight(i)||0;a=a<0?-a:a;var o=Ut.internal.getWidth(i)||0;o=o<0?-o:o;var l=function(R,F,U){if(R+1<r.length){var z=F+" "+r[R+1][0];return Iu(z,i,U).width<=o-4}return!1};s++;t:for(;s>0;){t="",s--;var h,c,f=Iu("3",i,s).height,g=i.multiline?a-s:(a-f)/2,d=g+=2,m=0,y=0,b=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+Iu(t,i,s=12).width+", FieldWidth:"+o+`
`;break}for(var x="",E=0,S=0;S<r.length;S++)if(r.hasOwnProperty(S)){var M=!1;if(r[S].length!==1&&b!==r[S].length-1){if((f+2)*(E+2)+2>a)continue t;x+=r[S][b],M=!0,y=S,S--}else{x=(x+=r[S][b]+" ").substr(x.length-1)==" "?x.substr(0,x.length-1):x;var D=parseInt(S),W=l(D,x,s),j=S>=r.length-1;if(W&&!j){x+=" ",b=0;continue}if(W||j){if(j)y=D;else if(i.multiline&&(f+2)*(E+2)+2>a)continue t}else{if(!i.multiline||(f+2)*(E+2)+2>a)continue t;y=D}}for(var P="",H=m;H<=y;H++){var et=r[H];if(i.multiline){if(H===y){P+=et[b]+" ",b=(b+1)%et.length;continue}if(H===m){P+=et[et.length-1]+" ";continue}}P+=et[0]+" "}switch(P=P.substr(P.length-1)==" "?P.substr(0,P.length-1):P,c=Iu(P,i,s).width,i.textAlign){case"right":h=o-c-2;break;case"center":h=(o-c)/2;break;case"left":default:h=2}t+=de(h)+" "+de(d)+` Td
`,t+="("+lo(P)+`) Tj
`,t+=-de(h)+` 0 Td
`,d=-(s+2),c=0,m=M?y:y+1,E++,x=""}break}return n.text=t,n.fontSize=s,n},Iu=function(i,t,e){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),r=t.scope.getStringUnitWidth(i,{font:n,fontSize:parseFloat(e),charSpace:0})*parseFloat(e);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(e),charSpace:0})*parseFloat(e)*1.5,width:r}},lE={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},hE=function(i,t){var e={type:"reference",object:i};t.internal.getPageInfo(i.page).pageContext.annotations.find(function(n){return n.type===e.type&&n.object===e.object})===void 0&&t.internal.getPageInfo(i.page).pageContext.annotations.push(e)},cE=function(i,t){for(var e in i)if(i.hasOwnProperty(e)){var n=e,r=i[e];t.internal.newObjectDeferredBegin(r.objId,!0),Xe(r)==="object"&&typeof r.putStream=="function"&&r.putStream(),delete i[n]}},uE=function(i,t){if(t.scope=i,i.internal!==void 0&&(i.internal.acroformPlugin===void 0||i.internal.acroformPlugin.isInitialized===!1)){if(Fr.FieldNum=0,i.internal.acroformPlugin=JSON.parse(JSON.stringify(lE)),i.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");A1=i.internal.scaleFactor,i.internal.acroformPlugin.acroFormDictionaryRoot=new uv,i.internal.acroformPlugin.acroFormDictionaryRoot.scope=i,i.internal.acroformPlugin.acroFormDictionaryRoot._eventID=i.internal.events.subscribe("postPutResources",function(){(function(e){e.internal.events.unsubscribe(e.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete e.internal.acroformPlugin.acroFormDictionaryRoot._eventID,e.internal.acroformPlugin.printedOut=!0})(i)}),i.internal.events.subscribe("buildDocument",function(){(function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var r in n)if(n.hasOwnProperty(r)){var s=n[r];s.objId=void 0,s.hasAnnotation&&hE(s,e)}})(i)}),i.internal.events.subscribe("putCatalog",function(){(function(e){if(e.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(i)}),i.internal.events.subscribe("postPutPages",function(e){(function(n,r){var s=!n;for(var a in n||(r.internal.newObjectDeferredBegin(r.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),r.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||r.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(a)){var o=n[a],l=[],h=o.Rect;if(o.Rect&&(o.Rect=aE(o.Rect,r)),r.internal.newObjectDeferredBegin(o.objId,!0),o.DA=Ut.createDefaultAppearanceStream(o),Xe(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=h,o.hasAppearanceStream&&!o.appearanceStreamContent){var c=oE(o);l.push({key:"AP",value:"<</N "+c+">>"}),r.internal.acroformPlugin.xForms.push(c)}if(o.appearanceStreamContent){var f="";for(var g in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(g)){var d=o.appearanceStreamContent[g];if(f+="/"+g+" ",f+="<<",Object.keys(d).length>=1||Array.isArray(d)){for(var a in d)if(d.hasOwnProperty(a)){var m=d[a];typeof m=="function"&&(m=m.call(r,o)),f+="/"+a+" "+m+" ",r.internal.acroformPlugin.xForms.indexOf(m)>=0||r.internal.acroformPlugin.xForms.push(m)}}else typeof(m=d)=="function"&&(m=m.call(r,o)),f+="/"+a+" "+m,r.internal.acroformPlugin.xForms.indexOf(m)>=0||r.internal.acroformPlugin.xForms.push(m);f+=">>"}l.push({key:"AP",value:`<<
`+f+">>"})}r.internal.putStream({additionalKeyValues:l,objectId:o.objId}),r.internal.out("endobj")}s&&cE(r.internal.acroformPlugin.xForms,r)})(e,i)}),i.internal.acroformPlugin.isInitialized=!0}},hv=yi.__acroform__.arrayToPdfArray=function(i,t,e){var n=function(a){return a};if(Array.isArray(i)){for(var r="[",s=0;s<i.length;s++)switch(s!==0&&(r+=" "),Xe(i[s])){case"boolean":case"number":case"object":r+=i[s].toString();break;case"string":i[s].substr(0,1)!=="/"?(t!==void 0&&e&&(n=e.internal.getEncryptor(t)),r+="("+lo(n(i[s].toString()))+")"):r+=i[s].toString()}return r+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Eg=function(i,t,e){var n=function(r){return r};return t!==void 0&&e&&(n=e.internal.getEncryptor(t)),(i=i||"").toString(),i="("+lo(n(i))+")"},$r=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(i){this._objId=i}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};$r.prototype.toString=function(){return this.objId+" 0 R"},$r.prototype.putStream=function(){var i=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:i,objectId:this.objId}),this.scope.internal.out("endobj")},$r.prototype.getKeyValueListForStream=function(){var i=[],t=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var e in t)if(Object.getOwnPropertyDescriptor(this,t[e]).configurable===!1){var n=t[e],r=this[n];r&&(Array.isArray(r)?i.push({key:n,value:hv(r,this.objId,this.scope)}):r instanceof $r?(r.scope=this.scope,i.push({key:n,value:r.objId+" 0 R"})):typeof r!="function"&&i.push({key:n,value:r}))}return i};var cv=function(){$r.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var i,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(e){i=e.trim()},get:function(){return i||null}})};Gn(cv,$r);var uv=function(){$r.call(this);var i,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(i){var e=function(n){return n};return this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),"("+lo(e(i))+")"}},set:function(e){i=e}})};Gn(uv,$r);var Fr=function i(){$r.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute F supplied.');t=x}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Mi(t,3)},set:function(x){x?this.F=Ti(t,3):this.F=Pi(t,3)}});var e=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return e},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute Ff supplied.');e=x}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(x){n=x!==void 0?x:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(x){n[0]=x}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(x){n[1]=x}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(x){n[2]=x}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(x){n[3]=x}});var r="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return r},set:function(x){switch(x){case"/Btn":case"/Tx":case"/Ch":case"/Sig":r=x;break;default:throw new Error('Invalid value "'+x+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof xf)return;s="FieldObject"+i.FieldNum++}var x=function(E){return E};return this.scope&&(x=this.scope.internal.getEncryptor(this.objId)),"("+lo(x(s))+")"},set:function(x){s=x.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(x){s=x}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(x){a=x}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(x){o=x}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(x){l=x}});var h=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return h===void 0?50/A1:h},set:function(x){h=x}});var c="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return c},set:function(x){c=x}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof xf||this instanceof Ja))return Eg(f,this.objId,this.scope)},set:function(x){x=x.toString(),f=x}});var g=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof Xi?g:Eg(g,this.objId,this.scope)},set:function(x){x=x.toString(),g=this instanceof Xi?x:x.substr(0,1)==="("?zo(x.substr(1,x.length-2)):zo(x)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Xi?zo(g.substr(1,g.length-1)):g},set:function(x){x=x.toString(),g=this instanceof Xi?"/"+x:x}});var d=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(d)return d},set:function(x){this.V=x}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(d)return this instanceof Xi?d:Eg(d,this.objId,this.scope)},set:function(x){x=x.toString(),d=this instanceof Xi?x:x.substr(0,1)==="("?zo(x.substr(1,x.length-2)):zo(x)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Xi?zo(d.substr(1,d.length-1)):d},set:function(x){x=x.toString(),d=this instanceof Xi?"/"+x:x}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,y=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return y},set:function(x){x=!!x,y=x}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(x){m=x}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Mi(this.Ff,1)},set:function(x){x?this.Ff=Ti(this.Ff,1):this.Ff=Pi(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Mi(this.Ff,2)},set:function(x){x?this.Ff=Ti(this.Ff,2):this.Ff=Pi(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Mi(this.Ff,3)},set:function(x){x?this.Ff=Ti(this.Ff,3):this.Ff=Pi(this.Ff,3)}});var b=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(b!==null)return b},set:function(x){if([0,1,2].indexOf(x)===-1)throw new Error('Invalid value "'+x+'" for attribute Q supplied.');b=x}}),Object.defineProperty(this,"textAlign",{get:function(){var x;switch(b){case 0:default:x="left";break;case 1:x="center";break;case 2:x="right"}return x},configurable:!0,enumerable:!0,set:function(x){switch(x){case"right":case 2:b=2;break;case"center":case 1:b=1;break;case"left":case 0:default:b=0}}})};Gn(Fr,$r);var pl=function(){Fr.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var i=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return i},set:function(e){i=e}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return i},set:function(e){i=e}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return hv(t,this.objId,this.scope)},set:function(e){var n,r;r=[],typeof(n=e)=="string"&&(r=function(s,a,o){o||(o=1);for(var l,h=[];l=a.exec(s);)h.push(l[o]);return h}(n,/\((.*?)\)/g)),t=r}}),this.getOptions=function(){return t},this.setOptions=function(e){t=e,this.sort&&t.sort()},this.addOption=function(e){e=(e=e||"").toString(),t.push(e),this.sort&&t.sort()},this.removeOption=function(e,n){for(n=n||!1,e=(e=e||"").toString();t.indexOf(e)!==-1&&(t.splice(t.indexOf(e),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Mi(this.Ff,18)},set:function(e){e?this.Ff=Ti(this.Ff,18):this.Ff=Pi(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Mi(this.Ff,19)},set:function(e){this.combo===!0&&(e?this.Ff=Ti(this.Ff,19):this.Ff=Pi(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Mi(this.Ff,20)},set:function(e){e?(this.Ff=Ti(this.Ff,20),t.sort()):this.Ff=Pi(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Mi(this.Ff,22)},set:function(e){e?this.Ff=Ti(this.Ff,22):this.Ff=Pi(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Mi(this.Ff,23)},set:function(e){e?this.Ff=Ti(this.Ff,23):this.Ff=Pi(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Mi(this.Ff,27)},set:function(e){e?this.Ff=Ti(this.Ff,27):this.Ff=Pi(this.Ff,27)}}),this.hasAppearanceStream=!1};Gn(pl,Fr);var ml=function(){pl.call(this),this.fontName="helvetica",this.combo=!1};Gn(ml,pl);var _l=function(){ml.call(this),this.combo=!0};Gn(_l,ml);var Wu=function(){_l.call(this),this.edit=!0};Gn(Wu,_l);var Xi=function(){Fr.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Mi(this.Ff,15)},set:function(e){e?this.Ff=Ti(this.Ff,15):this.Ff=Pi(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Mi(this.Ff,16)},set:function(e){e?this.Ff=Ti(this.Ff,16):this.Ff=Pi(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Mi(this.Ff,17)},set:function(e){e?this.Ff=Ti(this.Ff,17):this.Ff=Pi(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Mi(this.Ff,26)},set:function(e){e?this.Ff=Ti(this.Ff,26):this.Ff=Pi(this.Ff,26)}});var i,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(s){return s};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,r=[];for(n in r.push("<<"),t)r.push("/"+n+" ("+lo(e(t[n]))+")");return r.push(">>"),r.join(`
`)}},set:function(e){Xe(e)==="object"&&(t=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(e){typeof e=="string"&&(t.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return i},set:function(e){i=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return i.substr(1,i.length-1)},set:function(e){i="/"+e}})};Gn(Xi,Fr);var Vu=function(){Xi.call(this),this.pushButton=!0};Gn(Vu,Xi);var vl=function(){Xi.call(this),this.radio=!0,this.pushButton=!1;var i=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return i},set:function(t){i=t!==void 0?t:[]}})};Gn(vl,Xi);var xf=function(){var i,t;Fr.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return i},set:function(r){i=r}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(r){t=r}});var e,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(o){return o};this.scope&&(r=this.scope.internal.getEncryptor(this.objId));var s,a=[];for(s in a.push("<<"),n)a.push("/"+s+" ("+lo(r(n[s]))+")");return a.push(">>"),a.join(`
`)},set:function(r){Xe(r)==="object"&&(n=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(r){typeof r=="string"&&(n.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Ut.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Gn(xf,Fr),vl.prototype.setAppearance=function(i){if(!("createAppearanceStream"in i)||!("getCA"in i))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var e=this.Kids[t];e.appearanceStreamContent=i.createAppearanceStream(e.optionName),e.caption=i.getCA()}},vl.prototype.createOption=function(i){var t=new xf;return t.Parent=this,t.optionName=i,this.Kids.push(t),fE.call(this.scope,t),t};var Hu=function(){Xi.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Ut.CheckBox.createAppearanceStream()};Gn(Hu,Xi);var Ja=function(){Fr.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Mi(this.Ff,13)},set:function(t){t?this.Ff=Ti(this.Ff,13):this.Ff=Pi(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Mi(this.Ff,21)},set:function(t){t?this.Ff=Ti(this.Ff,21):this.Ff=Pi(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Mi(this.Ff,23)},set:function(t){t?this.Ff=Ti(this.Ff,23):this.Ff=Pi(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Mi(this.Ff,24)},set:function(t){t?this.Ff=Ti(this.Ff,24):this.Ff=Pi(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Mi(this.Ff,25)},set:function(t){t?this.Ff=Ti(this.Ff,25):this.Ff=Pi(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Mi(this.Ff,26)},set:function(t){t?this.Ff=Ti(this.Ff,26):this.Ff=Pi(this.Ff,26)}});var i=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return i},set:function(t){i=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return i},set:function(t){Number.isInteger(t)&&(i=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Gn(Ja,Fr);var Xu=function(){Ja.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Mi(this.Ff,14)},set:function(i){i?this.Ff=Ti(this.Ff,14):this.Ff=Pi(this.Ff,14)}}),this.password=!0};Gn(Xu,Ja);var Ut={CheckBox:{createAppearanceStream:function(){return{N:{On:Ut.CheckBox.YesNormal},D:{On:Ut.CheckBox.YesPushDown,Off:Ut.CheckBox.OffPushDown}}},YesPushDown:function(i){var t=Vr(i);t.scope=i.scope;var e=[],n=i.scope.internal.getFont(i.fontName,i.fontStyle).id,r=i.scope.__private__.encodeColorString(i.color),s=v0(i,i.caption);return e.push("0.749023 g"),e.push("0 0 "+de(Ut.internal.getWidth(i))+" "+de(Ut.internal.getHeight(i))+" re"),e.push("f"),e.push("BMC"),e.push("q"),e.push("0 0 1 rg"),e.push("/"+n+" "+de(s.fontSize)+" Tf "+r),e.push("BT"),e.push(s.text),e.push("ET"),e.push("Q"),e.push("EMC"),t.stream=e.join(`
`),t},YesNormal:function(i){var t=Vr(i);t.scope=i.scope;var e=i.scope.internal.getFont(i.fontName,i.fontStyle).id,n=i.scope.__private__.encodeColorString(i.color),r=[],s=Ut.internal.getHeight(i),a=Ut.internal.getWidth(i),o=v0(i,i.caption);return r.push("1 g"),r.push("0 0 "+de(a)+" "+de(s)+" re"),r.push("f"),r.push("q"),r.push("0 0 1 rg"),r.push("0 0 "+de(a-1)+" "+de(s-1)+" re"),r.push("W"),r.push("n"),r.push("0 g"),r.push("BT"),r.push("/"+e+" "+de(o.fontSize)+" Tf "+n),r.push(o.text),r.push("ET"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(i){var t=Vr(i);t.scope=i.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+de(Ut.internal.getWidth(i))+" "+de(Ut.internal.getHeight(i))+" re"),e.push("f"),t.stream=e.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(i){var t={D:{Off:Ut.RadioButton.Circle.OffPushDown},N:{}};return t.N[i]=Ut.RadioButton.Circle.YesNormal,t.D[i]=Ut.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(i){var t=Vr(i);t.scope=i.scope;var e=[],n=Ut.internal.getWidth(i)<=Ut.internal.getHeight(i)?Ut.internal.getWidth(i)/4:Ut.internal.getHeight(i)/4;n=Number((.9*n).toFixed(5));var r=Ut.internal.Bezier_C,s=Number((n*r).toFixed(5));return e.push("q"),e.push("1 0 0 1 "+sa(Ut.internal.getWidth(i)/2)+" "+sa(Ut.internal.getHeight(i)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),e.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),e.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),e.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t},YesPushDown:function(i){var t=Vr(i);t.scope=i.scope;var e=[],n=Ut.internal.getWidth(i)<=Ut.internal.getHeight(i)?Ut.internal.getWidth(i)/4:Ut.internal.getHeight(i)/4;n=Number((.9*n).toFixed(5));var r=Number((2*n).toFixed(5)),s=Number((r*Ut.internal.Bezier_C).toFixed(5)),a=Number((n*Ut.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+sa(Ut.internal.getWidth(i)/2)+" "+sa(Ut.internal.getHeight(i)/2)+" cm"),e.push(r+" 0 m"),e.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),e.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),e.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),e.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),e.push("f"),e.push("Q"),e.push("0 g"),e.push("q"),e.push("1 0 0 1 "+sa(Ut.internal.getWidth(i)/2)+" "+sa(Ut.internal.getHeight(i)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),e.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),e.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),e.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t},OffPushDown:function(i){var t=Vr(i);t.scope=i.scope;var e=[],n=Ut.internal.getWidth(i)<=Ut.internal.getHeight(i)?Ut.internal.getWidth(i)/4:Ut.internal.getHeight(i)/4;n=Number((.9*n).toFixed(5));var r=Number((2*n).toFixed(5)),s=Number((r*Ut.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+sa(Ut.internal.getWidth(i)/2)+" "+sa(Ut.internal.getHeight(i)/2)+" cm"),e.push(r+" 0 m"),e.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),e.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),e.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),e.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t}},Cross:{createAppearanceStream:function(i){var t={D:{Off:Ut.RadioButton.Cross.OffPushDown},N:{}};return t.N[i]=Ut.RadioButton.Cross.YesNormal,t.D[i]=Ut.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(i){var t=Vr(i);t.scope=i.scope;var e=[],n=Ut.internal.calculateCross(i);return e.push("q"),e.push("1 1 "+de(Ut.internal.getWidth(i)-2)+" "+de(Ut.internal.getHeight(i)-2)+" re"),e.push("W"),e.push("n"),e.push(de(n.x1.x)+" "+de(n.x1.y)+" m"),e.push(de(n.x2.x)+" "+de(n.x2.y)+" l"),e.push(de(n.x4.x)+" "+de(n.x4.y)+" m"),e.push(de(n.x3.x)+" "+de(n.x3.y)+" l"),e.push("s"),e.push("Q"),t.stream=e.join(`
`),t},YesPushDown:function(i){var t=Vr(i);t.scope=i.scope;var e=Ut.internal.calculateCross(i),n=[];return n.push("0.749023 g"),n.push("0 0 "+de(Ut.internal.getWidth(i))+" "+de(Ut.internal.getHeight(i))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+de(Ut.internal.getWidth(i)-2)+" "+de(Ut.internal.getHeight(i)-2)+" re"),n.push("W"),n.push("n"),n.push(de(e.x1.x)+" "+de(e.x1.y)+" m"),n.push(de(e.x2.x)+" "+de(e.x2.y)+" l"),n.push(de(e.x4.x)+" "+de(e.x4.y)+" m"),n.push(de(e.x3.x)+" "+de(e.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(i){var t=Vr(i);t.scope=i.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+de(Ut.internal.getWidth(i))+" "+de(Ut.internal.getHeight(i))+" re"),e.push("f"),t.stream=e.join(`
`),t}}},createDefaultAppearanceStream:function(i){var t=i.scope.internal.getFont(i.fontName,i.fontStyle).id,e=i.scope.__private__.encodeColorString(i.color);return"/"+t+" "+i.fontSize+" Tf "+e}};Ut.internal={Bezier_C:.551915024494,calculateCross:function(i){var t=Ut.internal.getWidth(i),e=Ut.internal.getHeight(i),n=Math.min(t,e);return{x1:{x:(t-n)/2,y:(e-n)/2+n},x2:{x:(t-n)/2+n,y:(e-n)/2},x3:{x:(t-n)/2,y:(e-n)/2},x4:{x:(t-n)/2+n,y:(e-n)/2+n}}}},Ut.internal.getWidth=function(i){var t=0;return Xe(i)==="object"&&(t=Am(i.Rect[2])),t},Ut.internal.getHeight=function(i){var t=0;return Xe(i)==="object"&&(t=Am(i.Rect[3])),t};var fE=yi.addField=function(i){if(uE(this,i),!(i instanceof Fr))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=i).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),i.page=i.scope.internal.getCurrentPageInfo().pageNumber,this};yi.AcroFormChoiceField=pl,yi.AcroFormListBox=ml,yi.AcroFormComboBox=_l,yi.AcroFormEditBox=Wu,yi.AcroFormButton=Xi,yi.AcroFormPushButton=Vu,yi.AcroFormRadioButton=vl,yi.AcroFormCheckBox=Hu,yi.AcroFormTextField=Ja,yi.AcroFormPasswordField=Xu,yi.AcroFormAppearance=Ut,yi.AcroForm={ChoiceField:pl,ListBox:ml,ComboBox:_l,EditBox:Wu,Button:Xi,PushButton:Vu,RadioButton:vl,CheckBox:Hu,TextField:Ja,PasswordField:Xu,Appearance:Ut},re.AcroForm={ChoiceField:pl,ListBox:ml,ComboBox:_l,EditBox:Wu,Button:Xi,PushButton:Vu,RadioButton:vl,CheckBox:Hu,TextField:Ja,PasswordField:Xu,Appearance:Ut};function fv(i){return i.reduce(function(t,e,n){return t[e]=n,t},{})}(function(i){i.__addimage__={};var t="UNKNOWN",e={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=i.__addimage__.getImageFileTypeByImageData=function(R,F){var U,z,it,Y,st,Q=t;if((F=F||t)==="RGBA"||R.data!==void 0&&R.data instanceof Uint8ClampedArray&&"height"in R&&"width"in R)return"RGBA";if(W(R))for(st in e)for(it=e[st],U=0;U<it.length;U+=1){for(Y=!0,z=0;z<it[U].length;z+=1)if(it[U][z]!==void 0&&it[U][z]!==R[z]){Y=!1;break}if(Y===!0){Q=st;break}}else for(st in e)for(it=e[st],U=0;U<it.length;U+=1){for(Y=!0,z=0;z<it[U].length;z+=1)if(it[U][z]!==void 0&&it[U][z]!==R.charCodeAt(z)){Y=!1;break}if(Y===!0){Q=st;break}}return Q===t&&F!==t&&(Q=F),Q},r=function R(F){for(var U=this.internal.write,z=this.internal.putStream,it=(0,this.internal.getFilters)();it.indexOf("FlateEncode")!==-1;)it.splice(it.indexOf("FlateEncode"),1);F.objectId=this.internal.newObject();var Y=[];if(Y.push({key:"Type",value:"/XObject"}),Y.push({key:"Subtype",value:"/Image"}),Y.push({key:"Width",value:F.width}),Y.push({key:"Height",value:F.height}),F.colorSpace===b.INDEXED?Y.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(F.palette.length/3-1)+" "+("sMask"in F&&F.sMask!==void 0?F.objectId+2:F.objectId+1)+" 0 R]"}):(Y.push({key:"ColorSpace",value:"/"+F.colorSpace}),F.colorSpace===b.DEVICE_CMYK&&Y.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Y.push({key:"BitsPerComponent",value:F.bitsPerComponent}),"decodeParameters"in F&&F.decodeParameters!==void 0&&Y.push({key:"DecodeParms",value:"<<"+F.decodeParameters+">>"}),"transparency"in F&&Array.isArray(F.transparency)){for(var st="",Q=0,gt=F.transparency.length;Q<gt;Q++)st+=F.transparency[Q]+" "+F.transparency[Q]+" ";Y.push({key:"Mask",value:"["+st+"]"})}F.sMask!==void 0&&Y.push({key:"SMask",value:F.objectId+1+" 0 R"});var lt=F.filter!==void 0?["/"+F.filter]:void 0;if(z({data:F.data,additionalKeyValues:Y,alreadyAppliedFilters:lt,objectId:F.objectId}),U("endobj"),"sMask"in F&&F.sMask!==void 0){var Et="/Predictor "+F.predictor+" /Colors 1 /BitsPerComponent "+F.bitsPerComponent+" /Columns "+F.width,A={width:F.width,height:F.height,colorSpace:"DeviceGray",bitsPerComponent:F.bitsPerComponent,decodeParameters:Et,data:F.sMask};"filter"in F&&(A.filter=F.filter),R.call(this,A)}if(F.colorSpace===b.INDEXED){var G=this.internal.newObject();z({data:P(new Uint8Array(F.palette)),objectId:G}),U("endobj")}},s=function(){var R=this.internal.collections.addImage_images;for(var F in R)r.call(this,R[F])},a=function(){var R,F=this.internal.collections.addImage_images,U=this.internal.write;for(var z in F)U("/I"+(R=F[z]).index,R.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",a))},l=function(){var R=this.internal.collections.addImage_images;return o.call(this),R},h=function(){return Object.keys(this.internal.collections.addImage_images).length},c=function(R){return typeof i["process"+R.toUpperCase()]=="function"},f=function(R){return Xe(R)==="object"&&R.nodeType===1},g=function(R,F){if(R.nodeName==="IMG"&&R.hasAttribute("src")){var U=""+R.getAttribute("src");if(U.indexOf("data:image/")===0)return Oh(unescape(U).split("base64,").pop());var z=i.loadFile(U,!0);if(z!==void 0)return z}if(R.nodeName==="CANVAS"){if(R.width===0||R.height===0)throw new Error("Given canvas must have data. Canvas width: "+R.width+", height: "+R.height);var it;switch(F){case"PNG":it="image/png";break;case"WEBP":it="image/webp";break;case"JPEG":case"JPG":default:it="image/jpeg"}return Oh(R.toDataURL(it,1).split("base64,").pop())}},d=function(R){var F=this.internal.collections.addImage_images;if(F){for(var U in F)if(R===F[U].alias)return F[U]}},m=function(R,F,U){return R||F||(R=-96,F=-96),R<0&&(R=-1*U.width*72/R/this.internal.scaleFactor),F<0&&(F=-1*U.height*72/F/this.internal.scaleFactor),R===0&&(R=F*U.width/U.height),F===0&&(F=R*U.height/U.width),[R,F]},y=function(R,F,U,z,it,Y){var st=m.call(this,U,z,it),Q=this.internal.getCoordinateString,gt=this.internal.getVerticalCoordinateString,lt=l.call(this);if(U=st[0],z=st[1],lt[it.index]=it,Y){Y*=Math.PI/180;var Et=Math.cos(Y),A=Math.sin(Y),G=function(X){return X.toFixed(4)},O=[G(Et),G(A),G(-1*A),G(Et),0,0,"cm"]}this.internal.write("q"),Y?(this.internal.write([1,"0","0",1,Q(R),gt(F+z),"cm"].join(" ")),this.internal.write(O.join(" ")),this.internal.write([Q(U),"0","0",Q(z),"0","0","cm"].join(" "))):this.internal.write([Q(U),"0","0",Q(z),Q(R),gt(F+z),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+it.index+" Do"),this.internal.write("Q")},b=i.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};i.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var x=i.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},E=i.__addimage__.sHashCode=function(R){var F,U,z=0;if(typeof R=="string")for(U=R.length,F=0;F<U;F++)z=(z<<5)-z+R.charCodeAt(F),z|=0;else if(W(R))for(U=R.byteLength/2,F=0;F<U;F++)z=(z<<5)-z+R[F],z|=0;return z},S=i.__addimage__.validateStringAsBase64=function(R){(R=R||"").toString().trim();var F=!0;return R.length===0&&(F=!1),R.length%4!=0&&(F=!1),/^[A-Za-z0-9+/]+$/.test(R.substr(0,R.length-2))===!1&&(F=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(R.substr(-2))===!1&&(F=!1),F},M=i.__addimage__.extractImageFromDataUrl=function(R){var F=(R=R||"").split("base64,"),U=null;if(F.length===2){var z=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(F[0]);Array.isArray(z)&&(U={mimeType:z[1],charset:z[2],data:F[1]})}return U},D=i.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};i.__addimage__.isArrayBuffer=function(R){return D()&&R instanceof ArrayBuffer};var W=i.__addimage__.isArrayBufferView=function(R){return D()&&typeof Uint32Array<"u"&&(R instanceof Int8Array||R instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&R instanceof Uint8ClampedArray||R instanceof Int16Array||R instanceof Uint16Array||R instanceof Int32Array||R instanceof Uint32Array||R instanceof Float32Array||R instanceof Float64Array)},j=i.__addimage__.binaryStringToUint8Array=function(R){for(var F=R.length,U=new Uint8Array(F),z=0;z<F;z++)U[z]=R.charCodeAt(z);return U},P=i.__addimage__.arrayBufferToBinaryString=function(R){for(var F="",U=W(R)?R:new Uint8Array(R),z=0;z<U.length;z+=8192)F+=String.fromCharCode.apply(null,U.subarray(z,z+8192));return F};i.addImage=function(){var R,F,U,z,it,Y,st,Q,gt;if(typeof arguments[1]=="number"?(F=t,U=arguments[1],z=arguments[2],it=arguments[3],Y=arguments[4],st=arguments[5],Q=arguments[6],gt=arguments[7]):(F=arguments[1],U=arguments[2],z=arguments[3],it=arguments[4],Y=arguments[5],st=arguments[6],Q=arguments[7],gt=arguments[8]),Xe(R=arguments[0])==="object"&&!f(R)&&"imageData"in R){var lt=R;R=lt.imageData,F=lt.format||F||t,U=lt.x||U||0,z=lt.y||z||0,it=lt.w||lt.width||it,Y=lt.h||lt.height||Y,st=lt.alias||st,Q=lt.compression||Q,gt=lt.rotation||lt.angle||gt}var Et=this.internal.getFilters();if(Q===void 0&&Et.indexOf("FlateEncode")!==-1&&(Q="SLOW"),isNaN(U)||isNaN(z))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var A=H.call(this,R,F,st,Q);return y.call(this,U,z,it,Y,A,gt),this};var H=function(R,F,U,z){var it,Y,st;if(typeof R=="string"&&n(R)===t){R=unescape(R);var Q=et(R,!1);(Q!==""||(Q=i.loadFile(R,!0))!==void 0)&&(R=Q)}if(f(R)&&(R=g(R,F)),F=n(R,F),!c(F))throw new Error("addImage does not support files of type '"+F+"', please ensure that a plugin for '"+F+"' support is added.");if(((st=U)==null||st.length===0)&&(U=function(gt){return typeof gt=="string"||W(gt)?E(gt):W(gt.data)?E(gt.data):null}(R)),(it=d.call(this,U))||(D()&&(R instanceof Uint8Array||F==="RGBA"||(Y=R,R=j(R))),it=this["process"+F.toUpperCase()](R,h.call(this),U,function(gt){return gt&&typeof gt=="string"&&(gt=gt.toUpperCase()),gt in i.image_compression?gt:x.NONE}(z),Y)),!it)throw new Error("An unknown error occurred whilst processing the image.");return it},et=i.__addimage__.convertBase64ToBinaryString=function(R,F){var U;F=typeof F!="boolean"||F;var z,it="";if(typeof R=="string"){z=(U=M(R))!==null?U.data:R;try{it=Oh(z)}catch(Y){if(F)throw S(z)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Y.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return it};i.getImageProperties=function(R){var F,U,z="";if(f(R)&&(R=g(R)),typeof R=="string"&&n(R)===t&&((z=et(R,!1))===""&&(z=i.loadFile(R)||""),R=z),U=n(R),!c(U))throw new Error("addImage does not support files of type '"+U+"', please ensure that a plugin for '"+U+"' support is added.");if(!D()||R instanceof Uint8Array||(R=j(R)),!(F=this["process"+U.toUpperCase()](R)))throw new Error("An unknown error occurred whilst processing the image");return F.fileType=U,F}})(re.API),function(i){var t=function(e){if(e!==void 0&&e!="")return!0};re.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),i.events.push(["putPage",function(e){for(var n,r,s,a=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(e.objId),h=e.pageContext.annotations,c=!1,f=0;f<h.length&&!c;f++)switch((n=h[f]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(c=!0);break;case"reference":case"text":case"freetext":c=!0}if(c!=0){this.internal.write("/Annots [");for(var g=0;g<h.length;g++){n=h[g];var d=this.internal.pdfEscape,m=this.internal.getEncryptor(e.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var y=this.internal.newAdditionalObject(),b=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(y.objId),E=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(r="/Rect ["+a(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+a(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+d(x(n.contents))+")",s+=" /Popup "+b.objId+" 0 R",s+=" /P "+l.objId+" 0 R",s+=" /T ("+d(x(E))+") >>",y.content=s;var S=y.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(r="/Rect ["+a(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+a(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+S,n.open&&(s+=" /Open true"),s+=" >>",b.content=s,this.internal.write(y.objId,"0 R",b.objId,"0 R");break;case"freetext":r="/Rect ["+a(n.bounds.x)+" "+o(n.bounds.y)+" "+a(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var M=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+r+"/Contents ("+d(m(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+M+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var D=this.annotations._nameMap[n.options.name];n.options.pageNumber=D.page,n.options.top=D.y}else n.options.top||(n.options.top=0);if(r="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /A <</S /URI /URI ("+d(m(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var W=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+W+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),i.createAnnotation=function(e){var n=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":n.pageContext.annotations.push(e)}},i.link=function(e,n,r,s,a){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,h=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(e),y:h(n),w:l(e+r),h:h(n+s)},options:a,type:"link"})},i.textWithLink=function(e,n,r,s){var a,o,l=this.getTextWidth(e),h=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){o=s.maxWidth;var c=this.splitTextToSize(e,o).length;a=Math.ceil(h*c)}else o=l,a=h;return this.text(e,n,r,s),r+=.2*h,s.align==="center"&&(n-=l/2),s.align==="right"&&(n-=l),this.link(n,r-h,o,a,s),l},i.getTextWidth=function(e){var n=this.internal.getFontSize();return this.getStringUnitWidth(e)*n/this.internal.scaleFactor}}(re.API),function(i){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},e={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},r=[1570,1571,1573,1575];i.__arabicParser__={};var s=i.__arabicParser__.isInArabicSubstitutionA=function(y){return t[y.charCodeAt(0)]!==void 0},a=i.__arabicParser__.isArabicLetter=function(y){return typeof y=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(y)},o=i.__arabicParser__.isArabicEndLetter=function(y){return a(y)&&s(y)&&t[y.charCodeAt(0)].length<=2},l=i.__arabicParser__.isArabicAlfLetter=function(y){return a(y)&&r.indexOf(y.charCodeAt(0))>=0};i.__arabicParser__.arabicLetterHasIsolatedForm=function(y){return a(y)&&s(y)&&t[y.charCodeAt(0)].length>=1};var h=i.__arabicParser__.arabicLetterHasFinalForm=function(y){return a(y)&&s(y)&&t[y.charCodeAt(0)].length>=2};i.__arabicParser__.arabicLetterHasInitialForm=function(y){return a(y)&&s(y)&&t[y.charCodeAt(0)].length>=3};var c=i.__arabicParser__.arabicLetterHasMedialForm=function(y){return a(y)&&s(y)&&t[y.charCodeAt(0)].length==4},f=i.__arabicParser__.resolveLigatures=function(y){var b=0,x=e,E="",S=0;for(b=0;b<y.length;b+=1)x[y.charCodeAt(b)]!==void 0?(S++,typeof(x=x[y.charCodeAt(b)])=="number"&&(E+=String.fromCharCode(x),x=e,S=0),b===y.length-1&&(x=e,E+=y.charAt(b-(S-1)),b-=S-1,S=0)):(x=e,E+=y.charAt(b-S),b-=S,S=0);return E};i.__arabicParser__.isArabicDiacritic=function(y){return y!==void 0&&n[y.charCodeAt(0)]!==void 0};var g=i.__arabicParser__.getCorrectForm=function(y,b,x){return a(y)?s(y)===!1?-1:!h(y)||!a(b)&&!a(x)||!a(x)&&o(b)||o(y)&&!a(b)||o(y)&&l(b)||o(y)&&o(b)?0:c(y)&&a(b)&&!o(b)&&a(x)&&h(x)?3:o(y)||!a(x)?1:2:-1},d=function(y){var b=0,x=0,E=0,S="",M="",D="",W=(y=y||"").split("\\s+"),j=[];for(b=0;b<W.length;b+=1){for(j.push(""),x=0;x<W[b].length;x+=1)S=W[b][x],M=W[b][x-1],D=W[b][x+1],a(S)?(E=g(S,M,D),j[b]+=E!==-1?String.fromCharCode(t[S.charCodeAt(0)][E]):S):j[b]+=S;j[b]=f(j[b])}return j.join(" ")},m=i.__arabicParser__.processArabic=i.processArabic=function(){var y,b=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,x=[];if(Array.isArray(b)){var E=0;for(x=[],E=0;E<b.length;E+=1)Array.isArray(b[E])?x.push([d(b[E][0]),b[E][1],b[E][2]]):x.push([d(b[E])]);y=x}else y=d(b);return typeof arguments[0]=="string"?y:(arguments[0].text=y,arguments[0])};i.events.push(["preProcessText",m])}(re.API),re.API.autoPrint=function(i){var t;switch((i=i||{}).variant=i.variant||"non-conform",i.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(i){var t=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(o){e=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var r=300;Object.defineProperty(this,"height",{get:function(){return r},set:function(o){r=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=r+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(o){s=o}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(o){a=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(e,n){var r;if((e=e||"2d")!=="2d")return null;for(r in n)this.pdf.context2d.hasOwnProperty(r)&&(this.pdf.context2d[r]=n[r]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},i.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(re.API),function(i){var t={left:0,top:0,bottom:0,right:0},e=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),r.call(this))},r=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(y){l=y}});var h=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return h},set:function(y){h=y}});var c=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return c},set:function(y){c=y}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(y){f=y}});var g=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return g},set:function(y){g=y}});var d=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return d},set:function(y){d=y}});var m=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return m},set:function(y){m=y}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},i.setHeaderFunction=function(l){return n.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},i.getTextDimensions=function(l,h){n.call(this);var c=(h=h||{}).fontSize||this.getFontSize(),f=h.font||this.getFont(),g=h.scaleFactor||this.internal.scaleFactor,d=0,m=0,y=0,b=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var x=h.maxWidth;x>0?typeof l=="string"?l=this.splitTextToSize(l,x):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(S,M){return S.concat(b.splitTextToSize(M,x))},[])):l=Array.isArray(l)?l:[l];for(var E=0;E<l.length;E++)d<(y=this.getStringUnitWidth(l[E],{font:f})*c)&&(d=y);return d!==0&&(m=l.length),{w:d/=g,h:Math.max((m*c*this.getLineHeightFactor()-c*(this.getLineHeightFactor()-1))/g,0)}},i.cellAddPage=function(){n.call(this),this.addPage();var l=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=i.cell=function(){var l;l=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var h=this.internal.__cell__.lastCell,c=this.internal.__cell__.padding,f=this.internal.__cell__.margins||t,g=this.internal.__cell__.tableHeaderRow,d=this.internal.__cell__.printHeaders;return h.lineNumber!==void 0&&(h.lineNumber===l.lineNumber?(l.x=(h.x||0)+(h.width||0),l.y=h.y||0):h.y+h.height+l.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=f.top,d&&g&&(this.printHeaderRow(l.lineNumber,!0),l.y+=g[0].height)):l.y=h.y+h.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,e===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-c,l.y+c,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+c,{align:"center",baseline:"top",maxWidth:l.width-c-c}):this.text(l.text,l.x+c,l.y+c,{align:"left",baseline:"top",maxWidth:l.width-c-c})),this.internal.__cell__.lastCell=l,this};i.table=function(l,h,c,f,g){if(n.call(this),!c)throw new Error("No data for PDF table.");var d,m,y,b,x=[],E=[],S=[],M={},D={},W=[],j=[],P=(g=g||{}).autoSize||!1,H=g.printHeaders!==!1,et=g.css&&g.css["font-size"]!==void 0?16*g.css["font-size"]:g.fontSize||12,R=g.margins||Object.assign({width:this.getPageWidth()},t),F=typeof g.padding=="number"?g.padding:3,U=g.headerBackgroundColor||"#c8c8c8",z=g.headerTextColor||"#000";if(r.call(this),this.internal.__cell__.printHeaders=H,this.internal.__cell__.margins=R,this.internal.__cell__.table_font_size=et,this.internal.__cell__.padding=F,this.internal.__cell__.headerBackgroundColor=U,this.internal.__cell__.headerTextColor=z,this.setFontSize(et),f==null)E=x=Object.keys(c[0]),S=x.map(function(){return"left"});else if(Array.isArray(f)&&Xe(f[0])==="object")for(x=f.map(function(lt){return lt.name}),E=f.map(function(lt){return lt.prompt||lt.name||""}),S=f.map(function(lt){return lt.align||"left"}),d=0;d<f.length;d+=1)D[f[d].name]=f[d].width*(19.049976/25.4);else Array.isArray(f)&&typeof f[0]=="string"&&(E=x=f,S=x.map(function(){return"left"}));if(P||Array.isArray(f)&&typeof f[0]=="string")for(d=0;d<x.length;d+=1){for(M[b=x[d]]=c.map(function(lt){return lt[b]}),this.setFont(void 0,"bold"),W.push(this.getTextDimensions(E[d],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),m=M[b],this.setFont(void 0,"normal"),y=0;y<m.length;y+=1)W.push(this.getTextDimensions(m[y],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);D[b]=Math.max.apply(null,W)+F+F,W=[]}if(H){var it={};for(d=0;d<x.length;d+=1)it[x[d]]={},it[x[d]].text=E[d],it[x[d]].align=S[d];var Y=o.call(this,it,D);j=x.map(function(lt){return new s(l,h,D[lt],Y,it[lt].text,void 0,it[lt].align)}),this.setTableHeaderRow(j),this.printHeaderRow(1,!1)}var st=f.reduce(function(lt,Et){return lt[Et.name]=Et.align,lt},{});for(d=0;d<c.length;d+=1){"rowStart"in g&&g.rowStart instanceof Function&&g.rowStart({row:d,data:c[d]},this);var Q=o.call(this,c[d],D);for(y=0;y<x.length;y+=1){var gt=c[d][x[y]];"cellStart"in g&&g.cellStart instanceof Function&&g.cellStart({row:d,col:y,data:gt},this),a.call(this,new s(l,h,D[x[y]],Q,gt,d+2,st[x[y]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=h,this};var o=function(l,h){var c=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,g=this.internal.scaleFactor;return Object.keys(l).map(function(d){var m=l[d];return this.splitTextToSize(m.hasOwnProperty("text")?m.text:m,h[d]-c-c)},this).map(function(d){return this.getLineHeightFactor()*d.length*f/g+c+c},this).reduce(function(d,m){return Math.max(d,m)},0)};i.setTableHeaderRow=function(l){n.call(this),this.internal.__cell__.tableHeaderRow=l},i.printHeaderRow=function(l,h){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var c;if(e=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var g=[],d=0;d<this.internal.__cell__.tableHeaderRow.length;d+=1){c=this.internal.__cell__.tableHeaderRow[d].clone(),h&&(c.y=this.internal.__cell__.margins.top||0,g.push(c)),c.lineNumber=l;var m=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,c),this.setTextColor(m)}g.length>0&&this.setTableHeaderRow(g),this.setFont(void 0,"normal"),e=!1}}(re.API);var dv={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},gv=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],y0=fv(gv),pv=[100,200,300,400,500,600,700,800,900],dE=fv(pv);function x0(i){var t=i.family.replace(/"|'/g,"").toLowerCase(),e=function(s){return dv[s=s||"normal"]?s:"normal"}(i.style),n=function(s){if(!s)return 400;if(typeof s=="number")return s>=100&&s<=900&&s%100==0?s:400;if(/^\d00$/.test(s))return parseInt(s);switch(s){case"bold":return 700;case"normal":default:return 400}}(i.weight),r=function(s){return typeof y0[s=s||"normal"]=="number"?s:"normal"}(i.stretch);return{family:t,style:e,weight:n,stretch:r,src:i.src||[],ref:i.ref||{name:t,style:[r,e,n].join(" ")}}}function Mm(i,t,e,n){var r;for(r=e;r>=0&&r<t.length;r+=n)if(i[t[r]])return i[t[r]];for(r=e;r>=0&&r<t.length;r-=n)if(i[t[r]])return i[t[r]]}var gE={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Tm={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Pm(i){return[i.stretch,i.style,i.weight,i.family].join(" ")}function pE(i,t,e){for(var n=(e=e||{}).defaultFontFamily||"times",r=Object.assign({},gE,e.genericFontFamilies||{}),s=null,a=null,o=0;o<t.length;++o)if(r[(s=x0(t[o])).family]&&(s.family=r[s.family]),i.hasOwnProperty(s.family)){a=i[s.family];break}if(!(a=a||i[n]))throw new Error("Could not find a font-family for the rule '"+Pm(s)+"' and default family '"+n+"'.");if(a=function(l,h){if(h[l])return h[l];var c=y0[l],f=c<=y0.normal?-1:1,g=Mm(h,gv,c,f);if(!g)throw new Error("Could not find a matching font-stretch value for "+l);return g}(s.stretch,a),a=function(l,h){if(h[l])return h[l];for(var c=dv[l],f=0;f<c.length;++f)if(h[c[f]])return h[c[f]];throw new Error("Could not find a matching font-style for "+l)}(s.style,a),!(a=function(l,h){if(h[l])return h[l];if(l===400&&h[500])return h[500];if(l===500&&h[400])return h[400];var c=dE[l],f=Mm(h,pv,c,l<400?-1:1);if(!f)throw new Error("Could not find a matching font-weight for value "+l);return f}(s.weight,a)))throw new Error("Failed to resolve a font for the rule '"+Pm(s)+"'.");return a}function Im(i){return i.trimLeft()}function mE(i,t){for(var e=0;e<i.length;){if(i.charAt(e)===t)return[i.substring(0,e),i.substring(e+1)];e+=1}return null}function _E(i){var t=i.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],i.substring(t[0].length)]}var Ru,Rm,Nm,Sg=["times"];(function(i){var t,e,n,r,s,a,o,l,h,c=function(A){return A=A||{},this.isStrokeTransparent=A.isStrokeTransparent||!1,this.strokeOpacity=A.strokeOpacity||1,this.strokeStyle=A.strokeStyle||"#000000",this.fillStyle=A.fillStyle||"#000000",this.isFillTransparent=A.isFillTransparent||!1,this.fillOpacity=A.fillOpacity||1,this.font=A.font||"10px sans-serif",this.textBaseline=A.textBaseline||"alphabetic",this.textAlign=A.textAlign||"left",this.lineWidth=A.lineWidth||1,this.lineJoin=A.lineJoin||"miter",this.lineCap=A.lineCap||"butt",this.path=A.path||[],this.transform=A.transform!==void 0?A.transform.clone():new l,this.globalCompositeOperation=A.globalCompositeOperation||"normal",this.globalAlpha=A.globalAlpha||1,this.clip_path=A.clip_path||[],this.currentPoint=A.currentPoint||new a,this.miterLimit=A.miterLimit||10,this.lastPoint=A.lastPoint||new a,this.lineDashOffset=A.lineDashOffset||0,this.lineDash=A.lineDash||[],this.margin=A.margin||[0,0,0,0],this.prevPageLastElemOffset=A.prevPageLastElemOffset||0,this.ignoreClearRect=typeof A.ignoreClearRect!="boolean"||A.ignoreClearRect,this};i.events.push(["initialized",function(){this.context2d=new f(this),t=this.internal.f2,e=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,r=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,a=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,h=new c}]);var f=function(A){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var G=A;Object.defineProperty(this,"pdf",{get:function(){return G}});var O=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return O},set:function(mt){O=!!mt}});var X=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return X},set:function(mt){X=!!mt}});var nt=0;Object.defineProperty(this,"posX",{get:function(){return nt},set:function(mt){isNaN(mt)||(nt=mt)}});var at=0;Object.defineProperty(this,"posY",{get:function(){return at},set:function(mt){isNaN(mt)||(at=mt)}}),Object.defineProperty(this,"margin",{get:function(){return h.margin},set:function(mt){var V;typeof mt=="number"?V=[mt,mt,mt,mt]:((V=new Array(4))[0]=mt[0],V[1]=mt.length>=2?mt[1]:V[0],V[2]=mt.length>=3?mt[2]:V[0],V[3]=mt.length>=4?mt[3]:V[1]),h.margin=V}});var ht=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ht},set:function(mt){ht=mt}});var dt=0;Object.defineProperty(this,"lastBreak",{get:function(){return dt},set:function(mt){dt=mt}});var St=[];Object.defineProperty(this,"pageBreaks",{get:function(){return St},set:function(mt){St=mt}}),Object.defineProperty(this,"ctx",{get:function(){return h},set:function(mt){mt instanceof c&&(h=mt)}}),Object.defineProperty(this,"path",{get:function(){return h.path},set:function(mt){h.path=mt}});var At=[];Object.defineProperty(this,"ctxStack",{get:function(){return At},set:function(mt){At=mt}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(mt){var V;V=g(mt),this.ctx.fillStyle=V.style,this.ctx.isFillTransparent=V.a===0,this.ctx.fillOpacity=V.a,this.pdf.setFillColor(V.r,V.g,V.b,{a:V.a}),this.pdf.setTextColor(V.r,V.g,V.b,{a:V.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(mt){var V=g(mt);this.ctx.strokeStyle=V.style,this.ctx.isStrokeTransparent=V.a===0,this.ctx.strokeOpacity=V.a,V.a===0?this.pdf.setDrawColor(255,255,255):(V.a,this.pdf.setDrawColor(V.r,V.g,V.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(mt){["butt","round","square"].indexOf(mt)!==-1&&(this.ctx.lineCap=mt,this.pdf.setLineCap(mt))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(mt){isNaN(mt)||(this.ctx.lineWidth=mt,this.pdf.setLineWidth(mt))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(mt){["bevel","round","miter"].indexOf(mt)!==-1&&(this.ctx.lineJoin=mt,this.pdf.setLineJoin(mt))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(mt){isNaN(mt)||(this.ctx.miterLimit=mt,this.pdf.setMiterLimit(mt))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(mt){this.ctx.textBaseline=mt}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(mt){["right","end","center","left","start"].indexOf(mt)!==-1&&(this.ctx.textAlign=mt)}});var Rt=null;function Dt(mt,V){if(Rt===null){var ne=function(qt){var Lt=[];return Object.keys(qt).forEach(function(It){qt[It].forEach(function(Ft){var Tt=null;switch(Ft){case"bold":Tt={family:It,weight:"bold"};break;case"italic":Tt={family:It,style:"italic"};break;case"bolditalic":Tt={family:It,weight:"bold",style:"italic"};break;case"":case"normal":Tt={family:It}}Tt!==null&&(Tt.ref={name:It,style:Ft},Lt.push(Tt))})}),Lt}(mt.getFontList());Rt=function(qt){for(var Lt={},It=0;It<qt.length;++It){var Ft=x0(qt[It]),Tt=Ft.family,zt=Ft.stretch,Kt=Ft.style,te=Ft.weight;Lt[Tt]=Lt[Tt]||{},Lt[Tt][zt]=Lt[Tt][zt]||{},Lt[Tt][zt][Kt]=Lt[Tt][zt][Kt]||{},Lt[Tt][zt][Kt][te]=Ft}return Lt}(ne.concat(V))}return Rt}var $t=null;Object.defineProperty(this,"fontFaces",{get:function(){return $t},set:function(mt){Rt=null,$t=mt}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(mt){var V;if(this.ctx.font=mt,(V=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(mt))!==null){var ne=V[1],qt=(V[2],V[3]),Lt=V[4],It=(V[5],V[6]),Ft=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Lt)[2];Lt=Math.floor(Ft==="px"?parseFloat(Lt)*this.pdf.internal.scaleFactor:Ft==="em"?parseFloat(Lt)*this.pdf.getFontSize():parseFloat(Lt)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Lt);var Tt=function(Xt){var me,Pt,Di=[],Se=Xt.trim();if(Se==="")return Sg;if(Se in Tm)return[Tm[Se]];for(;Se!=="";){switch(Pt=null,me=(Se=Im(Se)).charAt(0)){case'"':case"'":Pt=mE(Se.substring(1),me);break;default:Pt=_E(Se)}if(Pt===null||(Di.push(Pt[0]),(Se=Im(Pt[1]))!==""&&Se.charAt(0)!==","))return Sg;Se=Se.replace(/^,/,"")}return Di}(It);if(this.fontFaces){var zt=pE(Dt(this.pdf,this.fontFaces),Tt.map(function(Xt){return{family:Xt,stretch:"normal",weight:qt,style:ne}}));this.pdf.setFont(zt.ref.name,zt.ref.style)}else{var Kt="";(qt==="bold"||parseInt(qt,10)>=700||ne==="bold")&&(Kt="bold"),ne==="italic"&&(Kt+="italic"),Kt.length===0&&(Kt="normal");for(var te="",he={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},ve=0;ve<Tt.length;ve++){if(this.pdf.internal.getFont(Tt[ve],Kt,{noFallback:!0,disableWarning:!0})!==void 0){te=Tt[ve];break}if(Kt==="bolditalic"&&this.pdf.internal.getFont(Tt[ve],"bold",{noFallback:!0,disableWarning:!0})!==void 0)te=Tt[ve],Kt="bold";else if(this.pdf.internal.getFont(Tt[ve],"normal",{noFallback:!0,disableWarning:!0})!==void 0){te=Tt[ve],Kt="normal";break}}if(te===""){for(var we=0;we<Tt.length;we++)if(he[Tt[we]]){te=he[Tt[we]];break}}te=te===""?"Times":te,this.pdf.setFont(te,Kt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(mt){this.ctx.globalCompositeOperation=mt}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(mt){this.ctx.globalAlpha=mt}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(mt){this.ctx.lineDashOffset=mt,Et.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(mt){this.ctx.lineDash=mt,Et.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(mt){this.ctx.ignoreClearRect=!!mt}})};f.prototype.setLineDash=function(A){this.lineDash=A},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){M.call(this,"fill",!1)},f.prototype.stroke=function(){M.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(A,G){if(isNaN(A)||isNaN(G))throw Qe.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var O=this.ctx.transform.applyToPoint(new a(A,G));this.path.push({type:"mt",x:O.x,y:O.y}),this.ctx.lastPoint=new a(A,G)},f.prototype.closePath=function(){var A=new a(0,0),G=0;for(G=this.path.length-1;G!==-1;G--)if(this.path[G].type==="begin"&&Xe(this.path[G+1])==="object"&&typeof this.path[G+1].x=="number"){A=new a(this.path[G+1].x,this.path[G+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(A.x,A.y)},f.prototype.lineTo=function(A,G){if(isNaN(A)||isNaN(G))throw Qe.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var O=this.ctx.transform.applyToPoint(new a(A,G));this.path.push({type:"lt",x:O.x,y:O.y}),this.ctx.lastPoint=new a(O.x,O.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),M.call(this,null,!0)},f.prototype.quadraticCurveTo=function(A,G,O,X){if(isNaN(O)||isNaN(X)||isNaN(A)||isNaN(G))throw Qe.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var nt=this.ctx.transform.applyToPoint(new a(O,X)),at=this.ctx.transform.applyToPoint(new a(A,G));this.path.push({type:"qct",x1:at.x,y1:at.y,x:nt.x,y:nt.y}),this.ctx.lastPoint=new a(nt.x,nt.y)},f.prototype.bezierCurveTo=function(A,G,O,X,nt,at){if(isNaN(nt)||isNaN(at)||isNaN(A)||isNaN(G)||isNaN(O)||isNaN(X))throw Qe.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ht=this.ctx.transform.applyToPoint(new a(nt,at)),dt=this.ctx.transform.applyToPoint(new a(A,G)),St=this.ctx.transform.applyToPoint(new a(O,X));this.path.push({type:"bct",x1:dt.x,y1:dt.y,x2:St.x,y2:St.y,x:ht.x,y:ht.y}),this.ctx.lastPoint=new a(ht.x,ht.y)},f.prototype.arc=function(A,G,O,X,nt,at){if(isNaN(A)||isNaN(G)||isNaN(O)||isNaN(X)||isNaN(nt))throw Qe.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(at=!!at,!this.ctx.transform.isIdentity){var ht=this.ctx.transform.applyToPoint(new a(A,G));A=ht.x,G=ht.y;var dt=this.ctx.transform.applyToPoint(new a(0,O)),St=this.ctx.transform.applyToPoint(new a(0,0));O=Math.sqrt(Math.pow(dt.x-St.x,2)+Math.pow(dt.y-St.y,2))}Math.abs(nt-X)>=2*Math.PI&&(X=0,nt=2*Math.PI),this.path.push({type:"arc",x:A,y:G,radius:O,startAngle:X,endAngle:nt,counterclockwise:at})},f.prototype.arcTo=function(A,G,O,X,nt){throw new Error("arcTo not implemented.")},f.prototype.rect=function(A,G,O,X){if(isNaN(A)||isNaN(G)||isNaN(O)||isNaN(X))throw Qe.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(A,G),this.lineTo(A+O,G),this.lineTo(A+O,G+X),this.lineTo(A,G+X),this.lineTo(A,G),this.lineTo(A+O,G),this.lineTo(A,G)},f.prototype.fillRect=function(A,G,O,X){if(isNaN(A)||isNaN(G)||isNaN(O)||isNaN(X))throw Qe.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!d.call(this)){var nt={};this.lineCap!=="butt"&&(nt.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(nt.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(A,G,O,X),this.fill(),nt.hasOwnProperty("lineCap")&&(this.lineCap=nt.lineCap),nt.hasOwnProperty("lineJoin")&&(this.lineJoin=nt.lineJoin)}},f.prototype.strokeRect=function(A,G,O,X){if(isNaN(A)||isNaN(G)||isNaN(O)||isNaN(X))throw Qe.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(A,G,O,X),this.stroke())},f.prototype.clearRect=function(A,G,O,X){if(isNaN(A)||isNaN(G)||isNaN(O)||isNaN(X))throw Qe.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(A,G,O,X))},f.prototype.save=function(A){A=typeof A!="boolean"||A;for(var G=this.pdf.internal.getCurrentPageInfo().pageNumber,O=0;O<this.pdf.internal.getNumberOfPages();O++)this.pdf.setPage(O+1),this.pdf.internal.out("q");if(this.pdf.setPage(G),A){this.ctx.fontSize=this.pdf.internal.getFontSize();var X=new c(this.ctx);this.ctxStack.push(this.ctx),this.ctx=X}},f.prototype.restore=function(A){A=typeof A!="boolean"||A;for(var G=this.pdf.internal.getCurrentPageInfo().pageNumber,O=0;O<this.pdf.internal.getNumberOfPages();O++)this.pdf.setPage(O+1),this.pdf.internal.out("Q");this.pdf.setPage(G),A&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var g=function(A){var G,O,X,nt;if(A.isCanvasGradient===!0&&(A=A.getColor()),!A)return{r:0,g:0,b:0,a:0,style:A};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(A))G=0,O=0,X=0,nt=0;else{var at=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(A);if(at!==null)G=parseInt(at[1]),O=parseInt(at[2]),X=parseInt(at[3]),nt=1;else if((at=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(A))!==null)G=parseInt(at[1]),O=parseInt(at[2]),X=parseInt(at[3]),nt=parseFloat(at[4]);else{if(nt=1,typeof A=="string"&&A.charAt(0)!=="#"){var ht=new av(A);A=ht.ok?ht.toHex():"#000000"}A.length===4?(G=A.substring(1,2),G+=G,O=A.substring(2,3),O+=O,X=A.substring(3,4),X+=X):(G=A.substring(1,3),O=A.substring(3,5),X=A.substring(5,7)),G=parseInt(G,16),O=parseInt(O,16),X=parseInt(X,16)}}return{r:G,g:O,b:X,a:nt,style:A}},d=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},m=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(A,G,O,X){if(isNaN(G)||isNaN(O)||typeof A!="string")throw Qe.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(X=isNaN(X)?void 0:X,!d.call(this)){var nt=Q(this.ctx.transform.rotation),at=this.ctx.transform.scaleX;F.call(this,{text:A,x:G,y:O,scale:at,angle:nt,align:this.textAlign,maxWidth:X})}},f.prototype.strokeText=function(A,G,O,X){if(isNaN(G)||isNaN(O)||typeof A!="string")throw Qe.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){X=isNaN(X)?void 0:X;var nt=Q(this.ctx.transform.rotation),at=this.ctx.transform.scaleX;F.call(this,{text:A,x:G,y:O,scale:at,renderingMode:"stroke",angle:nt,align:this.textAlign,maxWidth:X})}},f.prototype.measureText=function(A){if(typeof A!="string")throw Qe.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var G=this.pdf,O=this.pdf.internal.scaleFactor,X=G.internal.getFontSize(),nt=G.getStringUnitWidth(A)*X/G.internal.scaleFactor,at=function(ht){var dt=(ht=ht||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return dt}}),this};return new at({width:nt*=Math.round(96*O/72*1e4)/1e4})},f.prototype.scale=function(A,G){if(isNaN(A)||isNaN(G))throw Qe.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var O=new l(A,0,0,G,0,0);this.ctx.transform=this.ctx.transform.multiply(O)},f.prototype.rotate=function(A){if(isNaN(A))throw Qe.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var G=new l(Math.cos(A),Math.sin(A),-Math.sin(A),Math.cos(A),0,0);this.ctx.transform=this.ctx.transform.multiply(G)},f.prototype.translate=function(A,G){if(isNaN(A)||isNaN(G))throw Qe.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var O=new l(1,0,0,1,A,G);this.ctx.transform=this.ctx.transform.multiply(O)},f.prototype.transform=function(A,G,O,X,nt,at){if(isNaN(A)||isNaN(G)||isNaN(O)||isNaN(X)||isNaN(nt)||isNaN(at))throw Qe.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ht=new l(A,G,O,X,nt,at);this.ctx.transform=this.ctx.transform.multiply(ht)},f.prototype.setTransform=function(A,G,O,X,nt,at){A=isNaN(A)?1:A,G=isNaN(G)?0:G,O=isNaN(O)?0:O,X=isNaN(X)?1:X,nt=isNaN(nt)?0:nt,at=isNaN(at)?0:at,this.ctx.transform=new l(A,G,O,X,nt,at)};var y=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(A,G,O,X,nt,at,ht,dt,St){var At=this.pdf.getImageProperties(A),Rt=1,Dt=1,$t=1,mt=1;X!==void 0&&dt!==void 0&&($t=dt/X,mt=St/nt,Rt=At.width/X*dt/X,Dt=At.height/nt*St/nt),at===void 0&&(at=G,ht=O,G=0,O=0),X!==void 0&&dt===void 0&&(dt=X,St=nt),X===void 0&&dt===void 0&&(dt=At.width,St=At.height);for(var V,ne=this.ctx.transform.decompose(),qt=Q(ne.rotate.shx),Lt=new l,It=(Lt=(Lt=(Lt=Lt.multiply(ne.translate)).multiply(ne.skew)).multiply(ne.scale)).applyToRectangle(new o(at-G*$t,ht-O*mt,X*Rt,nt*Dt)),Ft=b.call(this,It),Tt=[],zt=0;zt<Ft.length;zt+=1)Tt.indexOf(Ft[zt])===-1&&Tt.push(Ft[zt]);if(S(Tt),this.autoPaging)for(var Kt=Tt[0],te=Tt[Tt.length-1],he=Kt;he<te+1;he++){this.pdf.setPage(he);var ve=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],we=he===1?this.posY+this.margin[0]:this.margin[0],Xt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],me=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Pt=he===1?0:Xt+(he-2)*me;if(this.ctx.clip_path.length!==0){var Di=this.path;V=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=E(V,this.posX+this.margin[3],-Pt+we+this.ctx.prevPageLastElemOffset),D.call(this,"fill",!0),this.path=Di}var Se=JSON.parse(JSON.stringify(It));Se=E([Se],this.posX+this.margin[3],-Pt+we+this.ctx.prevPageLastElemOffset)[0];var qn=(he>Kt||he<te)&&y.call(this);qn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ve,me,null).clip().discardPath()),this.pdf.addImage(A,"JPEG",Se.x,Se.y,Se.w,Se.h,null,null,qt),qn&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(A,"JPEG",It.x,It.y,It.w,It.h,null,null,qt)};var b=function(A,G,O){var X=[];G=G||this.pdf.internal.pageSize.width,O=O||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var nt=this.posY+this.ctx.prevPageLastElemOffset;switch(A.type){default:case"mt":case"lt":X.push(Math.floor((A.y+nt)/O)+1);break;case"arc":X.push(Math.floor((A.y+nt-A.radius)/O)+1),X.push(Math.floor((A.y+nt+A.radius)/O)+1);break;case"qct":var at=gt(this.ctx.lastPoint.x,this.ctx.lastPoint.y,A.x1,A.y1,A.x,A.y);X.push(Math.floor((at.y+nt)/O)+1),X.push(Math.floor((at.y+at.h+nt)/O)+1);break;case"bct":var ht=lt(this.ctx.lastPoint.x,this.ctx.lastPoint.y,A.x1,A.y1,A.x2,A.y2,A.x,A.y);X.push(Math.floor((ht.y+nt)/O)+1),X.push(Math.floor((ht.y+ht.h+nt)/O)+1);break;case"rect":X.push(Math.floor((A.y+nt)/O)+1),X.push(Math.floor((A.y+A.h+nt)/O)+1)}for(var dt=0;dt<X.length;dt+=1)for(;this.pdf.internal.getNumberOfPages()<X[dt];)x.call(this);return X},x=function(){var A=this.fillStyle,G=this.strokeStyle,O=this.font,X=this.lineCap,nt=this.lineWidth,at=this.lineJoin;this.pdf.addPage(),this.fillStyle=A,this.strokeStyle=G,this.font=O,this.lineCap=X,this.lineWidth=nt,this.lineJoin=at},E=function(A,G,O){for(var X=0;X<A.length;X++)switch(A[X].type){case"bct":A[X].x2+=G,A[X].y2+=O;case"qct":A[X].x1+=G,A[X].y1+=O;case"mt":case"lt":case"arc":default:A[X].x+=G,A[X].y+=O}return A},S=function(A){return A.sort(function(G,O){return G-O})},M=function(A,G){for(var O,X,nt=this.fillStyle,at=this.strokeStyle,ht=this.lineCap,dt=this.lineWidth,St=Math.abs(dt*this.ctx.transform.scaleX),At=this.lineJoin,Rt=JSON.parse(JSON.stringify(this.path)),Dt=JSON.parse(JSON.stringify(this.path)),$t=[],mt=0;mt<Dt.length;mt++)if(Dt[mt].x!==void 0)for(var V=b.call(this,Dt[mt]),ne=0;ne<V.length;ne+=1)$t.indexOf(V[ne])===-1&&$t.push(V[ne]);for(var qt=0;qt<$t.length;qt++)for(;this.pdf.internal.getNumberOfPages()<$t[qt];)x.call(this);if(S($t),this.autoPaging)for(var Lt=$t[0],It=$t[$t.length-1],Ft=Lt;Ft<It+1;Ft++){this.pdf.setPage(Ft),this.fillStyle=nt,this.strokeStyle=at,this.lineCap=ht,this.lineWidth=St,this.lineJoin=At;var Tt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],zt=Ft===1?this.posY+this.margin[0]:this.margin[0],Kt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],te=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],he=Ft===1?0:Kt+(Ft-2)*te;if(this.ctx.clip_path.length!==0){var ve=this.path;O=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=E(O,this.posX+this.margin[3],-he+zt+this.ctx.prevPageLastElemOffset),D.call(this,A,!0),this.path=ve}if(X=JSON.parse(JSON.stringify(Rt)),this.path=E(X,this.posX+this.margin[3],-he+zt+this.ctx.prevPageLastElemOffset),G===!1||Ft===0){var we=(Ft>Lt||Ft<It)&&y.call(this);we&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Tt,te,null).clip().discardPath()),D.call(this,A,G),we&&this.pdf.restoreGraphicsState()}this.lineWidth=dt}else this.lineWidth=St,D.call(this,A,G),this.lineWidth=dt;this.path=Rt},D=function(A,G){if((A!=="stroke"||G||!m.call(this))&&(A==="stroke"||G||!d.call(this))){for(var O,X,nt=[],at=this.path,ht=0;ht<at.length;ht++){var dt=at[ht];switch(dt.type){case"begin":nt.push({begin:!0});break;case"close":nt.push({close:!0});break;case"mt":nt.push({start:dt,deltas:[],abs:[]});break;case"lt":var St=nt.length;if(at[ht-1]&&!isNaN(at[ht-1].x)&&(O=[dt.x-at[ht-1].x,dt.y-at[ht-1].y],St>0)){for(;St>=0;St--)if(nt[St-1].close!==!0&&nt[St-1].begin!==!0){nt[St-1].deltas.push(O),nt[St-1].abs.push(dt);break}}break;case"bct":O=[dt.x1-at[ht-1].x,dt.y1-at[ht-1].y,dt.x2-at[ht-1].x,dt.y2-at[ht-1].y,dt.x-at[ht-1].x,dt.y-at[ht-1].y],nt[nt.length-1].deltas.push(O);break;case"qct":var At=at[ht-1].x+2/3*(dt.x1-at[ht-1].x),Rt=at[ht-1].y+2/3*(dt.y1-at[ht-1].y),Dt=dt.x+2/3*(dt.x1-dt.x),$t=dt.y+2/3*(dt.y1-dt.y),mt=dt.x,V=dt.y;O=[At-at[ht-1].x,Rt-at[ht-1].y,Dt-at[ht-1].x,$t-at[ht-1].y,mt-at[ht-1].x,V-at[ht-1].y],nt[nt.length-1].deltas.push(O);break;case"arc":nt.push({deltas:[],abs:[],arc:!0}),Array.isArray(nt[nt.length-1].abs)&&nt[nt.length-1].abs.push(dt)}}X=G?null:A==="stroke"?"stroke":"fill";for(var ne=!1,qt=0;qt<nt.length;qt++)if(nt[qt].arc)for(var Lt=nt[qt].abs,It=0;It<Lt.length;It++){var Ft=Lt[It];Ft.type==="arc"?P.call(this,Ft.x,Ft.y,Ft.radius,Ft.startAngle,Ft.endAngle,Ft.counterclockwise,void 0,G,!ne):U.call(this,Ft.x,Ft.y),ne=!0}else if(nt[qt].close===!0)this.pdf.internal.out("h"),ne=!1;else if(nt[qt].begin!==!0){var Tt=nt[qt].start.x,zt=nt[qt].start.y;z.call(this,nt[qt].deltas,Tt,zt),ne=!0}X&&H.call(this,X),G&&et.call(this)}},W=function(A){var G=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,O=G*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return A-O;case"top":return A+G-O;case"hanging":return A+G-2*O;case"middle":return A+G/2-O;case"ideographic":return A;case"alphabetic":default:return A}},j=function(A){return A+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var A=function(){};return A.colorStops=[],A.addColorStop=function(G,O){this.colorStops.push([G,O])},A.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},A.isCanvasGradient=!0,A},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var P=function(A,G,O,X,nt,at,ht,dt,St){for(var At=Y.call(this,O,X,nt,at),Rt=0;Rt<At.length;Rt++){var Dt=At[Rt];Rt===0&&(St?R.call(this,Dt.x1+A,Dt.y1+G):U.call(this,Dt.x1+A,Dt.y1+G)),it.call(this,A,G,Dt.x2,Dt.y2,Dt.x3,Dt.y3,Dt.x4,Dt.y4)}dt?et.call(this):H.call(this,ht)},H=function(A){switch(A){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},et=function(){this.pdf.clip(),this.pdf.discardPath()},R=function(A,G){this.pdf.internal.out(e(A)+" "+n(G)+" m")},F=function(A){var G;switch(A.align){case"right":case"end":G="right";break;case"center":G="center";break;case"left":case"start":default:G="left"}var O=this.pdf.getTextDimensions(A.text),X=W.call(this,A.y),nt=j.call(this,X)-O.h,at=this.ctx.transform.applyToPoint(new a(A.x,X)),ht=this.ctx.transform.decompose(),dt=new l;dt=(dt=(dt=dt.multiply(ht.translate)).multiply(ht.skew)).multiply(ht.scale);for(var St,At,Rt,Dt=this.ctx.transform.applyToRectangle(new o(A.x,X,O.w,O.h)),$t=dt.applyToRectangle(new o(A.x,nt,O.w,O.h)),mt=b.call(this,$t),V=[],ne=0;ne<mt.length;ne+=1)V.indexOf(mt[ne])===-1&&V.push(mt[ne]);if(S(V),this.autoPaging)for(var qt=V[0],Lt=V[V.length-1],It=qt;It<Lt+1;It++){this.pdf.setPage(It);var Ft=It===1?this.posY+this.margin[0]:this.margin[0],Tt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],zt=this.pdf.internal.pageSize.height-this.margin[2],Kt=zt-this.margin[0],te=this.pdf.internal.pageSize.width-this.margin[1],he=te-this.margin[3],ve=It===1?0:Tt+(It-2)*Kt;if(this.ctx.clip_path.length!==0){var we=this.path;St=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=E(St,this.posX+this.margin[3],-1*ve+Ft),D.call(this,"fill",!0),this.path=we}var Xt=E([JSON.parse(JSON.stringify($t))],this.posX+this.margin[3],-ve+Ft+this.ctx.prevPageLastElemOffset)[0];A.scale>=.01&&(At=this.pdf.internal.getFontSize(),this.pdf.setFontSize(At*A.scale),Rt=this.lineWidth,this.lineWidth=Rt*A.scale);var me=this.autoPaging!=="text";if(me||Xt.y+Xt.h<=zt){if(me||Xt.y>=Ft&&Xt.x<=te){var Pt=me?A.text:this.pdf.splitTextToSize(A.text,A.maxWidth||te-Xt.x)[0],Di=E([JSON.parse(JSON.stringify(Dt))],this.posX+this.margin[3],-ve+Ft+this.ctx.prevPageLastElemOffset)[0],Se=me&&(It>qt||It<Lt)&&y.call(this);Se&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],he,Kt,null).clip().discardPath()),this.pdf.text(Pt,Di.x,Di.y,{angle:A.angle,align:G,renderingMode:A.renderingMode}),Se&&this.pdf.restoreGraphicsState()}}else Xt.y<zt&&(this.ctx.prevPageLastElemOffset+=zt-Xt.y);A.scale>=.01&&(this.pdf.setFontSize(At),this.lineWidth=Rt)}else A.scale>=.01&&(At=this.pdf.internal.getFontSize(),this.pdf.setFontSize(At*A.scale),Rt=this.lineWidth,this.lineWidth=Rt*A.scale),this.pdf.text(A.text,at.x+this.posX,at.y+this.posY,{angle:A.angle,align:G,renderingMode:A.renderingMode,maxWidth:A.maxWidth}),A.scale>=.01&&(this.pdf.setFontSize(At),this.lineWidth=Rt)},U=function(A,G,O,X){O=O||0,X=X||0,this.pdf.internal.out(e(A+O)+" "+n(G+X)+" l")},z=function(A,G,O){return this.pdf.lines(A,G,O,null,null)},it=function(A,G,O,X,nt,at,ht,dt){this.pdf.internal.out([t(r(O+A)),t(s(X+G)),t(r(nt+A)),t(s(at+G)),t(r(ht+A)),t(s(dt+G)),"c"].join(" "))},Y=function(A,G,O,X){for(var nt=2*Math.PI,at=Math.PI/2;G>O;)G-=nt;var ht=Math.abs(O-G);ht<nt&&X&&(ht=nt-ht);for(var dt=[],St=X?-1:1,At=G;ht>1e-5;){var Rt=At+St*Math.min(ht,at);dt.push(st.call(this,A,At,Rt)),ht-=Math.abs(Rt-At),At=Rt}return dt},st=function(A,G,O){var X=(O-G)/2,nt=A*Math.cos(X),at=A*Math.sin(X),ht=nt,dt=-at,St=ht*ht+dt*dt,At=St+ht*nt+dt*at,Rt=4/3*(Math.sqrt(2*St*At)-At)/(ht*at-dt*nt),Dt=ht-Rt*dt,$t=dt+Rt*ht,mt=Dt,V=-$t,ne=X+G,qt=Math.cos(ne),Lt=Math.sin(ne);return{x1:A*Math.cos(G),y1:A*Math.sin(G),x2:Dt*qt-$t*Lt,y2:Dt*Lt+$t*qt,x3:mt*qt-V*Lt,y3:mt*Lt+V*qt,x4:A*Math.cos(O),y4:A*Math.sin(O)}},Q=function(A){return 180*A/Math.PI},gt=function(A,G,O,X,nt,at){var ht=A+.5*(O-A),dt=G+.5*(X-G),St=nt+.5*(O-nt),At=at+.5*(X-at),Rt=Math.min(A,nt,ht,St),Dt=Math.max(A,nt,ht,St),$t=Math.min(G,at,dt,At),mt=Math.max(G,at,dt,At);return new o(Rt,$t,Dt-Rt,mt-$t)},lt=function(A,G,O,X,nt,at,ht,dt){var St,At,Rt,Dt,$t,mt,V,ne,qt,Lt,It,Ft,Tt,zt,Kt=O-A,te=X-G,he=nt-O,ve=at-X,we=ht-nt,Xt=dt-at;for(At=0;At<41;At++)qt=(V=(Rt=A+(St=At/40)*Kt)+St*(($t=O+St*he)-Rt))+St*($t+St*(nt+St*we-$t)-V),Lt=(ne=(Dt=G+St*te)+St*((mt=X+St*ve)-Dt))+St*(mt+St*(at+St*Xt-mt)-ne),At==0?(It=qt,Ft=Lt,Tt=qt,zt=Lt):(It=Math.min(It,qt),Ft=Math.min(Ft,Lt),Tt=Math.max(Tt,qt),zt=Math.max(zt,Lt));return new o(Math.round(It),Math.round(Ft),Math.round(Tt-It),Math.round(zt-Ft))},Et=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var A,G,O=(A=this.ctx.lineDash,G=this.ctx.lineDashOffset,JSON.stringify({lineDash:A,lineDashOffset:G}));this.prevLineDash!==O&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=O)}}})(re.API),function(i){var t=function(s){var a,o,l,h,c,f,g,d,m,y;for(o=[],l=0,h=(s+=a="\0\0\0\0".slice(s.length%4||4)).length;h>l;l+=4)(c=(s.charCodeAt(l)<<24)+(s.charCodeAt(l+1)<<16)+(s.charCodeAt(l+2)<<8)+s.charCodeAt(l+3))!==0?(f=(c=((c=((c=((c=(c-(y=c%85))/85)-(m=c%85))/85)-(d=c%85))/85)-(g=c%85))/85)%85,o.push(f+33,g+33,d+33,m+33,y+33)):o.push(122);return function(b,x){for(var E=x;E>0;E--)b.pop()}(o,a.length),String.fromCharCode.apply(String,o)+"~>"},e=function(s){var a,o,l,h,c,f=String,g="length",d=255,m="charCodeAt",y="slice",b="replace";for(s[y](-2),s=s[y](0,-2)[b](/\s/g,"")[b]("z","!!!!!"),l=[],h=0,c=(s+=a="uuuuu"[y](s[g]%5||5))[g];c>h;h+=5)o=52200625*(s[m](h)-33)+614125*(s[m](h+1)-33)+7225*(s[m](h+2)-33)+85*(s[m](h+3)-33)+(s[m](h+4)-33),l.push(d&o>>24,d&o>>16,d&o>>8,d&o);return function(x,E){for(var S=E;S>0;S--)x.pop()}(l,a[g]),f.fromCharCode.apply(f,l)},n=function(s){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),a.test(s)===!1)return"";for(var o="",l=0;l<s.length;l+=2)o+=String.fromCharCode("0x"+(s[l]+s[l+1]));return o},r=function(s){for(var a=new Uint8Array(s.length),o=s.length;o--;)a[o]=s.charCodeAt(o);return s=(a=g0(a)).reduce(function(l,h){return l+String.fromCharCode(h)},"")};i.processDataByFilters=function(s,a){var o=0,l=s||"",h=[];for(typeof(a=a||[])=="string"&&(a=[a]),o=0;o<a.length;o+=1)switch(a[o]){case"ASCII85Decode":case"/ASCII85Decode":l=e(l),h.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=t(l),h.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=n(l),h.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=l.split("").map(function(c){return("0"+c.charCodeAt().toString(16)).slice(-2)}).join("")+">",h.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=r(l),h.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[o]+'" is not implemented')}return{data:l,reverseChain:h.reverse().join(" ")}}}(re.API),function(i){i.loadFile=function(t,e,n){return function(r,s,a){s=s!==!1,a=typeof a=="function"?a:function(){};var o=void 0;try{o=function(l,h,c){var f=new XMLHttpRequest,g=0,d=function(m){var y=m.length,b=[],x=String.fromCharCode;for(g=0;g<y;g+=1)b.push(x(255&m.charCodeAt(g)));return b.join("")};if(f.open("GET",l,!h),f.overrideMimeType("text/plain; charset=x-user-defined"),h===!1&&(f.onload=function(){f.status===200?c(d(this.responseText)):c(void 0)}),f.send(null),h&&f.status===200)return d(f.responseText)}(r,s,a)}catch{}return o}(t,e,n)},i.loadImageFile=i.loadFile}(re.API),function(i){function t(){return(se.html2canvas?Promise.resolve(se.html2canvas):h0(()=>import("./html2canvas.esm-3NQT9CgR.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))}).then(function(a){return a.default?a.default:a})}function e(){return(se.DOMPurify?Promise.resolve(se.DOMPurify):h0(()=>import("./purify.es-CwLlgRcy.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load dompurify: "+a))}).then(function(a){return a.default?a.default:a})}var n=function(a){var o=Xe(a);return o==="undefined"?"undefined":o==="string"||a instanceof String?"string":o==="number"||a instanceof Number?"number":o==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":o==="object"?"object":"unknown"},r=function(a,o){var l=document.createElement(a);for(var h in o.className&&(l.className=o.className),o.innerHTML&&o.dompurify&&(l.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)l.style[h]=o.style[h];return l},s=function a(o){var l=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),h=a.convert(Promise.resolve(),l);return h=(h=h.setProgress(1,a,1,[a])).set(o)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(a,o){return a.__proto__=o||s.prototype,a},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(a,o){return this.then(function(){switch(o=o||function(l){switch(n(l)){case"string":return"string";case"element":return l.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(a)){case"string":return this.then(e).then(function(l){return this.set({src:r("div",{innerHTML:a,dompurify:l})})});case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}})},s.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=function l(h,c){for(var f=h.nodeType===3?document.createTextNode(h.nodeValue):h.cloneNode(!1),g=h.firstChild;g;g=g.nextSibling)c!==!0&&g.nodeType===1&&g.nodeName==="SCRIPT"||f.appendChild(l(g,c));return h.nodeType===1&&(h.nodeName==="CANVAS"?(f.width=h.width,f.height=h.height,f.getContext("2d").drawImage(h,0,0)):h.nodeName!=="TEXTAREA"&&h.nodeName!=="SELECT"||(f.value=h.value),f.addEventListener("load",function(){f.scrollTop=h.scrollTop,f.scrollLeft=h.scrollLeft},!0)),f}(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=r("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=r("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(r("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(t).then(function(o){var l=Object.assign({},this.opt.html2canvas);return delete l.onrendered,o(this.prop.container,l)}).then(function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(t).then(function(o){var l=this.opt.jsPDF,h=this.opt.fontFaces,c=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,f=Object.assign({async:!0,allowTaint:!0,scale:c,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete f.onrendered,l.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,l.context2d.posX=this.opt.x,l.context2d.posY=this.opt.y,l.context2d.margin=this.opt.margin,l.context2d.fontFaces=h,h)for(var g=0;g<h.length;++g){var d=h[g],m=d.src.find(function(y){return y.format==="truetype"});m&&l.addFont(m.url,d.ref.name,d.ref.style)}return f.windowHeight=f.windowHeight||0,f.windowHeight=f.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):f.windowHeight,l.context2d.save(!0),o(this.prop.container,f)}).then(function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(a,o,l){return(l=l||"pdf").toLowerCase()==="img"||l.toLowerCase()==="image"?this.outputImg(a,o):this.outputPdf(a,o)},s.prototype.outputPdf=function(a,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(a,o)})},s.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}})},s.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(a){if(n(a)!=="object")return this;var o=Object.keys(a||{}).map(function(l){if(l in s.template.prop)return function(){this.prop[l]=a[l]};switch(l){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[l]=a[l]}}},this);return this.then(function(){return this.thenList(o)})},s.prototype.get=function(a,o){return this.then(function(){var l=a in s.template.prop?this.prop[a]:this.opt[a];return o?o(l):l})},s.prototype.setMargin=function(a){return this.then(function(){switch(n(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a}).then(this.setPageSize)},s.prototype.setPageSize=function(a){function o(l,h){return Math.floor(l*h/72*96)}return this.then(function(){(a=a||re.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:o(a.inner.width,a.k),height:o(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a})},s.prototype.setProgress=function(a,o,l,h){return a!=null&&(this.progress.val=a),o!=null&&(this.progress.state=o),l!=null&&(this.progress.n=l),h!=null&&(this.progress.stack=h),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(a,o,l,h){return this.setProgress(a?this.progress.val+a:null,o||null,l?this.progress.n+l:null,h?this.progress.stack.concat(h):null)},s.prototype.then=function(a,o){var l=this;return this.thenCore(a,o,function(h,c){return l.updateProgress(null,null,1,[h]),Promise.prototype.then.call(this,function(f){return l.updateProgress(null,h),f}).then(h,c).then(function(f){return l.updateProgress(1),f})})},s.prototype.thenCore=function(a,o,l){l=l||Promise.prototype.then,a&&(a=a.bind(this)),o&&(o=o.bind(this));var h=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:s.convert(Object.assign({},this),Promise.prototype),c=l.call(h,a,o);return s.convert(c,this.__proto__)},s.prototype.thenExternal=function(a,o){return Promise.prototype.then.call(this,a,o)},s.prototype.thenList=function(a){var o=this;return a.forEach(function(l){o=o.thenCore(l)}),o},s.prototype.catch=function(a){a&&(a=a.bind(this));var o=Promise.prototype.catch.call(this,a);return s.convert(o,this)},s.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},s.prototype.error=function(a){return this.then(function(){throw new Error(a)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,re.getPageSize=function(a,o,l){if(Xe(a)==="object"){var h=a;a=h.orientation,o=h.unit||o,l=h.format||l}o=o||"mm",l=l||"a4",a=(""+(a||"P")).toLowerCase();var c,f=(""+l).toLowerCase(),g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":c=1;break;case"mm":c=72/25.4;break;case"cm":c=72/2.54;break;case"in":c=72;break;case"px":c=.75;break;case"pc":case"em":c=12;break;case"ex":c=6;break;default:throw"Invalid unit: "+o}var d,m=0,y=0;if(g.hasOwnProperty(f))m=g[f][1]/c,y=g[f][0]/c;else try{m=l[1],y=l[0]}catch{throw new Error("Invalid format: "+l)}if(a==="p"||a==="portrait")a="p",y>m&&(d=y,y=m,m=d);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",m>y&&(d=y,y=m,m=d)}return{width:y,height:m,unit:o,k:c,orientation:a}},i.html=function(a,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(x0):null;var l=new s(o);return o.worker?l:l.from(a).doCallback()}}(re.API),re.API.addJS=function(i){return Nm=i,this.internal.events.subscribe("postPutResources",function(){Ru=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Ru+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Rm=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Nm+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Ru!==void 0&&Rm!==void 0&&this.internal.out("/Names <</JavaScript "+Ru+" 0 R>>")}),this},function(i){var t;i.events.push(["postPutResources",function(){var e=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=e.outline.render().split(/\r\n/),s=0;s<r.length;s++){var a=r[s],o=n.exec(a);if(o!=null){var l=o[1];e.internal.newObjectDeferredBegin(l,!1)}e.internal.write(a)}if(this.outline.createNamedDestinations){var h=this.internal.pages.length,c=[];for(s=0;s<h;s++){var f=e.internal.newObject();c.push(f);var g=e.internal.getPageInfo(s+1);e.internal.write("<< /D["+g.objId+" 0 R /XYZ null null null]>> endobj")}var d=e.internal.newObject();for(e.internal.write("<< /Names [ "),s=0;s<c.length;s++)e.internal.write("(page_"+(s+1)+")"+c[s]+" 0 R");e.internal.write(" ] >>","endobj"),t=e.internal.newObject(),e.internal.write("<< /Dests "+d+" 0 R"),e.internal.write(">>","endobj")}}]),i.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),i.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(n,r,s){var a={title:r,options:s,children:[]};return n==null&&(n=this.root),n.children.push(a),a},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(n){n.id=e.internal.newObjectDeferred();for(var r=0;r<n.children.length;r++)this.genIds_r(n.children[r])},e.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},e.outline.renderItems=function(n){for(var r=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var a=n.children[s];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var o=this.count=this.count_r({count:0},a);if(o>0&&this.line("/Count "+o),a.options&&a.options.pageNumber){var l=e.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+r(0)+" 0]")}this.objEnd()}for(var h=0;h<n.children.length;h++)this.renderItems(n.children[h])},e.outline.line=function(n){this.ctx.val+=n+`\r
`},e.outline.makeRef=function(n){return n.id+" 0 R"},e.outline.makeString=function(n){return"("+e.internal.pdfEscape(n)+")"},e.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},e.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},e.outline.count_r=function(n,r){for(var s=0;s<r.children.length;s++)n.count++,this.count_r(n,r.children[s]);return n.count}}])}(re.API),function(i){var t=[192,193,194,195,196,197,198,199];i.processJPEG=function(e,n,r,s,a,o){var l,h=this.decode.DCT_DECODE,c=null;if(typeof e=="string"||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=a||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,(l=function(f){for(var g,d=256*f.charCodeAt(4)+f.charCodeAt(5),m=f.length,y={width:0,height:0,numcomponents:1},b=4;b<m;b+=2){if(b+=d,t.indexOf(f.charCodeAt(b+1))!==-1){g=256*f.charCodeAt(b+5)+f.charCodeAt(b+6),y={width:256*f.charCodeAt(b+7)+f.charCodeAt(b+8),height:g,numcomponents:f.charCodeAt(b+9)};break}d=256*f.charCodeAt(b+2)+f.charCodeAt(b+3)}return y}(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}c={data:e,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:h,index:n,alias:r}}return c}}(re.API);var qo,Nu,Fm,Om,km,vE=function(){var i,t,e;function n(s){var a,o,l,h,c,f,g,d,m,y,b,x,E,S;for(this.data=s,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},f=null;;){switch(a=this.readUInt32(),m=(function(){var M,D;for(D=[],M=0;M<4;++M)D.push(String.fromCharCode(this.data[this.pos++]));return D}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(a);break;case"fcTL":f&&this.animation.frames.push(f),this.pos+=4,f={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},c=this.readUInt16(),h=this.readUInt16()||100,f.delay=1e3*c/h,f.disposeOp=this.data[this.pos++],f.blendOp=this.data[this.pos++],f.data=[];break;case"IDAT":case"fdAT":for(m==="fdAT"&&(this.pos+=4,a-=4),s=(f!=null?f.data:void 0)||this.imgData,x=0;0<=a?x<a:x>a;0<=a?++x:--x)s.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(l=this.palette.length/3,this.transparency.indexed=this.read(a),this.transparency.indexed.length>l)throw new Error("More transparent colors than palette size");if((y=l-this.transparency.indexed.length)>0)for(E=0;0<=y?E<y:E>y;0<=y?++E:--E)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(a)[0];break;case 2:this.transparency.rgb=this.read(a)}break;case"tEXt":g=(b=this.read(a)).indexOf(0),d=String.fromCharCode.apply(String,b.slice(0,g)),this.text[d]=String.fromCharCode.apply(String,b.slice(g+1));break;case"IEND":return f&&this.animation.frames.push(f),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(S=this.colorType)===4||S===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=a}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(s){var a,o;for(o=[],a=0;0<=s?a<s:a>s;0<=s?++a:--a)o.push(this.data[this.pos++]);return o},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(s){var a=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*a),l=0,h=this;if(s==null&&(s=this.imgData),s.length===0)return new Uint8Array(0);function c(f,g,d,m){var y,b,x,E,S,M,D,W,j,P,H,et,R,F,U,z,it,Y,st,Q,gt,lt=Math.ceil((h.width-f)/d),Et=Math.ceil((h.height-g)/m),A=h.width==lt&&h.height==Et;for(F=a*lt,et=A?o:new Uint8Array(F*Et),M=s.length,R=0,b=0;R<Et&&l<M;){switch(s[l++]){case 0:for(E=it=0;it<F;E=it+=1)et[b++]=s[l++];break;case 1:for(E=Y=0;Y<F;E=Y+=1)y=s[l++],S=E<a?0:et[b-a],et[b++]=(y+S)%256;break;case 2:for(E=st=0;st<F;E=st+=1)y=s[l++],x=(E-E%a)/a,U=R&&et[(R-1)*F+x*a+E%a],et[b++]=(U+y)%256;break;case 3:for(E=Q=0;Q<F;E=Q+=1)y=s[l++],x=(E-E%a)/a,S=E<a?0:et[b-a],U=R&&et[(R-1)*F+x*a+E%a],et[b++]=(y+Math.floor((S+U)/2))%256;break;case 4:for(E=gt=0;gt<F;E=gt+=1)y=s[l++],x=(E-E%a)/a,S=E<a?0:et[b-a],R===0?U=z=0:(U=et[(R-1)*F+x*a+E%a],z=x&&et[(R-1)*F+(x-1)*a+E%a]),D=S+U-z,W=Math.abs(D-S),P=Math.abs(D-U),H=Math.abs(D-z),j=W<=P&&W<=H?S:P<=H?U:z,et[b++]=(y+j)%256;break;default:throw new Error("Invalid filter algorithm: "+s[l-1])}if(!A){var G=((g+R*m)*h.width+f)*a,O=R*F;for(E=0;E<lt;E+=1){for(var X=0;X<a;X+=1)o[G++]=et[O++];G+=(d-1)*a}}R++}}return s=J3(s),h.interlaceMethod==1?(c(0,0,8,8),c(4,0,8,8),c(0,4,4,8),c(2,0,4,4),c(0,2,2,4),c(1,0,2,2),c(0,1,1,2)):c(0,0,1,1),o},n.prototype.decodePalette=function(){var s,a,o,l,h,c,f,g,d;for(o=this.palette,c=this.transparency.indexed||[],h=new Uint8Array((c.length||0)+o.length),l=0,s=0,a=f=0,g=o.length;f<g;a=f+=3)h[l++]=o[a],h[l++]=o[a+1],h[l++]=o[a+2],h[l++]=(d=c[s++])!=null?d:255;return h},n.prototype.copyToImageData=function(s,a){var o,l,h,c,f,g,d,m,y,b,x;if(l=this.colors,y=null,o=this.hasAlphaChannel,this.palette.length&&(y=(x=this._decodedPalette)!=null?x:this._decodedPalette=this.decodePalette(),l=4,o=!0),m=(h=s.data||s).length,f=y||a,c=g=0,l===1)for(;c<m;)d=y?4*a[c/4]:g,b=f[d++],h[c++]=b,h[c++]=b,h[c++]=b,h[c++]=o?f[d++]:255,g=d;else for(;c<m;)d=y?4*a[c/4]:g,h[c++]=f[d++],h[c++]=f[d++],h[c++]=f[d++],h[c++]=o?f[d++]:255,g=d},n.prototype.decode=function(){var s;return s=new Uint8Array(this.width*this.height*4),this.copyToImageData(s,this.decodePixels()),s};var r=function(){if(Object.prototype.toString.call(se)==="[object Window]"){try{t=se.document.createElement("canvas"),e=t.getContext("2d")}catch{return!1}return!0}return!1};return r(),i=function(s){var a;if(r()===!0)return e.width=s.width,e.height=s.height,e.clearRect(0,0,s.width,s.height),e.putImageData(s,0,0),(a=new Image).src=t.toDataURL(),a;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(s){var a,o,l,h,c,f,g,d;if(this.animation){for(d=[],o=c=0,f=(g=this.animation.frames).length;c<f;o=++c)a=g[o],l=s.createImageData(a.width,a.height),h=this.decodePixels(new Uint8Array(a.data)),this.copyToImageData(l,h),a.imageData=l,d.push(a.image=i(l));return d}},n.prototype.renderFrame=function(s,a){var o,l,h;return o=(l=this.animation.frames)[a],h=l[a-1],a===0&&s.clearRect(0,0,this.width,this.height),(h!=null?h.disposeOp:void 0)===1?s.clearRect(h.xOffset,h.yOffset,h.width,h.height):(h!=null?h.disposeOp:void 0)===2&&s.putImageData(h.imageData,h.xOffset,h.yOffset),o.blendOp===0&&s.clearRect(o.xOffset,o.yOffset,o.width,o.height),s.drawImage(o.image,o.xOffset,o.yOffset)},n.prototype.animate=function(s){var a,o,l,h,c,f,g=this;return o=0,f=this.animation,h=f.numFrames,l=f.frames,c=f.numPlays,(a=function(){var d,m;if(d=o++%h,m=l[d],g.renderFrame(s,d),h>1&&o/h<c)return g.animation._timeout=setTimeout(a,m.delay)})()},n.prototype.stopAnimation=function(){var s;return clearTimeout((s=this.animation)!=null?s._timeout:void 0)},n.prototype.render=function(s){var a,o;return s._png&&s._png.stopAnimation(),s._png=this,s.width=this.width,s.height=this.height,a=s.getContext("2d"),this.animation?(this.decodeFrames(a),this.animate(a)):(o=a.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),a.putImageData(o,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function yE(i){var t=0;if(i[t++]!==71||i[t++]!==73||i[t++]!==70||i[t++]!==56||(i[t++]+1&253)!=56||i[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var e=i[t++]|i[t++]<<8,n=i[t++]|i[t++]<<8,r=i[t++],s=r>>7,a=1<<(7&r)+1;i[t++],i[t++];var o=null,l=null;s&&(o=t,l=a,t+=3*a);var h=!0,c=[],f=0,g=null,d=0,m=null;for(this.width=e,this.height=n;h&&t<i.length;)switch(i[t++]){case 33:switch(i[t++]){case 255:if(i[t]!==11||i[t+1]==78&&i[t+2]==69&&i[t+3]==84&&i[t+4]==83&&i[t+5]==67&&i[t+6]==65&&i[t+7]==80&&i[t+8]==69&&i[t+9]==50&&i[t+10]==46&&i[t+11]==48&&i[t+12]==3&&i[t+13]==1&&i[t+16]==0)t+=14,m=i[t++]|i[t++]<<8,t++;else for(t+=12;;){if(!((R=i[t++])>=0))throw Error("Invalid block size");if(R===0)break;t+=R}break;case 249:if(i[t++]!==4||i[t+4]!==0)throw new Error("Invalid graphics extension block.");var y=i[t++];f=i[t++]|i[t++]<<8,g=i[t++],!(1&y)&&(g=null),d=y>>2&7,t++;break;case 254:for(;;){if(!((R=i[t++])>=0))throw Error("Invalid block size");if(R===0)break;t+=R}break;default:throw new Error("Unknown graphic control label: 0x"+i[t-1].toString(16))}break;case 44:var b=i[t++]|i[t++]<<8,x=i[t++]|i[t++]<<8,E=i[t++]|i[t++]<<8,S=i[t++]|i[t++]<<8,M=i[t++],D=M>>6&1,W=1<<(7&M)+1,j=o,P=l,H=!1;M>>7&&(H=!0,j=t,P=W,t+=3*W);var et=t;for(t++;;){var R;if(!((R=i[t++])>=0))throw Error("Invalid block size");if(R===0)break;t+=R}c.push({x:b,y:x,width:E,height:S,has_local_palette:H,palette_offset:j,palette_size:P,data_offset:et,data_length:t-et,transparent_index:g,interlaced:!!D,delay:f,disposal:d});break;case 59:h=!1;break;default:throw new Error("Unknown gif block: 0x"+i[t-1].toString(16))}this.numFrames=function(){return c.length},this.loopCount=function(){return m},this.frameInfo=function(F){if(F<0||F>=c.length)throw new Error("Frame index out of range.");return c[F]},this.decodeAndBlitFrameBGRA=function(F,U){var z=this.frameInfo(F),it=z.width*z.height,Y=new Uint8Array(it);Dm(i,z.data_offset,Y,it);var st=z.palette_offset,Q=z.transparent_index;Q===null&&(Q=256);var gt=z.width,lt=e-gt,Et=gt,A=4*(z.y*e+z.x),G=4*((z.y+z.height)*e+z.x),O=A,X=4*lt;z.interlaced===!0&&(X+=4*e*7);for(var nt=8,at=0,ht=Y.length;at<ht;++at){var dt=Y[at];if(Et===0&&(Et=gt,(O+=X)>=G&&(X=4*lt+4*e*(nt-1),O=A+(gt+lt)*(nt<<1),nt>>=1)),dt===Q)O+=4;else{var St=i[st+3*dt],At=i[st+3*dt+1],Rt=i[st+3*dt+2];U[O++]=Rt,U[O++]=At,U[O++]=St,U[O++]=255}--Et}},this.decodeAndBlitFrameRGBA=function(F,U){var z=this.frameInfo(F),it=z.width*z.height,Y=new Uint8Array(it);Dm(i,z.data_offset,Y,it);var st=z.palette_offset,Q=z.transparent_index;Q===null&&(Q=256);var gt=z.width,lt=e-gt,Et=gt,A=4*(z.y*e+z.x),G=4*((z.y+z.height)*e+z.x),O=A,X=4*lt;z.interlaced===!0&&(X+=4*e*7);for(var nt=8,at=0,ht=Y.length;at<ht;++at){var dt=Y[at];if(Et===0&&(Et=gt,(O+=X)>=G&&(X=4*lt+4*e*(nt-1),O=A+(gt+lt)*(nt<<1),nt>>=1)),dt===Q)O+=4;else{var St=i[st+3*dt],At=i[st+3*dt+1],Rt=i[st+3*dt+2];U[O++]=St,U[O++]=At,U[O++]=Rt,U[O++]=255}--Et}}}function Dm(i,t,e,n){for(var r=i[t++],s=1<<r,a=s+1,o=a+1,l=r+1,h=(1<<l)-1,c=0,f=0,g=0,d=i[t++],m=new Int32Array(4096),y=null;;){for(;c<16&&d!==0;)f|=i[t++]<<c,c+=8,d===1?d=i[t++]:--d;if(c<l)break;var b=f&h;if(f>>=l,c-=l,b!==s){if(b===a)break;for(var x=b<o?b:y,E=0,S=x;S>s;)S=m[S]>>8,++E;var M=S;if(g+E+(x!==b?1:0)>n)return void Qe.log("Warning, gif stream longer than expected.");e[g++]=M;var D=g+=E;for(x!==b&&(e[g++]=M),S=x;E--;)S=m[S],e[--D]=255&S,S>>=8;y!==null&&o<4096&&(m[o++]=y<<8|M,o>=h+1&&l<12&&(++l,h=h<<1|1)),y=b}else o=a+1,h=(1<<(l=r+1))-1,y=null}return g!==n&&Qe.log("Warning, gif stream shorter than expected."),e}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Lg(i){var t,e,n,r,s,a=Math.floor,o=new Array(64),l=new Array(64),h=new Array(64),c=new Array(64),f=new Array(65535),g=new Array(65535),d=new Array(64),m=new Array(64),y=[],b=0,x=7,E=new Array(64),S=new Array(64),M=new Array(64),D=new Array(256),W=new Array(2048),j=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],P=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],H=[0,1,2,3,4,5,6,7,8,9,10,11],et=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],R=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],F=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],U=[0,1,2,3,4,5,6,7,8,9,10,11],z=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],it=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Y(A,G){for(var O=0,X=0,nt=new Array,at=1;at<=16;at++){for(var ht=1;ht<=A[at];ht++)nt[G[X]]=[],nt[G[X]][0]=O,nt[G[X]][1]=at,X++,O++;O*=2}return nt}function st(A){for(var G=A[0],O=A[1]-1;O>=0;)G&1<<O&&(b|=1<<x),O--,--x<0&&(b==255?(Q(255),Q(0)):Q(b),x=7,b=0)}function Q(A){y.push(A)}function gt(A){Q(A>>8&255),Q(255&A)}function lt(A,G,O,X,nt){for(var at,ht=nt[0],dt=nt[240],St=function(Lt,It){var Ft,Tt,zt,Kt,te,he,ve,we,Xt,me,Pt=0;for(Xt=0;Xt<8;++Xt){Ft=Lt[Pt],Tt=Lt[Pt+1],zt=Lt[Pt+2],Kt=Lt[Pt+3],te=Lt[Pt+4],he=Lt[Pt+5],ve=Lt[Pt+6];var Di=Ft+(we=Lt[Pt+7]),Se=Ft-we,qn=Tt+ve,We=Tt-ve,$e=zt+he,Un=zt-he,Me=Kt+te,kr=Kt-te,ei=Di+Me,Ji=Di-Me,vn=qn+$e,Ye=qn-$e;Lt[Pt]=ei+vn,Lt[Pt+4]=ei-vn;var oe=.707106781*(Ye+Ji);Lt[Pt+2]=Ji+oe,Lt[Pt+6]=Ji-oe;var Pe=.382683433*((ei=kr+Un)-(Ye=We+Se)),Ii=.5411961*ei+Pe,ai=1.306562965*Ye+Pe,ui=.707106781*(vn=Un+We),wi=Se+ui,Wt=Se-ui;Lt[Pt+5]=Wt+Ii,Lt[Pt+3]=Wt-Ii,Lt[Pt+1]=wi+ai,Lt[Pt+7]=wi-ai,Pt+=8}for(Pt=0,Xt=0;Xt<8;++Xt){Ft=Lt[Pt],Tt=Lt[Pt+8],zt=Lt[Pt+16],Kt=Lt[Pt+24],te=Lt[Pt+32],he=Lt[Pt+40],ve=Lt[Pt+48];var Ei=Ft+(we=Lt[Pt+56]),Ri=Ft-we,Ee=Tt+ve,Ae=Tt-ve,je=zt+he,yn=zt-he,ho=Kt+te,as=Kt-te,fr=Ei+ho,dr=Ei-ho,gr=Ee+je,Dr=Ee-je;Lt[Pt]=fr+gr,Lt[Pt+32]=fr-gr;var tr=.707106781*(Dr+dr);Lt[Pt+16]=dr+tr,Lt[Pt+48]=dr-tr;var jr=.382683433*((fr=as+yn)-(Dr=Ae+Ri)),Pa=.5411961*fr+jr,co=1.306562965*Dr+jr,uo=.707106781*(gr=yn+Ae),fo=Ri+uo,go=Ri-uo;Lt[Pt+40]=go+Pa,Lt[Pt+24]=go-Pa,Lt[Pt+8]=fo+co,Lt[Pt+56]=fo-co,Pt++}for(Xt=0;Xt<64;++Xt)me=Lt[Xt]*It[Xt],d[Xt]=me>0?me+.5|0:me-.5|0;return d}(A,G),At=0;At<64;++At)m[j[At]]=St[At];var Rt=m[0]-O;O=m[0],Rt==0?st(X[0]):(st(X[g[at=32767+Rt]]),st(f[at]));for(var Dt=63;Dt>0&&m[Dt]==0;)Dt--;if(Dt==0)return st(ht),O;for(var $t,mt=1;mt<=Dt;){for(var V=mt;m[mt]==0&&mt<=Dt;)++mt;var ne=mt-V;if(ne>=16){$t=ne>>4;for(var qt=1;qt<=$t;++qt)st(dt);ne&=15}at=32767+m[mt],st(nt[(ne<<4)+g[at]]),st(f[at]),mt++}return Dt!=63&&st(ht),O}function Et(A){A=Math.min(Math.max(A,1),100),s!=A&&(function(G){for(var O=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],X=0;X<64;X++){var nt=a((O[X]*G+50)/100);nt=Math.min(Math.max(nt,1),255),o[j[X]]=nt}for(var at=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ht=0;ht<64;ht++){var dt=a((at[ht]*G+50)/100);dt=Math.min(Math.max(dt,1),255),l[j[ht]]=dt}for(var St=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],At=0,Rt=0;Rt<8;Rt++)for(var Dt=0;Dt<8;Dt++)h[At]=1/(o[j[At]]*St[Rt]*St[Dt]*8),c[At]=1/(l[j[At]]*St[Rt]*St[Dt]*8),At++}(A<50?Math.floor(5e3/A):Math.floor(200-2*A)),s=A)}this.encode=function(A,G){G&&Et(G),y=new Array,b=0,x=7,gt(65496),gt(65504),gt(16),Q(74),Q(70),Q(73),Q(70),Q(0),Q(1),Q(1),Q(0),gt(1),gt(1),Q(0),Q(0),function(){gt(65499),gt(132),Q(0);for(var Tt=0;Tt<64;Tt++)Q(o[Tt]);Q(1);for(var zt=0;zt<64;zt++)Q(l[zt])}(),function(Tt,zt){gt(65472),gt(17),Q(8),gt(zt),gt(Tt),Q(3),Q(1),Q(17),Q(0),Q(2),Q(17),Q(1),Q(3),Q(17),Q(1)}(A.width,A.height),function(){gt(65476),gt(418),Q(0);for(var Tt=0;Tt<16;Tt++)Q(P[Tt+1]);for(var zt=0;zt<=11;zt++)Q(H[zt]);Q(16);for(var Kt=0;Kt<16;Kt++)Q(et[Kt+1]);for(var te=0;te<=161;te++)Q(R[te]);Q(1);for(var he=0;he<16;he++)Q(F[he+1]);for(var ve=0;ve<=11;ve++)Q(U[ve]);Q(17);for(var we=0;we<16;we++)Q(z[we+1]);for(var Xt=0;Xt<=161;Xt++)Q(it[Xt])}(),gt(65498),gt(12),Q(3),Q(1),Q(0),Q(2),Q(17),Q(3),Q(17),Q(0),Q(63),Q(0);var O=0,X=0,nt=0;b=0,x=7,this.encode.displayName="_encode_";for(var at,ht,dt,St,At,Rt,Dt,$t,mt,V=A.data,ne=A.width,qt=A.height,Lt=4*ne,It=0;It<qt;){for(at=0;at<Lt;){for(At=Lt*It+at,Dt=-1,$t=0,mt=0;mt<64;mt++)Rt=At+($t=mt>>3)*Lt+(Dt=4*(7&mt)),It+$t>=qt&&(Rt-=Lt*(It+1+$t-qt)),at+Dt>=Lt&&(Rt-=at+Dt-Lt+4),ht=V[Rt++],dt=V[Rt++],St=V[Rt++],E[mt]=(W[ht]+W[dt+256>>0]+W[St+512>>0]>>16)-128,S[mt]=(W[ht+768>>0]+W[dt+1024>>0]+W[St+1280>>0]>>16)-128,M[mt]=(W[ht+1280>>0]+W[dt+1536>>0]+W[St+1792>>0]>>16)-128;O=lt(E,h,O,t,n),X=lt(S,c,X,e,r),nt=lt(M,c,nt,e,r),at+=32}It+=8}if(x>=0){var Ft=[];Ft[1]=x+1,Ft[0]=(1<<x+1)-1,st(Ft)}return gt(65497),new Uint8Array(y)},i=i||50,function(){for(var A=String.fromCharCode,G=0;G<256;G++)D[G]=A(G)}(),t=Y(P,H),e=Y(F,U),n=Y(et,R),r=Y(z,it),function(){for(var A=1,G=2,O=1;O<=15;O++){for(var X=A;X<G;X++)g[32767+X]=O,f[32767+X]=[],f[32767+X][1]=O,f[32767+X][0]=X;for(var nt=-(G-1);nt<=-A;nt++)g[32767+nt]=O,f[32767+nt]=[],f[32767+nt][1]=O,f[32767+nt][0]=G-1+nt;A<<=1,G<<=1}}(),function(){for(var A=0;A<256;A++)W[A]=19595*A,W[A+256>>0]=38470*A,W[A+512>>0]=7471*A+32768,W[A+768>>0]=-11059*A,W[A+1024>>0]=-21709*A,W[A+1280>>0]=32768*A+8421375,W[A+1536>>0]=-27439*A,W[A+1792>>0]=-5329*A}(),Et(i)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Cr(i,t){if(this.pos=0,this.buffer=i,this.datav=new DataView(i.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function jm(i){function t(P){if(!P)throw Error("assert :P")}function e(P,H,et){for(var R=0;4>R;R++)if(P[H+R]!=et.charCodeAt(R))return!0;return!1}function n(P,H,et,R,F){for(var U=0;U<F;U++)P[H+U]=et[R+U]}function r(P,H,et,R){for(var F=0;F<R;F++)P[H+F]=et}function s(P){return new Int32Array(P)}function a(P,H){for(var et=[],R=0;R<P;R++)et.push(new H);return et}function o(P,H){var et=[];return function R(F,U,z){for(var it=z[U],Y=0;Y<it&&(F.push(z.length>U+1?[]:new H),!(z.length<U+1));Y++)R(F[Y],U+1,z)}(et,0,P),et}var l=function(){var P=this;function H(u,p){for(var v=1<<p-1>>>0;u&v;)v>>>=1;return v?(u&v-1)+v:u}function et(u,p,v,w,L){t(!(w%v));do u[p+(w-=v)]=L;while(0<w)}function R(u,p,v,w,L){if(t(2328>=L),512>=L)var T=s(512);else if((T=s(L))==null)return 0;return function(I,N,k,B,K,ct){var ut,rt,xt=N,pt=1<<k,J=s(16),tt=s(16);for(t(K!=0),t(B!=null),t(I!=null),t(0<k),rt=0;rt<K;++rt){if(15<B[rt])return 0;++J[B[rt]]}if(J[0]==K)return 0;for(tt[1]=0,ut=1;15>ut;++ut){if(J[ut]>1<<ut)return 0;tt[ut+1]=tt[ut]+J[ut]}for(rt=0;rt<K;++rt)ut=B[rt],0<B[rt]&&(ct[tt[ut]++]=rt);if(tt[15]==1)return(B=new F).g=0,B.value=ct[0],et(I,xt,1,pt,B),pt;var vt,wt=-1,yt=pt-1,Bt=0,Nt=1,ie=1,Ot=1<<k;for(rt=0,ut=1,K=2;ut<=k;++ut,K<<=1){if(Nt+=ie<<=1,0>(ie-=J[ut]))return 0;for(;0<J[ut];--J[ut])(B=new F).g=ut,B.value=ct[rt++],et(I,xt+Bt,K,Ot,B),Bt=H(Bt,ut)}for(ut=k+1,K=2;15>=ut;++ut,K<<=1){if(Nt+=ie<<=1,0>(ie-=J[ut]))return 0;for(;0<J[ut];--J[ut]){if(B=new F,(Bt&yt)!=wt){for(xt+=Ot,vt=1<<(wt=ut)-k;15>wt&&!(0>=(vt-=J[wt]));)++wt,vt<<=1;pt+=Ot=1<<(vt=wt-k),I[N+(wt=Bt&yt)].g=vt+k,I[N+wt].value=xt-N-wt}B.g=ut-k,B.value=ct[rt++],et(I,xt+(Bt>>k),K,Ot,B),Bt=H(Bt,ut)}}return Nt!=2*tt[15]-1?0:pt}(u,p,v,w,L,T)}function F(){this.value=this.g=0}function U(){this.value=this.g=0}function z(){this.G=a(5,F),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(Mn,U)}function it(u,p,v,w){t(u!=null),t(p!=null),t(2147483648>w),u.Ca=254,u.I=0,u.b=-8,u.Ka=0,u.oa=p,u.pa=v,u.Jd=p,u.Yc=v+w,u.Zc=4<=w?v+w-4+1:v,at(u)}function Y(u,p){for(var v=0;0<p--;)v|=dt(u,128)<<p;return v}function st(u,p){var v=Y(u,p);return ht(u)?-v:v}function Q(u,p,v,w){var L,T=0;for(t(u!=null),t(p!=null),t(4294967288>w),u.Sb=w,u.Ra=0,u.u=0,u.h=0,4<w&&(w=4),L=0;L<w;++L)T+=p[v+L]<<8*L;u.Ra=T,u.bb=w,u.oa=p,u.pa=v}function gt(u){for(;8<=u.u&&u.bb<u.Sb;)u.Ra>>>=8,u.Ra+=u.oa[u.pa+u.bb]<<To-8>>>0,++u.bb,u.u-=8;O(u)&&(u.h=1,u.u=0)}function lt(u,p){if(t(0<=p),!u.h&&p<=Mo){var v=G(u)&Ao[p];return u.u+=p,gt(u),v}return u.h=1,u.u=0}function Et(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function A(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function G(u){return u.Ra>>>(u.u&To-1)>>>0}function O(u){return t(u.bb<=u.Sb),u.h||u.bb==u.Sb&&u.u>To}function X(u,p){u.u=p,u.h=O(u)}function nt(u){u.u>=oh&&(t(u.u>=oh),gt(u))}function at(u){t(u!=null&&u.oa!=null),u.pa<u.Zc?(u.I=(u.oa[u.pa++]|u.I<<8)>>>0,u.b+=8):(t(u!=null&&u.oa!=null),u.pa<u.Yc?(u.b+=8,u.I=u.oa[u.pa++]|u.I<<8):u.Ka?u.b=0:(u.I<<=8,u.b+=8,u.Ka=1))}function ht(u){return Y(u,1)}function dt(u,p){var v=u.Ca;0>u.b&&at(u);var w=u.b,L=v*p>>>8,T=(u.I>>>w>L)+0;for(T?(v-=L,u.I-=L+1<<w>>>0):v=L+1,w=v,L=0;256<=w;)L+=8,w>>=8;return w=7^L+Tn[w],u.b-=w,u.Ca=(v<<w)-1,T}function St(u,p,v){u[p+0]=v>>24&255,u[p+1]=v>>16&255,u[p+2]=v>>8&255,u[p+3]=v>>0&255}function At(u,p){return u[p+0]<<0|u[p+1]<<8}function Rt(u,p){return At(u,p)|u[p+2]<<16}function Dt(u,p){return At(u,p)|At(u,p+2)<<16}function $t(u,p){var v=1<<p;return t(u!=null),t(0<p),u.X=s(v),u.X==null?0:(u.Mb=32-p,u.Xa=p,1)}function mt(u,p){t(u!=null),t(p!=null),t(u.Xa==p.Xa),n(p.X,0,u.X,0,1<<p.Xa)}function V(){this.X=[],this.Xa=this.Mb=0}function ne(u,p,v,w){t(v!=null),t(w!=null);var L=v[0],T=w[0];return L==0&&(L=(u*T+p/2)/p),T==0&&(T=(p*L+u/2)/u),0>=L||0>=T?0:(v[0]=L,w[0]=T,1)}function qt(u,p){return u+(1<<p)-1>>>p}function Lt(u,p){return((4278255360&u)+(4278255360&p)>>>0&4278255360)+((16711935&u)+(16711935&p)>>>0&16711935)>>>0}function It(u,p){P[p]=function(v,w,L,T,I,N,k){var B;for(B=0;B<I;++B){var K=P[u](N[k+B-1],L,T+B);N[k+B]=Lt(v[w+B],K)}}}function Ft(){this.ud=this.hd=this.jd=0}function Tt(u,p){return((4278124286&(u^p))>>>1)+(u&p)>>>0}function zt(u){return 0<=u&&256>u?u:0>u?0:255<u?255:void 0}function Kt(u,p){return zt(u+(u-p+.5>>1))}function te(u,p,v){return Math.abs(p-v)-Math.abs(u-v)}function he(u,p,v,w,L,T,I){for(w=T[I-1],v=0;v<L;++v)T[I+v]=w=Lt(u[p+v],w)}function ve(u,p,v,w,L){var T;for(T=0;T<v;++T){var I=u[p+T],N=I>>8&255,k=16711935&(k=(k=16711935&I)+((N<<16)+N));w[L+T]=(4278255360&I)+k>>>0}}function we(u,p){p.jd=u>>0&255,p.hd=u>>8&255,p.ud=u>>16&255}function Xt(u,p,v,w,L,T){var I;for(I=0;I<w;++I){var N=p[v+I],k=N>>>8,B=N,K=255&(K=(K=N>>>16)+((u.jd<<24>>24)*(k<<24>>24)>>>5));B=255&(B=(B=B+((u.hd<<24>>24)*(k<<24>>24)>>>5))+((u.ud<<24>>24)*(K<<24>>24)>>>5)),L[T+I]=(4278255360&N)+(K<<16)+B}}function me(u,p,v,w,L){P[p]=function(T,I,N,k,B,K,ct,ut,rt){for(k=ct;k<ut;++k)for(ct=0;ct<rt;++ct)B[K++]=L(N[w(T[I++])])},P[u]=function(T,I,N,k,B,K,ct){var ut=8>>T.b,rt=T.Ea,xt=T.K[0],pt=T.w;if(8>ut)for(T=(1<<T.b)-1,pt=(1<<ut)-1;I<N;++I){var J,tt=0;for(J=0;J<rt;++J)J&T||(tt=w(k[B++])),K[ct++]=L(xt[tt&pt]),tt>>=ut}else P["VP8LMapColor"+v](k,B,xt,pt,K,ct,I,N,rt)}}function Pt(u,p,v,w,L){for(v=p+v;p<v;){var T=u[p++];w[L++]=T>>16&255,w[L++]=T>>8&255,w[L++]=T>>0&255}}function Di(u,p,v,w,L){for(v=p+v;p<v;){var T=u[p++];w[L++]=T>>16&255,w[L++]=T>>8&255,w[L++]=T>>0&255,w[L++]=T>>24&255}}function Se(u,p,v,w,L){for(v=p+v;p<v;){var T=(I=u[p++])>>16&240|I>>12&15,I=I>>0&240|I>>28&15;w[L++]=T,w[L++]=I}}function qn(u,p,v,w,L){for(v=p+v;p<v;){var T=(I=u[p++])>>16&248|I>>13&7,I=I>>5&224|I>>3&31;w[L++]=T,w[L++]=I}}function We(u,p,v,w,L){for(v=p+v;p<v;){var T=u[p++];w[L++]=T>>0&255,w[L++]=T>>8&255,w[L++]=T>>16&255}}function $e(u,p,v,w,L,T){if(T==0)for(v=p+v;p<v;)St(w,((T=u[p++])[0]>>24|T[1]>>8&65280|T[2]<<8&16711680|T[3]<<24)>>>0),L+=32;else n(w,L,u,p,v)}function Un(u,p){P[p][0]=P[u+"0"],P[p][1]=P[u+"1"],P[p][2]=P[u+"2"],P[p][3]=P[u+"3"],P[p][4]=P[u+"4"],P[p][5]=P[u+"5"],P[p][6]=P[u+"6"],P[p][7]=P[u+"7"],P[p][8]=P[u+"8"],P[p][9]=P[u+"9"],P[p][10]=P[u+"10"],P[p][11]=P[u+"11"],P[p][12]=P[u+"12"],P[p][13]=P[u+"13"],P[p][14]=P[u+"0"],P[p][15]=P[u+"0"]}function Me(u){return u==jd||u==Bd||u==Qc||u==Gd}function kr(){this.eb=[],this.size=this.A=this.fb=0}function ei(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Ji(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new kr,this.f.kb=new ei,this.sd=null}function vn(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ye(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function oe(u){return alert("todo:WebPSamplerProcessPlane"),u.T}function Pe(u,p){var v=u.T,w=p.ba.f.RGBA,L=w.eb,T=w.fb+u.ka*w.A,I=rr[p.ba.S],N=u.y,k=u.O,B=u.f,K=u.N,ct=u.ea,ut=u.W,rt=p.cc,xt=p.dc,pt=p.Mc,J=p.Nc,tt=u.ka,vt=u.ka+u.T,wt=u.U,yt=wt+1>>1;for(tt==0?I(N,k,null,null,B,K,ct,ut,B,K,ct,ut,L,T,null,null,wt):(I(p.ec,p.fc,N,k,rt,xt,pt,J,B,K,ct,ut,L,T-w.A,L,T,wt),++v);tt+2<vt;tt+=2)rt=B,xt=K,pt=ct,J=ut,K+=u.Rc,ut+=u.Rc,T+=2*w.A,I(N,(k+=2*u.fa)-u.fa,N,k,rt,xt,pt,J,B,K,ct,ut,L,T-w.A,L,T,wt);return k+=u.fa,u.j+vt<u.o?(n(p.ec,p.fc,N,k,wt),n(p.cc,p.dc,B,K,yt),n(p.Mc,p.Nc,ct,ut,yt),v--):1&vt||I(N,k,null,null,B,K,ct,ut,B,K,ct,ut,L,T+w.A,null,null,wt),v}function Ii(u,p,v){var w=u.F,L=[u.J];if(w!=null){var T=u.U,I=p.ba.S,N=I==Jc||I==Qc;p=p.ba.f.RGBA;var k=[0],B=u.ka;k[0]=u.T,u.Kb&&(B==0?--k[0]:(--B,L[0]-=u.width),u.j+u.ka+u.T==u.o&&(k[0]=u.o-u.j-B));var K=p.eb;B=p.fb+B*p.A,u=Xc(w,L[0],u.width,T,k,K,B+(N?0:3),p.A),t(v==k),u&&Me(I)&&Hs(K,B,N,T,k,p.A)}return 0}function ai(u){var p=u.ma,v=p.ba.S,w=11>v,L=v==Kc||v==$c||v==Jc||v==Dd||v==12||Me(v);if(p.memory=null,p.Ib=null,p.Jb=null,p.Nd=null,!sh(p.Oa,u,L?11:12))return 0;if(L&&Me(v)&&Ct(),u.da)alert("todo:use_scaling");else{if(w){if(p.Ib=oe,u.Kb){if(v=u.U+1>>1,p.memory=s(u.U+2*v),p.memory==null)return 0;p.ec=p.memory,p.fc=0,p.cc=p.ec,p.dc=p.fc+u.U,p.Mc=p.cc,p.Nc=p.dc+v,p.Ib=Pe,Ct()}}else alert("todo:EmitYUV");L&&(p.Jb=Ii,w&&ot())}if(w&&!up){for(u=0;256>u;++u)qy[u]=89858*(u-128)+eu>>tu,Vy[u]=-22014*(u-128)+eu,Wy[u]=-45773*(u-128),Uy[u]=113618*(u-128)+eu>>tu;for(u=dh;u<Ud;++u)p=76283*(u-16)+eu>>tu,Hy[u-dh]=Wn(p,255),Xy[u-dh]=Wn(p+8>>4,15);up=1}return 1}function ui(u){var p=u.ma,v=u.U,w=u.T;return t(!(1&u.ka)),0>=v||0>=w?0:(v=p.Ib(u,p),p.Jb!=null&&p.Jb(u,p,v),p.Dc+=v,1)}function wi(u){u.ma.memory=null}function Wt(u,p,v,w){return lt(u,8)!=47?0:(p[0]=lt(u,14)+1,v[0]=lt(u,14)+1,w[0]=lt(u,1),lt(u,3)!=0?0:!u.h)}function Ei(u,p){if(4>u)return u+1;var v=u-2>>1;return(2+(1&u)<<v)+lt(p,v)+1}function Ri(u,p){return 120<p?p-120:1<=(v=((v=My[p-1])>>4)*u+(8-(15&v)))?v:1;var v}function Ee(u,p,v){var w=G(v),L=u[p+=255&w].g-8;return 0<L&&(X(v,v.u+8),w=G(v),p+=u[p].value,p+=w&(1<<L)-1),X(v,v.u+u[p].g),u[p].value}function Ae(u,p,v){return v.g+=u.g,v.value+=u.value<<p>>>0,t(8>=v.g),u.g}function je(u,p,v){var w=u.xc;return t((p=w==0?0:u.vc[u.md*(v>>w)+(p>>w)])<u.Wb),u.Ya[p]}function yn(u,p,v,w){var L=u.ab,T=u.c*p,I=u.C;p=I+p;var N=v,k=w;for(w=u.Ta,v=u.Ua;0<L--;){var B=u.gc[L],K=I,ct=p,ut=N,rt=k,xt=(k=w,N=v,B.Ea);switch(t(K<ct),t(ct<=B.nc),B.hc){case 2:Hc(ut,rt,(ct-K)*xt,k,N);break;case 0:var pt=K,J=ct,tt=k,vt=N,wt=(Ot=B).Ea;pt==0&&(Nd(ut,rt,null,null,1,tt,vt),he(ut,rt+1,0,0,wt-1,tt,vt+1),rt+=wt,vt+=wt,++pt);for(var yt=1<<Ot.b,Bt=yt-1,Nt=qt(wt,Ot.b),ie=Ot.K,Ot=Ot.w+(pt>>Ot.b)*Nt;pt<J;){var Oe=ie,Ve=Ot,Ie=1;for(lh(ut,rt,tt,vt-wt,1,tt,vt);Ie<wt;){var Le=(Ie&~Bt)+yt;Le>wt&&(Le=wt),(0,qs[Oe[Ve++]>>8&15])(ut,rt+ +Ie,tt,vt+Ie-wt,Le-Ie,tt,vt+Ie),Ie=Le}rt+=wt,vt+=wt,++pt&Bt||(Ot+=Nt)}ct!=B.nc&&n(k,N-xt,k,N+(ct-K-1)*xt,xt);break;case 1:for(xt=ut,J=rt,wt=(ut=B.Ea)-(vt=ut&~(tt=(rt=1<<B.b)-1)),pt=qt(ut,B.b),yt=B.K,B=B.w+(K>>B.b)*pt;K<ct;){for(Bt=yt,Nt=B,ie=new Ft,Ot=J+vt,Oe=J+ut;J<Ot;)we(Bt[Nt++],ie),er(ie,xt,J,rt,k,N),J+=rt,N+=rt;J<Oe&&(we(Bt[Nt++],ie),er(ie,xt,J,wt,k,N),J+=wt,N+=wt),++K&tt||(B+=pt)}break;case 3:if(ut==k&&rt==N&&0<B.b){for(J=k,ut=xt=N+(ct-K)*xt-(vt=(ct-K)*qt(B.Ea,B.b)),rt=k,tt=N,pt=[],vt=(wt=vt)-1;0<=vt;--vt)pt[vt]=rt[tt+vt];for(vt=wt-1;0<=vt;--vt)J[ut+vt]=pt[vt];vr(B,K,ct,k,xt,k,N)}else vr(B,K,ct,ut,rt,k,N)}N=w,k=v}k!=v&&n(w,v,N,k,T)}function ho(u,p){var v=u.V,w=u.Ba+u.c*u.C,L=p-u.C;if(t(p<=u.l.o),t(16>=L),0<L){var T=u.l,I=u.Ta,N=u.Ua,k=T.width;if(yn(u,L,v,w),L=N=[N],t((v=u.C)<(w=p)),t(T.v<T.va),w>T.o&&(w=T.o),v<T.j){var B=T.j-v;v=T.j,L[0]+=B*k}if(v>=w?v=0:(L[0]+=4*T.v,T.ka=v-T.j,T.U=T.va-T.v,T.T=w-v,v=1),v){if(N=N[0],11>(v=u.ca).S){var K=v.f.RGBA,ct=(w=v.S,L=T.U,T=T.T,B=K.eb,K.A),ut=T;for(K=K.fb+u.Ma*K.A;0<ut--;){var rt=I,xt=N,pt=L,J=B,tt=K;switch(w){case Zc:yr(rt,xt,pt,J,tt);break;case Kc:Us(rt,xt,pt,J,tt);break;case jd:Us(rt,xt,pt,J,tt),Hs(J,tt,0,pt,1,0);break;case ep:Po(rt,xt,pt,J,tt);break;case $c:$e(rt,xt,pt,J,tt,1);break;case Bd:$e(rt,xt,pt,J,tt,1),Hs(J,tt,0,pt,1,0);break;case Jc:$e(rt,xt,pt,J,tt,0);break;case Qc:$e(rt,xt,pt,J,tt,0),Hs(J,tt,1,pt,1,0);break;case Dd:Gr(rt,xt,pt,J,tt);break;case Gd:Gr(rt,xt,pt,J,tt),No(J,tt,pt,1,0);break;case ip:cs(rt,xt,pt,J,tt);break;default:t(0)}N+=k,K+=ct}u.Ma+=T}else alert("todo:EmitRescaledRowsYUVA");t(u.Ma<=v.height)}}u.C=p,t(u.C<=u.i)}function as(u){var p;if(0<u.ua)return 0;for(p=0;p<u.Wb;++p){var v=u.Ya[p].G,w=u.Ya[p].H;if(0<v[1][w[1]+0].g||0<v[2][w[2]+0].g||0<v[3][w[3]+0].g)return 0}return 1}function fr(u,p,v,w,L,T){if(u.Z!=0){var I=u.qd,N=u.rd;for(t(Ys[u.Z]!=null);p<v;++p)Ys[u.Z](I,N,w,L,w,L,T),I=w,N=L,L+=T;u.qd=I,u.rd=N}}function dr(u,p){var v=u.l.ma,w=v.Z==0||v.Z==1?u.l.j:u.C;if(w=u.C<w?w:u.C,t(p<=u.l.o),p>w){var L=u.l.width,T=v.ca,I=v.tb+L*w,N=u.V,k=u.Ba+u.c*w,B=u.gc;t(u.ab==1),t(B[0].hc==3),Fd(B[0],w,p,N,k,T,I),fr(v,w,p,T,I,L)}u.C=u.Ma=p}function gr(u,p,v,w,L,T,I){var N=u.$/w,k=u.$%w,B=u.m,K=u.s,ct=v+u.$,ut=ct;L=v+w*L;var rt=v+w*T,xt=280+K.ua,pt=u.Pb?N:16777216,J=0<K.ua?K.Wa:null,tt=K.wc,vt=ct<rt?je(K,k,N):null;t(u.C<T),t(rt<=L);var wt=!1;t:for(;;){for(;wt||ct<rt;){var yt=0;if(N>=pt){var Bt=ct-v;t((pt=u).Pb),pt.wd=pt.m,pt.xd=Bt,0<pt.s.ua&&mt(pt.s.Wa,pt.s.vb),pt=N+Py}if(k&tt||(vt=je(K,k,N)),t(vt!=null),vt.Qb&&(p[ct]=vt.qb,wt=!0),!wt)if(nt(B),vt.jc){yt=B,Bt=p;var Nt=ct,ie=vt.pd[G(yt)&Mn-1];t(vt.jc),256>ie.g?(X(yt,yt.u+ie.g),Bt[Nt]=ie.value,yt=0):(X(yt,yt.u+ie.g-256),t(256<=ie.value),yt=ie.value),yt==0&&(wt=!0)}else yt=Ee(vt.G[0],vt.H[0],B);if(B.h)break;if(wt||256>yt){if(!wt)if(vt.nd)p[ct]=(vt.qb|yt<<8)>>>0;else{if(nt(B),wt=Ee(vt.G[1],vt.H[1],B),nt(B),Bt=Ee(vt.G[2],vt.H[2],B),Nt=Ee(vt.G[3],vt.H[3],B),B.h)break;p[ct]=(Nt<<24|wt<<16|yt<<8|Bt)>>>0}if(wt=!1,++ct,++k>=w&&(k=0,++N,I!=null&&N<=T&&!(N%16)&&I(u,N),J!=null))for(;ut<ct;)yt=p[ut++],J.X[(506832829*yt&4294967295)>>>J.Mb]=yt}else if(280>yt){if(yt=Ei(yt-256,B),Bt=Ee(vt.G[4],vt.H[4],B),nt(B),Bt=Ri(w,Bt=Ei(Bt,B)),B.h)break;if(ct-v<Bt||L-ct<yt)break t;for(Nt=0;Nt<yt;++Nt)p[ct+Nt]=p[ct+Nt-Bt];for(ct+=yt,k+=yt;k>=w;)k-=w,++N,I!=null&&N<=T&&!(N%16)&&I(u,N);if(t(ct<=L),k&tt&&(vt=je(K,k,N)),J!=null)for(;ut<ct;)yt=p[ut++],J.X[(506832829*yt&4294967295)>>>J.Mb]=yt}else{if(!(yt<xt))break t;for(wt=yt-280,t(J!=null);ut<ct;)yt=p[ut++],J.X[(506832829*yt&4294967295)>>>J.Mb]=yt;yt=ct,t(!(wt>>>(Bt=J).Xa)),p[yt]=Bt.X[wt],wt=!0}wt||t(B.h==O(B))}if(u.Pb&&B.h&&ct<L)t(u.m.h),u.a=5,u.m=u.wd,u.$=u.xd,0<u.s.ua&&mt(u.s.vb,u.s.Wa);else{if(B.h)break t;I!=null&&I(u,N>T?T:N),u.a=0,u.$=ct-v}return 1}return u.a=3,0}function Dr(u){t(u!=null),u.vc=null,u.yc=null,u.Ya=null;var p=u.Wa;p!=null&&(p.X=null),u.vb=null,t(u!=null)}function tr(){var u=new Rd;return u==null?null:(u.a=0,u.xb=sp,Un("Predictor","VP8LPredictors"),Un("Predictor","VP8LPredictors_C"),Un("PredictorAdd","VP8LPredictorsAdd"),Un("PredictorAdd","VP8LPredictorsAdd_C"),Hc=ve,er=Xt,yr=Pt,Us=Di,Gr=Se,cs=qn,Po=We,P.VP8LMapColor32b=hh,P.VP8LMapColor8b=Od,u)}function jr(u,p,v,w,L){var T=1,I=[u],N=[p],k=w.m,B=w.s,K=null,ct=0;t:for(;;){if(v)for(;T&&lt(k,1);){var ut=I,rt=N,xt=w,pt=1,J=xt.m,tt=xt.gc[xt.ab],vt=lt(J,2);if(xt.Oc&1<<vt)T=0;else{switch(xt.Oc|=1<<vt,tt.hc=vt,tt.Ea=ut[0],tt.nc=rt[0],tt.K=[null],++xt.ab,t(4>=xt.ab),vt){case 0:case 1:tt.b=lt(J,3)+2,pt=jr(qt(tt.Ea,tt.b),qt(tt.nc,tt.b),0,xt,tt.K),tt.K=tt.K[0];break;case 3:var wt,yt=lt(J,8)+1,Bt=16<yt?0:4<yt?1:2<yt?2:3;if(ut[0]=qt(tt.Ea,Bt),tt.b=Bt,wt=pt=jr(yt,1,0,xt,tt.K)){var Nt,ie=yt,Ot=tt,Oe=1<<(8>>Ot.b),Ve=s(Oe);if(Ve==null)wt=0;else{var Ie=Ot.K[0],Le=Ot.w;for(Ve[0]=Ot.K[0][0],Nt=1;Nt<1*ie;++Nt)Ve[Nt]=Lt(Ie[Le+Nt],Ve[Nt-1]);for(;Nt<4*Oe;++Nt)Ve[Nt]=0;Ot.K[0]=null,Ot.K[0]=Ve,wt=1}}pt=wt;break;case 2:break;default:t(0)}T=pt}}if(I=I[0],N=N[0],T&&lt(k,1)&&!(T=1<=(ct=lt(k,4))&&11>=ct)){w.a=3;break t}var Je;if(Je=T)e:{var Ze,pe,Fi,Pn=w,Oi=I,In=N,He=ct,Hn=v,Xn=Pn.m,Ui=Pn.s,Qi=[null],xn=1,sr=0,zr=Ty[He];i:for(;;){if(Hn&&lt(Xn,1)){var Wi=lt(Xn,3)+2,ps=qt(Oi,Wi),Da=qt(In,Wi),Fo=ps*Da;if(!jr(ps,Da,0,Pn,Qi))break i;for(Qi=Qi[0],Ui.xc=Wi,Ze=0;Ze<Fo;++Ze){var Zs=Qi[Ze]>>8&65535;Qi[Ze]=Zs,Zs>=xn&&(xn=Zs+1)}}if(Xn.h)break i;for(pe=0;5>pe;++pe){var vi=np[pe];!pe&&0<He&&(vi+=1<<He),sr<vi&&(sr=vi)}var Wd=a(xn*zr,F),gp=xn,pp=a(gp,z);if(pp==null)var nu=null;else t(65536>=gp),nu=pp;var gh=s(sr);if(nu==null||gh==null||Wd==null){Pn.a=1;break i}var ru=Wd;for(Ze=Fi=0;Ze<xn;++Ze){var Er=nu[Ze],Oo=Er.G,ko=Er.H,mp=0,su=1,_p=0;for(pe=0;5>pe;++pe){vi=np[pe],Oo[pe]=ru,ko[pe]=Fi,!pe&&0<He&&(vi+=1<<He);r:{var au,Vd=vi,ou=Pn,ph=gh,Ky=ru,$y=Fi,Hd=0,Ks=ou.m,Jy=lt(Ks,1);if(r(ph,0,0,Vd),Jy){var Qy=lt(Ks,1)+1,t5=lt(Ks,1),vp=lt(Ks,t5==0?1:8);ph[vp]=1,Qy==2&&(ph[vp=lt(Ks,8)]=1);var lu=1}else{var yp=s(19),xp=lt(Ks,4)+4;if(19<xp){ou.a=3;var hu=0;break r}for(au=0;au<xp;++au)yp[Ay[au]]=lt(Ks,3);var Xd=void 0,mh=void 0,bp=ou,e5=yp,cu=Vd,wp=ph,Yd=0,$s=bp.m,Ep=8,Sp=a(128,F);n:for(;R(Sp,0,7,e5,19);){if(lt($s,1)){var i5=2+2*lt($s,3);if((Xd=2+lt($s,i5))>cu)break n}else Xd=cu;for(mh=0;mh<cu&&Xd--;){nt($s);var Lp=Sp[0+(127&G($s))];X($s,$s.u+Lp.g);var Do=Lp.value;if(16>Do)wp[mh++]=Do,Do!=0&&(Ep=Do);else{var n5=Do==16,Cp=Do-16,r5=Ly[Cp],Ap=lt($s,Sy[Cp])+r5;if(mh+Ap>cu)break n;for(var s5=n5?Ep:0;0<Ap--;)wp[mh++]=s5}}Yd=1;break n}Yd||(bp.a=3),lu=Yd}(lu=lu&&!Ks.h)&&(Hd=R(Ky,$y,8,ph,Vd)),lu&&Hd!=0?hu=Hd:(ou.a=3,hu=0)}if(hu==0)break i;if(su&&Cy[pe]==1&&(su=ru[Fi].g==0),mp+=ru[Fi].g,Fi+=hu,3>=pe){var _h,Zd=gh[0];for(_h=1;_h<vi;++_h)gh[_h]>Zd&&(Zd=gh[_h]);_p+=Zd}}if(Er.nd=su,Er.Qb=0,su&&(Er.qb=(Oo[3][ko[3]+0].value<<24|Oo[1][ko[1]+0].value<<16|Oo[2][ko[2]+0].value)>>>0,mp==0&&256>Oo[0][ko[0]+0].value&&(Er.Qb=1,Er.qb+=Oo[0][ko[0]+0].value<<8)),Er.jc=!Er.Qb&&6>_p,Er.jc){var uu,ms=Er;for(uu=0;uu<Mn;++uu){var Js=uu,Qs=ms.pd[Js],fu=ms.G[0][ms.H[0]+Js];256<=fu.value?(Qs.g=fu.g+256,Qs.value=fu.value):(Qs.g=0,Qs.value=0,Js>>=Ae(fu,8,Qs),Js>>=Ae(ms.G[1][ms.H[1]+Js],16,Qs),Js>>=Ae(ms.G[2][ms.H[2]+Js],0,Qs),Ae(ms.G[3][ms.H[3]+Js],24,Qs))}}}Ui.vc=Qi,Ui.Wb=xn,Ui.Ya=nu,Ui.yc=Wd,Je=1;break e}Je=0}if(!(T=Je)){w.a=3;break t}if(0<ct){if(B.ua=1<<ct,!$t(B.Wa,ct)){w.a=1,T=0;break t}}else B.ua=0;var Kd=w,Mp=I,a5=N,$d=Kd.s,Jd=$d.xc;if(Kd.c=Mp,Kd.i=a5,$d.md=qt(Mp,Jd),$d.wc=Jd==0?-1:(1<<Jd)-1,v){w.xb=Dy;break t}if((K=s(I*N))==null){w.a=1,T=0;break t}T=(T=gr(w,K,0,I,N,N,null))&&!k.h;break t}return T?(L!=null?L[0]=K:(t(K==null),t(v)),w.$=0,v||Dr(B)):Dr(B),T}function Pa(u,p){var v=u.c*u.i,w=v+p+16*p;return t(u.c<=p),u.V=s(w),u.V==null?(u.Ta=null,u.Ua=0,u.a=1,0):(u.Ta=u.V,u.Ua=u.Ba+v+p,1)}function co(u,p){var v=u.C,w=p-v,L=u.V,T=u.Ba+u.c*v;for(t(p<=u.l.o);0<w;){var I=16<w?16:w,N=u.l.ma,k=u.l.width,B=k*I,K=N.ca,ct=N.tb+k*v,ut=u.Ta,rt=u.Ua;yn(u,I,L,T),Z1(ut,rt,K,ct,B),fr(N,v,v+I,K,ct,k),w-=I,L+=I*u.c,v+=I}t(v==p),u.C=u.Ma=p}function uo(){this.ub=this.yd=this.td=this.Rb=0}function fo(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function go(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Cc(){this.Yb=function(){var u=[];return function p(v,w,L){for(var T=L[w],I=0;I<T&&(v.push(L.length>w+1?[]:0),!(L.length<w+1));I++)p(v[I],w+1,L)}(u,0,[3,11]),u}()}function hd(){this.jb=s(3),this.Wc=o([4,8],Cc),this.Xc=o([4,17],Cc)}function cd(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function po(){this.ld=this.La=this.dd=this.tc=0}function Ac(){this.Na=this.la=0}function ud(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ul(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function fd(){this.uc=this.M=this.Nb=0,this.wa=Array(new po),this.Y=0,this.ya=Array(new Ul),this.aa=0,this.l=new mo}function Mc(){this.y=s(16),this.f=s(8),this.ea=s(8)}function dd(){this.cb=this.a=0,this.sc="",this.m=new Et,this.Od=new uo,this.Kc=new fo,this.ed=new cd,this.Qa=new go,this.Ic=this.$c=this.Aa=0,this.D=new fd,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,Et),this.ia=0,this.pb=a(4,ud),this.Pa=new hd,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Mc),this.Hd=0,this.rb=Array(new Ac),this.sb=0,this.wa=Array(new po),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ul),this.L=this.aa=0,this.gd=o([4,2],po),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function mo(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function gd(){var u=new dd;return u!=null&&(u.a=0,u.sc="OK",u.cb=0,u.Xb=0,fh||(fh=Ic)),u}function Si(u,p,v){return u.a==0&&(u.a=p,u.sc=v,u.cb=0),0}function Tc(u,p,v){return 3<=v&&u[p+0]==157&&u[p+1]==1&&u[p+2]==42}function Pc(u,p){if(u==null)return 0;if(u.a=0,u.sc="OK",p==null)return Si(u,2,"null VP8Io passed to VP8GetHeaders()");var v=p.data,w=p.w,L=p.ha;if(4>L)return Si(u,7,"Truncated header.");var T=v[w+0]|v[w+1]<<8|v[w+2]<<16,I=u.Od;if(I.Rb=!(1&T),I.td=T>>1&7,I.yd=T>>4&1,I.ub=T>>5,3<I.td)return Si(u,3,"Incorrect keyframe parameters.");if(!I.yd)return Si(u,4,"Frame not displayable.");w+=3,L-=3;var N=u.Kc;if(I.Rb){if(7>L)return Si(u,7,"cannot parse picture header");if(!Tc(v,w,L))return Si(u,3,"Bad code word");N.c=16383&(v[w+4]<<8|v[w+3]),N.Td=v[w+4]>>6,N.i=16383&(v[w+6]<<8|v[w+5]),N.Ud=v[w+6]>>6,w+=7,L-=7,u.za=N.c+15>>4,u.Ub=N.i+15>>4,p.width=N.c,p.height=N.i,p.Da=0,p.j=0,p.v=0,p.va=p.width,p.o=p.height,p.da=0,p.ib=p.width,p.hb=p.height,p.U=p.width,p.T=p.height,r((T=u.Pa).jb,0,255,T.jb.length),t((T=u.Qa)!=null),T.Cb=0,T.Bb=0,T.Fb=1,r(T.Zb,0,0,T.Zb.length),r(T.Lb,0,0,T.Lb)}if(I.ub>L)return Si(u,7,"bad partition length");it(T=u.m,v,w,I.ub),w+=I.ub,L-=I.ub,I.Rb&&(N.Ld=ht(T),N.Kd=ht(T)),N=u.Qa;var k,B=u.Pa;if(t(T!=null),t(N!=null),N.Cb=ht(T),N.Cb){if(N.Bb=ht(T),ht(T)){for(N.Fb=ht(T),k=0;4>k;++k)N.Zb[k]=ht(T)?st(T,7):0;for(k=0;4>k;++k)N.Lb[k]=ht(T)?st(T,6):0}if(N.Bb)for(k=0;3>k;++k)B.jb[k]=ht(T)?Y(T,8):255}else N.Bb=0;if(T.Ka)return Si(u,3,"cannot parse segment header");if((N=u.ed).zd=ht(T),N.Tb=Y(T,6),N.wb=Y(T,3),N.Pc=ht(T),N.Pc&&ht(T)){for(B=0;4>B;++B)ht(T)&&(N.vd[B]=st(T,6));for(B=0;4>B;++B)ht(T)&&(N.od[B]=st(T,6))}if(u.L=N.Tb==0?0:N.zd?1:2,T.Ka)return Si(u,3,"cannot parse filter header");var K=L;if(L=k=w,w=k+K,N=K,u.Xb=(1<<Y(u.m,2))-1,K<3*(B=u.Xb))v=7;else{for(k+=3*B,N-=3*B,K=0;K<B;++K){var ct=v[L+0]|v[L+1]<<8|v[L+2]<<16;ct>N&&(ct=N),it(u.Jc[+K],v,k,ct),k+=ct,N-=ct,L+=3}it(u.Jc[+B],v,k,N),v=k<w?0:5}if(v!=0)return Si(u,v,"cannot parse partitions");for(v=Y(k=u.m,7),L=ht(k)?st(k,4):0,w=ht(k)?st(k,4):0,N=ht(k)?st(k,4):0,B=ht(k)?st(k,4):0,k=ht(k)?st(k,4):0,K=u.Qa,ct=0;4>ct;++ct){if(K.Cb){var ut=K.Zb[ct];K.Fb||(ut+=v)}else{if(0<ct){u.pb[ct]=u.pb[0];continue}ut=v}var rt=u.pb[ct];rt.Sc[0]=zd[Wn(ut+L,127)],rt.Sc[1]=qd[Wn(ut+0,127)],rt.Eb[0]=2*zd[Wn(ut+w,127)],rt.Eb[1]=101581*qd[Wn(ut+N,127)]>>16,8>rt.Eb[1]&&(rt.Eb[1]=8),rt.Qc[0]=zd[Wn(ut+B,117)],rt.Qc[1]=qd[Wn(ut+k,127)],rt.lc=ut+k}if(!I.Rb)return Si(u,4,"Not a key frame.");for(ht(T),I=u.Pa,v=0;4>v;++v){for(L=0;8>L;++L)for(w=0;3>w;++w)for(N=0;11>N;++N)B=dt(T,Oy[v][L][w][N])?Y(T,8):Ny[v][L][w][N],I.Wc[v][L].Yb[w][N]=B;for(L=0;17>L;++L)I.Xc[v][L]=I.Wc[v][ky[L]]}return u.kc=ht(T),u.kc&&(u.Bd=Y(T,8)),u.cb=1}function Ic(u,p,v,w,L,T,I){var N=p[L].Yb[v];for(v=0;16>L;++L){if(!dt(u,N[v+0]))return L;for(;!dt(u,N[v+1]);)if(N=p[++L].Yb[0],v=0,L==16)return 16;var k=p[L+1].Yb;if(dt(u,N[v+2])){var B=u,K=0;if(dt(B,(ut=N)[(ct=v)+3]))if(dt(B,ut[ct+6])){for(N=0,ct=2*(K=dt(B,ut[ct+8]))+(ut=dt(B,ut[ct+9+K])),K=0,ut=Iy[ct];ut[N];++N)K+=K+dt(B,ut[N]);K+=3+(8<<ct)}else dt(B,ut[ct+7])?(K=7+2*dt(B,165),K+=dt(B,145)):K=5+dt(B,159);else K=dt(B,ut[ct+4])?3+dt(B,ut[ct+5]):2;N=k[2]}else K=1,N=k[1];k=I+Ry[L],0>(B=u).b&&at(B);var ct,ut=B.b,rt=(ct=B.Ca>>1)-(B.I>>ut)>>31;--B.b,B.Ca+=rt,B.Ca|=1,B.I-=(ct+1&rt)<<ut,T[k]=((K^rt)-rt)*w[(0<L)+0]}return 16}function Wl(u){var p=u.rb[u.sb-1];p.la=0,p.Na=0,r(u.zc,0,0,u.zc.length),u.ja=0}function pd(u,p){if(u==null)return 0;if(p==null)return Si(u,2,"NULL VP8Io parameter in VP8Decode().");if(!u.cb&&!Pc(u,p))return 0;if(t(u.cb),p.ac==null||p.ac(p)){p.ob&&(u.L=0);var v=iu[u.L];if(u.L==2?(u.yb=0,u.zb=0):(u.yb=p.v-v>>4,u.zb=p.j-v>>4,0>u.yb&&(u.yb=0),0>u.zb&&(u.zb=0)),u.Va=p.o+15+v>>4,u.Hb=p.va+15+v>>4,u.Hb>u.za&&(u.Hb=u.za),u.Va>u.Ub&&(u.Va=u.Ub),0<u.L){var w=u.ed;for(v=0;4>v;++v){var L;if(u.Qa.Cb){var T=u.Qa.Lb[v];u.Qa.Fb||(T+=w.Tb)}else T=w.Tb;for(L=0;1>=L;++L){var I=u.gd[v][L],N=T;if(w.Pc&&(N+=w.vd[0],L&&(N+=w.od[0])),0<(N=0>N?0:63<N?63:N)){var k=N;0<w.wb&&(k=4<w.wb?k>>2:k>>1)>9-w.wb&&(k=9-w.wb),1>k&&(k=1),I.dd=k,I.tc=2*N+k,I.ld=40<=N?2:15<=N?1:0}else I.tc=0;I.La=L}}}v=0}else Si(u,6,"Frame setup failed"),v=u.a;if(v=v==0){if(v){u.$c=0,0<u.Aa||(u.Ic=Zy);t:{v=u.Ic,w=4*(k=u.za);var B=32*k,K=k+1,ct=0<u.L?k*(0<u.Aa?2:1):0,ut=(u.Aa==2?2:1)*k;if((I=w+832+(L=3*(16*v+iu[u.L])/2*B)+(T=u.Fa!=null&&0<u.Fa.length?u.Kc.c*u.Kc.i:0))!=I)v=0;else{if(I>u.Vb){if(u.Vb=0,u.Ec=s(I),u.Fc=0,u.Ec==null){v=Si(u,1,"no memory during frame initialization.");break t}u.Vb=I}I=u.Ec,N=u.Fc,u.Ac=I,u.Bc=N,N+=w,u.Gd=a(B,Mc),u.Hd=0,u.rb=a(K+1,Ac),u.sb=1,u.wa=ct?a(ct,po):null,u.Y=0,u.D.Nb=0,u.D.wa=u.wa,u.D.Y=u.Y,0<u.Aa&&(u.D.Y+=k),t(!0),u.oc=I,u.pc=N,N+=832,u.ya=a(ut,Ul),u.aa=0,u.D.ya=u.ya,u.D.aa=u.aa,u.Aa==2&&(u.D.aa+=k),u.R=16*k,u.B=8*k,k=(B=iu[u.L])*u.R,B=B/2*u.B,u.sa=I,u.ta=N+k,u.qa=u.sa,u.ra=u.ta+16*v*u.R+B,u.Ha=u.qa,u.Ia=u.ra+8*v*u.B+B,u.$c=0,N+=L,u.mb=T?I:null,u.nb=T?N:null,t(N+T<=u.Fc+u.Vb),Wl(u),r(u.Ac,u.Bc,0,w),v=1}}if(v){if(p.ka=0,p.y=u.sa,p.O=u.ta,p.f=u.qa,p.N=u.ra,p.ea=u.Ha,p.Vd=u.Ia,p.fa=u.R,p.Rc=u.B,p.F=null,p.J=0,!tp){for(v=-255;255>=v;++v)K1[255+v]=0>v?-v:v;for(v=-1020;1020>=v;++v)$1[1020+v]=-128>v?-128:127<v?127:v;for(v=-112;112>=v;++v)J1[112+v]=-16>v?-16:15<v?15:v;for(v=-255;510>=v;++v)Q1[255+v]=0>v?0:255<v?255:v;tp=1}xr=vd,Io=md,Ws=Nc,br=_d,us=Fc,ch=Rc,Oa=Kl,Ro=Na,ka=Id,Vs=$l,uh=Pd,ir=wo,fs=Jl,ii=Uc,ni=qc,Li=ls,ji=Bs,ds=Td,wr[0]=Br,wr[1]=yd,wr[2]=Ed,wr[3]=Sd,wr[4]=Dc,wr[5]=xo,wr[6]=jc,wr[7]=Xl,wr[8]=Cd,wr[9]=Ld,Xs[0]=Oc,Xs[1]=bd,Xs[2]=os,Xs[3]=vo,Xs[4]=an,Xs[5]=wd,Xs[6]=kc,gs[0]=js,gs[1]=xd,gs[2]=Ad,gs[3]=Yl,gs[4]=Ra,gs[5]=Md,gs[6]=Zl,v=1}else v=0}v&&(v=function(rt,xt){for(rt.M=0;rt.M<rt.Va;++rt.M){var pt,J=rt.Jc[rt.M&rt.Xb],tt=rt.m,vt=rt;for(pt=0;pt<vt.za;++pt){var wt=tt,yt=vt,Bt=yt.Ac,Nt=yt.Bc+4*pt,ie=yt.zc,Ot=yt.ya[yt.aa+pt];if(yt.Qa.Bb?Ot.$b=dt(wt,yt.Pa.jb[0])?2+dt(wt,yt.Pa.jb[2]):dt(wt,yt.Pa.jb[1]):Ot.$b=0,yt.kc&&(Ot.Ad=dt(wt,yt.Bd)),Ot.Za=!dt(wt,145)+0,Ot.Za){var Oe=Ot.Ob,Ve=0;for(yt=0;4>yt;++yt){var Ie,Le=ie[0+yt];for(Ie=0;4>Ie;++Ie){Le=Fy[Bt[Nt+Ie]][Le];for(var Je=rp[dt(wt,Le[0])];0<Je;)Je=rp[2*Je+dt(wt,Le[Je])];Le=-Je,Bt[Nt+Ie]=Le}n(Oe,Ve,Bt,Nt,4),Ve+=4,ie[0+yt]=Le}}else Le=dt(wt,156)?dt(wt,128)?1:3:dt(wt,163)?2:0,Ot.Ob[0]=Le,r(Bt,Nt,Le,4),r(ie,0,Le,4);Ot.Dd=dt(wt,142)?dt(wt,114)?dt(wt,183)?1:3:2:0}if(vt.m.Ka)return Si(rt,7,"Premature end-of-partition0 encountered.");for(;rt.ja<rt.za;++rt.ja){if(vt=J,wt=(tt=rt).rb[tt.sb-1],Bt=tt.rb[tt.sb+tt.ja],pt=tt.ya[tt.aa+tt.ja],Nt=tt.kc?pt.Ad:0)wt.la=Bt.la=0,pt.Za||(wt.Na=Bt.Na=0),pt.Hc=0,pt.Gc=0,pt.ia=0;else{var Ze,pe;if(wt=Bt,Bt=vt,Nt=tt.Pa.Xc,ie=tt.ya[tt.aa+tt.ja],Ot=tt.pb[ie.$b],yt=ie.ad,Oe=0,Ve=tt.rb[tt.sb-1],Le=Ie=0,r(yt,Oe,0,384),ie.Za)var Fi=0,Pn=Nt[3];else{Je=s(16);var Oi=wt.Na+Ve.Na;if(Oi=fh(Bt,Nt[1],Oi,Ot.Eb,0,Je,0),wt.Na=Ve.Na=(0<Oi)+0,1<Oi)xr(Je,0,yt,Oe);else{var In=Je[0]+3>>3;for(Je=0;256>Je;Je+=16)yt[Oe+Je]=In}Fi=1,Pn=Nt[0]}var He=15&wt.la,Hn=15&Ve.la;for(Je=0;4>Je;++Je){var Xn=1&Hn;for(In=pe=0;4>In;++In)He=He>>1|(Xn=(Oi=fh(Bt,Pn,Oi=Xn+(1&He),Ot.Sc,Fi,yt,Oe))>Fi)<<7,pe=pe<<2|(3<Oi?3:1<Oi?2:yt[Oe+0]!=0),Oe+=16;He>>=4,Hn=Hn>>1|Xn<<7,Ie=(Ie<<8|pe)>>>0}for(Pn=He,Fi=Hn>>4,Ze=0;4>Ze;Ze+=2){for(pe=0,He=wt.la>>4+Ze,Hn=Ve.la>>4+Ze,Je=0;2>Je;++Je){for(Xn=1&Hn,In=0;2>In;++In)Oi=Xn+(1&He),He=He>>1|(Xn=0<(Oi=fh(Bt,Nt[2],Oi,Ot.Qc,0,yt,Oe)))<<3,pe=pe<<2|(3<Oi?3:1<Oi?2:yt[Oe+0]!=0),Oe+=16;He>>=2,Hn=Hn>>1|Xn<<5}Le|=pe<<4*Ze,Pn|=He<<4<<Ze,Fi|=(240&Hn)<<Ze}wt.la=Pn,Ve.la=Fi,ie.Hc=Ie,ie.Gc=Le,ie.ia=43690&Le?0:Ot.ia,Nt=!(Ie|Le)}if(0<tt.L&&(tt.wa[tt.Y+tt.ja]=tt.gd[pt.$b][pt.Za],tt.wa[tt.Y+tt.ja].La|=!Nt),vt.Ka)return Si(rt,7,"Premature end-of-file encountered.")}if(Wl(rt),tt=xt,vt=1,pt=(J=rt).D,wt=0<J.L&&J.M>=J.zb&&J.M<=J.Va,J.Aa==0)t:{if(pt.M=J.M,pt.uc=wt,rh(J,pt),vt=1,pt=(pe=J.D).Nb,wt=(Le=iu[J.L])*J.R,Bt=Le/2*J.B,Je=16*pt*J.R,In=8*pt*J.B,Nt=J.sa,ie=J.ta-wt+Je,Ot=J.qa,yt=J.ra-Bt+In,Oe=J.Ha,Ve=J.Ia-Bt+In,Hn=(He=pe.M)==0,Ie=He>=J.Va-1,J.Aa==2&&rh(J,pe),pe.uc)for(Xn=(Oi=J).D.M,t(Oi.D.uc),pe=Oi.yb;pe<Oi.Hb;++pe){Fi=pe,Pn=Xn;var Ui=(Qi=(vi=Oi).D).Nb;Ze=vi.R;var Qi=Qi.wa[Qi.Y+Fi],xn=vi.sa,sr=vi.ta+16*Ui*Ze+16*Fi,zr=Qi.dd,Wi=Qi.tc;if(Wi!=0)if(t(3<=Wi),vi.L==1)0<Fi&&Li(xn,sr,Ze,Wi+4),Qi.La&&ds(xn,sr,Ze,Wi),0<Pn&&ni(xn,sr,Ze,Wi+4),Qi.La&&ji(xn,sr,Ze,Wi);else{var ps=vi.B,Da=vi.qa,Fo=vi.ra+8*Ui*ps+8*Fi,Zs=vi.Ha,vi=vi.Ia+8*Ui*ps+8*Fi;Ui=Qi.ld,0<Fi&&(Ro(xn,sr,Ze,Wi+4,zr,Ui),Vs(Da,Fo,Zs,vi,ps,Wi+4,zr,Ui)),Qi.La&&(ir(xn,sr,Ze,Wi,zr,Ui),ii(Da,Fo,Zs,vi,ps,Wi,zr,Ui)),0<Pn&&(Oa(xn,sr,Ze,Wi+4,zr,Ui),ka(Da,Fo,Zs,vi,ps,Wi+4,zr,Ui)),Qi.La&&(uh(xn,sr,Ze,Wi,zr,Ui),fs(Da,Fo,Zs,vi,ps,Wi,zr,Ui))}}if(J.ia&&alert("todo:DitherRow"),tt.put!=null){if(pe=16*He,He=16*(He+1),Hn?(tt.y=J.sa,tt.O=J.ta+Je,tt.f=J.qa,tt.N=J.ra+In,tt.ea=J.Ha,tt.W=J.Ia+In):(pe-=Le,tt.y=Nt,tt.O=ie,tt.f=Ot,tt.N=yt,tt.ea=Oe,tt.W=Ve),Ie||(He-=Le),He>tt.o&&(He=tt.o),tt.F=null,tt.J=null,J.Fa!=null&&0<J.Fa.length&&pe<He&&(tt.J=ih(J,tt,pe,He-pe),tt.F=J.mb,tt.F==null&&tt.F.length==0)){vt=Si(J,3,"Could not decode alpha data.");break t}pe<tt.j&&(Le=tt.j-pe,pe=tt.j,t(!(1&Le)),tt.O+=J.R*Le,tt.N+=J.B*(Le>>1),tt.W+=J.B*(Le>>1),tt.F!=null&&(tt.J+=tt.width*Le)),pe<He&&(tt.O+=tt.v,tt.N+=tt.v>>1,tt.W+=tt.v>>1,tt.F!=null&&(tt.J+=tt.v),tt.ka=pe-tt.j,tt.U=tt.va-tt.v,tt.T=He-pe,vt=tt.put(tt))}pt+1!=J.Ic||Ie||(n(J.sa,J.ta-wt,Nt,ie+16*J.R,wt),n(J.qa,J.ra-Bt,Ot,yt+8*J.B,Bt),n(J.Ha,J.Ia-Bt,Oe,Ve+8*J.B,Bt))}if(!vt)return Si(rt,6,"Output aborted.")}return 1}(u,p)),p.bc!=null&&p.bc(p),v&=1}return v?(u.cb=0,v):0}function pr(u,p,v,w,L){L=u[p+v+32*w]+(L>>3),u[p+v+32*w]=-256&L?0>L?0:255:L}function _o(u,p,v,w,L,T){pr(u,p,0,v,w+L),pr(u,p,1,v,w+T),pr(u,p,2,v,w-T),pr(u,p,3,v,w-L)}function An(u){return(20091*u>>16)+u}function Vl(u,p,v,w){var L,T=0,I=s(16);for(L=0;4>L;++L){var N=u[p+0]+u[p+8],k=u[p+0]-u[p+8],B=(35468*u[p+4]>>16)-An(u[p+12]),K=An(u[p+4])+(35468*u[p+12]>>16);I[T+0]=N+K,I[T+1]=k+B,I[T+2]=k-B,I[T+3]=N-K,T+=4,p++}for(L=T=0;4>L;++L)N=(u=I[T+0]+4)+I[T+8],k=u-I[T+8],B=(35468*I[T+4]>>16)-An(I[T+12]),pr(v,w,0,0,N+(K=An(I[T+4])+(35468*I[T+12]>>16))),pr(v,w,1,0,k+B),pr(v,w,2,0,k-B),pr(v,w,3,0,N-K),T++,w+=32}function Rc(u,p,v,w){var L=u[p+0]+4,T=35468*u[p+4]>>16,I=An(u[p+4]),N=35468*u[p+1]>>16;_o(v,w,0,L+I,u=An(u[p+1]),N),_o(v,w,1,L+T,u,N),_o(v,w,2,L-T,u,N),_o(v,w,3,L-I,u,N)}function md(u,p,v,w,L){Vl(u,p,v,w),L&&Vl(u,p+16,v,w+4)}function Nc(u,p,v,w){Io(u,p+0,v,w,1),Io(u,p+32,v,w+128,1)}function _d(u,p,v,w){var L;for(u=u[p+0]+4,L=0;4>L;++L)for(p=0;4>p;++p)pr(v,w,p,L,u)}function Fc(u,p,v,w){u[p+0]&&br(u,p+0,v,w),u[p+16]&&br(u,p+16,v,w+4),u[p+32]&&br(u,p+32,v,w+128),u[p+48]&&br(u,p+48,v,w+128+4)}function vd(u,p,v,w){var L,T=s(16);for(L=0;4>L;++L){var I=u[p+0+L]+u[p+12+L],N=u[p+4+L]+u[p+8+L],k=u[p+4+L]-u[p+8+L],B=u[p+0+L]-u[p+12+L];T[0+L]=I+N,T[8+L]=I-N,T[4+L]=B+k,T[12+L]=B-k}for(L=0;4>L;++L)I=(u=T[0+4*L]+3)+T[3+4*L],N=T[1+4*L]+T[2+4*L],k=T[1+4*L]-T[2+4*L],B=u-T[3+4*L],v[w+0]=I+N>>3,v[w+16]=B+k>>3,v[w+32]=I-N>>3,v[w+48]=B-k>>3,w+=64}function Hl(u,p,v){var w,L=p-32,T=Vn,I=255-u[L-1];for(w=0;w<v;++w){var N,k=T,B=I+u[p-1];for(N=0;N<v;++N)u[p+N]=k[B+u[L+N]];p+=32}}function yd(u,p){Hl(u,p,4)}function xd(u,p){Hl(u,p,8)}function bd(u,p){Hl(u,p,16)}function os(u,p){var v;for(v=0;16>v;++v)n(u,p+32*v,u,p-32,16)}function vo(u,p){var v;for(v=16;0<v;--v)r(u,p,u[p-1],16),p+=32}function yo(u,p,v){var w;for(w=0;16>w;++w)r(p,v+32*w,u,16)}function Oc(u,p){var v,w=16;for(v=0;16>v;++v)w+=u[p-1+32*v]+u[p+v-32];yo(w>>5,u,p)}function an(u,p){var v,w=8;for(v=0;16>v;++v)w+=u[p-1+32*v];yo(w>>4,u,p)}function wd(u,p){var v,w=8;for(v=0;16>v;++v)w+=u[p+v-32];yo(w>>4,u,p)}function kc(u,p){yo(128,u,p)}function ce(u,p,v){return u+2*p+v+2>>2}function Ed(u,p){var v,w=p-32;for(w=new Uint8Array([ce(u[w-1],u[w+0],u[w+1]),ce(u[w+0],u[w+1],u[w+2]),ce(u[w+1],u[w+2],u[w+3]),ce(u[w+2],u[w+3],u[w+4])]),v=0;4>v;++v)n(u,p+32*v,w,0,w.length)}function Sd(u,p){var v=u[p-1],w=u[p-1+32],L=u[p-1+64],T=u[p-1+96];St(u,p+0,16843009*ce(u[p-1-32],v,w)),St(u,p+32,16843009*ce(v,w,L)),St(u,p+64,16843009*ce(w,L,T)),St(u,p+96,16843009*ce(L,T,T))}function Br(u,p){var v,w=4;for(v=0;4>v;++v)w+=u[p+v-32]+u[p-1+32*v];for(w>>=3,v=0;4>v;++v)r(u,p+32*v,w,4)}function Dc(u,p){var v=u[p-1+0],w=u[p-1+32],L=u[p-1+64],T=u[p-1-32],I=u[p+0-32],N=u[p+1-32],k=u[p+2-32],B=u[p+3-32];u[p+0+96]=ce(w,L,u[p-1+96]),u[p+1+96]=u[p+0+64]=ce(v,w,L),u[p+2+96]=u[p+1+64]=u[p+0+32]=ce(T,v,w),u[p+3+96]=u[p+2+64]=u[p+1+32]=u[p+0+0]=ce(I,T,v),u[p+3+64]=u[p+2+32]=u[p+1+0]=ce(N,I,T),u[p+3+32]=u[p+2+0]=ce(k,N,I),u[p+3+0]=ce(B,k,N)}function jc(u,p){var v=u[p+1-32],w=u[p+2-32],L=u[p+3-32],T=u[p+4-32],I=u[p+5-32],N=u[p+6-32],k=u[p+7-32];u[p+0+0]=ce(u[p+0-32],v,w),u[p+1+0]=u[p+0+32]=ce(v,w,L),u[p+2+0]=u[p+1+32]=u[p+0+64]=ce(w,L,T),u[p+3+0]=u[p+2+32]=u[p+1+64]=u[p+0+96]=ce(L,T,I),u[p+3+32]=u[p+2+64]=u[p+1+96]=ce(T,I,N),u[p+3+64]=u[p+2+96]=ce(I,N,k),u[p+3+96]=ce(N,k,k)}function xo(u,p){var v=u[p-1+0],w=u[p-1+32],L=u[p-1+64],T=u[p-1-32],I=u[p+0-32],N=u[p+1-32],k=u[p+2-32],B=u[p+3-32];u[p+0+0]=u[p+1+64]=T+I+1>>1,u[p+1+0]=u[p+2+64]=I+N+1>>1,u[p+2+0]=u[p+3+64]=N+k+1>>1,u[p+3+0]=k+B+1>>1,u[p+0+96]=ce(L,w,v),u[p+0+64]=ce(w,v,T),u[p+0+32]=u[p+1+96]=ce(v,T,I),u[p+1+32]=u[p+2+96]=ce(T,I,N),u[p+2+32]=u[p+3+96]=ce(I,N,k),u[p+3+32]=ce(N,k,B)}function Xl(u,p){var v=u[p+0-32],w=u[p+1-32],L=u[p+2-32],T=u[p+3-32],I=u[p+4-32],N=u[p+5-32],k=u[p+6-32],B=u[p+7-32];u[p+0+0]=v+w+1>>1,u[p+1+0]=u[p+0+64]=w+L+1>>1,u[p+2+0]=u[p+1+64]=L+T+1>>1,u[p+3+0]=u[p+2+64]=T+I+1>>1,u[p+0+32]=ce(v,w,L),u[p+1+32]=u[p+0+96]=ce(w,L,T),u[p+2+32]=u[p+1+96]=ce(L,T,I),u[p+3+32]=u[p+2+96]=ce(T,I,N),u[p+3+64]=ce(I,N,k),u[p+3+96]=ce(N,k,B)}function Ld(u,p){var v=u[p-1+0],w=u[p-1+32],L=u[p-1+64],T=u[p-1+96];u[p+0+0]=v+w+1>>1,u[p+2+0]=u[p+0+32]=w+L+1>>1,u[p+2+32]=u[p+0+64]=L+T+1>>1,u[p+1+0]=ce(v,w,L),u[p+3+0]=u[p+1+32]=ce(w,L,T),u[p+3+32]=u[p+1+64]=ce(L,T,T),u[p+3+64]=u[p+2+64]=u[p+0+96]=u[p+1+96]=u[p+2+96]=u[p+3+96]=T}function Cd(u,p){var v=u[p-1+0],w=u[p-1+32],L=u[p-1+64],T=u[p-1+96],I=u[p-1-32],N=u[p+0-32],k=u[p+1-32],B=u[p+2-32];u[p+0+0]=u[p+2+32]=v+I+1>>1,u[p+0+32]=u[p+2+64]=w+v+1>>1,u[p+0+64]=u[p+2+96]=L+w+1>>1,u[p+0+96]=T+L+1>>1,u[p+3+0]=ce(N,k,B),u[p+2+0]=ce(I,N,k),u[p+1+0]=u[p+3+32]=ce(v,I,N),u[p+1+32]=u[p+3+64]=ce(w,v,I),u[p+1+64]=u[p+3+96]=ce(L,w,v),u[p+1+96]=ce(T,L,w)}function Ad(u,p){var v;for(v=0;8>v;++v)n(u,p+32*v,u,p-32,8)}function Yl(u,p){var v;for(v=0;8>v;++v)r(u,p,u[p-1],8),p+=32}function Ia(u,p,v){var w;for(w=0;8>w;++w)r(p,v+32*w,u,8)}function js(u,p){var v,w=8;for(v=0;8>v;++v)w+=u[p+v-32]+u[p-1+32*v];Ia(w>>4,u,p)}function Md(u,p){var v,w=4;for(v=0;8>v;++v)w+=u[p+v-32];Ia(w>>3,u,p)}function Ra(u,p){var v,w=4;for(v=0;8>v;++v)w+=u[p-1+32*v];Ia(w>>3,u,p)}function Zl(u,p){Ia(128,u,p)}function bo(u,p,v){var w=u[p-v],L=u[p+0],T=3*(L-w)+kd[1020+u[p-2*v]-u[p+v]],I=Yc[112+(T+4>>3)];u[p-v]=Vn[255+w+Yc[112+(T+3>>3)]],u[p+0]=Vn[255+L-I]}function Bc(u,p,v,w){var L=u[p+0],T=u[p+v];return nr[255+u[p-2*v]-u[p-v]]>w||nr[255+T-L]>w}function Gc(u,p,v,w){return 4*nr[255+u[p-v]-u[p+0]]+nr[255+u[p-2*v]-u[p+v]]<=w}function zc(u,p,v,w,L){var T=u[p-3*v],I=u[p-2*v],N=u[p-v],k=u[p+0],B=u[p+v],K=u[p+2*v],ct=u[p+3*v];return 4*nr[255+N-k]+nr[255+I-B]>w?0:nr[255+u[p-4*v]-T]<=L&&nr[255+T-I]<=L&&nr[255+I-N]<=L&&nr[255+ct-K]<=L&&nr[255+K-B]<=L&&nr[255+B-k]<=L}function qc(u,p,v,w){var L=2*w+1;for(w=0;16>w;++w)Gc(u,p+w,v,L)&&bo(u,p+w,v)}function ls(u,p,v,w){var L=2*w+1;for(w=0;16>w;++w)Gc(u,p+w*v,1,L)&&bo(u,p+w*v,1)}function Bs(u,p,v,w){var L;for(L=3;0<L;--L)qc(u,p+=4*v,v,w)}function Td(u,p,v,w){var L;for(L=3;0<L;--L)ls(u,p+=4,v,w)}function Gs(u,p,v,w,L,T,I,N){for(T=2*T+1;0<L--;){if(zc(u,p,v,T,I))if(Bc(u,p,v,N))bo(u,p,v);else{var k=u,B=p,K=v,ct=k[B-2*K],ut=k[B-K],rt=k[B+0],xt=k[B+K],pt=k[B+2*K],J=27*(vt=kd[1020+3*(rt-ut)+kd[1020+ct-xt]])+63>>7,tt=18*vt+63>>7,vt=9*vt+63>>7;k[B-3*K]=Vn[255+k[B-3*K]+vt],k[B-2*K]=Vn[255+ct+tt],k[B-K]=Vn[255+ut+J],k[B+0]=Vn[255+rt-J],k[B+K]=Vn[255+xt-tt],k[B+2*K]=Vn[255+pt-vt]}p+=w}}function mr(u,p,v,w,L,T,I,N){for(T=2*T+1;0<L--;){if(zc(u,p,v,T,I))if(Bc(u,p,v,N))bo(u,p,v);else{var k=u,B=p,K=v,ct=k[B-K],ut=k[B+0],rt=k[B+K],xt=Yc[112+((pt=3*(ut-ct))+4>>3)],pt=Yc[112+(pt+3>>3)],J=xt+1>>1;k[B-2*K]=Vn[255+k[B-2*K]+J],k[B-K]=Vn[255+ct+pt],k[B+0]=Vn[255+ut-xt],k[B+K]=Vn[255+rt-J]}p+=w}}function Kl(u,p,v,w,L,T){Gs(u,p,v,1,16,w,L,T)}function Na(u,p,v,w,L,T){Gs(u,p,1,v,16,w,L,T)}function Pd(u,p,v,w,L,T){var I;for(I=3;0<I;--I)mr(u,p+=4*v,v,1,16,w,L,T)}function wo(u,p,v,w,L,T){var I;for(I=3;0<I;--I)mr(u,p+=4,1,v,16,w,L,T)}function Id(u,p,v,w,L,T,I,N){Gs(u,p,L,1,8,T,I,N),Gs(v,w,L,1,8,T,I,N)}function $l(u,p,v,w,L,T,I,N){Gs(u,p,1,L,8,T,I,N),Gs(v,w,1,L,8,T,I,N)}function Jl(u,p,v,w,L,T,I,N){mr(u,p+4*L,L,1,8,T,I,N),mr(v,w+4*L,L,1,8,T,I,N)}function Uc(u,p,v,w,L,T,I,N){mr(u,p+4,1,L,8,T,I,N),mr(v,w+4,1,L,8,T,I,N)}function Eo(){this.ba=new Ji,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ye,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Ql(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function th(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Wc(){this.ua=0,this.Wa=new V,this.vb=new V,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new z,this.yc=new F}function Rd(){this.xb=this.a=0,this.l=new mo,this.ca=new Ji,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new A,this.Pb=0,this.wd=new A,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Wc,this.ab=0,this.gc=a(4,th),this.Oc=0}function So(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new mo,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Fa(u,p,v,w,L,T,I){for(u=u==null?0:u[p+0],p=0;p<I;++p)L[T+p]=u+v[w+p]&255,u=L[T+p]}function eh(u,p,v,w,L,T,I){var N;if(u==null)Fa(null,null,v,w,L,T,I);else for(N=0;N<I;++N)L[T+N]=u[p+N]+v[w+N]&255}function zs(u,p,v,w,L,T,I){if(u==null)Fa(null,null,v,w,L,T,I);else{var N,k=u[p+0],B=k,K=k;for(N=0;N<I;++N)B=K+(k=u[p+N])-B,K=v[w+N]+(-256&B?0>B?0:255:B)&255,B=k,L[T+N]=K}}function ih(u,p,v,w){var L=p.width,T=p.o;if(t(u!=null&&p!=null),0>v||0>=w||v+w>T)return null;if(!u.Cc){if(u.ga==null){var I;if(u.ga=new So,(I=u.ga==null)||(I=p.width*p.o,t(u.Gb.length==0),u.Gb=s(I),u.Uc=0,u.Gb==null?I=0:(u.mb=u.Gb,u.nb=u.Uc,u.rc=null,I=1),I=!I),!I){I=u.ga;var N=u.Fa,k=u.P,B=u.qc,K=u.mb,ct=u.nb,ut=k+1,rt=B-1,xt=I.l;if(t(N!=null&&K!=null&&p!=null),Ys[0]=null,Ys[1]=Fa,Ys[2]=eh,Ys[3]=zs,I.ca=K,I.tb=ct,I.c=p.width,I.i=p.height,t(0<I.c&&0<I.i),1>=B)p=0;else if(I.$a=N[k+0]>>0&3,I.Z=N[k+0]>>2&3,I.Lc=N[k+0]>>4&3,k=N[k+0]>>6&3,0>I.$a||1<I.$a||4<=I.Z||1<I.Lc||k)p=0;else if(xt.put=ui,xt.ac=ai,xt.bc=wi,xt.ma=I,xt.width=p.width,xt.height=p.height,xt.Da=p.Da,xt.v=p.v,xt.va=p.va,xt.j=p.j,xt.o=p.o,I.$a)t:{t(I.$a==1),p=tr();e:for(;;){if(p==null){p=0;break t}if(t(I!=null),I.mc=p,p.c=I.c,p.i=I.i,p.l=I.l,p.l.ma=I,p.l.width=I.c,p.l.height=I.i,p.a=0,Q(p.m,N,ut,rt),!jr(I.c,I.i,1,p,null)||(p.ab==1&&p.gc[0].hc==3&&as(p.s)?(I.ic=1,N=p.c*p.i,p.Ta=null,p.Ua=0,p.V=s(N),p.Ba=0,p.V==null?(p.a=1,p=0):p=1):(I.ic=0,p=Pa(p,I.c)),!p))break e;p=1;break t}I.mc=null,p=0}else p=rt>=I.c*I.i;I=!p}if(I)return null;u.ga.Lc!=1?u.Ga=0:w=T-v}t(u.ga!=null),t(v+w<=T);t:{if(p=(N=u.ga).c,T=N.l.o,N.$a==0){if(ut=u.rc,rt=u.Vc,xt=u.Fa,k=u.P+1+v*p,B=u.mb,K=u.nb+v*p,t(k<=u.P+u.qc),N.Z!=0)for(t(Ys[N.Z]!=null),I=0;I<w;++I)Ys[N.Z](ut,rt,xt,k,B,K,p),ut=B,rt=K,K+=p,k+=p;else for(I=0;I<w;++I)n(B,K,xt,k,p),ut=B,rt=K,K+=p,k+=p;u.rc=ut,u.Vc=rt}else{if(t(N.mc!=null),p=v+w,t((I=N.mc)!=null),t(p<=I.i),I.C>=p)p=1;else if(N.ic||ot(),N.ic){N=I.V,ut=I.Ba,rt=I.c;var pt=I.i,J=(xt=1,k=I.$/rt,B=I.$%rt,K=I.m,ct=I.s,I.$),tt=rt*pt,vt=rt*p,wt=ct.wc,yt=J<vt?je(ct,B,k):null;t(J<=tt),t(p<=pt),t(as(ct));e:for(;;){for(;!K.h&&J<vt;){if(B&wt||(yt=je(ct,B,k)),t(yt!=null),nt(K),256>(pt=Ee(yt.G[0],yt.H[0],K)))N[ut+J]=pt,++J,++B>=rt&&(B=0,++k<=p&&!(k%16)&&dr(I,k));else{if(!(280>pt)){xt=0;break e}pt=Ei(pt-256,K);var Bt,Nt=Ee(yt.G[4],yt.H[4],K);if(nt(K),!(J>=(Nt=Ri(rt,Nt=Ei(Nt,K)))&&tt-J>=pt)){xt=0;break e}for(Bt=0;Bt<pt;++Bt)N[ut+J+Bt]=N[ut+J+Bt-Nt];for(J+=pt,B+=pt;B>=rt;)B-=rt,++k<=p&&!(k%16)&&dr(I,k);J<vt&&B&wt&&(yt=je(ct,B,k))}t(K.h==O(K))}dr(I,k>p?p:k);break e}!xt||K.h&&J<tt?(xt=0,I.a=K.h?5:3):I.$=J,p=xt}else p=gr(I,I.V,I.Ba,I.c,I.i,p,co);if(!p){w=0;break t}}v+w>=T&&(u.Cc=1),w=1}if(!w)return null;if(u.Cc&&((w=u.ga)!=null&&(w.mc=null),u.ga=null,0<u.Ga))return alert("todo:WebPDequantizeLevels"),null}return u.nb+v*L}function _(u,p,v,w,L,T){for(;0<L--;){var I,N=u,k=p+(v?1:0),B=u,K=p+(v?0:3);for(I=0;I<w;++I){var ct=B[K+4*I];ct!=255&&(ct*=32897,N[k+4*I+0]=N[k+4*I+0]*ct>>23,N[k+4*I+1]=N[k+4*I+1]*ct>>23,N[k+4*I+2]=N[k+4*I+2]*ct>>23)}p+=T}}function C(u,p,v,w,L){for(;0<w--;){var T;for(T=0;T<v;++T){var I=u[p+2*T+0],N=15&(B=u[p+2*T+1]),k=4369*N,B=(240&B|B>>4)*k>>16;u[p+2*T+0]=(240&I|I>>4)*k>>16&240|(15&I|I<<4)*k>>16>>4&15,u[p+2*T+1]=240&B|N}p+=L}}function q(u,p,v,w,L,T,I,N){var k,B,K=255;for(B=0;B<L;++B){for(k=0;k<w;++k){var ct=u[p+k];T[I+4*k]=ct,K&=ct}p+=v,I+=N}return K!=255}function Z(u,p,v,w,L){var T;for(T=0;T<L;++T)v[w+T]=u[p+T]>>8}function ot(){Hs=_,No=C,Xc=q,Z1=Z}function _t(u,p,v){P[u]=function(w,L,T,I,N,k,B,K,ct,ut,rt,xt,pt,J,tt,vt,wt){var yt,Bt=wt-1>>1,Nt=N[k+0]|B[K+0]<<16,ie=ct[ut+0]|rt[xt+0]<<16;t(w!=null);var Ot=3*Nt+ie+131074>>2;for(p(w[L+0],255&Ot,Ot>>16,pt,J),T!=null&&(Ot=3*ie+Nt+131074>>2,p(T[I+0],255&Ot,Ot>>16,tt,vt)),yt=1;yt<=Bt;++yt){var Oe=N[k+yt]|B[K+yt]<<16,Ve=ct[ut+yt]|rt[xt+yt]<<16,Ie=Nt+Oe+ie+Ve+524296,Le=Ie+2*(Oe+ie)>>3;Ot=Le+Nt>>1,Nt=(Ie=Ie+2*(Nt+Ve)>>3)+Oe>>1,p(w[L+2*yt-1],255&Ot,Ot>>16,pt,J+(2*yt-1)*v),p(w[L+2*yt-0],255&Nt,Nt>>16,pt,J+(2*yt-0)*v),T!=null&&(Ot=Ie+ie>>1,Nt=Le+Ve>>1,p(T[I+2*yt-1],255&Ot,Ot>>16,tt,vt+(2*yt-1)*v),p(T[I+2*yt+0],255&Nt,Nt>>16,tt,vt+(2*yt+0)*v)),Nt=Oe,ie=Ve}1&wt||(Ot=3*Nt+ie+131074>>2,p(w[L+wt-1],255&Ot,Ot>>16,pt,J+(wt-1)*v),T!=null&&(Ot=3*ie+Nt+131074>>2,p(T[I+wt-1],255&Ot,Ot>>16,tt,vt+(wt-1)*v)))}}function Ct(){rr[Zc]=jy,rr[Kc]=ap,rr[ep]=By,rr[$c]=op,rr[Jc]=lp,rr[Dd]=hp,rr[ip]=Gy,rr[jd]=ap,rr[Bd]=op,rr[Qc]=lp,rr[Gd]=hp}function jt(u){return u&~zy?0>u?0:255:u>>cp}function Jt(u,p){return jt((19077*u>>8)+(26149*p>>8)-14234)}function ge(u,p,v){return jt((19077*u>>8)-(6419*p>>8)-(13320*v>>8)+8708)}function ye(u,p){return jt((19077*u>>8)+(33050*p>>8)-17685)}function Te(u,p,v,w,L){w[L+0]=Jt(u,v),w[L+1]=ge(u,p,v),w[L+2]=ye(u,p)}function fi(u,p,v,w,L){w[L+0]=ye(u,p),w[L+1]=ge(u,p,v),w[L+2]=Jt(u,v)}function _i(u,p,v,w,L){var T=ge(u,p,v);p=T<<3&224|ye(u,p)>>3,w[L+0]=248&Jt(u,v)|T>>5,w[L+1]=p}function Ni(u,p,v,w,L){var T=240&ye(u,p)|15;w[L+0]=240&Jt(u,v)|ge(u,p,v)>>4,w[L+1]=T}function on(u,p,v,w,L){w[L+0]=255,Te(u,p,v,w,L+1)}function qi(u,p,v,w,L){fi(u,p,v,w,L),w[L+3]=255}function _r(u,p,v,w,L){Te(u,p,v,w,L),w[L+3]=255}function Wn(u,p){return 0>u?0:u>p?p:u}function hs(u,p,v){P[u]=function(w,L,T,I,N,k,B,K,ct){for(var ut=K+(-2&ct)*v;K!=ut;)p(w[L+0],T[I+0],N[k+0],B,K),p(w[L+1],T[I+0],N[k+0],B,K+v),L+=2,++I,++k,K+=2*v;1&ct&&p(w[L+0],T[I+0],N[k+0],B,K)}}function Vc(u,p,v){return v==0?u==0?p==0?6:5:p==0?4:0:v}function nh(u,p,v,w,L){switch(u>>>30){case 3:Io(p,v,w,L,0);break;case 2:ch(p,v,w,L);break;case 1:br(p,v,w,L)}}function rh(u,p){var v,w,L=p.M,T=p.Nb,I=u.oc,N=u.pc+40,k=u.oc,B=u.pc+584,K=u.oc,ct=u.pc+600;for(v=0;16>v;++v)I[N+32*v-1]=129;for(v=0;8>v;++v)k[B+32*v-1]=129,K[ct+32*v-1]=129;for(0<L?I[N-1-32]=k[B-1-32]=K[ct-1-32]=129:(r(I,N-32-1,127,21),r(k,B-32-1,127,9),r(K,ct-32-1,127,9)),w=0;w<u.za;++w){var ut=p.ya[p.aa+w];if(0<w){for(v=-1;16>v;++v)n(I,N+32*v-4,I,N+32*v+12,4);for(v=-1;8>v;++v)n(k,B+32*v-4,k,B+32*v+4,4),n(K,ct+32*v-4,K,ct+32*v+4,4)}var rt=u.Gd,xt=u.Hd+w,pt=ut.ad,J=ut.Hc;if(0<L&&(n(I,N-32,rt[xt].y,0,16),n(k,B-32,rt[xt].f,0,8),n(K,ct-32,rt[xt].ea,0,8)),ut.Za){var tt=I,vt=N-32+16;for(0<L&&(w>=u.za-1?r(tt,vt,rt[xt].y[15],4):n(tt,vt,rt[xt+1].y,0,4)),v=0;4>v;v++)tt[vt+128+v]=tt[vt+256+v]=tt[vt+384+v]=tt[vt+0+v];for(v=0;16>v;++v,J<<=2)tt=I,vt=N+fp[v],wr[ut.Ob[v]](tt,vt),nh(J,pt,16*+v,tt,vt)}else if(tt=Vc(w,L,ut.Ob[0]),Xs[tt](I,N),J!=0)for(v=0;16>v;++v,J<<=2)nh(J,pt,16*+v,I,N+fp[v]);for(v=ut.Gc,tt=Vc(w,L,ut.Dd),gs[tt](k,B),gs[tt](K,ct),J=pt,tt=k,vt=B,255&(ut=v>>0)&&(170&ut?Ws(J,256,tt,vt):us(J,256,tt,vt)),ut=K,J=ct,255&(v>>=8)&&(170&v?Ws(pt,320,ut,J):us(pt,320,ut,J)),L<u.Ub-1&&(n(rt[xt].y,0,I,N+480,16),n(rt[xt].f,0,k,B+224,8),n(rt[xt].ea,0,K,ct+224,8)),v=8*T*u.B,rt=u.sa,xt=u.ta+16*w+16*T*u.R,pt=u.qa,ut=u.ra+8*w+v,J=u.Ha,tt=u.Ia+8*w+v,v=0;16>v;++v)n(rt,xt+v*u.R,I,N+32*v,16);for(v=0;8>v;++v)n(pt,ut+v*u.B,k,B+32*v,8),n(J,tt+v*u.B,K,ct+32*v,8)}}function Lo(u,p,v,w,L,T,I,N,k){var B=[0],K=[0],ct=0,ut=k!=null?k.kd:0,rt=k??new Ql;if(u==null||12>v)return 7;rt.data=u,rt.w=p,rt.ha=v,p=[p],v=[v],rt.gb=[rt.gb];t:{var xt=p,pt=v,J=rt.gb;if(t(u!=null),t(pt!=null),t(J!=null),J[0]=0,12<=pt[0]&&!e(u,xt[0],"RIFF")){if(e(u,xt[0]+8,"WEBP")){J=3;break t}var tt=Dt(u,xt[0]+4);if(12>tt||4294967286<tt){J=3;break t}if(ut&&tt>pt[0]-8){J=7;break t}J[0]=tt,xt[0]+=12,pt[0]-=12}J=0}if(J!=0)return J;for(tt=0<rt.gb[0],v=v[0];;){t:{var vt=u;pt=p,J=v;var wt=B,yt=K,Bt=xt=[0];if((Ot=ct=[ct])[0]=0,8>J[0])J=7;else{if(!e(vt,pt[0],"VP8X")){if(Dt(vt,pt[0]+4)!=10){J=3;break t}if(18>J[0]){J=7;break t}var Nt=Dt(vt,pt[0]+8),ie=1+Rt(vt,pt[0]+12);if(2147483648<=ie*(vt=1+Rt(vt,pt[0]+15))){J=3;break t}Bt!=null&&(Bt[0]=Nt),wt!=null&&(wt[0]=ie),yt!=null&&(yt[0]=vt),pt[0]+=18,J[0]-=18,Ot[0]=1}J=0}}if(ct=ct[0],xt=xt[0],J!=0)return J;if(pt=!!(2&xt),!tt&&ct)return 3;if(T!=null&&(T[0]=!!(16&xt)),I!=null&&(I[0]=pt),N!=null&&(N[0]=0),I=B[0],xt=K[0],ct&&pt&&k==null){J=0;break}if(4>v){J=7;break}if(tt&&ct||!tt&&!ct&&!e(u,p[0],"ALPH")){v=[v],rt.na=[rt.na],rt.P=[rt.P],rt.Sa=[rt.Sa];t:{Nt=u,J=p,tt=v;var Ot=rt.gb;wt=rt.na,yt=rt.P,Bt=rt.Sa,ie=22,t(Nt!=null),t(tt!=null),vt=J[0];var Oe=tt[0];for(t(wt!=null),t(Bt!=null),wt[0]=null,yt[0]=null,Bt[0]=0;;){if(J[0]=vt,tt[0]=Oe,8>Oe){J=7;break t}var Ve=Dt(Nt,vt+4);if(4294967286<Ve){J=3;break t}var Ie=8+Ve+1&-2;if(ie+=Ie,0<Ot&&ie>Ot){J=3;break t}if(!e(Nt,vt,"VP8 ")||!e(Nt,vt,"VP8L")){J=0;break t}if(Oe[0]<Ie){J=7;break t}e(Nt,vt,"ALPH")||(wt[0]=Nt,yt[0]=vt+8,Bt[0]=Ve),vt+=Ie,Oe-=Ie}}if(v=v[0],rt.na=rt.na[0],rt.P=rt.P[0],rt.Sa=rt.Sa[0],J!=0)break}v=[v],rt.Ja=[rt.Ja],rt.xa=[rt.xa];t:if(Ot=u,J=p,tt=v,wt=rt.gb[0],yt=rt.Ja,Bt=rt.xa,Nt=J[0],vt=!e(Ot,Nt,"VP8 "),ie=!e(Ot,Nt,"VP8L"),t(Ot!=null),t(tt!=null),t(yt!=null),t(Bt!=null),8>tt[0])J=7;else{if(vt||ie){if(Ot=Dt(Ot,Nt+4),12<=wt&&Ot>wt-12){J=3;break t}if(ut&&Ot>tt[0]-8){J=7;break t}yt[0]=Ot,J[0]+=8,tt[0]-=8,Bt[0]=ie}else Bt[0]=5<=tt[0]&&Ot[Nt+0]==47&&!(Ot[Nt+4]>>5),yt[0]=tt[0];J=0}if(v=v[0],rt.Ja=rt.Ja[0],rt.xa=rt.xa[0],p=p[0],J!=0)break;if(4294967286<rt.Ja)return 3;if(N==null||pt||(N[0]=rt.xa?2:1),I=[I],xt=[xt],rt.xa){if(5>v){J=7;break}N=I,ut=xt,pt=T,u==null||5>v?u=0:5<=v&&u[p+0]==47&&!(u[p+4]>>5)?(tt=[0],Ot=[0],wt=[0],Q(yt=new A,u,p,v),Wt(yt,tt,Ot,wt)?(N!=null&&(N[0]=tt[0]),ut!=null&&(ut[0]=Ot[0]),pt!=null&&(pt[0]=wt[0]),u=1):u=0):u=0}else{if(10>v){J=7;break}N=xt,u==null||10>v||!Tc(u,p+3,v-3)?u=0:(ut=u[p+0]|u[p+1]<<8|u[p+2]<<16,pt=16383&(u[p+7]<<8|u[p+6]),u=16383&(u[p+9]<<8|u[p+8]),1&ut||3<(ut>>1&7)||!(ut>>4&1)||ut>>5>=rt.Ja||!pt||!u?u=0:(I&&(I[0]=pt),N&&(N[0]=u),u=1))}if(!u||(I=I[0],xt=xt[0],ct&&(B[0]!=I||K[0]!=xt)))return 3;k!=null&&(k[0]=rt,k.offset=p-k.w,t(4294967286>p-k.w),t(k.offset==k.ha-v));break}return J==0||J==7&&ct&&k==null?(T!=null&&(T[0]|=rt.na!=null&&0<rt.na.length),w!=null&&(w[0]=I),L!=null&&(L[0]=xt),0):J}function sh(u,p,v){var w=p.width,L=p.height,T=0,I=0,N=w,k=L;if(p.Da=u!=null&&0<u.Da,p.Da&&(N=u.cd,k=u.bd,T=u.v,I=u.j,11>v||(T&=-2,I&=-2),0>T||0>I||0>=N||0>=k||T+N>w||I+k>L))return 0;if(p.v=T,p.j=I,p.va=T+N,p.o=I+k,p.U=N,p.T=k,p.da=u!=null&&0<u.da,p.da){if(!ne(N,k,v=[u.ib],T=[u.hb]))return 0;p.ib=v[0],p.hb=T[0]}return p.ob=u!=null&&u.ob,p.Kb=u==null||!u.Sd,p.da&&(p.ob=p.ib<3*w/4&&p.hb<3*L/4,p.Kb=0),1}function ah(u){if(u==null)return 2;if(11>u.S){var p=u.f.RGBA;p.fb+=(u.height-1)*p.A,p.A=-p.A}else p=u.f.kb,u=u.height,p.O+=(u-1)*p.fa,p.fa=-p.fa,p.N+=(u-1>>1)*p.Ab,p.Ab=-p.Ab,p.W+=(u-1>>1)*p.Db,p.Db=-p.Db,p.F!=null&&(p.J+=(u-1)*p.lb,p.lb=-p.lb);return 0}function Co(u,p,v,w){if(w==null||0>=u||0>=p)return 2;if(v!=null){if(v.Da){var L=v.cd,T=v.bd,I=-2&v.v,N=-2&v.j;if(0>I||0>N||0>=L||0>=T||I+L>u||N+T>p)return 2;u=L,p=T}if(v.da){if(!ne(u,p,L=[v.ib],T=[v.hb]))return 2;u=L[0],p=T[0]}}w.width=u,w.height=p;t:{var k=w.width,B=w.height;if(u=w.S,0>=k||0>=B||!(u>=Zc&&13>u))u=2;else{if(0>=w.Rd&&w.sd==null){I=T=L=p=0;var K=(N=k*dp[u])*B;if(11>u||(T=(B+1)/2*(p=(k+1)/2),u==12&&(I=(L=k)*B)),(B=s(K+2*T+I))==null){u=1;break t}w.sd=B,11>u?((k=w.f.RGBA).eb=B,k.fb=0,k.A=N,k.size=K):((k=w.f.kb).y=B,k.O=0,k.fa=N,k.Fd=K,k.f=B,k.N=0+K,k.Ab=p,k.Cd=T,k.ea=B,k.W=0+K+T,k.Db=p,k.Ed=T,u==12&&(k.F=B,k.J=0+K+2*T),k.Tc=I,k.lb=L)}if(p=1,L=w.S,T=w.width,I=w.height,L>=Zc&&13>L)if(11>L)u=w.f.RGBA,p&=(N=Math.abs(u.A))*(I-1)+T<=u.size,p&=N>=T*dp[L],p&=u.eb!=null;else{u=w.f.kb,N=(T+1)/2,K=(I+1)/2,k=Math.abs(u.fa),B=Math.abs(u.Ab);var ct=Math.abs(u.Db),ut=Math.abs(u.lb),rt=ut*(I-1)+T;p&=k*(I-1)+T<=u.Fd,p&=B*(K-1)+N<=u.Cd,p=(p&=ct*(K-1)+N<=u.Ed)&k>=T&B>=N&ct>=N,p&=u.y!=null,p&=u.f!=null,p&=u.ea!=null,L==12&&(p&=ut>=T,p&=rt<=u.Tc,p&=u.F!=null)}else p=0;u=p?0:2}}return u!=0||v!=null&&v.fd&&(u=ah(w)),u}var Mn=64,Ao=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Mo=24,To=32,oh=8,Tn=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];It("Predictor0","PredictorAdd0"),P.Predictor0=function(){return 4278190080},P.Predictor1=function(u){return u},P.Predictor2=function(u,p,v){return p[v+0]},P.Predictor3=function(u,p,v){return p[v+1]},P.Predictor4=function(u,p,v){return p[v-1]},P.Predictor5=function(u,p,v){return Tt(Tt(u,p[v+1]),p[v+0])},P.Predictor6=function(u,p,v){return Tt(u,p[v-1])},P.Predictor7=function(u,p,v){return Tt(u,p[v+0])},P.Predictor8=function(u,p,v){return Tt(p[v-1],p[v+0])},P.Predictor9=function(u,p,v){return Tt(p[v+0],p[v+1])},P.Predictor10=function(u,p,v){return Tt(Tt(u,p[v-1]),Tt(p[v+0],p[v+1]))},P.Predictor11=function(u,p,v){var w=p[v+0];return 0>=te(w>>24&255,u>>24&255,(p=p[v-1])>>24&255)+te(w>>16&255,u>>16&255,p>>16&255)+te(w>>8&255,u>>8&255,p>>8&255)+te(255&w,255&u,255&p)?w:u},P.Predictor12=function(u,p,v){var w=p[v+0];return(zt((u>>24&255)+(w>>24&255)-((p=p[v-1])>>24&255))<<24|zt((u>>16&255)+(w>>16&255)-(p>>16&255))<<16|zt((u>>8&255)+(w>>8&255)-(p>>8&255))<<8|zt((255&u)+(255&w)-(255&p)))>>>0},P.Predictor13=function(u,p,v){var w=p[v-1];return(Kt((u=Tt(u,p[v+0]))>>24&255,w>>24&255)<<24|Kt(u>>16&255,w>>16&255)<<16|Kt(u>>8&255,w>>8&255)<<8|Kt(u>>0&255,w>>0&255))>>>0};var Nd=P.PredictorAdd0;P.PredictorAdd1=he,It("Predictor2","PredictorAdd2"),It("Predictor3","PredictorAdd3"),It("Predictor4","PredictorAdd4"),It("Predictor5","PredictorAdd5"),It("Predictor6","PredictorAdd6"),It("Predictor7","PredictorAdd7"),It("Predictor8","PredictorAdd8"),It("Predictor9","PredictorAdd9"),It("Predictor10","PredictorAdd10"),It("Predictor11","PredictorAdd11"),It("Predictor12","PredictorAdd12"),It("Predictor13","PredictorAdd13");var lh=P.PredictorAdd2;me("ColorIndexInverseTransform","MapARGB","32b",function(u){return u>>8&255},function(u){return u}),me("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(u){return u},function(u){return u>>8&255});var Hc,vr=P.ColorIndexInverseTransform,hh=P.MapARGB,Fd=P.VP8LColorIndexInverseTransformAlpha,Od=P.MapAlpha,qs=P.VP8LPredictorsAdd=[];qs.length=16,(P.VP8LPredictors=[]).length=16,(P.VP8LPredictorsAdd_C=[]).length=16,(P.VP8LPredictors_C=[]).length=16;var er,yr,Us,Gr,cs,Po,xr,Io,ch,Ws,br,us,Oa,Ro,ka,Vs,uh,ir,fs,ii,ni,Li,ji,ds,Hs,No,Xc,Z1,K1=s(511),$1=s(2041),J1=s(225),Q1=s(767),tp=0,kd=$1,Yc=J1,Vn=Q1,nr=K1,Zc=0,Kc=1,ep=2,$c=3,Jc=4,Dd=5,ip=6,jd=7,Bd=8,Qc=9,Gd=10,Sy=[2,3,7],Ly=[3,3,11],np=[280,256,256,256,40],Cy=[0,1,1,1,0],Ay=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],My=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Ty=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Py=8,zd=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],qd=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],fh=null,Iy=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Ry=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],rp=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Ny=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Fy=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Oy=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],ky=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Xs=[],wr=[],gs=[],Dy=1,sp=2,Ys=[],rr=[];_t("UpsampleRgbLinePair",Te,3),_t("UpsampleBgrLinePair",fi,3),_t("UpsampleRgbaLinePair",_r,4),_t("UpsampleBgraLinePair",qi,4),_t("UpsampleArgbLinePair",on,4),_t("UpsampleRgba4444LinePair",Ni,2),_t("UpsampleRgb565LinePair",_i,2);var jy=P.UpsampleRgbLinePair,By=P.UpsampleBgrLinePair,ap=P.UpsampleRgbaLinePair,op=P.UpsampleBgraLinePair,lp=P.UpsampleArgbLinePair,hp=P.UpsampleRgba4444LinePair,Gy=P.UpsampleRgb565LinePair,tu=16,eu=1<<tu-1,dh=-227,Ud=482,cp=6,zy=(256<<cp)-1,up=0,qy=s(256),Uy=s(256),Wy=s(256),Vy=s(256),Hy=s(Ud-dh),Xy=s(Ud-dh);hs("YuvToRgbRow",Te,3),hs("YuvToBgrRow",fi,3),hs("YuvToRgbaRow",_r,4),hs("YuvToBgraRow",qi,4),hs("YuvToArgbRow",on,4),hs("YuvToRgba4444Row",Ni,2),hs("YuvToRgb565Row",_i,2);var fp=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],iu=[0,2,8],Yy=[8,7,6,4,4,2,2,2,1,1,1,1],Zy=1;this.WebPDecodeRGBA=function(u,p,v,w,L){var T=Kc,I=new Eo,N=new Ji;I.ba=N,N.S=T,N.width=[N.width],N.height=[N.height];var k=N.width,B=N.height,K=new vn;if(K==null||u==null)var ct=2;else t(K!=null),ct=Lo(u,p,v,K.width,K.height,K.Pd,K.Qd,K.format,null);if(ct!=0?k=0:(k!=null&&(k[0]=K.width[0]),B!=null&&(B[0]=K.height[0]),k=1),k){N.width=N.width[0],N.height=N.height[0],w!=null&&(w[0]=N.width),L!=null&&(L[0]=N.height);t:{if(w=new mo,(L=new Ql).data=u,L.w=p,L.ha=v,L.kd=1,p=[0],t(L!=null),((u=Lo(L.data,L.w,L.ha,null,null,null,p,null,L))==0||u==7)&&p[0]&&(u=4),(p=u)==0){if(t(I!=null),w.data=L.data,w.w=L.w+L.offset,w.ha=L.ha-L.offset,w.put=ui,w.ac=ai,w.bc=wi,w.ma=I,L.xa){if((u=tr())==null){I=1;break t}if(function(ut,rt){var xt=[0],pt=[0],J=[0];e:for(;;){if(ut==null)return 0;if(rt==null)return ut.a=2,0;if(ut.l=rt,ut.a=0,Q(ut.m,rt.data,rt.w,rt.ha),!Wt(ut.m,xt,pt,J)){ut.a=3;break e}if(ut.xb=sp,rt.width=xt[0],rt.height=pt[0],!jr(xt[0],pt[0],1,ut,null))break e;return 1}return t(ut.a!=0),0}(u,w)){if(w=(p=Co(w.width,w.height,I.Oa,I.ba))==0){e:{w=u;i:for(;;){if(w==null){w=0;break e}if(t(w.s.yc!=null),t(w.s.Ya!=null),t(0<w.s.Wb),t((v=w.l)!=null),t((L=v.ma)!=null),w.xb!=0){if(w.ca=L.ba,w.tb=L.tb,t(w.ca!=null),!sh(L.Oa,v,$c)){w.a=2;break i}if(!Pa(w,v.width)||v.da)break i;if((v.da||Me(w.ca.S))&&ot(),11>w.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),w.ca.f.kb.F!=null&&ot()),w.Pb&&0<w.s.ua&&w.s.vb.X==null&&!$t(w.s.vb,w.s.Wa.Xa)){w.a=1;break i}w.xb=0}if(!gr(w,w.V,w.Ba,w.c,w.i,v.o,ho))break i;L.Dc=w.Ma,w=1;break e}t(w.a!=0),w=0}w=!w}w&&(p=u.a)}else p=u.a}else{if((u=new gd)==null){I=1;break t}if(u.Fa=L.na,u.P=L.P,u.qc=L.Sa,Pc(u,w)){if((p=Co(w.width,w.height,I.Oa,I.ba))==0){if(u.Aa=0,v=I.Oa,t((L=u)!=null),v!=null){if(0<(k=0>(k=v.Md)?0:100<k?255:255*k/100)){for(B=K=0;4>B;++B)12>(ct=L.pb[B]).lc&&(ct.ia=k*Yy[0>ct.lc?0:ct.lc]>>3),K|=ct.ia;K&&(alert("todo:VP8InitRandom"),L.ia=1)}L.Ga=v.Id,100<L.Ga?L.Ga=100:0>L.Ga&&(L.Ga=0)}pd(u,w)||(p=u.a)}}else p=u.a}p==0&&I.Oa!=null&&I.Oa.fd&&(p=ah(I.ba))}I=p}T=I!=0?null:11>T?N.f.RGBA.eb:N.f.kb.y}else T=null;return T};var dp=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function h(P,H){for(var et="",R=0;R<4;R++)et+=String.fromCharCode(P[H++]);return et}function c(P,H){return(P[H+0]<<0|P[H+1]<<8|P[H+2]<<16)>>>0}function f(P,H){return(P[H+0]<<0|P[H+1]<<8|P[H+2]<<16|P[H+3]<<24)>>>0}new l;var g=[0],d=[0],m=[],y=new l,b=i,x=function(P,H){var et={},R=0,F=!1,U=0,z=0;if(et.frames=[],!function(G,O,X,nt){for(var at=0;at<nt;at++)if(G[O+at]!=X.charCodeAt(at))return!0;return!1}(P,H,"RIFF",4)){var it,Y;for(f(P,H+=4),H+=8;H<P.length;){var st=h(P,H),Q=f(P,H+=4);H+=4;var gt=Q+(1&Q);switch(st){case"VP8 ":case"VP8L":et.frames[R]===void 0&&(et.frames[R]={}),(A=et.frames[R]).src_off=F?z:H-8,A.src_size=U+Q+8,R++,F&&(F=!1,U=0,z=0);break;case"VP8X":(A=et.header={}).feature_flags=P[H];var lt=H+4;A.canvas_width=1+c(P,lt),lt+=3,A.canvas_height=1+c(P,lt),lt+=3;break;case"ALPH":F=!0,U=gt+8,z=H-8;break;case"ANIM":(A=et.header).bgcolor=f(P,H),lt=H+4,A.loop_count=(it=P)[(Y=lt)+0]<<0|it[Y+1]<<8,lt+=2;break;case"ANMF":var Et,A;(A=et.frames[R]={}).offset_x=2*c(P,H),H+=3,A.offset_y=2*c(P,H),H+=3,A.width=1+c(P,H),H+=3,A.height=1+c(P,H),H+=3,A.duration=c(P,H),H+=3,Et=P[H++],A.dispose=1&Et,A.blend=Et>>1&1}st!="ANMF"&&(H+=gt)}return et}}(b,0);x.response=b,x.rgbaoutput=!0,x.dataurl=!1;var E=x.header?x.header:null,S=x.frames?x.frames:null;if(E){E.loop_counter=E.loop_count,g=[E.canvas_height],d=[E.canvas_width];for(var M=0;M<S.length&&S[M].blend!=0;M++);}var D=S[0],W=y.WebPDecodeRGBA(b,D.src_off,D.src_size,d,g);D.rgba=W,D.imgwidth=d[0],D.imgheight=g[0];for(var j=0;j<d[0]*g[0]*4;j++)m[j]=W[j];return this.width=d,this.height=g,this.data=m,this}(function(i){var t=function(){return typeof g0=="function"},e=function(g,d,m,y){var b=4,x=a;switch(y){case i.image_compression.FAST:b=1,x=s;break;case i.image_compression.MEDIUM:b=6,x=o;break;case i.image_compression.SLOW:b=9,x=l}g=n(g,d,m,x);var E=g0(g,{level:b});return i.__addimage__.arrayBufferToBinaryString(E)},n=function(g,d,m,y){for(var b,x,E,S=g.length/d,M=new Uint8Array(g.length+S),D=c(),W=0;W<S;W+=1){if(E=W*d,b=g.subarray(E,E+d),y)M.set(y(b,m,x),E+W);else{for(var j,P=D.length,H=[];j<P;j+=1)H[j]=D[j](b,m,x);var et=f(H.concat());M.set(H[et],E+W)}x=b}return M},r=function(g){var d=Array.apply([],g);return d.unshift(0),d},s=function(g,d){var m,y=[],b=g.length;y[0]=1;for(var x=0;x<b;x+=1)m=g[x-d]||0,y[x+1]=g[x]-m+256&255;return y},a=function(g,d,m){var y,b=[],x=g.length;b[0]=2;for(var E=0;E<x;E+=1)y=m&&m[E]||0,b[E+1]=g[E]-y+256&255;return b},o=function(g,d,m){var y,b,x=[],E=g.length;x[0]=3;for(var S=0;S<E;S+=1)y=g[S-d]||0,b=m&&m[S]||0,x[S+1]=g[S]+256-(y+b>>>1)&255;return x},l=function(g,d,m){var y,b,x,E,S=[],M=g.length;S[0]=4;for(var D=0;D<M;D+=1)y=g[D-d]||0,b=m&&m[D]||0,x=m&&m[D-d]||0,E=h(y,b,x),S[D+1]=g[D]-E+256&255;return S},h=function(g,d,m){if(g===d&&d===m)return g;var y=Math.abs(d-m),b=Math.abs(g-m),x=Math.abs(g+d-m-m);return y<=b&&y<=x?g:b<=x?d:m},c=function(){return[r,s,a,o,l]},f=function(g){var d=g.map(function(m){return m.reduce(function(y,b){return y+Math.abs(b)},0)});return d.indexOf(Math.min.apply(null,d))};i.processPNG=function(g,d,m,y){var b,x,E,S,M,D,W,j,P,H,et,R,F,U,z,it=this.decode.FLATE_DECODE,Y="";if(this.__addimage__.isArrayBuffer(g)&&(g=new Uint8Array(g)),this.__addimage__.isArrayBufferView(g)){if(g=(E=new vE(g)).imgData,x=E.bits,b=E.colorSpace,M=E.colors,[4,6].indexOf(E.colorType)!==-1){if(E.bits===8){P=(j=E.pixelBitlength==32?new Uint32Array(E.decodePixels().buffer):E.pixelBitlength==16?new Uint16Array(E.decodePixels().buffer):new Uint8Array(E.decodePixels().buffer)).length,et=new Uint8Array(P*E.colors),H=new Uint8Array(P);var st,Q=E.pixelBitlength-E.bits;for(U=0,z=0;U<P;U++){for(F=j[U],st=0;st<Q;)et[z++]=F>>>st&255,st+=E.bits;H[U]=F>>>st&255}}if(E.bits===16){P=(j=new Uint32Array(E.decodePixels().buffer)).length,et=new Uint8Array(P*(32/E.pixelBitlength)*E.colors),H=new Uint8Array(P*(32/E.pixelBitlength)),R=E.colors>1,U=0,z=0;for(var gt=0;U<P;)F=j[U++],et[z++]=F>>>0&255,R&&(et[z++]=F>>>16&255,F=j[U++],et[z++]=F>>>0&255),H[gt++]=F>>>16&255;x=8}y!==i.image_compression.NONE&&t()?(g=e(et,E.width*E.colors,E.colors,y),W=e(H,E.width,1,y)):(g=et,W=H,it=void 0)}if(E.colorType===3&&(b=this.color_spaces.INDEXED,D=E.palette,E.transparency.indexed)){var lt=E.transparency.indexed,Et=0;for(U=0,P=lt.length;U<P;++U)Et+=lt[U];if((Et/=255)===P-1&&lt.indexOf(0)!==-1)S=[lt.indexOf(0)];else if(Et!==P){for(j=E.decodePixels(),H=new Uint8Array(j.length),U=0,P=j.length;U<P;U++)H[U]=lt[j[U]];W=e(H,E.width,1)}}var A=function(G){var O;switch(G){case i.image_compression.FAST:O=11;break;case i.image_compression.MEDIUM:O=13;break;case i.image_compression.SLOW:O=14;break;default:O=12}return O}(y);return it===this.decode.FLATE_DECODE&&(Y="/Predictor "+A+" "),Y+="/Colors "+M+" /BitsPerComponent "+x+" /Columns "+E.width,(this.__addimage__.isArrayBuffer(g)||this.__addimage__.isArrayBufferView(g))&&(g=this.__addimage__.arrayBufferToBinaryString(g)),(W&&this.__addimage__.isArrayBuffer(W)||this.__addimage__.isArrayBufferView(W))&&(W=this.__addimage__.arrayBufferToBinaryString(W)),{alias:m,data:g,index:d,filter:it,decodeParameters:Y,transparency:S,palette:D,sMask:W,predictor:A,width:E.width,height:E.height,bitsPerComponent:x,colorSpace:b}}}})(re.API),function(i){i.processGIF89A=function(t,e,n,r){var s=new yE(t),a=s.width,o=s.height,l=[];s.decodeAndBlitFrameRGBA(0,l);var h={data:l,width:a,height:o},c=new Lg(100).encode(h,100);return i.processJPEG.call(this,c,e,n,r)},i.processGIF87A=i.processGIF89A}(re.API),Cr.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var i=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(i);for(var t=0;t<i;t++){var e=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:r,green:n,blue:e,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Cr.prototype.parseBGR=function(){this.pos=this.offset;try{var i="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[i]()}catch(e){Qe.log("bit decode error:"+e)}},Cr.prototype.bit1=function(){var i,t=Math.ceil(this.width/8),e=t%4;for(i=this.height-1;i>=0;i--){for(var n=this.bottom_up?i:this.height-1-i,r=0;r<t;r++)for(var s=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+8*r*4,o=0;o<8&&8*r+o<this.width;o++){var l=this.palette[s>>7-o&1];this.data[a+4*o]=l.blue,this.data[a+4*o+1]=l.green,this.data[a+4*o+2]=l.red,this.data[a+4*o+3]=255}e!==0&&(this.pos+=4-e)}},Cr.prototype.bit4=function(){for(var i=Math.ceil(this.width/2),t=i%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,r=0;r<i;r++){var s=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+2*r*4,o=s>>4,l=15&s,h=this.palette[o];if(this.data[a]=h.blue,this.data[a+1]=h.green,this.data[a+2]=h.red,this.data[a+3]=255,2*r+1>=this.width)break;h=this.palette[l],this.data[a+4]=h.blue,this.data[a+4+1]=h.green,this.data[a+4+2]=h.red,this.data[a+4+3]=255}t!==0&&(this.pos+=4-t)}},Cr.prototype.bit8=function(){for(var i=this.width%4,t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*n;if(r<this.palette.length){var a=this.palette[r];this.data[s]=a.red,this.data[s+1]=a.green,this.data[s+2]=a.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}i!==0&&(this.pos+=4-i)}},Cr.prototype.bit15=function(){for(var i=this.width%3,t=parseInt("11111",2),e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&t)/t*255|0,o=(s>>5&t)/t*255|0,l=(s>>10&t)/t*255|0,h=s>>15?255:0,c=n*this.width*4+4*r;this.data[c]=l,this.data[c+1]=o,this.data[c+2]=a,this.data[c+3]=h}this.pos+=i}},Cr.prototype.bit16=function(){for(var i=this.width%3,t=parseInt("11111",2),e=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&t)/t*255|0,l=(a>>5&e)/e*255|0,h=(a>>11)/t*255|0,c=r*this.width*4+4*s;this.data[c]=h,this.data[c+1]=l,this.data[c+2]=o,this.data[c+3]=255}this.pos+=i}},Cr.prototype.bit24=function(){for(var i=this.height-1;i>=0;i--){for(var t=this.bottom_up?i:this.height-1-i,e=0;e<this.width;e++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=t*this.width*4+4*e;this.data[a]=s,this.data[a+1]=r,this.data[a+2]=n,this.data[a+3]=255}this.pos+=this.width%4}},Cr.prototype.bit32=function(){for(var i=this.height-1;i>=0;i--)for(var t=this.bottom_up?i:this.height-1-i,e=0;e<this.width;e++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*e;this.data[o]=s,this.data[o+1]=r,this.data[o+2]=n,this.data[o+3]=a}},Cr.prototype.getData=function(){return this.data},function(i){i.processBMP=function(t,e,n,r){var s=new Cr(t,!1),a=s.width,o=s.height,l={data:s.getData(),width:a,height:o},h=new Lg(100).encode(l,100);return i.processJPEG.call(this,h,e,n,r)}}(re.API),jm.prototype.getData=function(){return this.data},function(i){i.processWEBP=function(t,e,n,r){var s=new jm(t),a=s.width,o=s.height,l={data:s.getData(),width:a,height:o},h=new Lg(100).encode(l,100);return i.processJPEG.call(this,h,e,n,r)}}(re.API),re.API.processRGBA=function(i,t,e){for(var n=i.data,r=n.length,s=new Uint8Array(r/4*3),a=new Uint8Array(r/4),o=0,l=0,h=0;h<r;h+=4){var c=n[h],f=n[h+1],g=n[h+2],d=n[h+3];s[o++]=c,s[o++]=f,s[o++]=g,a[l++]=d}var m=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:m,index:t,alias:e,colorSpace:"DeviceRGB",bitsPerComponent:8,width:i.width,height:i.height}},re.API.setLanguage=function(i){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[i]!==void 0&&(this.internal.languageSettings.languageCode=i,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},qo=re.API,Nu=qo.getCharWidthsArray=function(i,t){var e,n,r=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),a=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:r.metadata.Unicode.widths,l=o.fof?o.fof:1,h=t.kerning?t.kerning:r.metadata.Unicode.kerning,c=h.fof?h.fof:1,f=t.doKerning!==!1,g=0,d=i.length,m=0,y=o[0]||l,b=[];for(e=0;e<d;e++)n=i.charCodeAt(e),typeof r.metadata.widthOfString=="function"?b.push((r.metadata.widthOfGlyph(r.metadata.characterToGlyph(n))+a*(1e3/s)||0)/1e3):(g=f&&Xe(h[n])==="object"&&!isNaN(parseInt(h[n][m],10))?h[n][m]/c:0,b.push((o[n]||y)/l+g)),m=n;return b},Fm=qo.getStringUnitWidth=function(i,t){var e=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),r=t.charSpace||this.internal.getCharSpace();return qo.processArabic&&(i=qo.processArabic(i)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(i,e,r)/e:Nu.apply(this,arguments).reduce(function(s,a){return s+a},0)},Om=function(i,t,e,n){for(var r=[],s=0,a=i.length,o=0;s!==a&&o+t[s]<e;)o+=t[s],s++;r.push(i.slice(0,s));var l=s;for(o=0;s!==a;)o+t[s]>n&&(r.push(i.slice(l,s)),o=0,l=s),o+=t[s],s++;return l!==s&&r.push(i.slice(l,s)),r},km=function(i,t,e){e||(e={});var n,r,s,a,o,l,h,c=[],f=[c],g=e.textIndent||0,d=0,m=0,y=i.split(" "),b=Nu.apply(this,[" ",e])[0];if(l=e.lineIndent===-1?y[0].length+2:e.lineIndent||0){var x=Array(l).join(" "),E=[];y.map(function(M){(M=M.split(/\s*\n/)).length>1?E=E.concat(M.map(function(D,W){return(W&&D.length?`
`:"")+D})):E.push(M[0])}),y=E,l=Fm.apply(this,[x,e])}for(s=0,a=y.length;s<a;s++){var S=0;if(n=y[s],l&&n[0]==`
`&&(n=n.substr(1),S=1),g+d+(m=(r=Nu.apply(this,[n,e])).reduce(function(M,D){return M+D},0))>t||S){if(m>t){for(o=Om.apply(this,[n,r,t-(g+d),t]),c.push(o.shift()),c=[o.pop()];o.length;)f.push([o.shift()]);m=r.slice(n.length-(c[0]?c[0].length:0)).reduce(function(M,D){return M+D},0)}else c=[n];f.push(c),g=m+l,d=b}else c.push(n),g+=d+m,d=b}return h=l?function(M,D){return(D?x:"")+M.join(" ")}:function(M){return M.join(" ")},f.map(h)},qo.splitTextToSize=function(i,t,e){var n,r=(e=e||{}).fontSize||this.internal.getFontSize(),s=(function(c){if(c.widths&&c.kerning)return{widths:c.widths,kerning:c.kerning};var f=this.internal.getFont(c.fontName,c.fontStyle);return f.metadata.Unicode?{widths:f.metadata.Unicode.widths||{0:1},kerning:f.metadata.Unicode.kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,e);n=Array.isArray(i)?i:String(i).split(/\r?\n/);var a=1*this.internal.scaleFactor*t/r;s.textIndent=e.textIndent?1*e.textIndent*this.internal.scaleFactor/r:0,s.lineIndent=e.lineIndent;var o,l,h=[];for(o=0,l=n.length;o<l;o++)h=h.concat(km.apply(this,[n[o],a,s]));return h},function(i){i.__fontmetrics__=i.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",e={},n={},r=0;r<t.length;r++)e[t[r]]="0123456789abcdef"[r],n["0123456789abcdef"[r]]=t[r];var s=function(f){return"0x"+parseInt(f,10).toString(16)},a=i.__fontmetrics__.compress=function(f){var g,d,m,y,b=["{"];for(var x in f){if(g=f[x],isNaN(parseInt(x,10))?d="'"+x+"'":(x=parseInt(x,10),d=(d=s(x).slice(2)).slice(0,-1)+n[d.slice(-1)]),typeof g=="number")g<0?(m=s(g).slice(3),y="-"):(m=s(g).slice(2),y=""),m=y+m.slice(0,-1)+n[m.slice(-1)];else{if(Xe(g)!=="object")throw new Error("Don't know what to do with value type "+Xe(g)+".");m=a(g)}b.push(d+m)}return b.push("}"),b.join("")},o=i.__fontmetrics__.uncompress=function(f){if(typeof f!="string")throw new Error("Invalid argument passed to uncompress.");for(var g,d,m,y,b={},x=1,E=b,S=[],M="",D="",W=f.length-1,j=1;j<W;j+=1)(y=f[j])=="'"?g?(m=g.join(""),g=void 0):g=[]:g?g.push(y):y=="{"?(S.push([E,m]),E={},m=void 0):y=="}"?((d=S.pop())[0][d[1]]=E,m=void 0,E=d[0]):y=="-"?x=-1:m===void 0?e.hasOwnProperty(y)?(M+=e[y],m=parseInt(M,16)*x,x=1,M=""):M+=y:e.hasOwnProperty(y)?(D+=e[y],E[m]=parseInt(D,16)*x,x=1,m=void 0,D=""):D+=y;return b},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},h={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},c={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};i.events.push(["addFont",function(f){var g=f.font,d=c.Unicode[g.postScriptName];d&&(g.metadata.Unicode={},g.metadata.Unicode.widths=d.widths,g.metadata.Unicode.kerning=d.kerning);var m=h.Unicode[g.postScriptName];m&&(g.metadata.Unicode.encoding=m,g.encoding=m.codePages[0])}])}(re.API),function(i){var t=function(e){for(var n=e.length,r=new Uint8Array(n),s=0;s<n;s++)r[s]=e.charCodeAt(s);return r};i.API.events.push(["addFont",function(e){var n=void 0,r=e.font,s=e.instance;if(!r.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");if(typeof(n=s.existsFileInVFS(r.postScriptName)===!1?s.loadFile(r.postScriptName):s.getFileFromVFS(r.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");(function(a,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(Oh(o)),a.metadata=i.API.TTFFont.open(o),a.metadata.Unicode=a.metadata.Unicode||{encoding:{},kerning:{},widths:[]},a.metadata.glyIdsUsed=[0]})(r,n)}}])}(re),function(i){function t(){return(se.canvg?Promise.resolve(se.canvg):h0(()=>import("./index.es-Ci8F_-NX.js"),[])).catch(function(e){return Promise.reject(new Error("Could not load canvg: "+e))}).then(function(e){return e.default?e.default:e})}re.API.addSvgAsImage=function(e,n,r,s,a,o,l,h){if(isNaN(n)||isNaN(r))throw Qe.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(a))throw Qe.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=s,c.height=a;var f=c.getContext("2d");f.fillStyle="#fff",f.fillRect(0,0,c.width,c.height);var g={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},d=this;return t().then(function(m){return m.fromString(f,e,g)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(m){return m.render(g)}).then(function(){d.addImage(c.toDataURL("image/jpeg",1),n,r,s,a,l,h)})}}(),re.API.putTotalPages=function(i){var t,e=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(i,"g"),e=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(i,this.internal.getFont()),"g"),e=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var r=0;r<this.internal.pages[n].length;r++)this.internal.pages[n][r]=this.internal.pages[n][r].replace(t,e);return this},re.API.viewerPreferences=function(i,t){var e;i=i||{},t=t||!1;var n,r,s,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(a),l=[],h=0,c=0,f=0;function g(m,y){var b,x=!1;for(b=0;b<m.length;b+=1)m[b]===y&&(x=!0);return x}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),e=this.internal.viewerpreferences.configuration,i==="reset"||t===!0){var d=o.length;for(f=0;f<d;f+=1)e[o[f]].value=e[o[f]].defaultValue,e[o[f]].explicitSet=!1}if(Xe(i)==="object"){for(r in i)if(s=i[r],g(o,r)&&s!==void 0){if(e[r].type==="boolean"&&typeof s=="boolean")e[r].value=s;else if(e[r].type==="name"&&g(e[r].valueSet,s))e[r].value=s;else if(e[r].type==="integer"&&Number.isInteger(s))e[r].value=s;else if(e[r].type==="array"){for(h=0;h<s.length;h+=1)if(n=!0,s[h].length===1&&typeof s[h][0]=="number")l.push(String(s[h]-1));else if(s[h].length>1){for(c=0;c<s[h].length;c+=1)typeof s[h][c]!="number"&&(n=!1);n===!0&&l.push([s[h][0]-1,s[h][1]-1].join(" "))}e[r].value="["+l.join(" ")+"]"}else e[r].value=e[r].defaultValue;e[r].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var m,y=[];for(m in e)e[m].explicitSet===!0&&(e[m].type==="name"?y.push("/"+m+" /"+e[m].value):y.push("/"+m+" "+e[m].value));y.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+y.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=e,this},function(i){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',r=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),a=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),h=s.length+a.length+o.length+r.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+h+" >>"),this.internal.write("stream"),this.internal.write(r+s+a+o+l),this.internal.write("endstream"),this.internal.write("endobj")},e=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};i.addMetadata=function(n,r){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:r||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",e),this.internal.events.subscribe("postPutResources",t)),this}}(re.API),function(i){var t=i.API,e=t.pdfEscape16=function(s,a){for(var o,l=a.metadata.Unicode.widths,h=["","0","00","000","0000"],c=[""],f=0,g=s.length;f<g;++f){if(o=a.metadata.characterToGlyph(s.charCodeAt(f)),a.metadata.glyIdsUsed.push(o),a.metadata.toUnicode[o]=s.charCodeAt(f),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(a.metadata.widthOfGlyph(o),10)])),o=="0")return c.join("");o=o.toString(16),c.push(h[4-o.length],o)}return c.join("")},n=function(s){var a,o,l,h,c,f,g;for(c=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],f=0,g=(o=Object.keys(s).sort(function(d,m){return d-m})).length;f<g;f++)a=o[f],l.length>=100&&(c+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),s[a]!==void 0&&s[a]!==null&&typeof s[a].toString=="function"&&(h=("0000"+s[a].toString(16)).slice(-4),a=("0000"+(+a).toString(16)).slice(-4),l.push("<"+a+"><"+h+">"));return l.length&&(c+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),c+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(a){var o=a.font,l=a.out,h=a.newObject,c=a.putStream;if(o.metadata instanceof i.API.TTFFont&&o.encoding==="Identity-H"){for(var f=o.metadata.Unicode.widths,g=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),d="",m=0;m<g.length;m++)d+=String.fromCharCode(g[m]);var y=h();c({data:d,addLength1:!0,objectId:y}),l("endobj");var b=h();c({data:n(o.metadata.toUnicode),addLength1:!0,objectId:b}),l("endobj");var x=h();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+tl(o.fontName)),l("/FontFile2 "+y+" 0 R"),l("/FontBBox "+i.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var E=h();l("<<"),l("/Type /Font"),l("/BaseFont /"+tl(o.fontName)),l("/FontDescriptor "+x+" 0 R"),l("/W "+i.API.PDFObject.convert(f)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=h(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+b+" 0 R"),l("/BaseFont /"+tl(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+E+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(a){var o=a.font,l=a.out,h=a.newObject,c=a.putStream;if(o.metadata instanceof i.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var f=o.metadata.rawData,g="",d=0;d<f.length;d++)g+=String.fromCharCode(f[d]);var m=h();c({data:g,addLength1:!0,objectId:m}),l("endobj");var y=h();c({data:n(o.metadata.toUnicode),addLength1:!0,objectId:y}),l("endobj");var b=h();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+m+" 0 R"),l("/Flags 96"),l("/FontBBox "+i.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+tl(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=h();for(var x=0;x<o.metadata.hmtx.widths.length;x++)o.metadata.hmtx.widths[x]=parseInt(o.metadata.hmtx.widths[x]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+y+" 0 R/BaseFont/"+tl(o.fontName)+"/FontDescriptor "+b+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+i.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(s)}]);var r=function(s){var a,o=s.text||"",l=s.x,h=s.y,c=s.options||{},f=s.mutex||{},g=f.pdfEscape,d=f.activeFontKey,m=f.fonts,y=d,b="",x=0,E="",S=m[y].encoding;if(m[y].encoding!=="Identity-H")return{text:o,x:l,y:h,options:c,mutex:f};for(E=o,y=d,Array.isArray(o)&&(E=o[0]),x=0;x<E.length;x+=1)m[y].metadata.hasOwnProperty("cmap")&&(a=m[y].metadata.cmap.unicode.codeMap[E[x].charCodeAt(0)]),a||E[x].charCodeAt(0)<256&&m[y].metadata.hasOwnProperty("Unicode")?b+=E[x]:b+="";var M="";return parseInt(y.slice(1))<14||S==="WinAnsiEncoding"?M=g(b,y).split("").map(function(D){return D.charCodeAt(0).toString(16)}).join(""):S==="Identity-H"&&(M=e(b,m[y])),f.isHex=!0,{text:M,x:l,y:h,options:c,mutex:f}};t.events.push(["postProcessText",function(s){var a=s.text||"",o=[],l={text:a,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(a)){var h=0;for(h=0;h<a.length;h+=1)Array.isArray(a[h])&&a[h].length===3?o.push([r(Object.assign({},l,{text:a[h][0]})).text,a[h][1],a[h][2]]):o.push(r(Object.assign({},l,{text:a[h]})).text);s.text=o}else s.text=r(Object.assign({},l,{text:a})).text}])}(re),function(i){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};i.existsFileInVFS=function(e){return t.call(this),this.internal.vFS[e]!==void 0},i.addFileToVFS=function(e,n){return t.call(this),this.internal.vFS[e]=n,this},i.getFileFromVFS=function(e){return t.call(this),this.internal.vFS[e]!==void 0?this.internal.vFS[e]:null}}(re.API),function(i){i.__bidiEngine__=i.prototype.__bidiEngine__=function(n){var r,s,a,o,l,h,c,f=t,g=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],d=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],m={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},y={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},b=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],x=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),E=!1,S=0;this.__bidiEngine__={};var M=function(R){var F=R.charCodeAt(),U=F>>8,z=y[U];return z!==void 0?f[256*z+(255&F)]:U===252||U===253?"AL":x.test(U)?"L":U===8?"R":"N"},D=function(R){for(var F,U=0;U<R.length;U++){if((F=M(R.charAt(U)))==="L")return!1;if(F==="R")return!0}return!1},W=function(R,F,U,z){var it,Y,st,Q,gt=F[z];switch(gt){case"L":case"R":E=!1;break;case"N":case"AN":break;case"EN":E&&(gt="AN");break;case"AL":E=!0,gt="R";break;case"WS":gt="N";break;case"CS":z<1||z+1>=F.length||(it=U[z-1])!=="EN"&&it!=="AN"||(Y=F[z+1])!=="EN"&&Y!=="AN"?gt="N":E&&(Y="AN"),gt=Y===it?Y:"N";break;case"ES":gt=(it=z>0?U[z-1]:"B")==="EN"&&z+1<F.length&&F[z+1]==="EN"?"EN":"N";break;case"ET":if(z>0&&U[z-1]==="EN"){gt="EN";break}if(E){gt="N";break}for(st=z+1,Q=F.length;st<Q&&F[st]==="ET";)st++;gt=st<Q&&F[st]==="EN"?"EN":"N";break;case"NSM":if(a&&!o){for(Q=F.length,st=z+1;st<Q&&F[st]==="NSM";)st++;if(st<Q){var lt=R[z],Et=lt>=1425&&lt<=2303||lt===64286;if(it=F[st],Et&&(it==="R"||it==="AL")){gt="R";break}}}gt=z<1||(it=F[z-1])==="B"?"N":U[z-1];break;case"B":E=!1,r=!0,gt=S;break;case"S":s=!0,gt="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":E=!1;break;case"BN":gt="N"}return gt},j=function(R,F,U){var z=R.split("");return U&&P(z,U,{hiLevel:S}),z.reverse(),F&&F.reverse(),z.join("")},P=function(R,F,U){var z,it,Y,st,Q,gt=-1,lt=R.length,Et=0,A=[],G=S?d:g,O=[];for(E=!1,r=!1,s=!1,it=0;it<lt;it++)O[it]=M(R[it]);for(Y=0;Y<lt;Y++){if(Q=Et,A[Y]=W(R,O,A,Y),z=240&(Et=G[Q][m[A[Y]]]),Et&=15,F[Y]=st=G[Et][5],z>0)if(z===16){for(it=gt;it<Y;it++)F[it]=1;gt=-1}else gt=-1;if(G[Et][6])gt===-1&&(gt=Y);else if(gt>-1){for(it=gt;it<Y;it++)F[it]=st;gt=-1}O[Y]==="B"&&(F[Y]=0),U.hiLevel|=st}s&&function(X,nt,at){for(var ht=0;ht<at;ht++)if(X[ht]==="S"){nt[ht]=S;for(var dt=ht-1;dt>=0&&X[dt]==="WS";dt--)nt[dt]=S}}(O,F,lt)},H=function(R,F,U,z,it){if(!(it.hiLevel<R)){if(R===1&&S===1&&!r)return F.reverse(),void(U&&U.reverse());for(var Y,st,Q,gt,lt=F.length,Et=0;Et<lt;){if(z[Et]>=R){for(Q=Et+1;Q<lt&&z[Q]>=R;)Q++;for(gt=Et,st=Q-1;gt<st;gt++,st--)Y=F[gt],F[gt]=F[st],F[st]=Y,U&&(Y=U[gt],U[gt]=U[st],U[st]=Y);Et=Q}Et++}}},et=function(R,F,U){var z=R.split(""),it={hiLevel:S};return U||(U=[]),P(z,U,it),function(Y,st,Q){if(Q.hiLevel!==0&&c)for(var gt,lt=0;lt<Y.length;lt++)st[lt]===1&&(gt=b.indexOf(Y[lt]))>=0&&(Y[lt]=b[gt+1])}(z,U,it),H(2,z,F,U,it),H(1,z,F,U,it),z.join("")};return this.__bidiEngine__.doBidiReorder=function(R,F,U){if(function(it,Y){if(Y)for(var st=0;st<it.length;st++)Y[st]=st;o===void 0&&(o=D(it)),h===void 0&&(h=D(it))}(R,F),a||!l||h)if(a&&l&&o^h)S=o?1:0,R=j(R,F,U);else if(!a&&l&&h)S=o?1:0,R=et(R,F,U),R=j(R,F);else if(!a||o||l||h){if(a&&!l&&o^h)R=j(R,F),o?(S=0,R=et(R,F,U)):(S=1,R=et(R,F,U),R=j(R,F));else if(a&&o&&!l&&h)S=1,R=et(R,F,U),R=j(R,F);else if(!a&&!l&&o^h){var z=c;o?(S=1,R=et(R,F,U),S=0,c=!1,R=et(R,F,U),c=z):(S=0,R=et(R,F,U),R=j(R,F),S=1,c=!1,R=et(R,F,U),c=z,R=j(R,F))}}else S=0,R=et(R,F,U);else S=o?1:0,R=et(R,F,U);return R},this.__bidiEngine__.setOptions=function(R){R&&(a=R.isInputVisual,l=R.isOutputVisual,o=R.isInputRtl,h=R.isOutputRtl,c=R.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],e=new i.__bidiEngine__({isInputVisual:!0});i.API.events.push(["postProcessText",function(n){var r=n.text,s=(n.x,n.y,n.options||{}),a=(n.mutex,s.lang,[]);if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,e.setOptions(s),Object.prototype.toString.call(r)==="[object Array]"){var o=0;for(a=[],o=0;o<r.length;o+=1)Object.prototype.toString.call(r[o])==="[object Array]"?a.push([e.doBidiReorder(r[o][0]),r[o][1],r[o][2]]):a.push([e.doBidiReorder(r[o])]);n.text=a}else n.text=e.doBidiReorder(r);e.setOptions({isInputVisual:!0})}])}(re),re.API.TTFFont=function(){function i(t){var e;if(this.rawData=t,e=this.contents=new Sa(t),this.contents.pos=4,e.readString(4)==="ttcf")throw new Error("TTCF not supported.");e.pos=0,this.parse(),this.subset=new FE(this),this.registerTTF()}return i.open=function(t){return new i(t)},i.prototype.parse=function(){return this.directory=new xE(this.contents),this.head=new wE(this),this.name=new AE(this),this.cmap=new mv(this),this.toUnicode={},this.hhea=new EE(this),this.maxp=new ME(this),this.hmtx=new TE(this),this.post=new LE(this),this.os2=new SE(this),this.loca=new NE(this),this.glyf=new PE(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},i.prototype.registerTTF=function(){var t,e,n,r,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var a,o,l,h;for(h=[],a=0,o=(l=this.bbox).length;a<o;a++)t=l[a],h.push(Math.round(t*this.scaleFactor));return h}).call(this),this.stemV=0,this.post.exists?(n=255&(r=this.post.italic_angle),32768&(e=r>>16)&&(e=-(1+(65535^e))),this.italicAngle=+(e+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},i.prototype.characterToGlyph=function(t){var e;return((e=this.cmap.unicode)!=null?e.codeMap[t]:void 0)||0},i.prototype.widthOfGlyph=function(t){var e;return e=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*e},i.prototype.widthOfString=function(t,e,n){var r,s,a,o;for(a=0,s=0,o=(t=""+t).length;0<=o?s<o:s>o;s=0<=o?++s:--s)r=t.charCodeAt(s),a+=this.widthOfGlyph(this.characterToGlyph(r))+n*(1e3/e)||0;return a*(e/1e3)},i.prototype.lineHeight=function(t,e){var n;return e==null&&(e=!1),n=e?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},i}();var Or,Sa=function(){function i(t){this.data=t??[],this.pos=0,this.length=this.data.length}return i.prototype.readByte=function(){return this.data[this.pos++]},i.prototype.writeByte=function(t){return this.data[this.pos++]=t},i.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},i.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},i.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},i.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},i.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},i.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},i.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},i.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},i.prototype.readString=function(t){var e,n;for(n=[],e=0;0<=t?e<t:e>t;e=0<=t?++e:--e)n[e]=String.fromCharCode(this.readByte());return n.join("")},i.prototype.writeString=function(t){var e,n,r;for(r=[],e=0,n=t.length;0<=n?e<n:e>n;e=0<=n?++e:--e)r.push(this.writeByte(t.charCodeAt(e)));return r},i.prototype.readShort=function(){return this.readInt16()},i.prototype.writeShort=function(t){return this.writeInt16(t)},i.prototype.readLongLong=function(){var t,e,n,r,s,a,o,l;return t=this.readByte(),e=this.readByte(),n=this.readByte(),r=this.readByte(),s=this.readByte(),a=this.readByte(),o=this.readByte(),l=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^e)+1099511627776*(255^n)+4294967296*(255^r)+16777216*(255^s)+65536*(255^a)+256*(255^o)+(255^l)+1):72057594037927940*t+281474976710656*e+1099511627776*n+4294967296*r+16777216*s+65536*a+256*o+l},i.prototype.writeLongLong=function(t){var e,n;return e=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},i.prototype.readInt=function(){return this.readInt32()},i.prototype.writeInt=function(t){return this.writeInt32(t)},i.prototype.read=function(t){var e,n;for(e=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)e.push(this.readByte());return e},i.prototype.write=function(t){var e,n,r,s;for(s=[],n=0,r=t.length;n<r;n++)e=t[n],s.push(this.writeByte(e));return s},i}(),xE=function(){var i;function t(e){var n,r,s;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},r=0,s=this.tableCount;0<=s?r<s:r>s;r=0<=s?++r:--r)n={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(e){var n,r,s,a,o,l,h,c,f,g,d,m,y;for(y in d=Object.keys(e).length,l=Math.log(2),f=16*Math.floor(Math.log(d)/l),a=Math.floor(f/l),c=16*d-f,(r=new Sa).writeInt(this.scalarType),r.writeShort(d),r.writeShort(f),r.writeShort(a),r.writeShort(c),s=16*d,h=r.pos+s,o=null,m=[],e)for(g=e[y],r.writeString(y),r.writeInt(i(g)),r.writeInt(h),r.writeInt(g.length),m=m.concat(g),y==="head"&&(o=h),h+=g.length;h%4;)m.push(0),h++;return r.write(m),n=2981146554-i(r.data),r.pos=o+8,r.writeUInt32(n),r.data},i=function(e){var n,r,s,a;for(e=_v.call(e);e.length%4;)e.push(0);for(s=new Sa(e),r=0,n=0,a=e.length;n<a;n=n+=4)r+=s.readUInt32();return 4294967295&r},t}(),bE={}.hasOwnProperty,ss=function(i,t){for(var e in t)bE.call(t,e)&&(i[e]=t[e]);function n(){this.constructor=i}return n.prototype=t.prototype,i.prototype=new n,i.__super__=t.prototype,i};Or=function(){function i(t){var e;this.file=t,e=this.file.directory.tables[this.tag],this.exists=!!e,e&&(this.offset=e.offset,this.length=e.length,this.parse(this.file.contents))}return i.prototype.parse=function(){},i.prototype.encode=function(){},i.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},i}();var wE=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return ss(t,Or),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var n;return(n=new Sa).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(e),n.writeShort(this.glyphDataFormat),n.data},t}(),Bm=function(){function i(t,e){var n,r,s,a,o,l,h,c,f,g,d,m,y,b,x,E,S;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=e+t.readInt(),f=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=t.readByte();break;case 4:for(d=t.readUInt16(),g=d/2,t.pos+=6,s=function(){var M,D;for(D=[],l=M=0;0<=g?M<g:M>g;l=0<=g?++M:--M)D.push(t.readUInt16());return D}(),t.pos+=2,y=function(){var M,D;for(D=[],l=M=0;0<=g?M<g:M>g;l=0<=g?++M:--M)D.push(t.readUInt16());return D}(),h=function(){var M,D;for(D=[],l=M=0;0<=g?M<g:M>g;l=0<=g?++M:--M)D.push(t.readUInt16());return D}(),c=function(){var M,D;for(D=[],l=M=0;0<=g?M<g:M>g;l=0<=g?++M:--M)D.push(t.readUInt16());return D}(),r=(this.length-t.pos+this.offset)/2,o=function(){var M,D;for(D=[],l=M=0;0<=r?M<r:M>r;l=0<=r?++M:--M)D.push(t.readUInt16());return D}(),l=x=0,S=s.length;x<S;l=++x)for(b=s[l],n=E=m=y[l];m<=b?E<=b:E>=b;n=m<=b?++E:--E)c[l]===0?a=n+h[l]:(a=o[c[l]/2+(n-m)-(g-l)]||0)!==0&&(a+=h[l]),this.codeMap[n]=65535&a}t.pos=f}return i.encode=function(t,e){var n,r,s,a,o,l,h,c,f,g,d,m,y,b,x,E,S,M,D,W,j,P,H,et,R,F,U,z,it,Y,st,Q,gt,lt,Et,A,G,O,X,nt,at,ht,dt,St,At,Rt;switch(z=new Sa,a=Object.keys(t).sort(function(Dt,$t){return Dt-$t}),e){case"macroman":for(y=0,b=function(){var Dt=[];for(m=0;m<256;++m)Dt.push(0);return Dt}(),E={0:0},s={},it=0,gt=a.length;it<gt;it++)E[dt=t[r=a[it]]]==null&&(E[dt]=++y),s[r]={old:t[r],new:E[t[r]]},b[r]=E[t[r]];return z.writeUInt16(1),z.writeUInt16(0),z.writeUInt32(12),z.writeUInt16(0),z.writeUInt16(262),z.writeUInt16(0),z.write(b),{charMap:s,subtable:z.data,maxGlyphID:y+1};case"unicode":for(F=[],f=[],S=0,E={},n={},x=h=null,Y=0,lt=a.length;Y<lt;Y++)E[D=t[r=a[Y]]]==null&&(E[D]=++S),n[r]={old:D,new:E[D]},o=E[D]-r,x!=null&&o===h||(x&&f.push(x),F.push(r),h=o),x=r;for(x&&f.push(x),f.push(65535),F.push(65535),et=2*(H=F.length),P=2*Math.pow(Math.log(H)/Math.LN2,2),g=Math.log(P/2)/Math.LN2,j=2*H-P,l=[],W=[],d=[],m=st=0,Et=F.length;st<Et;m=++st){if(R=F[m],c=f[m],R===65535){l.push(0),W.push(0);break}if(R-(U=n[R].new)>=32768)for(l.push(0),W.push(2*(d.length+H-m)),r=Q=R;R<=c?Q<=c:Q>=c;r=R<=c?++Q:--Q)d.push(n[r].new);else l.push(U-R),W.push(0)}for(z.writeUInt16(3),z.writeUInt16(1),z.writeUInt32(12),z.writeUInt16(4),z.writeUInt16(16+8*H+2*d.length),z.writeUInt16(0),z.writeUInt16(et),z.writeUInt16(P),z.writeUInt16(g),z.writeUInt16(j),at=0,A=f.length;at<A;at++)r=f[at],z.writeUInt16(r);for(z.writeUInt16(0),ht=0,G=F.length;ht<G;ht++)r=F[ht],z.writeUInt16(r);for(St=0,O=l.length;St<O;St++)o=l[St],z.writeUInt16(o);for(At=0,X=W.length;At<X;At++)M=W[At],z.writeUInt16(M);for(Rt=0,nt=d.length;Rt<nt;Rt++)y=d[Rt],z.writeUInt16(y);return{charMap:n,subtable:z.data,maxGlyphID:S+1}}},i}(),mv=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return ss(t,Or),t.prototype.tag="cmap",t.prototype.parse=function(e){var n,r,s;for(e.pos=this.offset,this.version=e.readUInt16(),s=e.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=s?r<s:r>s;r=0<=s?++r:--r)n=new Bm(e,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(e,n){var r,s;return n==null&&(n="macroman"),r=Bm.encode(e,n),(s=new Sa).writeUInt16(0),s.writeUInt16(1),r.table=s.data.concat(r.subtable),r},t}(),EE=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return ss(t,Or),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),SE=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return ss(t,Or),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var n,r;for(r=[],n=0;n<10;++n)r.push(e.readByte());return r}(),this.charRange=function(){var n,r;for(r=[],n=0;n<4;++n)r.push(e.readInt());return r}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var n,r;for(r=[],n=0;n<2;n=++n)r.push(e.readInt());return r}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),LE=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return ss(t,Or),t.prototype.tag="post",t.prototype.parse=function(e){var n,r,s;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:break;case 131072:var a;for(r=e.readUInt16(),this.glyphNameIndex=[],a=0;0<=r?a<r:a>r;a=0<=r?++a:--a)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],s=[];e.pos<this.offset+this.length;)n=e.readByte(),s.push(this.names.push(e.readString(n)));return s;case 151552:return r=e.readUInt16(),this.offsets=e.read(r);case 196608:break;case 262144:return this.map=(function(){var o,l,h;for(h=[],a=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;a=0<=l?++o:--o)h.push(e.readUInt32());return h}).call(this)}},t}(),CE=function(i,t){this.raw=i,this.length=i.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},AE=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return ss(t,Or),t.prototype.tag="name",t.prototype.parse=function(e){var n,r,s,a,o,l,h,c,f,g,d;for(e.pos=this.offset,e.readShort(),n=e.readShort(),l=e.readShort(),r=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)r.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+l+e.readShort()});for(h={},a=f=0,g=r.length;f<g;a=++f)s=r[a],e.pos=s.offset,c=e.readString(s.length),o=new CE(c,s),h[d=s.nameID]==null&&(h[d]=[]),h[s.nameID].push(o);this.strings=h,this.copyright=h[0],this.fontFamily=h[1],this.fontSubfamily=h[2],this.uniqueSubfamily=h[3],this.fontName=h[4],this.version=h[5];try{this.postscriptName=h[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=h[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=h[7],this.manufacturer=h[8],this.designer=h[9],this.description=h[10],this.vendorUrl=h[11],this.designerUrl=h[12],this.license=h[13],this.licenseUrl=h[14],this.preferredFamily=h[15],this.preferredSubfamily=h[17],this.compatibleFull=h[18],this.sampleText=h[19]},t}(),ME=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return ss(t,Or),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),TE=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return ss(t,Or),t.prototype.tag="hmtx",t.prototype.parse=function(e){var n,r,s,a,o,l,h;for(e.pos=this.offset,this.metrics=[],n=0,l=this.file.hhea.numberOfMetrics;0<=l?n<l:n>l;n=0<=l?++n:--n)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var c,f;for(f=[],n=c=0;0<=s?c<s:c>s;n=0<=s?++c:--c)f.push(e.readInt16());return f}(),this.widths=(function(){var c,f,g,d;for(d=[],c=0,f=(g=this.metrics).length;c<f;c++)a=g[c],d.push(a.advance);return d}).call(this),r=this.widths[this.widths.length-1],h=[],n=o=0;0<=s?o<s:o>s;n=0<=s?++o:--o)h.push(this.widths.push(r));return h},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),_v=[].slice,PE=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return ss(t,Or),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var n,r,s,a,o,l,h,c,f,g;return e in this.cache?this.cache[e]:(a=this.file.loca,n=this.file.contents,r=a.indexOf(e),(s=a.lengthOf(e))===0?this.cache[e]=null:(n.pos=this.offset+r,o=(l=new Sa(n.read(s))).readShort(),c=l.readShort(),g=l.readShort(),h=l.readShort(),f=l.readShort(),this.cache[e]=o===-1?new RE(l,c,g,h,f):new IE(l,o,c,g,h,f),this.cache[e]))},t.prototype.encode=function(e,n,r){var s,a,o,l,h;for(o=[],a=[],l=0,h=n.length;l<h;l++)s=e[n[l]],a.push(o.length),s&&(o=o.concat(s.encode(r)));return a.push(o.length),{table:o,offsets:a}},t}(),IE=function(){function i(t,e,n,r,s,a){this.raw=t,this.numberOfContours=e,this.xMin=n,this.yMin=r,this.xMax=s,this.yMax=a,this.compound=!1}return i.prototype.encode=function(){return this.raw.data},i}(),RE=function(){function i(t,e,n,r,s){var a,o;for(this.raw=t,this.xMin=e,this.yMin=n,this.xMax=r,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],a=this.raw;o=a.readShort(),this.glyphOffsets.push(a.pos),this.glyphIDs.push(a.readUInt16()),32&o;)a.pos+=1&o?4:2,128&o?a.pos+=8:64&o?a.pos+=4:8&o&&(a.pos+=2)}return i.prototype.encode=function(){var t,e,n;for(e=new Sa(_v.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)e.pos=this.glyphOffsets[t];return e.data},i}(),NE=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return ss(t,Or),t.prototype.tag="loca",t.prototype.parse=function(e){var n,r;return e.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var s,a;for(a=[],r=0,s=this.length;r<s;r+=2)a.push(2*e.readUInt16());return a}).call(this):(function(){var s,a;for(a=[],r=0,s=this.length;r<s;r+=4)a.push(e.readUInt32());return a}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,n){for(var r=new Uint32Array(this.offsets.length),s=0,a=0,o=0;o<r.length;++o)if(r[o]=s,a<n.length&&n[a]==o){++a,r[o]=s;var l=this.offsets[o],h=this.offsets[o+1]-l;h>0&&(s+=h)}for(var c=new Array(4*r.length),f=0;f<r.length;++f)c[4*f+3]=255&r[f],c[4*f+2]=(65280&r[f])>>8,c[4*f+1]=(16711680&r[f])>>16,c[4*f]=(4278190080&r[f])>>24;return c},t}(),FE=function(){function i(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return i.prototype.generateCmap=function(){var t,e,n,r,s;for(e in r=this.font.cmap.tables[0].codeMap,t={},s=this.subset)n=s[e],t[e]=r[n];return t},i.prototype.glyphsFor=function(t){var e,n,r,s,a,o,l;for(r={},a=0,o=t.length;a<o;a++)r[s=t[a]]=this.font.glyf.glyphFor(s);for(s in e=[],r)(n=r[s])!=null&&n.compound&&e.push.apply(e,n.glyphIDs);if(e.length>0)for(s in l=this.glyphsFor(e))n=l[s],r[s]=n;return r},i.prototype.encode=function(t,e){var n,r,s,a,o,l,h,c,f,g,d,m,y,b,x;for(r in n=mv.encode(this.generateCmap(),"unicode"),a=this.glyphsFor(t),d={0:0},x=n.charMap)d[(l=x[r]).old]=l.new;for(m in g=n.maxGlyphID,a)m in d||(d[m]=g++);return c=function(E){var S,M;for(S in M={},E)M[E[S]]=S;return M}(d),f=Object.keys(c).sort(function(E,S){return E-S}),y=function(){var E,S,M;for(M=[],E=0,S=f.length;E<S;E++)o=f[E],M.push(c[o]);return M}(),s=this.font.glyf.encode(a,y,d),h=this.font.loca.encode(s.offsets,y),b={cmap:this.font.cmap.raw(),glyf:s.table,loca:h,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(e)},this.font.os2.exists&&(b["OS/2"]=this.font.os2.raw()),this.font.directory.encode(b)},i}();re.API.PDFObject=function(){var i;function t(){}return i=function(e,n){return(Array(n+1).join("0")+e).slice(-n)},t.convert=function(e){var n,r,s,a;if(Array.isArray(e))return"["+function(){var o,l,h;for(h=[],o=0,l=e.length;o<l;o++)n=e[o],h.push(t.convert(n));return h}().join(" ")+"]";if(typeof e=="string")return"/"+e;if(e!=null&&e.isString)return"("+e+")";if(e instanceof Date)return"(D:"+i(e.getUTCFullYear(),4)+i(e.getUTCMonth(),2)+i(e.getUTCDate(),2)+i(e.getUTCHours(),2)+i(e.getUTCMinutes(),2)+i(e.getUTCSeconds(),2)+"Z)";if({}.toString.call(e)==="[object Object]"){for(r in s=["<<"],e)a=e[r],s.push("/"+r+" "+t.convert(a));return s.push(">>"),s.join(`
`)}return""+e},t}();class OE{constructor(t){this.highWaterMark=t!==void 0?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const n=this.entries_[t];return Ce(n!==void 0,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_}remove(t){const e=this.entries_[t];return Ce(e!==void 0,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e=0,n;for(n=this.newest_;n;n=n.older)t[e++]=n.key_;return t}getValues(){const t=new Array(this.count_);let e=0,n;for(n=this.newest_;n;n=n.older)t[e++]=n.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){var e;return(e=this.entries_[t])==null?void 0:e.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){Ce(!(t in this.entries_),"Tried to set a value for a key that is used already");const n={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[t]=n,++this.count_}setSize(t){this.highWaterMark=t}}class vv extends Nf{constructor(t,e,n){super(),n=n||{},this.tileCoord=t,this.state=e,this.interimTile=null,this.key="",this.transition_=n.transition===void 0?250:n.transition,this.transitionStarts_={},this.interpolate=!!n.interpolate}changed(){this.dispatchEvent(le.CHANGE)}release(){this.state===Zt.ERROR&&this.setState(Zt.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){let t=this.interimTile;if(!t)return this;do{if(t.getState()==Zt.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this}refreshInterimChain(){let t=this.interimTile;if(!t)return;let e=this;do{if(t.getState()==Zt.LOADED){t.interimTile=null;break}t.getState()==Zt.LOADING?e=t:t.getState()==Zt.IDLE?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==Zt.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}load(){ae()}getAlpha(t,e){if(!this.transition_)return 1;let n=this.transitionStarts_[t];if(!n)n=e,this.transitionStarts_[t]=n;else if(n===-1)return 1;const r=e-n+1e3/60;return r>=this.transition_?1:X2(r/this.transition_)}inTransition(t){return this.transition_?this.transitionStarts_[t]!==-1:!1}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}}class yv extends vv{constructor(t,e,n,r,s,a){super(t,e,a),this.crossOrigin_=r,this.src_=n,this.key=n,this.image_=new Image,r!==null&&(this.image_.crossOrigin=r),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(t){this.image_=t,this.state=Zt.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=Zt.ERROR,this.unlistenImage_(),this.image_=kE(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=Zt.LOADED:this.state=Zt.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==Zt.ERROR&&(this.state=Zt.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Zt.IDLE&&(this.state=Zt.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=Vx(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}function kE(){const i=Ki(1,1);return i.fillStyle="rgba(0,0,0,0)",i.fillRect(0,0,1,1),i.canvas}const DE=.5,jE=10,Gm=.25;class BE{constructor(t,e,n,r,s,a){this.sourceProj_=t,this.targetProj_=e;let o={};const l=Cl(this.targetProj_,this.sourceProj_);this.transformInv_=function(E){const S=E[0]+"/"+E[1];return o[S]||(o[S]=l(E)),o[S]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&Re(r)>=Re(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Re(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Re(this.targetProj_.getExtent()):null;const h=Aa(n),c=kf(n),f=Of(n),g=Ff(n),d=this.transformInv_(h),m=this.transformInv_(c),y=this.transformInv_(f),b=this.transformInv_(g),x=jE+(a?Math.max(0,Math.ceil(Math.log2(zg(n)/(a*a*256*256)))):0);if(this.addQuad_(h,c,f,g,d,m,y,b,x),this.wrapsXInSource_){let E=1/0;this.triangles_.forEach(function(S,M,D){E=Math.min(E,S.source[0][0],S.source[1][0],S.source[2][0])}),this.triangles_.forEach(S=>{if(Math.max(S.source[0][0],S.source[1][0],S.source[2][0])-E>this.sourceWorldWidth_/2){const M=[[S.source[0][0],S.source[0][1]],[S.source[1][0],S.source[1][1]],[S.source[2][0],S.source[2][1]]];M[0][0]-E>this.sourceWorldWidth_/2&&(M[0][0]-=this.sourceWorldWidth_),M[1][0]-E>this.sourceWorldWidth_/2&&(M[1][0]-=this.sourceWorldWidth_),M[2][0]-E>this.sourceWorldWidth_/2&&(M[2][0]-=this.sourceWorldWidth_);const D=Math.min(M[0][0],M[1][0],M[2][0]);Math.max(M[0][0],M[1][0],M[2][0])-D<this.sourceWorldWidth_/2&&(S.source=M)}})}o={}}addTriangle_(t,e,n,r,s,a){this.triangles_.push({source:[r,s,a],target:[t,e,n]})}addQuad_(t,e,n,r,s,a,o,l,h){const c=Qu([s,a,o,l]),f=this.sourceWorldWidth_?Re(c)/this.sourceWorldWidth_:null,g=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&f>.5&&f<1;let m=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const b=Qu([t,e,n,r]);m=Re(b)/this.targetWorldWidth_>Gm||m}!d&&this.sourceProj_.isGlobal()&&f&&(m=f>Gm||m)}if(!m&&this.maxSourceExtent_&&isFinite(c[0])&&isFinite(c[1])&&isFinite(c[2])&&isFinite(c[3])&&!ki(c,this.maxSourceExtent_))return;let y=0;if(!m&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(l[0])||!isFinite(l[1]))){if(h>0)m=!0;else if(y=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(a[0])||!isFinite(a[1])?4:0)+(!isFinite(o[0])||!isFinite(o[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),y!=1&&y!=2&&y!=4&&y!=8)return}if(h>0){if(!m){const b=[(t[0]+n[0])/2,(t[1]+n[1])/2],x=this.transformInv_(b);let E;d?E=(Za(s[0],g)+Za(o[0],g))/2-Za(x[0],g):E=(s[0]+o[0])/2-x[0];const S=(s[1]+o[1])/2-x[1];m=E*E+S*S>this.errorThresholdSquared_}if(m){if(Math.abs(t[0]-n[0])<=Math.abs(t[1]-n[1])){const b=[(e[0]+n[0])/2,(e[1]+n[1])/2],x=this.transformInv_(b),E=[(r[0]+t[0])/2,(r[1]+t[1])/2],S=this.transformInv_(E);this.addQuad_(t,e,b,E,s,a,x,S,h-1),this.addQuad_(E,b,n,r,S,x,o,l,h-1)}else{const b=[(t[0]+e[0])/2,(t[1]+e[1])/2],x=this.transformInv_(b),E=[(n[0]+r[0])/2,(n[1]+r[1])/2],S=this.transformInv_(E);this.addQuad_(t,b,E,r,s,x,S,l,h-1),this.addQuad_(b,e,n,E,x,a,o,S,h-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}y&11||this.addTriangle_(t,n,r,s,o,l),y&14||this.addTriangle_(t,n,e,s,o,a),y&&(y&13||this.addTriangle_(e,r,t,a,l,s),y&7||this.addTriangle_(e,r,n,a,l,o))}calculateSourceExtent(){const t=Dn();return this.triangles_.forEach(function(e,n,r){const s=e.source;Rh(t,s[0]),Rh(t,s[1]),Rh(t,s[2])}),t}getTriangles(){return this.triangles_}}let Cg;const yl=[];function zm(i,t,e,n,r){i.beginPath(),i.moveTo(0,0),i.lineTo(t,e),i.lineTo(n,r),i.closePath(),i.save(),i.clip(),i.fillRect(0,0,Math.max(t,n)+1,Math.max(e,r)),i.restore()}function Ag(i,t){return Math.abs(i[t*4]-210)>2||Math.abs(i[t*4+3]-.75*255)>2}function GE(){if(Cg===void 0){const i=Ki(6,6,yl);i.globalCompositeOperation="lighter",i.fillStyle="rgba(210, 0, 0, 0.75)",zm(i,4,5,4,0),zm(i,4,5,0,5);const t=i.getImageData(0,0,3,3).data;Cg=Ag(t,0)||Ag(t,4)||Ag(t,8),Vf(i),yl.push(i.canvas)}return Cg}function b0(i,t,e,n){const r=ba(e,t,i);let s=Dp(t,n,e);const a=t.getMetersPerUnit();a!==void 0&&(s*=a);const o=i.getMetersPerUnit();o!==void 0&&(s/=o);const l=i.getExtent();if(!l||ya(l,r)){const h=Dp(i,s,r)/s;isFinite(h)&&h>0&&(s/=h)}return s}function zE(i,t,e,n){const r=xa(e);let s=b0(i,t,r,n);return(!isFinite(s)||s<=0)&&B0(e,function(a){return s=b0(i,t,a,n),isFinite(s)&&s>0}),s}function qE(i,t,e,n,r,s,a,o,l,h,c,f,g,d){const m=Ki(Math.round(e*i),Math.round(e*t),yl);if(f||(m.imageSmoothingEnabled=!1),l.length===0)return m.canvas;m.scale(e,e);function y(D){return Math.round(D*e)/e}m.globalCompositeOperation="lighter";const b=Dn();l.forEach(function(D,W,j){F2(b,D.extent)});let x;const E=e/n,S=(f?1:1+Math.pow(2,-24))/E;if(!g||l.length!==1||h!==0){if(x=Ki(Math.round(Re(b)*E),Math.round(en(b)*E),yl),f||(x.imageSmoothingEnabled=!1),r&&d){const D=(r[0]-b[0])*E,W=-(r[3]-b[3])*E,j=Re(r)*E,P=en(r)*E;x.rect(D,W,j,P),x.clip()}l.forEach(function(D,W,j){const P=(D.extent[0]-b[0])*E,H=-(D.extent[3]-b[3])*E,et=Re(D.extent)*E,R=en(D.extent)*E;D.image.width>0&&D.image.height>0&&x.drawImage(D.image,h,h,D.image.width-2*h,D.image.height-2*h,f?P:Math.round(P),f?H:Math.round(H),f?et:Math.round(P+et)-Math.round(P),f?R:Math.round(H+R)-Math.round(H))})}const M=Aa(a);return o.getTriangles().forEach(function(D,W,j){const P=D.source,H=D.target;let et=P[0][0],R=P[0][1],F=P[1][0],U=P[1][1],z=P[2][0],it=P[2][1];const Y=y((H[0][0]-M[0])/s),st=y(-(H[0][1]-M[1])/s),Q=y((H[1][0]-M[0])/s),gt=y(-(H[1][1]-M[1])/s),lt=y((H[2][0]-M[0])/s),Et=y(-(H[2][1]-M[1])/s),A=et,G=R;et=0,R=0,F-=A,U-=G,z-=A,it-=G;const O=[[F,U,0,0,Q-Y],[z,it,0,0,lt-Y],[0,0,F,U,gt-st],[0,0,z,it,Et-st]],X=g5(O);if(!X)return;if(m.save(),m.beginPath(),GE()||!f){m.moveTo(Q,gt);const at=4,ht=Y-Q,dt=st-gt;for(let St=0;St<at;St++)m.lineTo(Q+y((St+1)*ht/at),gt+y(St*dt/(at-1))),St!=at-1&&m.lineTo(Q+y((St+1)*ht/at),gt+y((St+1)*dt/(at-1)));m.lineTo(lt,Et)}else m.moveTo(Q,gt),m.lineTo(Y,st),m.lineTo(lt,Et);m.clip(),m.transform(X[0],X[2],X[1],X[3],Y,st),m.translate(b[0]-A,b[3]-G);let nt;if(x)nt=x.canvas,m.scale(S,-S);else{const at=l[0],ht=at.extent;nt=at.image,m.scale(Re(ht)/nt.width,-en(ht)/nt.height)}m.drawImage(nt,0,0),m.restore()}),x&&(Vf(x),yl.push(x.canvas)),c&&(m.save(),m.globalCompositeOperation="source-over",m.strokeStyle="black",m.lineWidth=1,o.getTriangles().forEach(function(D,W,j){const P=D.target,H=(P[0][0]-M[0])/s,et=-(P[0][1]-M[1])/s,R=(P[1][0]-M[0])/s,F=-(P[1][1]-M[1])/s,U=(P[2][0]-M[0])/s,z=-(P[2][1]-M[1])/s;m.beginPath(),m.moveTo(R,F),m.lineTo(H,et),m.lineTo(U,z),m.closePath(),m.stroke()}),m.restore()),m.canvas}class w0 extends vv{constructor(t,e,n,r,s,a,o,l,h,c,f,g){super(s,Zt.IDLE,g),this.renderEdges_=f!==void 0?f:!1,this.pixelRatio_=o,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=r,this.wrappedTileCoord_=a||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const d=r.getTileCoordExtent(this.wrappedTileCoord_),m=this.targetTileGrid_.getExtent();let y=this.sourceTileGrid_.getExtent();const b=m?Ka(d,m):d;if(zg(b)===0){this.state=Zt.EMPTY;return}const x=t.getExtent();x&&(y?y=Ka(y,x):y=x);const E=r.getResolution(this.wrappedTileCoord_[0]),S=zE(t,n,b,E);if(!isFinite(S)||S<=0){this.state=Zt.EMPTY;return}const M=c!==void 0?c:DE;if(this.triangulation_=new BE(t,n,b,y,S*M,E),this.triangulation_.getTriangles().length===0){this.state=Zt.EMPTY;return}this.sourceZ_=e.getZForResolution(S);let D=this.triangulation_.calculateSourceExtent();if(y&&(t.canWrapX()?(D[1]=hi(D[1],y[1],y[3]),D[3]=hi(D[3],y[1],y[3])):D=Ka(D,y)),!zg(D))this.state=Zt.EMPTY;else{const W=e.getTileRangeForExtentAndZ(D,this.sourceZ_);for(let j=W.minX;j<=W.maxX;j++)for(let P=W.minY;P<=W.maxY;P++){const H=h(this.sourceZ_,j,P,o);H&&this.sourceTiles_.push(H)}this.sourceTiles_.length===0&&(this.state=Zt.EMPTY)}}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach(e=>{e&&e.getState()==Zt.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}),this.sourceTiles_.length=0,t.length===0)this.state=Zt.ERROR;else{const e=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(e),r=typeof n=="number"?n:n[0],s=typeof n=="number"?n:n[1],a=this.targetTileGrid_.getResolution(e),o=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=qE(r,s,this.pixelRatio_,o,this.sourceTileGrid_.getExtent(),a,l,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=Zt.LOADED}this.changed()}load(){if(this.state==Zt.IDLE){this.state=Zt.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(e=>{const n=e.getState();if(n==Zt.IDLE||n==Zt.LOADING){t++;const r=_e(e,le.CHANGE,function(s){const a=e.getState();(a==Zt.LOADED||a==Zt.ERROR||a==Zt.EMPTY)&&(Ke(r),t--,t===0&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(r)}}),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(e,n,r){e.getState()==Zt.IDLE&&e.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Ke),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Vf(this.canvas_.getContext("2d")),yl.push(this.canvas_),this.canvas_=null),super.release()}}function qm(i,t,e,n){return n!==void 0?(n[0]=i,n[1]=t,n[2]=e,n):[i,t,e]}function nd(i,t,e){return i+"/"+t+"/"+e}function xv(i){return nd(i[0],i[1],i[2])}function UE(i){return i.split("/").map(Number)}function bv(i){return(i[1]<<i[0])+i[2]}function WE(i,t){const e=i[0],n=i[1],r=i[2];if(t.getMinZoom()>e||e>t.getMaxZoom())return!1;const s=t.getFullTileRange(e);return s?s.containsXY(n,r):!0}class wv extends OE{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()}pruneExceptNewestZ(){if(this.getCount()===0)return;const t=this.peekFirstKey(),n=UE(t)[0];this.forEach(r=>{r.tileCoord[0]!==n&&(this.remove(xv(r.tileCoord)),r.release())})}}const Mg={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class M1{constructor(t,e,n,r){this.minX=t,this.maxX=e,this.minY=n,this.maxY=r}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function Uo(i,t,e,n,r){return r!==void 0?(r.minX=i,r.maxX=t,r.minY=e,r.maxY=n,r):new M1(i,t,e,n)}const Wo=[0,0,0],aa=5;class VE{constructor(t){this.minZoom=t.minZoom!==void 0?t.minZoom:0,this.resolutions_=t.resolutions,Ce(u5(this.resolutions_,(r,s)=>s-r,!0),"`resolutions` must be sorted in descending order");let e;if(!t.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!e)e=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==e){e=void 0;break}}this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=t.origin!==void 0?t.origin:null,this.origins_=null,t.origins!==void 0&&(this.origins_=t.origins,Ce(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const n=t.extent;n!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Aa(n)),Ce(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,t.tileSizes!==void 0&&(this.tileSizes_=t.tileSizes,Ce(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=t.tileSize!==void 0?t.tileSize:this.tileSizes_?null:O0,Ce(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=n!==void 0?n:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],t.sizes!==void 0?this.fullTileRanges_=t.sizes.map((r,s)=>{const a=new M1(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(n){const o=this.getTileRangeForExtentAndZ(n,s);a.minX=Math.max(o.minX,a.minX),a.maxX=Math.min(o.maxX,a.maxX),a.minY=Math.max(o.minY,a.minY),a.maxY=Math.min(o.maxY,a.maxY)}return a}):n&&this.calculateTileRanges_(n)}forEachTileCoord(t,e,n){const r=this.getTileRangeForExtentAndZ(t,e);for(let s=r.minX,a=r.maxX;s<=a;++s)for(let o=r.minY,l=r.maxY;o<=l;++o)n([e,s,o])}forEachTileCoordParentTileRange(t,e,n,r){let s,a,o,l=null,h=t[0]-1;for(this.zoomFactor_===2?(a=t[1],o=t[2]):l=this.getTileCoordExtent(t,r);h>=this.minZoom;){if(a!==void 0&&o!==void 0?(a=Math.floor(a/2),o=Math.floor(o/2),s=Uo(a,a,o,o,n)):s=this.getTileRangeForExtentAndZ(l,h,n),e(h,s))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,n){if(t[0]<this.maxZoom){if(this.zoomFactor_===2){const s=t[1]*2,a=t[2]*2;return Uo(s,s+1,a,a+1,e)}const r=this.getTileCoordExtent(t,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,n){if(e>this.maxZoom||e<this.minZoom)return null;const r=t[0],s=t[1],a=t[2];if(e===r)return Uo(s,a,s,a,n);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,e-r),h=Math.floor(s*l),c=Math.floor(a*l);if(e<r)return Uo(h,h,c,c,n);const f=Math.floor(l*(s+1))-1,g=Math.floor(l*(a+1))-1;return Uo(h,f,c,g,n)}const o=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,e,n)}getTileRangeForExtentAndZ(t,e,n){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,Wo);const r=Wo[1],s=Wo[2];this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,Wo);const a=Wo[1],o=Wo[2];return Uo(r,a,s,o,n)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),n=this.getResolution(t[0]),r=kn(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*r[0]*n,e[1]-(t[2]+.5)*r[1]*n]}getTileCoordExtent(t,e){const n=this.getOrigin(t[0]),r=this.getResolution(t[0]),s=kn(this.getTileSize(t[0]),this.tmpSize_),a=n[0]+t[1]*s[0]*r,o=n[1]-(t[2]+1)*s[1]*r,l=a+s[0]*r,h=o+s[1]*r;return is(a,o,l,h,e)}getTileCoordForCoordAndResolution(t,e,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,n)}getTileCoordForXYAndResolution_(t,e,n,r,s){const a=this.getZForResolution(n),o=n/this.getResolution(a),l=this.getOrigin(a),h=kn(this.getTileSize(a),this.tmpSize_);let c=o*(t-l[0])/n/h[0],f=o*(l[1]-e)/n/h[1];return r?(c=pu(c,aa)-1,f=pu(f,aa)-1):(c=gu(c,aa),f=gu(f,aa)),qm(a,c,f,s)}getTileCoordForXYAndZ_(t,e,n,r,s){const a=this.getOrigin(n),o=this.getResolution(n),l=kn(this.getTileSize(n),this.tmpSize_);let h=(t-a[0])/o/l[0],c=(a[1]-e)/o/l[1];return r?(h=pu(h,aa)-1,c=pu(c,aa)-1):(h=gu(h,aa),c=gu(c,aa)),qm(n,h,c,s)}getTileCoordForCoordAndZ(t,e,n){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){const n=F0(this.resolutions_,t,e||0);return hi(n,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return s_(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,n=new Array(e);for(let r=this.minZoom;r<e;++r)n[r]=this.getTileRangeForExtentAndZ(t,r);this.fullTileRanges_=n}}const Ev=VE;function Sv(i){let t=i.getDefaultTileGrid();return t||(t=ZE(i),i.setDefaultTileGrid(t)),t}function HE(i,t,e){const n=t[0],r=i.getTileCoordCenter(t),s=T1(e);if(!ya(s,r)){const a=Re(s),o=Math.ceil((s[0]-r[0])/a);return r[0]+=a*o,i.getTileCoordForCoordAndZ(r,n)}return t}function XE(i,t,e,n){n=n!==void 0?n:"top-left";const r=Lv(i,t,e);return new Ev({extent:i,origin:A5(i,n),resolutions:r,tileSize:e})}function YE(i){const t=i||{},e=t.extent||ti("EPSG:3857").getExtent(),n={extent:e,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:Lv(e,t.maxZoom,t.tileSize,t.maxResolution)};return new Ev(n)}function Lv(i,t,e,n){t=t!==void 0?t:p5,e=kn(e!==void 0?e:O0);const r=en(i),s=Re(i);n=n>0?n:Math.max(s/e[0],r/e[1]);const a=t+1,o=new Array(a);for(let l=0;l<a;++l)o[l]=n/Math.pow(2,l);return o}function ZE(i,t,e,n){const r=T1(i);return XE(r,t,e,n)}function T1(i){i=ti(i);let t=i.getExtent();if(!t){const e=180*Uh.degrees/i.getMetersPerUnit();t=is(-e,-e,e,e)}return t}class Cv extends L1{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.opaque_=t.opaque!==void 0?t.opaque:!1,this.tilePixelRatio_=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,this.tileGrid=t.tileGrid!==void 0?t.tileGrid:null;const e=[256,256];this.tileGrid&&kn(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),e),this.tileCache=new wv(t.cacheSize||0),this.tmpSize=[0,0],this.key_=t.key||"",this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(t,e){const n=this.getTileCacheForProjection(t);n&&n.expireCache(e)}forEachLoadedTile(t,e,n,r){const s=this.getTileCacheForProjection(t);if(!s)return!1;let a=!0,o,l,h;for(let c=n.minX;c<=n.maxX;++c)for(let f=n.minY;f<=n.maxY;++f)l=nd(e,c,f),h=!1,s.containsKey(l)&&(o=s.get(l),h=o.getState()===Zt.LOADED,h&&(h=r(o)!==!1)),h||(a=!1);return a}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getOpaque(t){return this.opaque_}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,n,r,s){return ae()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:Sv(t)}getTileCacheForProjection(t){const e=this.getProjection();return Ce(e===null||qa(e,t),"A VectorTile source can only be rendered if it has a projection compatible with the view projection."),this.tileCache}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,n){const r=this.getTileGridForProjection(n),s=this.getTilePixelRatio(e),a=kn(r.getTileSize(t),this.tmpSize);return s==1?a:Mx(a,s,this.tmpSize)}getTileCoordForTileUrlFunction(t,e){e=e!==void 0?e:this.getProjection();const n=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(t=HE(n,t,e)),WE(t,n)?t:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}updateCacheSize(t,e){const n=this.getTileCacheForProjection(e);t>n.highWaterMark&&(n.highWaterMark=t)}useTile(t,e,n,r){}}class KE extends Nr{constructor(t,e){super(t),this.tile=e}}function $E(i,t){const e=/\{z\}/g,n=/\{x\}/g,r=/\{y\}/g,s=/\{-y\}/g;return function(a,o,l){if(a)return i.replace(e,a[0].toString()).replace(n,a[1].toString()).replace(r,a[2].toString()).replace(s,function(){const h=a[0],c=t.getFullTileRange(h);if(!c)throw new Error("The {-y} placeholder requires a tile grid with extent");return(c.getHeight()-a[2]-1).toString()})}}function JE(i,t){const e=i.length,n=new Array(e);for(let r=0;r<e;++r)n[r]=$E(i[r],t);return QE(n)}function QE(i){return i.length===1?i[0]:function(t,e,n){if(!t)return;const r=bv(t),s=Za(r,i.length);return i[s](t,e,n)}}function tS(i){const t=[];let e=/\{([a-z])-([a-z])\}/.exec(i);if(e){const n=e[1].charCodeAt(0),r=e[2].charCodeAt(0);let s;for(s=n;s<=r;++s)t.push(i.replace(e[0],String.fromCharCode(s)));return t}if(e=/\{(\d+)-(\d+)\}/.exec(i),e){const n=parseInt(e[2],10);for(let r=parseInt(e[1],10);r<=n;r++)t.push(i.replace(e[0],r.toString()));return t}return t.push(i),t}class P1 extends Cv{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===P1.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,n=Qt(e),r=e.getState();let s;r==Zt.LOADING?(this.tileLoadingKeys_[n]=!0,s=Mg.TILELOADSTART):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],s=r==Zt.ERROR?Mg.TILELOADERROR:r==Zt.LOADED?Mg.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new KE(s,e))}setTileLoadFunction(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),typeof e<"u"?this.setKey(e):this.changed()}setUrl(t){const e=tS(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(JE(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,n){}useTile(t,e,n){const r=nd(t,e,n);this.tileCache.containsKey(r)&&this.tileCache.get(r)}}class rd extends P1{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:eS,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate!==void 0?t.interpolate:!0,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=t.crossOrigin!==void 0?t.crossOrigin:null,this.tileClass=t.tileClass!==void 0?t.tileClass:yv,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}expireCache(t,e){const n=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==n?e:{});for(const r in this.tileCacheForProjection){const s=this.tileCacheForProjection[r];s.expireCache(s==n?e:{})}}getGutterForProjection(t){return this.getProjection()&&t&&!qa(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getOpaque(t){return this.getProjection()&&t&&!qa(this.getProjection(),t)?!1:super.getOpaque(t)}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||qa(e,t)))return this.tileGrid;const n=Qt(t);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=Sv(t)),this.tileGridForProjection[n]}getTileCacheForProjection(t){const e=this.getProjection();if(!e||qa(e,t))return this.tileCache;const n=Qt(t);return n in this.tileCacheForProjection||(this.tileCacheForProjection[n]=new wv(this.tileCache.highWaterMark)),this.tileCacheForProjection[n]}createTile_(t,e,n,r,s,a){const o=[t,e,n],l=this.getTileCoordForTileUrlFunction(o,s),h=l?this.tileUrlFunction(l,r,s):void 0,c=new this.tileClass(o,h!==void 0?Zt.IDLE:Zt.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return c.key=a,c.addEventListener(le.CHANGE,this.handleTileChange.bind(this)),c}getTile(t,e,n,r,s){const a=this.getProjection();if(!a||!s||qa(a,s))return this.getTileInternal(t,e,n,r,a||s);const o=this.getTileCacheForProjection(s),l=[t,e,n];let h;const c=xv(l);o.containsKey(c)&&(h=o.get(c));const f=this.getKey();if(h&&h.key==f)return h;const g=this.getTileGridForProjection(a),d=this.getTileGridForProjection(s),m=this.getTileCoordForTileUrlFunction(l,s),y=new w0(a,g,s,d,l,m,this.getTilePixelRatio(r),this.getGutter(),(b,x,E,S)=>this.getTileInternal(b,x,E,S,a),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return y.key=f,h?(y.interimTile=h,y.refreshInterimChain(),o.replace(c,y)):o.set(c,y),y}getTileInternal(t,e,n,r,s){let a=null;const o=nd(t,e,n),l=this.getKey();if(!this.tileCache.containsKey(o))a=this.createTile_(t,e,n,r,s,l),this.tileCache.set(o,a);else if(a=this.tileCache.get(o),a.key!=l){const h=a;a=this.createTile_(t,e,n,r,s,l),h.getState()==Zt.IDLE?a.interimTile=h.interimTile:a.interimTile=h,a.refreshInterimChain(),this.tileCache.replace(o,a)}return a}setRenderReprojectionEdges(t){if(this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(const e in this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}}setTileGridForProjection(t,e){const n=ti(t);if(n){const r=Qt(n);r in this.tileGridForProjection||(this.tileGridForProjection[r]=e)}}clear(){super.clear();for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear()}}function eS(i,t){i.getImage().src=t}class I1 extends rd{constructor(t){t=t||{};const e=t.projection!==void 0?t.projection:"EPSG:3857",n=t.tileGrid!==void 0?t.tileGrid:YE({extent:T1(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,opaque:t.opaque,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=t.gutter!==void 0?t.gutter:0}getGutter(){return this.gutter_}}const Um=4;function Av(i,t){const e=[];Object.keys(t).forEach(function(r){t[r]!==null&&t[r]!==void 0&&e.push(r+"="+encodeURIComponent(t[r]))});const n=e.join("&");return i=i.replace(/[?&]$/,""),i+=i.includes("?")?"&":"?",i+n}const E0="1.3.0";function iS(i,t,e,n,r){r.WIDTH=e[0],r.HEIGHT=e[1];const s=n.getAxisOrientation();let a;const o=D2(r.VERSION,"1.3")>=0;return r[o?"CRS":"SRS"]=n.getCode(),o&&s.substr(0,2)=="ne"?a=[t[1],t[0],t[3],t[2]]:a=t,r.BBOX=a.join(","),Av(i,r)}function nS(i,t,e,n,r,s,a){s=Object.assign({REQUEST:"GetMap"},s);const o=t/e,l=[Np(Re(i)/o,Um),Np(en(i)/o,Um)];if(e!=1)switch(a){case"geoserver":const c=90*e+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+c:s.FORMAT_OPTIONS="dpi:"+c;break;case"mapserver":s.MAP_RESOLUTION=90*e;break;case"carmentaserver":case"qgis":s.DPI=90*e;break;default:throw new Error("Unknown `serverType` configured")}return iS(r,i,l,n,s)}function Wm(i,t){return Object.assign({REQUEST:t,SERVICE:"WMS",VERSION:E0,FORMAT:"image/png",STYLES:"",TRANSPARENT:!0},i)}const rS='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class Mv extends I1{constructor(t){t=t||{};let e;t.attributions!==void 0?e=t.attributions:e=[rS];const n=t.crossOrigin!==void 0?t.crossOrigin:"anonymous",r=t.url!==void 0?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:e,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:n,interpolate:t.interpolate,maxZoom:t.maxZoom!==void 0?t.maxZoom:19,opaque:t.opaque!==void 0?t.opaque:!0,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:r,wrapX:t.wrapX,zDirection:t.zDirection})}}class sS extends Dl{constructor(t){t=t||{},super(t)}}class aS extends S1{constructor(t){super(t),this.image_=null}getImage(){return this.image_?this.image_.getImage():null}prepareFrame(t){const e=t.layerStatesArray[t.layerIndex],n=t.pixelRatio,r=t.viewState,s=r.resolution,a=this.getLayer().getSource(),o=t.viewHints;let l=t.extent;if(e.extent!==void 0&&(l=Ka(l,Yr(e.extent,r.projection))),!o[ri.ANIMATING]&&!o[ri.INTERACTING]&&!Ol(l))if(a){const h=r.projection,c=a.getImage(l,s,n,h);c&&(this.loadImage(c)?this.image_=c:c.getState()===xe.EMPTY&&(this.image_=null))}else this.image_=null;return!!this.image_}getData(t){const e=this.frameState;if(!e)return null;const n=this.getLayer(),r=xi(e.pixelToCoordinateTransform,t.slice()),s=n.getExtent();if(s&&!ya(s,r))return null;const a=this.image_.getExtent(),o=this.image_.getImage(),l=Re(a),h=Math.floor(o.width*((r[0]-a[0])/l));if(h<0||h>=o.width)return null;const c=en(a),f=Math.floor(o.height*((a[3]-r[1])/c));return f<0||f>=o.height?null:this.getImageData(o,h,f)}renderFrame(t,e){const n=this.image_,r=n.getExtent(),s=n.getResolution(),[a,o]=Array.isArray(s)?s:[s,s],l=n.getPixelRatio(),h=t.layerStatesArray[t.layerIndex],c=t.pixelRatio,f=t.viewState,g=f.center,d=f.resolution,m=c*a/(d*l),y=c*o/(d*l),b=t.extent,x=f.resolution,E=f.rotation,S=Math.round(Re(b)/x*c),M=Math.round(en(b)/x*c);Jn(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/c,1/c,E,-S/2,-M/2),pc(this.inversePixelTransform,this.pixelTransform);const D=Y0(this.pixelTransform);this.useContainer(e,D,this.getBackground(t));const W=this.getRenderContext(t),j=this.context.canvas;j.width!=S||j.height!=M?(j.width=S,j.height=M):this.containerReused||W.clearRect(0,0,S,M);let P=!1,H=!0;if(h.extent){const z=Yr(h.extent,f.projection);H=ki(z,t.extent),P=H&&!As(z,t.extent),P&&this.clipUnrotated(W,t,z)}const et=n.getImage(),R=Jn(this.tempTransform,S/2,M/2,m,y,0,l*(r[0]-g[0])/a,l*(g[1]-r[3])/o);this.renderedResolution=o*c/l;const F=et.width*R[0],U=et.height*R[3];if(this.getLayer().getSource().getInterpolate()||(W.imageSmoothingEnabled=!1),this.preRender(W,t),H&&F>=.5&&U>=.5){const z=R[4],it=R[5],Y=h.opacity;Y!==1&&(W.save(),W.globalAlpha=Y),W.drawImage(et,0,0,+et.width,+et.height,z,it,F,U),Y!==1&&W.restore()}return this.postRender(this.context,t),P&&W.restore(),W.imageSmoothingEnabled=!0,D!==j.style.transform&&(j.style.transform=D),this.container}}class oS extends sS{constructor(t){super(t)}createRenderer(){return new aS(this)}getData(t){return super.getData(t)}}const lS=oS,da={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class hS extends Dl{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.setPreload(t.preload!==void 0?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0)}getPreload(){return this.get(da.PRELOAD)}setPreload(t){this.set(da.PRELOAD,t)}getUseInterimTilesOnError(){return this.get(da.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(t){this.set(da.USE_INTERIM_TILES_ON_ERROR,t)}getData(t){return super.getData(t)}}class Tv extends S1{constructor(t){super(t),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=Dn(),this.tmpTileRange_=new M1(0,0,0,0)}isDrawableTile(t){const e=this.getLayer(),n=t.getState(),r=e.getUseInterimTilesOnError();return n==Zt.LOADED||n==Zt.EMPTY||n==Zt.ERROR&&!r}getTile(t,e,n,r){const s=r.pixelRatio,a=r.viewState.projection,o=this.getLayer();let h=o.getSource().getTile(t,e,n,s,a);return h.getState()==Zt.ERROR&&o.getUseInterimTilesOnError()&&o.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(h)||(h=h.getInterimTile()),h}getData(t){const e=this.frameState;if(!e)return null;const n=this.getLayer(),r=xi(e.pixelToCoordinateTransform,t.slice()),s=n.getExtent();if(s&&!ya(s,r))return null;const a=e.pixelRatio,o=e.viewState.projection,l=e.viewState,h=n.getRenderSource(),c=h.getTileGridForProjection(l.projection),f=h.getTilePixelRatio(e.pixelRatio);for(let g=c.getZForResolution(l.resolution);g>=c.getMinZoom();--g){const d=c.getTileCoordForCoordAndZ(r,g),m=h.getTile(g,d[1],d[2],a,o);if(!(m instanceof yv||m instanceof w0)||m instanceof w0&&m.getState()===Zt.EMPTY)return null;if(m.getState()!==Zt.LOADED)continue;const y=c.getOrigin(g),b=kn(c.getTileSize(g)),x=c.getResolution(g),E=Math.floor(f*((r[0]-y[0])/x-d[1]*b[0])),S=Math.floor(f*((y[1]-r[1])/x-d[2]*b[1])),M=Math.round(f*h.getGutterForProjection(l.projection));return this.getImageData(m.getImage(),E+M,S+M)}return null}loadedTileCallback(t,e,n){return this.isDrawableTile(n)?super.loadedTileCallback(t,e,n):!1}prepareFrame(t){return!!this.getLayer().getSource()}renderFrame(t,e){const n=t.layerStatesArray[t.layerIndex],r=t.viewState,s=r.projection,a=r.resolution,o=r.center,l=r.rotation,h=t.pixelRatio,c=this.getLayer(),f=c.getSource(),g=f.getRevision(),d=f.getTileGridForProjection(s),m=d.getZForResolution(a,f.zDirection),y=d.getResolution(m);let b=t.extent;const x=t.viewState.resolution,E=f.getTilePixelRatio(h),S=Math.round(Re(b)/x*h),M=Math.round(en(b)/x*h),D=n.extent&&Yr(n.extent);D&&(b=Ka(b,Yr(n.extent)));const W=y*S/2/E,j=y*M/2/E,P=[o[0]-W,o[1]-j,o[0]+W,o[1]+j],H=d.getTileRangeForExtentAndZ(b,m),et={};et[m]={};const R=this.createLoadedTileFinder(f,s,et),F=this.tmpExtent,U=this.tmpTileRange_;this.newTiles_=!1;const z=l?Ug(r.center,x,l,t.size):void 0;for(let G=H.minX;G<=H.maxX;++G)for(let O=H.minY;O<=H.maxY;++O){if(l&&!d.tileCoordIntersectsViewport([m,G,O],z))continue;const X=this.getTile(m,G,O,t);if(this.isDrawableTile(X)){const ht=Qt(this);if(X.getState()==Zt.LOADED){et[m][X.tileCoord.toString()]=X;let dt=X.inTransition(ht);dt&&n.opacity!==1&&(X.endTransition(ht),dt=!1),!this.newTiles_&&(dt||!this.renderedTiles.includes(X))&&(this.newTiles_=!0)}if(X.getAlpha(ht,t.time)===1)continue}const nt=d.getTileCoordChildTileRange(X.tileCoord,U,F);let at=!1;nt&&(at=R(m+1,nt)),at||d.forEachTileCoordParentTileRange(X.tileCoord,R,U,F)}const it=y/a*h/E;Jn(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/h,1/h,l,-S/2,-M/2);const Y=Y0(this.pixelTransform);this.useContainer(e,Y,this.getBackground(t));const st=this.getRenderContext(t),Q=this.context.canvas;pc(this.inversePixelTransform,this.pixelTransform),Jn(this.tempTransform,S/2,M/2,it,it,0,-S/2,-M/2),Q.width!=S||Q.height!=M?(Q.width=S,Q.height=M):this.containerReused||st.clearRect(0,0,S,M),D&&this.clipUnrotated(st,t,D),f.getInterpolate()||(st.imageSmoothingEnabled=!1),this.preRender(st,t),this.renderedTiles.length=0;let gt=Object.keys(et).map(Number);gt.sort(Rs);let lt,Et,A;n.opacity===1&&(!this.containerReused||f.getOpaque(t.viewState.projection))?gt=gt.reverse():(lt=[],Et=[]);for(let G=gt.length-1;G>=0;--G){const O=gt[G],X=f.getTilePixelSize(O,h,s),at=d.getResolution(O)/y,ht=X[0]*at*it,dt=X[1]*at*it,St=d.getTileCoordForCoordAndZ(Aa(P),O),At=d.getTileCoordExtent(St),Rt=xi(this.tempTransform,[E*(At[0]-P[0])/y,E*(P[3]-At[3])/y]),Dt=E*f.getGutterForProjection(s),$t=et[O];for(const mt in $t){const V=$t[mt],ne=V.tileCoord,qt=St[1]-ne[1],Lt=Math.round(Rt[0]-(qt-1)*ht),It=St[2]-ne[2],Ft=Math.round(Rt[1]-(It-1)*dt),Tt=Math.round(Rt[0]-qt*ht),zt=Math.round(Rt[1]-It*dt),Kt=Lt-Tt,te=Ft-zt,he=m===O,ve=he&&V.getAlpha(Qt(this),t.time)!==1;let we=!1;if(!ve)if(lt){A=[Tt,zt,Tt+Kt,zt,Tt+Kt,zt+te,Tt,zt+te];for(let Xt=0,me=lt.length;Xt<me;++Xt)if(m!==O&&O<Et[Xt]){const Pt=lt[Xt];ki([Tt,zt,Tt+Kt,zt+te],[Pt[0],Pt[3],Pt[4],Pt[7]])&&(we||(st.save(),we=!0),st.beginPath(),st.moveTo(A[0],A[1]),st.lineTo(A[2],A[3]),st.lineTo(A[4],A[5]),st.lineTo(A[6],A[7]),st.moveTo(Pt[6],Pt[7]),st.lineTo(Pt[4],Pt[5]),st.lineTo(Pt[2],Pt[3]),st.lineTo(Pt[0],Pt[1]),st.clip())}lt.push(A),Et.push(O)}else st.clearRect(Tt,zt,Kt,te);this.drawTileImage(V,t,Tt,zt,Kt,te,Dt,he),lt&&!ve?(we&&st.restore(),this.renderedTiles.unshift(V)):this.renderedTiles.push(V),this.updateUsedTiles(t.usedTiles,f,V)}}return this.renderedRevision=g,this.renderedResolution=y,this.extentChanged=!this.renderedExtent_||!to(this.renderedExtent_,P),this.renderedExtent_=P,this.renderedPixelRatio=h,this.renderedProjection=s,this.manageTilePyramid(t,f,d,h,s,b,m,c.getPreload()),this.scheduleExpireCache(t,f),this.postRender(this.context,t),n.extent&&st.restore(),st.imageSmoothingEnabled=!0,Y!==Q.style.transform&&(Q.style.transform=Y),this.container}drawTileImage(t,e,n,r,s,a,o,l){const h=this.getTileImage(t);if(!h)return;const c=this.getRenderContext(e),f=Qt(this),g=e.layerStatesArray[e.layerIndex],d=g.opacity*(l?t.getAlpha(f,e.time):1),m=d!==c.globalAlpha;m&&(c.save(),c.globalAlpha=d),c.drawImage(h,o,o,h.width-2*o,h.height-2*o,n,r,s,a),m&&c.restore(),d!==g.opacity?e.animate=!0:l&&t.endTransition(f)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}scheduleExpireCache(t,e){if(e.canExpireCache()){const n=(function(r,s,a){const o=Qt(r);o in a.usedTiles&&r.expireCache(a.viewState.projection,a.usedTiles[o])}).bind(null,e);t.postRenderFunctions.push(n)}}updateUsedTiles(t,e,n){const r=Qt(e);r in t||(t[r]={}),t[r][n.getKey()]=!0}manageTilePyramid(t,e,n,r,s,a,o,l,h){const c=Qt(e);c in t.wantedTiles||(t.wantedTiles[c]={});const f=t.wantedTiles[c],g=t.tileQueue,d=n.getMinZoom(),m=t.viewState.rotation,y=m?Ug(t.viewState.center,t.viewState.resolution,m,t.size):void 0;let b=0,x,E,S,M,D,W;for(W=d;W<=o;++W)for(E=n.getTileRangeForExtentAndZ(a,W,E),S=n.getResolution(W),M=E.minX;M<=E.maxX;++M)for(D=E.minY;D<=E.maxY;++D)m&&!n.tileCoordIntersectsViewport([W,M,D],y)||(o-W<=l?(++b,x=e.getTile(W,M,D,r,s),x.getState()==Zt.IDLE&&(f[x.getKey()]=!0,g.isKeyQueued(x.getKey())||g.enqueue([x,c,n.getTileCoordCenter(x.tileCoord),S])),h!==void 0&&h(x)):e.useTile(W,M,D,s));e.updateCacheSize(b,s)}}class cS extends hS{constructor(t){super(t)}createRenderer(){return new Tv(this)}}const Ue=cS;class ci extends rd{constructor(t){t=t||{};const e=Object.assign({},t.params),n="TRANSPARENT"in e?e.TRANSPARENT:!0;super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,opaque:!n,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction,url:t.url,urls:t.urls,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,zDirection:t.zDirection}),this.gutter_=t.gutter!==void 0?t.gutter:0,this.params_=e,this.v13_=!0,this.serverType_=t.serverType,this.hidpi_=t.hidpi!==void 0?t.hidpi:!0,this.tmpExtent_=Dn(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(t,e,n,r){const s=ti(n),a=this.getProjection()||s;let o=this.getTileGrid();o||(o=this.getTileGridForProjection(a));const l=ba(t,s,a),h=b0(a,s,t,e),c=o.getZForResolution(h,this.zDirection),f=o.getResolution(c),g=o.getTileCoordForCoordAndZ(l,c);if(o.getResolutions().length<=g[0])return;let d=o.getTileCoordExtent(g,this.tmpExtent_);const m=this.gutter_;m!==0&&(d=va(d,f*m,d));const y={QUERY_LAYERS:this.params_.LAYERS};Object.assign(y,Wm(this.params_,"GetFeatureInfo"),r);const b=Math.floor((l[0]-d[0])/f),x=Math.floor((d[3]-l[1])/f);return y[this.v13_?"I":"X"]=b,y[this.v13_?"J":"Y"]=x,this.getRequestUrl_(g,d,1,a||s,y)}getLegendUrl(t,e){if(this.urls[0]===void 0)return;const n={SERVICE:"WMS",VERSION:E0,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(e===void 0||e.LAYER===void 0){const r=this.params_.LAYERS;if(!(!Array.isArray(r)||r.length===1))return;n.LAYER=r}if(t!==void 0){const r=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;n.SCALE=t*r/s}return Object.assign(n,e),Av(this.urls[0],n)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(t,e,n,r,s){const a=this.urls;if(!a)return;let o;if(a.length==1)o=a[0];else{const l=Za(bv(t),a.length);o=a[l]}return nS(e,(this.tileGrid||this.getTileGridForProjection(r)).getResolution(t[0]),n,r,o,s,this.serverType_)}getTilePixelRatio(t){return!this.hidpi_||this.serverType_===void 0?1:t}getKeyForParams_(){let t=0;const e=[];for(const n in this.params_)e[t++]=n+"-"+this.params_[n];return e.join("/")}updateParams(t){Object.assign(this.params_,t),this.updateV13_(),this.setKey(this.getKeyForParams_())}updateV13_(){const t=this.params_.VERSION||E0;this.v13_=D2(t,"1.3")>=0}tileUrlFunction(t,e,n){let r=this.getTileGrid();if(r||(r=this.getTileGridForProjection(n)),r.getResolutions().length<=t[0])return;e!=1&&(!this.hidpi_||this.serverType_===void 0)&&(e=1);const s=r.getResolution(t[0]);let a=r.getTileCoordExtent(t,this.tmpExtent_);const o=this.gutter_;o!==0&&(a=va(a,s*o,a));const l=Object.assign({},Wm(this.params_,"GetMap"));return this.getRequestUrl_(t,a,e,n,l)}}const R1=34962,N1=34963,uS=35040,fS=35044,S0=35048,dS=5121,gS=5123,pS=5125,Pv=5126,Vm=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function mS(i,t){t=Object.assign({preserveDrawingBuffer:!0,antialias:!Gx},t);const e=Vm.length;for(let n=0;n<e;++n)try{const r=i.getContext(Vm[n],t);if(r)return r}catch{}return null}const _S={STATIC_DRAW:fS,STREAM_DRAW:uS,DYNAMIC_DRAW:S0};class Hm{constructor(t,e){this.array_=null,this.type_=t,Ce(t===R1||t===N1,"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`"),this.usage_=e!==void 0?e:_S.STATIC_DRAW}ofSize(t){return this.array_=new(Tg(this.type_))(t),this}fromArray(t){return this.array_=Tg(this.type_).from(t),this}fromArrayBuffer(t){return this.array_=new(Tg(this.type_))(t),this}getType(){return this.type_}getArray(){return this.array_}getUsage(){return this.usage_}getSize(){return this.array_?this.array_.length:0}}function Tg(i){switch(i){case R1:return Float32Array;case N1:return Uint32Array;default:return Float32Array}}const Fu={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},vS=`
  precision mediump float;
  
  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;
  
  uniform vec2 u_screenSize;
   
  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,yS=`
  precision mediump float;
   
  uniform sampler2D u_image;
  uniform float u_opacity;
   
  varying vec2 v_texCoord;
   
  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`;class Xm{constructor(t){this.gl_=t.webGlContext;const e=this.gl_;this.scaleRatio_=t.scaleRatio||1,this.renderTargetTexture_=e.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=e.createFramebuffer(),this.depthBuffer_=e.createRenderbuffer();const n=e.createShader(e.VERTEX_SHADER);e.shaderSource(n,t.vertexShader||vS),e.compileShader(n);const r=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(r,t.fragmentShader||yS),e.compileShader(r),this.renderTargetProgram_=e.createProgram(),e.attachShader(this.renderTargetProgram_,n),e.attachShader(this.renderTargetProgram_,r),e.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=e.createBuffer();const s=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];e.bindBuffer(e.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),e.bufferData(e.ARRAY_BUFFER,new Float32Array(s),e.STATIC_DRAW),this.renderTargetAttribLocation_=e.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],t.uniforms&&Object.keys(t.uniforms).forEach(a=>{this.uniforms_.push({value:t.uniforms[a],location:e.getUniformLocation(this.renderTargetProgram_,a)})})}getGL(){return this.gl_}init(t){const e=this.getGL(),n=[e.drawingBufferWidth*this.scaleRatio_,e.drawingBufferHeight*this.scaleRatio_];if(e.bindFramebuffer(e.FRAMEBUFFER,this.getFrameBuffer()),e.bindRenderbuffer(e.RENDERBUFFER,this.getDepthBuffer()),e.viewport(0,0,n[0],n[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==n[0]||this.renderTargetTextureSize_[1]!==n[1]){this.renderTargetTextureSize_=n;const r=0,s=e.RGBA,a=0,o=e.RGBA,l=e.UNSIGNED_BYTE,h=null;e.bindTexture(e.TEXTURE_2D,this.renderTargetTexture_),e.texImage2D(e.TEXTURE_2D,r,s,n[0],n[1],a,o,l,h),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.renderTargetTexture_,0),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,n[0],n[1]),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this.depthBuffer_)}}apply(t,e,n,r){const s=this.getGL(),a=t.size;if(s.bindFramebuffer(s.FRAMEBUFFER,e?e.getFrameBuffer():null),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,this.renderTargetTexture_),!e){const l=Qt(s.canvas);if(!t.renderTargets[l]){const h=s.getContextAttributes();h&&h.preserveDrawingBuffer&&(s.clearColor(0,0,0,0),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)),t.renderTargets[l]=!0}}s.disable(s.DEPTH_TEST),s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),s.viewport(0,0,s.drawingBufferWidth,s.drawingBufferHeight),s.bindBuffer(s.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),s.useProgram(this.renderTargetProgram_),s.enableVertexAttribArray(this.renderTargetAttribLocation_),s.vertexAttribPointer(this.renderTargetAttribLocation_,2,s.FLOAT,!1,0,0),s.uniform2f(this.renderTargetUniformLocation_,a[0],a[1]),s.uniform1i(this.renderTargetTextureLocation_,0);const o=t.layerStatesArray[t.layerIndex].opacity;s.uniform1f(this.renderTargetOpacityLocation_,o),this.applyUniforms(t),n&&n(s,t),s.drawArrays(s.TRIANGLES,0,6),r&&r(s,t)}getFrameBuffer(){return this.frameBuffer_}getDepthBuffer(){return this.depthBuffer_}applyUniforms(t){const e=this.getGL();let n,r=1;this.uniforms_.forEach(function(s){if(n=typeof s.value=="function"?s.value(t):s.value,n instanceof HTMLCanvasElement||n instanceof ImageData)s.texture||(s.texture=e.createTexture()),e.activeTexture(e[`TEXTURE${r}`]),e.bindTexture(e.TEXTURE_2D,s.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),n instanceof ImageData?e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,n.width,n.height,0,e.UNSIGNED_BYTE,new Uint8Array(n.data)):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.uniform1i(s.location,r++);else if(Array.isArray(n))switch(n.length){case 2:e.uniform2f(s.location,n[0],n[1]);return;case 3:e.uniform3f(s.location,n[0],n[1],n[2]);return;case 4:e.uniform4f(s.location,n[0],n[1],n[2],n[3]);return;default:return}else typeof n=="number"&&e.uniform1f(s.location,n)})}}function xS(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function bS(i,t){return i[0]=t[0],i[1]=t[1],i[4]=t[2],i[5]=t[3],i[12]=t[4],i[13]=t[5],i}const bs={PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",ROTATION:"u_rotation",VIEWPORT_SIZE_PX:"u_viewportSizePx",PIXEL_RATIO:"u_pixelRatio",HIT_DETECTION:"u_hitDetection"},Cs={UNSIGNED_BYTE:dS,UNSIGNED_SHORT:gS,UNSIGNED_INT:pS,FLOAT:Pv},bf={};function Ym(i){return"shared/"+i}let Zm=0;function wS(){const i="unique/"+Zm;return Zm+=1,i}function ES(i){let t=bf[i];if(!t){const e=document.createElement("canvas");e.width=1,e.height=1,e.style.position="absolute",e.style.left="0",t={users:0,context:mS(e)},bf[i]=t}return t.users+=1,t.context}function SS(i){const t=bf[i];if(!t||(t.users-=1,t.users>0))return;const e=t.context,n=e.getExtension("WEBGL_lose_context");n&&n.loseContext();const r=e.canvas;r.width=1,r.height=1,delete bf[i]}class LS extends Rf{constructor(t){super(),t=t||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=t.canvasCacheKey?Ym(t.canvasCacheKey):wS(),this.gl_=ES(this.canvasCacheKey_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.needsToBeRecreated_=!1;const e=this.gl_.canvas;e.addEventListener(Fu.LOST,this.boundHandleWebGLContextLost_),e.addEventListener(Fu.RESTORED,this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=Bi(),this.offsetScaleMatrix_=Bi(),this.tmpMat4_=xS(),this.uniformLocationsByProgram_={},this.attribLocationsByProgram_={},this.uniforms_=[],t.uniforms&&this.setUniforms(t.uniforms),this.postProcessPasses_=t.postProcesses?t.postProcesses.map(n=>new Xm({webGlContext:this.gl_,scaleRatio:n.scaleRatio,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,uniforms:n.uniforms})):[new Xm({webGlContext:this.gl_})],this.shaderCompileErrors_=null,this.startTime_=Date.now()}setUniforms(t){this.uniforms_=[],this.addUniforms(t)}addUniforms(t){for(const e in t)this.uniforms_.push({name:e,value:t[e]})}canvasCacheKeyMatches(t){return this.canvasCacheKey_===Ym(t)}getExtension(t){if(t in this.extensionCache_)return this.extensionCache_[t];const e=this.gl_.getExtension(t);return this.extensionCache_[t]=e,e}bindBuffer(t){const e=this.gl_,n=Qt(t);let r=this.bufferCache_[n];if(!r){const s=e.createBuffer();r={buffer:t,webGlBuffer:s},this.bufferCache_[n]=r}e.bindBuffer(t.getType(),r.webGlBuffer)}flushBufferData(t){const e=this.gl_;this.bindBuffer(t),e.bufferData(t.getType(),t.getArray(),t.getUsage())}deleteBuffer(t){const e=this.gl_,n=Qt(t),r=this.bufferCache_[n];r&&!e.isContextLost()&&e.deleteBuffer(r.webGlBuffer),delete this.bufferCache_[n]}disposeInternal(){const t=this.gl_.canvas;t.removeEventListener(Fu.LOST,this.boundHandleWebGLContextLost_),t.removeEventListener(Fu.RESTORED,this.boundHandleWebGLContextRestored_),SS(this.canvasCacheKey_),delete this.gl_}prepareDraw(t,e,n){const r=this.gl_,s=this.getCanvas(),a=t.size,o=t.pixelRatio;(s.width!==a[0]*o||s.height!==a[1]*o)&&(s.width=a[0]*o,s.height=a[1]*o,s.style.width=a[0]+"px",s.style.height=a[1]+"px");for(let l=this.postProcessPasses_.length-1;l>=0;l--)this.postProcessPasses_[l].init(t);r.bindTexture(r.TEXTURE_2D,null),r.clearColor(0,0,0,0),r.depthRange(0,1),r.clearDepth(1),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),r.enable(r.BLEND),r.blendFunc(r.ONE,e?r.ZERO:r.ONE_MINUS_SRC_ALPHA),n?(r.enable(r.DEPTH_TEST),r.depthFunc(r.LEQUAL)):r.disable(r.DEPTH_TEST)}bindTexture(t,e,n){const r=this.gl_;r.activeTexture(r.TEXTURE0+e),r.bindTexture(r.TEXTURE_2D,t),r.uniform1i(this.getUniformLocation(n),e)}prepareDrawToRenderTarget(t,e,n,r){const s=this.gl_,a=e.getSize();s.bindFramebuffer(s.FRAMEBUFFER,e.getFramebuffer()),s.bindRenderbuffer(s.RENDERBUFFER,e.getDepthbuffer()),s.viewport(0,0,a[0],a[1]),s.bindTexture(s.TEXTURE_2D,e.getTexture()),s.clearColor(0,0,0,0),s.depthRange(0,1),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.enable(s.BLEND),s.blendFunc(s.ONE,n?s.ZERO:s.ONE_MINUS_SRC_ALPHA),r?(s.enable(s.DEPTH_TEST),s.depthFunc(s.LEQUAL)):s.disable(s.DEPTH_TEST)}drawElements(t,e){const n=this.gl_;this.getExtension("OES_element_index_uint");const r=n.UNSIGNED_INT,s=4,a=e-t,o=t*s;n.drawElements(n.TRIANGLES,a,r,o)}finalizeDraw(t,e,n){for(let r=0,s=this.postProcessPasses_.length;r<s;r++)r===s-1?this.postProcessPasses_[r].apply(t,null,e,n):this.postProcessPasses_[r].apply(t,this.postProcessPasses_[r+1])}getCanvas(){return this.gl_.canvas}getGL(){return this.gl_}applyFrameState(t){const e=t.size,n=t.viewState.rotation,r=t.pixelRatio;this.setUniformFloatValue(bs.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(bs.ZOOM,t.viewState.zoom),this.setUniformFloatValue(bs.RESOLUTION,t.viewState.resolution),this.setUniformFloatValue(bs.PIXEL_RATIO,r),this.setUniformFloatVec2(bs.VIEWPORT_SIZE_PX,[e[0],e[1]]),this.setUniformFloatValue(bs.ROTATION,n)}applyHitDetectionUniform(t){const e=this.getUniformLocation(bs.HIT_DETECTION);this.getGL().uniform1i(e,t?1:0),t&&this.setUniformFloatValue(bs.PIXEL_RATIO,.5)}applyUniforms(t){const e=this.gl_;let n,r=0;this.uniforms_.forEach(s=>{if(n=typeof s.value=="function"?s.value(t):s.value,n instanceof HTMLCanvasElement||n instanceof HTMLImageElement||n instanceof ImageData||n instanceof WebGLTexture){n instanceof WebGLTexture&&!s.texture?(s.prevValue=void 0,s.texture=n):s.texture||(s.prevValue=void 0,s.texture=e.createTexture()),this.bindTexture(s.texture,r,s.name),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);const a=!(n instanceof HTMLImageElement)||n.complete;!(n instanceof WebGLTexture)&&a&&s.prevValue!==n&&(s.prevValue=n,e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)),r++}else if(Array.isArray(n)&&n.length===6)this.setUniformMatrixValue(s.name,bS(this.tmpMat4_,n));else if(Array.isArray(n)&&n.length<=4)switch(n.length){case 2:e.uniform2f(this.getUniformLocation(s.name),n[0],n[1]);return;case 3:e.uniform3f(this.getUniformLocation(s.name),n[0],n[1],n[2]);return;case 4:e.uniform4f(this.getUniformLocation(s.name),n[0],n[1],n[2],n[3]);return;default:return}else typeof n=="number"&&e.uniform1f(this.getUniformLocation(s.name),n)})}useProgram(t,e){this.gl_.useProgram(t),this.currentProgram_=t,this.applyFrameState(e),this.applyUniforms(e)}compileShader(t,e){const n=this.gl_,r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),r}getProgram(t,e){const n=this.gl_,r=this.compileShader(t,n.FRAGMENT_SHADER),s=this.compileShader(e,n.VERTEX_SHADER),a=n.createProgram();if(n.attachShader(a,r),n.attachShader(a,s),n.linkProgram(a),!n.getShaderParameter(r,n.COMPILE_STATUS)){const o=`Fragment shader compilation failed: ${n.getShaderInfoLog(r)}`;throw new Error(o)}if(n.deleteShader(r),!n.getShaderParameter(s,n.COMPILE_STATUS)){const o=`Vertex shader compilation failed: ${n.getShaderInfoLog(s)}`;throw new Error(o)}if(n.deleteShader(s),!n.getProgramParameter(a,n.LINK_STATUS)){const o=`GL program linking failed: ${n.getProgramInfoLog(a)}`;throw new Error(o)}return a}getUniformLocation(t){const e=Qt(this.currentProgram_);return this.uniformLocationsByProgram_[e]===void 0&&(this.uniformLocationsByProgram_[e]={}),this.uniformLocationsByProgram_[e][t]===void 0&&(this.uniformLocationsByProgram_[e][t]=this.gl_.getUniformLocation(this.currentProgram_,t)),this.uniformLocationsByProgram_[e][t]}getAttributeLocation(t){const e=Qt(this.currentProgram_);return this.attribLocationsByProgram_[e]===void 0&&(this.attribLocationsByProgram_[e]={}),this.attribLocationsByProgram_[e][t]===void 0&&(this.attribLocationsByProgram_[e][t]=this.gl_.getAttribLocation(this.currentProgram_,t)),this.attribLocationsByProgram_[e][t]}makeProjectionTransform(t,e){const n=t.size,r=t.viewState.rotation,s=t.viewState.resolution,a=t.viewState.center;return Jn(e,0,0,2/(s*n[0]),2/(s*n[1]),-r,-a[0],-a[1]),e}setUniformFloatValue(t,e){this.gl_.uniform1f(this.getUniformLocation(t),e)}setUniformFloatVec2(t,e){this.gl_.uniform2fv(this.getUniformLocation(t),e)}setUniformFloatVec4(t,e){this.gl_.uniform4fv(this.getUniformLocation(t),e)}setUniformMatrixValue(t,e){this.gl_.uniformMatrix4fv(this.getUniformLocation(t),!1,e)}enableAttributeArray_(t,e,n,r,s){const a=this.getAttributeLocation(t);a<0||(this.gl_.enableVertexAttribArray(a),this.gl_.vertexAttribPointer(a,e,n,!1,r,s))}enableAttributes(t){const e=CS(t);let n=0;for(let r=0;r<t.length;r++){const s=t[r];this.enableAttributeArray_(s.name,s.size,s.type||Pv,e,n),n+=s.size*Iv(s.type)}}handleWebGLContextLost(t){ro(this.bufferCache_),this.currentProgram_=null,t.preventDefault()}handleWebGLContextRestored(){this.needsToBeRecreated_=!0}needsToBeRecreated(){return this.needsToBeRecreated_}createTexture(t,e,n){const r=this.gl_;n=n||r.createTexture();const s=0,a=r.RGBA,o=0,l=r.RGBA,h=r.UNSIGNED_BYTE;return r.bindTexture(r.TEXTURE_2D,n),e?r.texImage2D(r.TEXTURE_2D,s,a,l,h,e):r.texImage2D(r.TEXTURE_2D,s,a,t[0],t[1],o,l,h,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),n}}function CS(i){let t=0;for(let e=0;e<i.length;e++){const n=i[e];t+=n.size*Iv(n.type)}return t}function Iv(i){switch(i){case Cs.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case Cs.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case Cs.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case Cs.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}class F1 extends H_{constructor(t,e){super(t),e=e||{},this.inversePixelTransform_=Bi(),this.pixelContext_=null,this.postProcesses_=e.postProcesses,this.uniforms_=e.uniforms,this.helper,t.addChangeListener(Be.MAP,this.removeHelper.bind(this)),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(t,e){const n=this.getLayer();if(n.hasListener(Zi.PRECOMPOSE)){const r=new Nh(Zi.PRECOMPOSE,void 0,e,t);n.dispatchEvent(r)}}dispatchPostComposeEvent(t,e){const n=this.getLayer();if(n.hasListener(Zi.POSTCOMPOSE)){const r=new Nh(Zi.POSTCOMPOSE,void 0,e,t);n.dispatchEvent(r)}}reset(t){this.uniforms_=t.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(t){if(this.getLayer().getRenderSource()){let e=!0,n=-1,r;for(let a=0,o=t.layerStatesArray.length;a<o;a++){const l=t.layerStatesArray[a].layer,h=l.getRenderer();if(!(h instanceof F1)){e=!0;continue}const c=l.getClassName();if((e||c!==r)&&(n+=1,e=!1),r=c,h===this)break}const s="map/"+t.mapId+"/group/"+n;(!this.helper||!this.helper.canvasCacheKeyMatches(s)||this.helper.needsToBeRecreated())&&(this.removeHelper(),this.helper=new LS({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:s}),r&&(this.helper.getCanvas().className=r),this.afterHelperCreated())}return this.prepareFrameInternal(t)}afterHelperCreated(){}prepareFrameInternal(t){return!0}disposeInternal(){this.removeHelper(),super.disposeInternal()}dispatchRenderEvent_(t,e,n){const r=this.getLayer();if(r.hasListener(t)){Jn(this.inversePixelTransform_,0,0,n.pixelRatio,-n.pixelRatio,0,0,-n.size[1]);const s=new Nh(t,this.inversePixelTransform_,n,e);r.dispatchEvent(s)}}preRender(t,e){this.dispatchRenderEvent_(Zi.PRERENDER,t,e)}postRender(t,e){this.dispatchRenderEvent_(Zi.POSTRENDER,t,e)}}const qr=new Uint8Array(4);class AS{constructor(t,e){this.helper_=t;const n=t.getGL();this.texture_=n.createTexture(),this.framebuffer_=n.createFramebuffer(),this.depthbuffer_=n.createRenderbuffer(),this.size_=e||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}setSize(t){Os(t,this.size_)||(this.size_[0]=t[0],this.size_[1]=t[1],this.updateSize_())}getSize(){return this.size_}clearCachedData(){this.dataCacheDirty_=!0}readAll(){if(this.dataCacheDirty_){const t=this.size_,e=this.helper_.getGL();e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer_),e.readPixels(0,0,t[0],t[1],e.RGBA,e.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_}readPixel(t,e){if(t<0||e<0||t>this.size_[0]||e>=this.size_[1])return qr[0]=0,qr[1]=0,qr[2]=0,qr[3]=0,qr;this.readAll();const n=Math.floor(t)+(this.size_[1]-Math.floor(e)-1)*this.size_[0];return qr[0]=this.data_[n*4],qr[1]=this.data_[n*4+1],qr[2]=this.data_[n*4+2],qr[3]=this.data_[n*4+3],qr}getTexture(){return this.texture_}getFramebuffer(){return this.framebuffer_}getDepthbuffer(){return this.depthbuffer_}updateSize_(){const t=this.size_,e=this.helper_.getGL();this.texture_=this.helper_.createTexture(t,null,this.texture_),e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer_),e.viewport(0,0,t[0],t[1]),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture_,0),e.bindRenderbuffer(e.RENDERBUFFER,this.depthbuffer_),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,t[0],t[1]),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this.depthbuffer_),this.data_=new Uint8Array(t[0]*t[1]*4)}}const Km={GENERATE_POLYGON_BUFFERS:"GENERATE_POLYGON_BUFFERS",GENERATE_POINT_BUFFERS:"GENERATE_POINT_BUFFERS",GENERATE_LINE_STRING_BUFFERS:"GENERATE_LINE_STRING_BUFFERS"};var Rv={exports:{}};Rv.exports=sd;Rv.exports.default=sd;function sd(i,t,e){e=e||2;var n=t&&t.length,r=n?t[0]*e:i.length,s=Nv(i,0,r,e,!0),a=[];if(!s||s.next===s.prev)return a;var o,l,h,c,f,g,d;if(n&&(s=RS(i,t,s,e)),i.length>80*e){o=h=i[0],l=c=i[1];for(var m=e;m<r;m+=e)f=i[m],g=i[m+1],f<o&&(o=f),g<l&&(l=g),f>h&&(h=f),g>c&&(c=g);d=Math.max(h-o,c-l),d=d!==0?32767/d:0}return nc(s,a,e,o,l,d,0),a}function Nv(i,t,e,n,r){var s,a;if(r===A0(i,t,e,n)>0)for(s=t;s<e;s+=n)a=$m(s,i[s],i[s+1],a);else for(s=e-n;s>=t;s-=n)a=$m(s,i[s],i[s+1],a);return a&&ad(a,a.next)&&(sc(a),a=a.next),a}function eo(i,t){if(!i)return i;t||(t=i);var e=i,n;do if(n=!1,!e.steiner&&(ad(e,e.next)||gi(e.prev,e,e.next)===0)){if(sc(e),e=t=e.prev,e===e.next)break;n=!0}else e=e.next;while(n||e!==t);return t}function nc(i,t,e,n,r,s,a){if(i){!a&&s&&DS(i,n,r,s);for(var o=i,l,h;i.prev!==i.next;){if(l=i.prev,h=i.next,s?TS(i,n,r,s):MS(i)){t.push(l.i/e|0),t.push(i.i/e|0),t.push(h.i/e|0),sc(i),i=h.next,o=h.next;continue}if(i=h,i===o){a?a===1?(i=PS(eo(i),t,e),nc(i,t,e,n,r,s,2)):a===2&&IS(i,t,e,n,r,s):nc(eo(i),t,e,n,r,s,1);break}}}}function MS(i){var t=i.prev,e=i,n=i.next;if(gi(t,e,n)>=0)return!1;for(var r=t.x,s=e.x,a=n.x,o=t.y,l=e.y,h=n.y,c=r<s?r<a?r:a:s<a?s:a,f=o<l?o<h?o:h:l<h?l:h,g=r>s?r>a?r:a:s>a?s:a,d=o>l?o>h?o:h:l>h?l:h,m=n.next;m!==t;){if(m.x>=c&&m.x<=g&&m.y>=f&&m.y<=d&&al(r,o,s,l,a,h,m.x,m.y)&&gi(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function TS(i,t,e,n){var r=i.prev,s=i,a=i.next;if(gi(r,s,a)>=0)return!1;for(var o=r.x,l=s.x,h=a.x,c=r.y,f=s.y,g=a.y,d=o<l?o<h?o:h:l<h?l:h,m=c<f?c<g?c:g:f<g?f:g,y=o>l?o>h?o:h:l>h?l:h,b=c>f?c>g?c:g:f>g?f:g,x=L0(d,m,t,e,n),E=L0(y,b,t,e,n),S=i.prevZ,M=i.nextZ;S&&S.z>=x&&M&&M.z<=E;){if(S.x>=d&&S.x<=y&&S.y>=m&&S.y<=b&&S!==r&&S!==a&&al(o,c,l,f,h,g,S.x,S.y)&&gi(S.prev,S,S.next)>=0||(S=S.prevZ,M.x>=d&&M.x<=y&&M.y>=m&&M.y<=b&&M!==r&&M!==a&&al(o,c,l,f,h,g,M.x,M.y)&&gi(M.prev,M,M.next)>=0))return!1;M=M.nextZ}for(;S&&S.z>=x;){if(S.x>=d&&S.x<=y&&S.y>=m&&S.y<=b&&S!==r&&S!==a&&al(o,c,l,f,h,g,S.x,S.y)&&gi(S.prev,S,S.next)>=0)return!1;S=S.prevZ}for(;M&&M.z<=E;){if(M.x>=d&&M.x<=y&&M.y>=m&&M.y<=b&&M!==r&&M!==a&&al(o,c,l,f,h,g,M.x,M.y)&&gi(M.prev,M,M.next)>=0)return!1;M=M.nextZ}return!0}function PS(i,t,e){var n=i;do{var r=n.prev,s=n.next.next;!ad(r,s)&&Fv(r,n,n.next,s)&&rc(r,s)&&rc(s,r)&&(t.push(r.i/e|0),t.push(n.i/e|0),t.push(s.i/e|0),sc(n),sc(n.next),n=i=s),n=n.next}while(n!==i);return eo(n)}function IS(i,t,e,n,r,s){var a=i;do{for(var o=a.next.next;o!==a.prev;){if(a.i!==o.i&&GS(a,o)){var l=Ov(a,o);a=eo(a,a.next),l=eo(l,l.next),nc(a,t,e,n,r,s,0),nc(l,t,e,n,r,s,0);return}o=o.next}a=a.next}while(a!==i)}function RS(i,t,e,n){var r=[],s,a,o,l,h;for(s=0,a=t.length;s<a;s++)o=t[s]*n,l=s<a-1?t[s+1]*n:i.length,h=Nv(i,o,l,n,!1),h===h.next&&(h.steiner=!0),r.push(BS(h));for(r.sort(NS),s=0;s<r.length;s++)e=FS(r[s],e);return e}function NS(i,t){return i.x-t.x}function FS(i,t){var e=OS(i,t);if(!e)return t;var n=Ov(e,i);return eo(n,n.next),eo(e,e.next)}function OS(i,t){var e=t,n=i.x,r=i.y,s=-1/0,a;do{if(r<=e.y&&r>=e.next.y&&e.next.y!==e.y){var o=e.x+(r-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(o<=n&&o>s&&(s=o,a=e.x<e.next.x?e:e.next,o===n))return a}e=e.next}while(e!==t);if(!a)return null;var l=a,h=a.x,c=a.y,f=1/0,g;e=a;do n>=e.x&&e.x>=h&&n!==e.x&&al(r<c?n:s,r,h,c,r<c?s:n,r,e.x,e.y)&&(g=Math.abs(r-e.y)/(n-e.x),rc(e,i)&&(g<f||g===f&&(e.x>a.x||e.x===a.x&&kS(a,e)))&&(a=e,f=g)),e=e.next;while(e!==l);return a}function kS(i,t){return gi(i.prev,i,t.prev)<0&&gi(t.next,i,i.next)<0}function DS(i,t,e,n){var r=i;do r.z===0&&(r.z=L0(r.x,r.y,t,e,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,jS(r)}function jS(i){var t,e,n,r,s,a,o,l,h=1;do{for(e=i,i=null,s=null,a=0;e;){for(a++,n=e,o=0,t=0;t<h&&(o++,n=n.nextZ,!!n);t++);for(l=h;o>0||l>0&&n;)o!==0&&(l===0||!n||e.z<=n.z)?(r=e,e=e.nextZ,o--):(r=n,n=n.nextZ,l--),s?s.nextZ=r:i=r,r.prevZ=s,s=r;e=n}s.nextZ=null,h*=2}while(a>1);return i}function L0(i,t,e,n,r){return i=(i-e)*r|0,t=(t-n)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,i|t<<1}function BS(i){var t=i,e=i;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==i);return e}function al(i,t,e,n,r,s,a,o){return(r-a)*(t-o)>=(i-a)*(s-o)&&(i-a)*(n-o)>=(e-a)*(t-o)&&(e-a)*(s-o)>=(r-a)*(n-o)}function GS(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!zS(i,t)&&(rc(i,t)&&rc(t,i)&&qS(i,t)&&(gi(i.prev,i,t.prev)||gi(i,t.prev,t))||ad(i,t)&&gi(i.prev,i,i.next)>0&&gi(t.prev,t,t.next)>0)}function gi(i,t,e){return(t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y)}function ad(i,t){return i.x===t.x&&i.y===t.y}function Fv(i,t,e,n){var r=ku(gi(i,t,e)),s=ku(gi(i,t,n)),a=ku(gi(e,n,i)),o=ku(gi(e,n,t));return!!(r!==s&&a!==o||r===0&&Ou(i,e,t)||s===0&&Ou(i,n,t)||a===0&&Ou(e,i,n)||o===0&&Ou(e,t,n))}function Ou(i,t,e){return t.x<=Math.max(i.x,e.x)&&t.x>=Math.min(i.x,e.x)&&t.y<=Math.max(i.y,e.y)&&t.y>=Math.min(i.y,e.y)}function ku(i){return i>0?1:i<0?-1:0}function zS(i,t){var e=i;do{if(e.i!==i.i&&e.next.i!==i.i&&e.i!==t.i&&e.next.i!==t.i&&Fv(e,e.next,i,t))return!0;e=e.next}while(e!==i);return!1}function rc(i,t){return gi(i.prev,i,i.next)<0?gi(i,t,i.next)>=0&&gi(i,i.prev,t)>=0:gi(i,t,i.prev)<0||gi(i,i.next,t)<0}function qS(i,t){var e=i,n=!1,r=(i.x+t.x)/2,s=(i.y+t.y)/2;do e.y>s!=e.next.y>s&&e.next.y!==e.y&&r<(e.next.x-e.x)*(s-e.y)/(e.next.y-e.y)+e.x&&(n=!n),e=e.next;while(e!==i);return n}function Ov(i,t){var e=new C0(i.i,i.x,i.y),n=new C0(t.i,t.x,t.y),r=i.next,s=t.prev;return i.next=t,t.prev=i,e.next=r,r.prev=e,n.next=e,e.prev=n,s.next=n,n.prev=s,n}function $m(i,t,e,n){var r=new C0(i,t,e);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function sc(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function C0(i,t,e){this.i=i,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}sd.deviation=function(i,t,e,n){var r=t&&t.length,s=r?t[0]*e:i.length,a=Math.abs(A0(i,0,s,e));if(r)for(var o=0,l=t.length;o<l;o++){var h=t[o]*e,c=o<l-1?t[o+1]*e:i.length;a-=Math.abs(A0(i,h,c,e))}var f=0;for(o=0;o<n.length;o+=3){var g=n[o]*e,d=n[o+1]*e,m=n[o+2]*e;f+=Math.abs((i[g]-i[m])*(i[d+1]-i[g+1])-(i[g]-i[d])*(i[m+1]-i[g+1]))}return a===0&&f===0?0:Math.abs((f-a)/a)};function A0(i,t,e,n){for(var r=0,s=t,a=e-n;s<e;s+=n)r+=(i[a]-i[s])*(i[s+1]+i[a+1]),a=s;return r}sd.flatten=function(i){for(var t=i[0][0].length,e={vertices:[],holes:[],dimensions:t},n=0,r=0;r<i.length;r++){for(var s=0;s<i[r].length;s++)for(var a=0;a<t;a++)e.vertices.push(i[r][s][a]);r>0&&(n+=i[r-1].length,e.holes.push(n))}return e};const Jm=.985;function US(i,t){t=t||[];const e=256,n=e-1;return t[0]=Math.floor(i/e/e/e)/n,t[1]=Math.floor(i/e/e)%e/n,t[2]=Math.floor(i/e)%e/n,t[3]=i%e/n,t}function WS(i){let t=0;const e=256,n=e-1;return t+=Math.round(i[0]*e*e*e*n),t+=Math.round(i[1]*e*e*n),t+=Math.round(i[2]*e*n),t+=Math.round(i[3]*n),t}function VS(){const i='const e="GENERATE_POLYGON_BUFFERS",t="GENERATE_POINT_BUFFERS",n="GENERATE_LINE_STRING_BUFFERS";function r(e,t){const n=t[0],r=t[1];return t[0]=e[0]*n+e[2]*r+e[4],t[1]=e[1]*n+e[3]*r+e[5],t}function x(e,t){const n=(r=t)[0]*r[3]-r[1]*r[2];var r;!function(e,t){if(!e)throw new Error(t)}(0!==n,"Transformation matrix cannot be inverted");const x=t[0],i=t[1],u=t[2],o=t[3],f=t[4],s=t[5];return e[0]=o/n,e[1]=-i/n,e[2]=-u/n,e[3]=x/n,e[4]=(u*s-o*f)/n,e[5]=-(x*s-i*f)/n,e}function i(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}new Array(6);var u={exports:{}};function o(e,t,n){n=n||2;var r,x,i,u,o,s,l,v=t&&t.length,h=v?t[0]*n:e.length,c=f(e,0,h,n,!0),g=[];if(!c||c.next===c.prev)return g;if(v&&(c=function(e,t,n,r){var x,i,u,o=[];for(x=0,i=t.length;x<i;x++)(u=f(e,t[x]*r,x<i-1?t[x+1]*r:e.length,r,!1))===u.next&&(u.steiner=!0),o.push(d(u));for(o.sort(p),x=0;x<o.length;x++)n=y(o[x],n);return n}(e,t,c,n)),e.length>80*n){r=i=e[0],x=u=e[1];for(var b=n;b<h;b+=n)(o=e[b])<r&&(r=o),(s=e[b+1])<x&&(x=s),o>i&&(i=o),s>u&&(u=s);l=0!==(l=Math.max(i-r,u-x))?32767/l:0}return a(c,g,n,r,x,l,0),g}function f(e,t,n,r,x){var i,u;if(x===O(e,t,n,r)>0)for(i=t;i<n;i+=r)u=P(i,e[i],e[i+1],u);else for(i=n-r;i>=t;i-=r)u=P(i,e[i],e[i+1],u);return u&&m(u,u.next)&&(B(u),u=u.next),u}function s(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!m(r,r.next)&&0!==w(r.prev,r,r.next))r=r.next;else{if(B(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function a(e,t,n,r,x,i,u){if(e){!u&&i&&function(e,t,n,r){var x=e;do{0===x.z&&(x.z=b(x.x,x.y,t,n,r)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next}while(x!==e);x.prevZ.nextZ=null,x.prevZ=null,function(e){var t,n,r,x,i,u,o,f,s=1;do{for(n=e,e=null,i=null,u=0;n;){for(u++,r=n,o=0,t=0;t<s&&(o++,r=r.nextZ);t++);for(f=s;o>0||f>0&&r;)0!==o&&(0===f||!r||n.z<=r.z)?(x=n,n=n.nextZ,o--):(x=r,r=r.nextZ,f--),i?i.nextZ=x:e=x,x.prevZ=i,i=x;n=r}i.nextZ=null,s*=2}while(u>1)}(x)}(e,r,x,i);for(var o,f,p=e;e.prev!==e.next;)if(o=e.prev,f=e.next,i?v(e,r,x,i):l(e))t.push(o.i/n|0),t.push(e.i/n|0),t.push(f.i/n|0),B(e),e=f.next,p=f.next;else if((e=f)===p){u?1===u?a(e=h(s(e),t,n),t,n,r,x,i,2):2===u&&c(e,t,n,r,x,i):a(s(e),t,n,r,x,i,1);break}}}function l(e){var t=e.prev,n=e,r=e.next;if(w(t,n,r)>=0)return!1;for(var x=t.x,i=n.x,u=r.x,o=t.y,f=n.y,s=r.y,a=x<i?x<u?x:u:i<u?i:u,l=o<f?o<s?o:s:f<s?f:s,v=x>i?x>u?x:u:i>u?i:u,h=o>f?o>s?o:s:f>s?f:s,c=r.next;c!==t;){if(c.x>=a&&c.x<=v&&c.y>=l&&c.y<=h&&M(x,o,i,f,u,s,c.x,c.y)&&w(c.prev,c,c.next)>=0)return!1;c=c.next}return!0}function v(e,t,n,r){var x=e.prev,i=e,u=e.next;if(w(x,i,u)>=0)return!1;for(var o=x.x,f=i.x,s=u.x,a=x.y,l=i.y,v=u.y,h=o<f?o<s?o:s:f<s?f:s,c=a<l?a<v?a:v:l<v?l:v,p=o>f?o>s?o:s:f>s?f:s,y=a>l?a>v?a:v:l>v?l:v,g=b(h,c,t,n,r),d=b(p,y,t,n,r),Z=e.prevZ,m=e.nextZ;Z&&Z.z>=g&&m&&m.z<=d;){if(Z.x>=h&&Z.x<=p&&Z.y>=c&&Z.y<=y&&Z!==x&&Z!==u&&M(o,a,f,l,s,v,Z.x,Z.y)&&w(Z.prev,Z,Z.next)>=0)return!1;if(Z=Z.prevZ,m.x>=h&&m.x<=p&&m.y>=c&&m.y<=y&&m!==x&&m!==u&&M(o,a,f,l,s,v,m.x,m.y)&&w(m.prev,m,m.next)>=0)return!1;m=m.nextZ}for(;Z&&Z.z>=g;){if(Z.x>=h&&Z.x<=p&&Z.y>=c&&Z.y<=y&&Z!==x&&Z!==u&&M(o,a,f,l,s,v,Z.x,Z.y)&&w(Z.prev,Z,Z.next)>=0)return!1;Z=Z.prevZ}for(;m&&m.z<=d;){if(m.x>=h&&m.x<=p&&m.y>=c&&m.y<=y&&m!==x&&m!==u&&M(o,a,f,l,s,v,m.x,m.y)&&w(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function h(e,t,n){var r=e;do{var x=r.prev,i=r.next.next;!m(x,i)&&A(x,r,r.next,i)&&z(x,i)&&z(i,x)&&(t.push(x.i/n|0),t.push(r.i/n|0),t.push(i.i/n|0),B(r),B(r.next),r=e=i),r=r.next}while(r!==e);return s(r)}function c(e,t,n,r,x,i){var u=e;do{for(var o=u.next.next;o!==u.prev;){if(u.i!==o.i&&Z(u,o)){var f=F(u,o);return u=s(u,u.next),f=s(f,f.next),a(u,t,n,r,x,i,0),void a(f,t,n,r,x,i,0)}o=o.next}u=u.next}while(u!==e)}function p(e,t){return e.x-t.x}function y(e,t){var n=function(e,t){var n,r=t,x=e.x,i=e.y,u=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var o=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(o<=x&&o>u&&(u=o,n=r.x<r.next.x?r:r.next,o===x))return n}r=r.next}while(r!==t);if(!n)return null;var f,s=n,a=n.x,l=n.y,v=1/0;r=n;do{x>=r.x&&r.x>=a&&x!==r.x&&M(i<l?x:u,i,a,l,i<l?u:x,i,r.x,r.y)&&(f=Math.abs(i-r.y)/(x-r.x),z(r,e)&&(f<v||f===v&&(r.x>n.x||r.x===n.x&&g(n,r)))&&(n=r,v=f)),r=r.next}while(r!==s);return n}(e,t);if(!n)return t;var r=F(n,e);return s(r,r.next),s(n,n.next)}function g(e,t){return w(e.prev,e,t.prev)<0&&w(t.next,e,e.next)<0}function b(e,t,n,r,x){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*x|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*x|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function d(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function M(e,t,n,r,x,i,u,o){return(x-u)*(t-o)>=(e-u)*(i-o)&&(e-u)*(r-o)>=(n-u)*(t-o)&&(n-u)*(i-o)>=(x-u)*(r-o)}function Z(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&A(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(z(e,t)&&z(t,e)&&function(e,t){var n=e,r=!1,x=(e.x+t.x)/2,i=(e.y+t.y)/2;do{n.y>i!=n.next.y>i&&n.next.y!==n.y&&x<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(w(e.prev,e,t.prev)||w(e,t.prev,t))||m(e,t)&&w(e.prev,e,e.next)>0&&w(t.prev,t,t.next)>0)}function w(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function m(e,t){return e.x===t.x&&e.y===t.y}function A(e,t,n,r){var x=I(w(e,t,n)),i=I(w(e,t,r)),u=I(w(n,r,e)),o=I(w(n,r,t));return x!==i&&u!==o||(!(0!==x||!E(e,n,t))||(!(0!==i||!E(e,r,t))||(!(0!==u||!E(n,e,r))||!(0!==o||!E(n,t,r)))))}function E(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function I(e){return e>0?1:e<0?-1:0}function z(e,t){return w(e.prev,e,e.next)<0?w(e,t,e.next)>=0&&w(e,e.prev,t)>=0:w(e,t,e.prev)<0||w(e,e.next,t)<0}function F(e,t){var n=new _(e.i,e.x,e.y),r=new _(t.i,t.x,t.y),x=e.next,i=t.prev;return e.next=t,t.prev=e,n.next=x,x.prev=n,r.next=n,n.prev=r,i.next=r,r.prev=i,r}function P(e,t,n,r){var x=new _(e,t,n);return r?(x.next=r.next,x.prev=r,r.next.prev=x,r.next=x):(x.prev=x,x.next=x),x}function B(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function _(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function O(e,t,n,r){for(var x=0,i=t,u=n-r;i<n;i+=r)x+=(e[u]-e[i])*(e[i+1]+e[u+1]),u=i;return x}u.exports=o,u.exports.default=o,o.deviation=function(e,t,n,r){var x=t&&t.length,i=x?t[0]*n:e.length,u=Math.abs(O(e,0,i,n));if(x)for(var o=0,f=t.length;o<f;o++){var s=t[o]*n,a=o<f-1?t[o+1]*n:e.length;u-=Math.abs(O(e,s,a,n))}var l=0;for(o=0;o<r.length;o+=3){var v=r[o]*n,h=r[o+1]*n,c=r[o+2]*n;l+=Math.abs((e[v]-e[c])*(e[h+1]-e[v+1])-(e[v]-e[h])*(e[c+1]-e[v+1]))}return 0===u&&0===l?0:Math.abs((l-u)/u)},o.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,x=0;x<e.length;x++){for(var i=0;i<e[x].length;i++)for(var u=0;u<t;u++)n.vertices.push(e[x][i][u]);x>0&&(r+=e[x-1].length,n.holes.push(r))}return n};var N=i(u.exports);const R=[],S={vertexPosition:0,indexPosition:0};function T(e,t,n,r,x){e[t+0]=n,e[t+1]=r,e[t+2]=x}function U(e,t,n,r,x,i){const u=3+x,o=e[t+0],f=e[t+1],s=R;s.length=x;for(let n=0;n<s.length;n++)s[n]=e[t+2+n];let a=i?i.vertexPosition:0,l=i?i.indexPosition:0;const v=a/u;return T(n,a,o,f,0),s.length&&n.set(s,a+3),a+=u,T(n,a,o,f,1),s.length&&n.set(s,a+3),a+=u,T(n,a,o,f,2),s.length&&n.set(s,a+3),a+=u,T(n,a,o,f,3),s.length&&n.set(s,a+3),a+=u,r[l++]=v,r[l++]=v+1,r[l++]=v+3,r[l++]=v+1,r[l++]=v+2,r[l++]=v+3,S.vertexPosition=a,S.indexPosition=l,S}function k(e,t,n,x,i,u,o,f,s,a,l){const v=8+f.length,h=u.length/v,c=[e[t+0],e[t+1]],p=[e[n],e[n+1]],y=r(s,[...c]),g=r(s,[...p]);function b(e,t,n){const r=Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])),x=[(t[0]-e[0])/r,(t[1]-e[1])/r],i=[-x[1],x[0]],u=Math.sqrt((n[0]-e[0])*(n[0]-e[0])+(n[1]-e[1])*(n[1]-e[1])),o=[(n[0]-e[0])/u,(n[1]-e[1])/u],f=0===r||0===u?0:Math.acos((s=o[0]*x[0]+o[1]*x[1],a=-1,l=1,Math.min(Math.max(s,a),l)));var s,a,l;return o[0]*i[0]+o[1]*i[1]>0?f:2*Math.PI-f}let d=-1,M=-1,Z=l;const w=null!==i;if(null!==x){d=b(y,g,r(s,[...[e[x],e[x+1]]])),Math.cos(d)<=.985&&(Z+=Math.tan((d-Math.PI)/2))}if(w){M=b(g,y,r(s,[...[e[i],e[i+1]]])),Math.cos(M)<=.985&&(Z+=Math.tan((Math.PI-M)/2))}function m(e,t){return 0===t?1e4*e:Math.sign(t)*(1e4*e+Math.abs(t))}return u.push(c[0],c[1],p[0],p[1],d,M,a,m(0,l)),u.push(...f),u.push(c[0],c[1],p[0],p[1],d,M,a,m(1,l)),u.push(...f),u.push(c[0],c[1],p[0],p[1],d,M,a,m(2,l)),u.push(...f),u.push(c[0],c[1],p[0],p[1],d,M,a,m(3,l)),u.push(...f),o.push(h,h+1,h+2,h+1,h+3,h+2),{length:a+Math.sqrt((g[0]-y[0])*(g[0]-y[0])+(g[1]-y[1])*(g[1]-y[1])),angle:Z}}function G(e,t,n,r,x){const i=2+x;let u=t;const o=e.slice(u,u+x);u+=x;const f=e[u++];let s=0;const a=new Array(f-1);for(let t=0;t<f;t++)s+=e[u++],t<f-1&&(a[t]=s);const l=e.slice(u,u+2*s),v=N(l,a,2);for(let e=0;e<v.length;e++)r.push(v[e]+n.length/i);for(let e=0;e<l.length;e+=2)n.push(l[e],l[e+1],...o);return u+2*s}const j=self;j.onmessage=r=>{const i=r.data;switch(i.type){case t:{const e=3,t=2,n=i.customAttributesSize,r=t+n,x=new Float32Array(i.renderInstructions),u=x.length/r,o=4*u*(n+e),f=new Uint32Array(6*u),s=new Float32Array(o);let a;for(let e=0;e<x.length;e+=r)a=U(x,e,s,f,n,a);const l=Object.assign({vertexBuffer:s.buffer,indexBuffer:f.buffer,renderInstructions:x.buffer},i);j.postMessage(l,[s.buffer,f.buffer,x.buffer]);break}case n:{const e=[],t=[],n=i.customAttributesSize,r=2,u=new Float32Array(i.renderInstructions);let o=0;const f=[1,0,0,1,0,0];let s,a;for(x(f,i.renderInstructionsTransform);o<u.length;){a=Array.from(u.slice(o,o+n)),o+=n,s=u[o++];const x=o,i=o+(s-1)*r,l=u[x]===u[i]&&u[x+1]===u[i+1];let v=0,h=0;for(let n=0;n<s-1;n++){let c=null;n>0?c=o+(n-1)*r:l&&(c=i-r);let p=null;n<s-2?p=o+(n+2)*r:l&&(p=x+r);const y=k(u,o+n*r,o+(n+1)*r,c,p,e,t,a,f,v,h);v=y.length,h=y.angle}o+=s*r}const l=Uint32Array.from(t),v=Float32Array.from(e),h=Object.assign({vertexBuffer:v.buffer,indexBuffer:l.buffer,renderInstructions:u.buffer},i);j.postMessage(h,[v.buffer,l.buffer,u.buffer]);break}case e:{const e=[],t=[],n=i.customAttributesSize,r=new Float32Array(i.renderInstructions);let x=0;for(;x<r.length;)x=G(r,x,e,t,n);const u=Uint32Array.from(t),o=Float32Array.from(e),f=Object.assign({vertexBuffer:o.buffer,indexBuffer:u.buffer,renderInstructions:r.buffer},i);j.postMessage(f,[o.buffer,u.buffer,r.buffer]);break}}};';return new Worker(typeof Blob>"u"?"data:application/javascript;base64,"+Buffer.from(i,"binary").toString("base64"):URL.createObjectURL(new Blob([i],{type:"application/javascript"})))}function HS(i,t){const e=i.viewState.projection,r=t.getSource().getWrapX()&&e.canWrapX(),s=e.getExtent(),a=i.extent,o=r?Re(s):null,l=r?Math.ceil((a[2]-s[2])/o)+1:1;return[r?Math.floor((a[0]-s[0])/o):0,l,o]}class XS extends F1{constructor(t,e){const n=e.uniforms||{},r=Bi();n[bs.PROJECTION_MATRIX]=r,super(t,{uniforms:n,postProcesses:e.postProcesses}),this.sourceRevision_=-1,this.verticesBuffer_=new Hm(R1,S0),this.indicesBuffer_=new Hm(N1,S0),this.vertexShader_=e.vertexShader,this.fragmentShader_=e.fragmentShader,this.program_,this.hitDetectionEnabled_=e.hitDetectionEnabled??!0;const s=e.attributes?e.attributes.map(function(o){return{name:"a_prop_"+o.name,size:1,type:Cs.FLOAT}}):[];this.attributes=[{name:"a_position",size:2,type:Cs.FLOAT},{name:"a_index",size:1,type:Cs.FLOAT}],this.hitDetectionEnabled_&&(this.attributes.push({name:"a_prop_hitColor",size:4,type:Cs.FLOAT}),this.attributes.push({name:"a_featureUid",size:1,type:Cs.FLOAT})),this.attributes.push(...s),this.customAttributes=e.attributes?e.attributes:[],this.previousExtent_=Dn(),this.currentTransform_=r,this.renderTransform_=Bi(),this.invertRenderTransform_=Bi(),this.renderInstructions_=new Float32Array(0),this.hitRenderTarget_,this.lastSentId=0,this.worker_=VS(),this.worker_.addEventListener("message",o=>{const l=o.data;if(l.type===Km.GENERATE_POINT_BUFFERS){const h=l.projectionTransform;this.verticesBuffer_.fromArrayBuffer(l.vertexBuffer),this.helper.flushBufferData(this.verticesBuffer_),this.indicesBuffer_.fromArrayBuffer(l.indexBuffer),this.helper.flushBufferData(this.indicesBuffer_),this.renderTransform_=h,pc(this.invertRenderTransform_,this.renderTransform_),this.renderInstructions_=new Float32Array(o.data.renderInstructions),l.id===this.lastSentId&&(this.ready=!0),this.getLayer().changed()}}),this.featureCache_={},this.featureCount_=0;const a=this.getLayer().getSource();this.sourceListenKeys_=[_e(a,bn.ADDFEATURE,this.handleSourceFeatureAdded_,this),_e(a,bn.CHANGEFEATURE,this.handleSourceFeatureChanged_,this),_e(a,bn.REMOVEFEATURE,this.handleSourceFeatureDelete_,this),_e(a,bn.CLEAR,this.handleSourceFeatureClear_,this)],a.forEachFeature(o=>{this.featureCache_[Qt(o)]={feature:o,properties:o.getProperties(),geometry:o.getGeometry()},this.featureCount_++})}afterHelperCreated(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.hitDetectionEnabled_&&(this.hitRenderTarget_=new AS(this.helper))}handleSourceFeatureAdded_(t){const e=t.feature;this.featureCache_[Qt(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()},this.featureCount_++}handleSourceFeatureChanged_(t){const e=t.feature;this.featureCache_[Qt(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()}}handleSourceFeatureDelete_(t){const e=t.feature;delete this.featureCache_[Qt(e)],this.featureCount_--}handleSourceFeatureClear_(){this.featureCache_={},this.featureCount_=0}renderFrame(t){const e=this.helper.getGL();this.preRender(e,t);const[n,r,s]=HS(t,this.getLayer());return this.renderWorlds(t,!1,n,r,s),this.helper.finalizeDraw(t,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent),this.hitDetectionEnabled_&&(this.renderWorlds(t,!0,n,r,s),this.hitRenderTarget_.clearCachedData()),this.postRender(e,t),this.helper.getCanvas()}prepareFrameInternal(t){const e=this.getLayer(),n=e.getSource(),r=t.viewState,s=!t.viewHints[ri.ANIMATING]&&!t.viewHints[ri.INTERACTING],a=!to(this.previousExtent_,t.extent),o=this.sourceRevision_<n.getRevision();if(o&&(this.sourceRevision_=n.getRevision()),s&&(a||o)){const l=r.projection,h=r.resolution,c=e instanceof yc?e.getRenderBuffer():0,f=va(t.extent,c*h);n.loadFeatures(f,h,l),this.rebuildBuffers_(t),this.previousExtent_=t.extent.slice()}return this.helper.useProgram(this.program_,t),this.helper.prepareDraw(t),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes),!0}rebuildBuffers_(t){const e=Bi();this.helper.makeProjectionTransform(t,e);const r=(this.hitDetectionEnabled_?7:2)+this.customAttributes.length,s=r*this.featureCount_;(!this.renderInstructions_||this.renderInstructions_.length!==s)&&(this.renderInstructions_=new Float32Array(s));let a,o;const l=[],h=[];let c=-1;for(const g in this.featureCache_)if(a=this.featureCache_[g],o=a.geometry,!(!o||o.getType()!=="Point")){if(l[0]=o.getFlatCoordinates()[0],l[1]=o.getFlatCoordinates()[1],xi(e,l),this.renderInstructions_[++c]=l[0],this.renderInstructions_[++c]=l[1],this.hitDetectionEnabled_){const d=US(c+5,h);this.renderInstructions_[++c]=d[0],this.renderInstructions_[++c]=d[1],this.renderInstructions_[++c]=d[2],this.renderInstructions_[++c]=d[3],this.renderInstructions_[++c]=Number(g)}for(let d=0;d<this.customAttributes.length;d++){const m=this.customAttributes[d].callback(a.feature,a.properties);this.renderInstructions_[++c]=m}}const f={id:++this.lastSentId,type:Km.GENERATE_POINT_BUFFERS,renderInstructions:this.renderInstructions_.buffer,customAttributesSize:r-2};f.projectionTransform=e,this.ready=!1,this.worker_.postMessage(f,[this.renderInstructions_.buffer]),this.renderInstructions_=null}forEachFeatureAtCoordinate(t,e,n,r,s){if(Ce(this.hitDetectionEnabled_,"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has been disabled using the `disableHitDetection: true` option."),!this.renderInstructions_||!this.hitDetectionEnabled_)return;const a=xi(e.coordinateToPixelTransform,t.slice()),o=this.hitRenderTarget_.readPixel(a[0]/2,a[1]/2),l=[o[0]/255,o[1]/255,o[2]/255,o[3]/255],h=WS(l),c=this.renderInstructions_[h],f=Math.floor(c).toString(),d=this.getLayer().getSource().getFeatureByUid(f);if(d)return r(d,this.getLayer(),null)}renderWorlds(t,e,n,r,s){let a=n;this.helper.useProgram(this.program_,t),e&&(this.hitRenderTarget_.setSize([Math.floor(t.size[0]/2),Math.floor(t.size[1]/2)]),this.helper.prepareDrawToRenderTarget(t,this.hitRenderTarget_,!0)),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes);do{this.helper.makeProjectionTransform(t,this.currentTransform_),Z2(this.currentTransform_,a*s,0),Bf(this.currentTransform_,this.invertRenderTransform_),this.helper.applyUniforms(t),this.helper.applyHitDetectionUniform(e);const o=this.indicesBuffer_.getSize();this.helper.drawElements(0,o)}while(++a<r)}disposeInternal(){this.worker_.terminate(),this.layer_=null,this.sourceListenKeys_.forEach(function(t){Ke(t)}),this.sourceListenKeys_=null,super.disposeInternal()}renderDeclutter(){}}function kh(i){const t=i.toString();return t.includes(".")?t:t+".0"}function YS(i){if(i.length<2||i.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return`vec${i.length}(${i.map(kh).join(", ")})`}function Pg(i){const t=Al(i),e=t.length>3?t[3]:1;return YS([t[0]/255*e,t[1]/255*e,t[2]/255*e,e])}const Ig={};let ZS=0;function KS(i){return i in Ig||(Ig[i]=ZS++),Ig[i]}function Vo(i){return kh(KS(i))}function $S(){return{"fill-color":"rgba(255,255,255,0.4)","stroke-color":"#3399CC","stroke-width":1.25,"circle-radius":5,"circle-fill-color":"rgba(255,255,255,0.4)","circle-stroke-width":1.25,"circle-stroke-color":"#3399CC"}}const Ho=`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
uniform mat4 u_projectionMatrix;
uniform mat4 u_screenToWorldMatrix;
uniform vec2 u_viewportSizePx;
uniform float u_pixelRatio;
uniform float u_globalAlpha;
uniform float u_time;
uniform float u_zoom;
uniform float u_resolution;
uniform float u_rotation;
uniform vec4 u_renderExtent;
uniform vec2 u_patternOrigin;
uniform float u_depth;
uniform mediump int u_hitDetection;

const float PI = 3.141592653589793238;
const float TWO_PI = 2.0 * PI;

// this used to produce an alpha-premultiplied color from a texture
vec4 samplePremultiplied(sampler2D sampler, vec2 texCoord) {
  vec4 color = texture2D(sampler, texCoord);
  return vec4(color.rgb * color.a, color.a);
}
`,Xo=$S();class JS{constructor(){this.uniforms_=[],this.attributes_=[],this.varyings_=[],this.hasSymbol_=!1,this.symbolSizeExpression_=`vec2(${kh(Xo["circle-radius"])} + ${kh(Xo["circle-stroke-width"]*.5)})`,this.symbolRotationExpression_="0.0",this.symbolOffsetExpression_="vec2(0.0)",this.symbolColorExpression_=Pg(Xo["circle-fill-color"]),this.texCoordExpression_="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression_="false",this.symbolRotateWithView_=!1,this.hasStroke_=!1,this.strokeWidthExpression_=kh(Xo["stroke-width"]),this.strokeColorExpression_=Pg(Xo["stroke-color"]),this.strokeOffsetExpression_="0.",this.strokeCapExpression_=Vo("round"),this.strokeJoinExpression_=Vo("round"),this.strokeMiterLimitExpression_="10.",this.strokeDistanceFieldExpression_="-1000.",this.hasFill_=!1,this.fillColorExpression_=Pg(Xo["fill-color"]),this.vertexShaderFunctions_=[],this.fragmentShaderFunctions_=[]}addUniform(t){return this.uniforms_.push(t),this}addAttribute(t){return this.attributes_.push(t),this}addVarying(t,e,n){return this.varyings_.push({name:t,type:e,expression:n}),this}setSymbolSizeExpression(t){return this.hasSymbol_=!0,this.symbolSizeExpression_=t,this}getSymbolSizeExpression(){return this.symbolSizeExpression_}setSymbolRotationExpression(t){return this.symbolRotationExpression_=t,this}setSymbolOffsetExpression(t){return this.symbolOffsetExpression_=t,this}getSymbolOffsetExpression(){return this.symbolOffsetExpression_}setSymbolColorExpression(t){return this.hasSymbol_=!0,this.symbolColorExpression_=t,this}getSymbolColorExpression(){return this.symbolColorExpression_}setTextureCoordinateExpression(t){return this.texCoordExpression_=t,this}setFragmentDiscardExpression(t){return this.discardExpression_=t,this}getFragmentDiscardExpression(){return this.discardExpression_}setSymbolRotateWithView(t){return this.symbolRotateWithView_=t,this}setStrokeWidthExpression(t){return this.hasStroke_=!0,this.strokeWidthExpression_=t,this}setStrokeColorExpression(t){return this.hasStroke_=!0,this.strokeColorExpression_=t,this}getStrokeColorExpression(){return this.strokeColorExpression_}setStrokeOffsetExpression(t){return this.strokeOffsetExpression_=t,this}setStrokeCapExpression(t){return this.strokeCapExpression_=t,this}setStrokeJoinExpression(t){return this.strokeJoinExpression_=t,this}setStrokeMiterLimitExpression(t){return this.strokeMiterLimitExpression_=t,this}setStrokeDistanceFieldExpression(t){return this.strokeDistanceFieldExpression_=t,this}setFillColorExpression(t){return this.hasFill_=!0,this.fillColorExpression_=t,this}getFillColorExpression(){return this.fillColorExpression_}addVertexShaderFunction(t){this.vertexShaderFunctions_.includes(t)||this.vertexShaderFunctions_.push(t)}addFragmentShaderFunction(t){this.fragmentShaderFunctions_.includes(t)||this.fragmentShaderFunctions_.push(t)}getSymbolVertexShader(){return this.hasSymbol_?`${Ho}
${this.uniforms_.map(function(t){return"uniform "+t+";"}).join(`
`)}
attribute vec2 a_position;
attribute float a_index;
attribute vec4 a_prop_hitColor;
${this.attributes_.map(function(t){return"attribute "+t+";"}).join(`
`)}
varying vec2 v_texCoord;
varying vec2 v_quadCoord;
varying vec4 v_prop_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;
${this.varyings_.map(function(t){return"varying "+t.type+" "+t.name+";"}).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 pxToScreen(vec2 coordPx) {
  vec2 scaled = coordPx / u_viewportSizePx / 0.5;
  return scaled;
}

vec2 screenToPx(vec2 coordScreen) {
  return (coordScreen * 0.5 + 0.5) * u_viewportSizePx;
}

void main(void) {
  v_quadSizePx = ${this.symbolSizeExpression_};
  vec2 halfSizePx = v_quadSizePx * 0.5;
  vec2 centerOffsetPx = ${this.symbolOffsetExpression_};
  vec2 offsetPx = centerOffsetPx;
  if (a_index == 0.0) {
    offsetPx -= halfSizePx;
  } else if (a_index == 1.0) {
    offsetPx += halfSizePx * vec2(1., -1.);
  } else if (a_index == 2.0) {
    offsetPx += halfSizePx;
  } else {
    offsetPx += halfSizePx * vec2(-1., 1.);
  }
  float angle = ${this.symbolRotationExpression_};
  ${this.symbolRotateWithView_?"angle += u_rotation;":""}
  float c = cos(-angle);
  float s = sin(-angle);
  offsetPx = vec2(c * offsetPx.x - s * offsetPx.y, s * offsetPx.x + c * offsetPx.y);
  vec4 center = u_projectionMatrix * vec4(a_position, 0.0, 1.0);
  gl_Position = center + vec4(pxToScreen(offsetPx), u_depth, 0.);
  vec4 texCoord = ${this.texCoordExpression_};
  float u = a_index == 0.0 || a_index == 3.0 ? texCoord.s : texCoord.p;
  float v = a_index == 2.0 || a_index == 3.0 ? texCoord.t : texCoord.q;
  v_texCoord = vec2(u, v);
  v_prop_hitColor = a_prop_hitColor;
  v_angle = angle;
  c = cos(-v_angle);
  s = sin(-v_angle);
  centerOffsetPx = vec2(c * centerOffsetPx.x - s * centerOffsetPx.y, s * centerOffsetPx.x + c * centerOffsetPx.y); 
  v_centerPx = screenToPx(center.xy) + centerOffsetPx;
${this.varyings_.map(function(t){return"  "+t.name+" = "+t.expression+";"}).join(`
`)}
}`:null}getSymbolFragmentShader(){return this.hasSymbol_?`${Ho}
${this.uniforms_.map(function(t){return"uniform "+t+";"}).join(`
`)}
varying vec2 v_texCoord;
varying vec4 v_prop_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;
${this.varyings_.map(function(t){return"varying "+t.type+" "+t.name+";"}).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

void main(void) {
  if (${this.discardExpression_}) { discard; }
  vec2 coordsPx = gl_FragCoord.xy / u_pixelRatio - v_centerPx; // relative to center
  float c = cos(v_angle);
  float s = sin(v_angle);
  coordsPx = vec2(c * coordsPx.x - s * coordsPx.y, s * coordsPx.x + c * coordsPx.y);
  gl_FragColor = ${this.symbolColorExpression_};
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.05) { discard; };
    gl_FragColor = v_prop_hitColor;
  }
}`:null}getStrokeVertexShader(){return this.hasStroke_?`${Ho}
${this.uniforms_.map(function(t){return"uniform "+t+";"}).join(`
`)}
attribute vec2 a_position;
attribute float a_index;
attribute vec2 a_segmentStart;
attribute vec2 a_segmentEnd;
attribute float a_parameters;
attribute float a_distance;
attribute vec2 a_joinAngles;
attribute vec4 a_prop_hitColor;
${this.attributes_.map(function(t){return"attribute "+t+";"}).join(`
`)}
varying vec2 v_segmentStart;
varying vec2 v_segmentEnd;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_prop_hitColor;
varying float v_distanceOffsetPx;
${this.varyings_.map(function(t){return"varying "+t.type+" "+t.name+";"}).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

vec4 pxToScreen(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return vec4(screenPos, u_depth, 1.0);
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

vec2 getJoinOffsetDirection(vec2 normalPx, float joinAngle) {
  float halfAngle = joinAngle / 2.0;
  float c = cos(halfAngle);
  float s = sin(halfAngle);
  vec2 angleBisectorNormal = vec2(s * normalPx.x + c * normalPx.y, -c * normalPx.x + s * normalPx.y);
  float length = 1.0 / s;
  return angleBisectorNormal * length;
}

vec2 getOffsetPoint(vec2 point, vec2 normal, float joinAngle, float offsetPx) {
  // if on a cap or the join angle is too high, offset the line along the segment normal
  if (cos(joinAngle) > 0.998 || isCap(joinAngle)) {
    return point - normal * offsetPx;
  }
  // offset is applied along the inverted normal (positive offset goes "right" relative to line direction)
  return point - getJoinOffsetDirection(normal, joinAngle) * offsetPx;
}

void main(void) {
  v_angleStart = a_joinAngles.x;
  v_angleEnd = a_joinAngles.y;
  float vertexNumber = floor(abs(a_parameters) / 10000. + 0.5);
  // we're reading the fractional part while keeping the sign (so -4.12 gives -0.12, 3.45 gives 0.45)
  float angleTangentSum = fract(abs(a_parameters) / 10000.) * 10000. * sign(a_parameters);

  float lineWidth = ${this.strokeWidthExpression_};
  float lineOffsetPx = ${this.strokeOffsetExpression_};

  // compute segment start/end in px with offset
  vec2 segmentStartPx = worldToPx(a_segmentStart);
  vec2 segmentEndPx = worldToPx(a_segmentEnd);
  vec2 tangentPx = normalize(segmentEndPx - segmentStartPx);
  vec2 normalPx = vec2(-tangentPx.y, tangentPx.x);
  segmentStartPx = getOffsetPoint(segmentStartPx, normalPx, v_angleStart, lineOffsetPx),
  segmentEndPx = getOffsetPoint(segmentEndPx, normalPx, v_angleEnd, lineOffsetPx);
  
  // compute current vertex position
  float normalDir = vertexNumber < 0.5 || (vertexNumber > 1.5 && vertexNumber < 2.5) ? 1.0 : -1.0;
  float tangentDir = vertexNumber < 1.5 ? 1.0 : -1.0;
  float angle = vertexNumber < 1.5 ? v_angleStart : v_angleEnd;
  vec2 joinDirection;
  vec2 positionPx = vertexNumber < 1.5 ? segmentStartPx : segmentEndPx;
  // if angle is too high, do not make a proper join
  if (cos(angle) > ${Jm} || isCap(angle)) {
    joinDirection = normalPx * normalDir - tangentPx * tangentDir;
  } else {
    joinDirection = getJoinOffsetDirection(normalPx * normalDir, angle);
  }
  positionPx = positionPx + joinDirection * (lineWidth * 0.5 + 1.); // adding 1 pixel for antialiasing
  gl_Position = pxToScreen(positionPx);

  v_segmentStart = segmentStartPx;
  v_segmentEnd = segmentEndPx;
  v_width = lineWidth;
  v_prop_hitColor = a_prop_hitColor;
  v_distanceOffsetPx = a_distance / u_resolution - (lineOffsetPx * angleTangentSum);
${this.varyings_.map(function(t){return"  "+t.name+" = "+t.expression+";"}).join(`
`)}
}`:null}getStrokeFragmentShader(){return this.hasStroke_?`${Ho}
${this.uniforms_.map(function(t){return"uniform "+t+";"}).join(`
`)}
varying vec2 v_segmentStart;
varying vec2 v_segmentEnd;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_prop_hitColor;
varying float v_distanceOffsetPx;
${this.varyings_.map(function(t){return"varying "+t.type+" "+t.name+";"}).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

float segmentDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  vec2 tangent = normalize(end - start);
  vec2 normal = vec2(-tangent.y, tangent.x);
  vec2 startToPoint = point - start;
  return abs(dot(startToPoint, normal)) - width * 0.5;
}

float buttCapDistanceField(vec2 point, vec2 start, vec2 end) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  return dot(startToPoint, -tangent);
}

float squareCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return buttCapDistanceField(point, start, end) - width * 0.5;
}

float roundCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  float onSegment = max(0., 1000. * dot(point - start, end - start)); // this is very high when inside the segment
  return length(point - start) - width * 0.5 - onSegment;
}

float roundJoinDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return roundCapDistanceField(point, start, end, width);
}

float bevelJoinField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  float c = cos(joinAngle * 0.5);
  float s = sin(joinAngle * 0.5);
  float direction = -sign(sin(joinAngle));
  vec2 bisector = vec2(c * tangent.x - s * tangent.y, s * tangent.x + c * tangent.y);
  float radius = width * 0.5 * s;
  return dot(startToPoint, bisector * direction) - radius;
}

float miterJoinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  if (cos(joinAngle) > ${Jm}) { // avoid risking a division by zero
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  float miterLength = 1. / sin(joinAngle * 0.5);
  float miterLimit = ${this.strokeMiterLimitExpression_};
  if (miterLength > miterLimit) {
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  return -1000.;
}

float capDistanceField(vec2 point, vec2 start, vec2 end, float width, float capType) {
   if (capType == ${Vo("butt")}) {
    return buttCapDistanceField(point, start, end);
  } else if (capType == ${Vo("square")}) {
    return squareCapDistanceField(point, start, end, width);
  }
  return roundCapDistanceField(point, start, end, width);
}

float joinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float joinType) {
  if (joinType == ${Vo("bevel")}) {
    return bevelJoinField(point, start, end, width, joinAngle);
  } else if (joinType == ${Vo("miter")}) {
    return miterJoinDistanceField(point, start, end, width, joinAngle);
  }
  return roundJoinDistanceField(point, start, end, width);
}

float computeSegmentPointDistance(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float capType, float joinType) {
  if (isCap(joinAngle)) {
    return capDistanceField(point, start, end, width, capType);
  }
  return joinDistanceField(point, start, end, width, joinAngle, joinType);
}

void main(void) {
  vec2 currentPoint = gl_FragCoord.xy / u_pixelRatio;
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(currentPoint);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif
  if (${this.discardExpression_}) { discard; }

  float segmentLength = length(v_segmentEnd - v_segmentStart);
  vec2 segmentTangent = (v_segmentEnd - v_segmentStart) / segmentLength;
  vec2 segmentNormal = vec2(-segmentTangent.y, segmentTangent.x);
  vec2 startToPoint = currentPoint - v_segmentStart;
  float currentLengthPx = max(0., min(dot(segmentTangent, startToPoint), segmentLength)) + v_distanceOffsetPx; 
  float currentRadiusPx = abs(dot(segmentNormal, startToPoint));
  float currentRadiusRatio = dot(segmentNormal, startToPoint) * 2. / v_width;
  vec4 color = ${this.strokeColorExpression_} * u_globalAlpha;
  float capType = ${this.strokeCapExpression_};
  float joinType = ${this.strokeJoinExpression_};
  float segmentStartDistance = computeSegmentPointDistance(currentPoint, v_segmentStart, v_segmentEnd, v_width, v_angleStart, capType, joinType);
  float segmentEndDistance = computeSegmentPointDistance(currentPoint, v_segmentEnd, v_segmentStart, v_width, v_angleEnd, capType, joinType);
  float distance = max(
    segmentDistanceField(currentPoint, v_segmentStart, v_segmentEnd, v_width),
    max(segmentStartDistance, segmentEndDistance)
  );
  distance = max(distance, ${this.strokeDistanceFieldExpression_});
  gl_FragColor = color * smoothstep(0.5, -0.5, distance);
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_prop_hitColor;
  }
}`:null}getFillVertexShader(){return this.hasFill_?`${Ho}
${this.uniforms_.map(function(t){return"uniform "+t+";"}).join(`
`)}
attribute vec2 a_position;
attribute vec4 a_prop_hitColor;
${this.attributes_.map(function(t){return"attribute "+t+";"}).join(`
`)}
varying vec4 v_prop_hitColor;
${this.varyings_.map(function(t){return"varying "+t.type+" "+t.name+";"}).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
void main(void) {
  gl_Position = u_projectionMatrix * vec4(a_position, u_depth, 1.0);
  v_prop_hitColor = a_prop_hitColor;
${this.varyings_.map(function(t){return"  "+t.name+" = "+t.expression+";"}).join(`
`)}
}`:null}getFillFragmentShader(){return this.hasFill_?`${Ho}
${this.uniforms_.map(function(t){return"uniform "+t+";"}).join(`
`)}
varying vec4 v_prop_hitColor;
${this.varyings_.map(function(t){return"varying "+t.type+" "+t.name+";"}).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}
vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

void main(void) {
  vec2 pxPos = gl_FragCoord.xy / u_pixelRatio;
  vec2 pxOrigin = worldToPx(u_patternOrigin);
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(pxPos);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif
  if (${this.discardExpression_}) { discard; }
  gl_FragColor = ${this.fillColorExpression_} * u_globalAlpha;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_prop_hitColor;
  }
}`:null}}const Ar={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},QS=["#00f","#0ff","#0f0","#ff0","#f00"];class tL extends yc{constructor(t){t=t||{};const e=Object.assign({},t);delete e.gradient,delete e.radius,delete e.blur,delete e.weight,super(e),this.gradient_=null,this.addChangeListener(Ar.GRADIENT,this.handleGradientChanged_),this.setGradient(t.gradient?t.gradient:QS),this.setBlur(t.blur!==void 0?t.blur:15),this.setRadius(t.radius!==void 0?t.radius:8);const n=t.weight?t.weight:"weight";typeof n=="string"?this.weightFunction_=function(r){return r.get(n)}:this.weightFunction_=n,this.setRenderOrder(null)}getBlur(){return this.get(Ar.BLUR)}getGradient(){return this.get(Ar.GRADIENT)}getRadius(){return this.get(Ar.RADIUS)}handleGradientChanged_(){this.gradient_=eL(this.getGradient())}setBlur(t){this.set(Ar.BLUR,t)}setGradient(t){this.set(Ar.GRADIENT,t)}setRadius(t){this.set(Ar.RADIUS,t)}createRenderer(){const t=new JS().addAttribute("float a_prop_weight").addVarying("v_prop_weight","float","a_prop_weight").addUniform("float u_size").addUniform("float u_blurSlope").setSymbolSizeExpression("vec2(u_size)").setSymbolColorExpression("vec4(smoothstep(0., 1., (1. - length(coordsPx * 2. / v_quadSizePx)) * u_blurSlope) * v_prop_weight)");return new XS(this,{className:this.getClassName(),attributes:[{name:"weight",callback:e=>{const n=this.weightFunction_(e);return n!==void 0?hi(n,0,1):1}}],uniforms:{u_size:()=>(this.get(Ar.RADIUS)+this.get(Ar.BLUR))*2,u_blurSlope:()=>this.get(Ar.RADIUS)/Math.max(1,this.get(Ar.BLUR))},hitDetectionEnabled:!0,vertexShader:t.getSymbolVertexShader(),fragmentShader:t.getSymbolFragmentShader(),postProcesses:[{fragmentShader:`
            precision mediump float;

            uniform sampler2D u_image;
            uniform sampler2D u_gradientTexture;
            uniform float u_opacity;

            varying vec2 v_texCoord;

            void main() {
              vec4 color = texture2D(u_image, v_texCoord);
              gl_FragColor.a = color.a * u_opacity;
              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;
              gl_FragColor.rgb *= gl_FragColor.a;
            }`,uniforms:{u_gradientTexture:()=>this.gradient_,u_opacity:()=>this.getOpacity()}}]})}renderDeclutter(){}}function eL(i){const n=Ki(1,256),r=n.createLinearGradient(0,0,1,256),s=1/(i.length-1);for(let a=0,o=i.length;a<o;++a)r.addColorStop(a*s,i[a]);return n.fillStyle=r,n.fillRect(0,0,1,256),n.canvas}const iL=tL,nL={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},Qm={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]};class rL extends Tv{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.renderedLayerRevision_,this.renderedPixelToCoordinateTransform_=null,this.renderedRotation_,this.renderedOpacity_=1,this.tmpTransform_=Bi(),this.tileClipContexts_=null}prepareTile(t,e,n){let r;const s=t.getState();return(s===Zt.LOADED||s===Zt.ERROR)&&(this.updateExecutorGroup_(t,e,n),this.tileImageNeedsRender_(t)&&(r=!0)),r}getTile(t,e,n,r){const s=r.pixelRatio,a=r.viewState,o=a.resolution,l=a.projection,h=this.getLayer(),c=h.getSource().getTile(t,e,n,s,l),f=r.viewHints,g=!(f[ri.ANIMATING]||f[ri.INTERACTING]);return(g||!c.wantedResolution)&&(c.wantedResolution=o),this.prepareTile(c,s,l)&&(g||Date.now()-r.time<8)&&h.getRenderMode()!=="vector"&&this.renderTileImage_(c,r),super.getTile(t,e,n,r)}isDrawableTile(t){const e=this.getLayer();return super.isDrawableTile(t)&&(e.getRenderMode()==="vector"?Qt(e)in t.executorGroups:t.hasContext(e))}getTileImage(t){return t.getImage(this.getLayer())}prepareFrame(t){const e=this.getLayer().getRevision();return this.renderedLayerRevision_!==e&&(this.renderedLayerRevision_=e,this.renderedTiles.length=0),super.prepareFrame(t)}updateExecutorGroup_(t,e,n){var b;const r=this.getLayer(),s=r.getRevision(),a=r.getRenderOrder()||null,o=t.wantedResolution,l=t.getReplayState(r);if(!l.dirty&&l.renderedResolution===o&&l.renderedRevision==s&&l.renderedRenderOrder==a)return;const h=r.getSource(),c=!!r.getDeclutter(),f=h.getTileGrid(),d=h.getTileGridForProjection(n).getTileCoordExtent(t.wrappedTileCoord),m=h.getSourceTiles(e,n,t),y=Qt(r);delete t.hitDetectionImageData[y],t.executorGroups[y]=[],l.dirty=!1;for(let x=0,E=m.length;x<E;++x){const S=m[x];if(S.getState()!=Zt.LOADED)continue;const M=S.tileCoord,D=f.getTileCoordExtent(M),W=Ka(d,D),j=va(W,r.getRenderBuffer()*o,this.tmpExtent),P=to(D,W)?null:j,H=new V_(0,W,o,e),et=l0(o,e),R=function(Y,st){let Q;const gt=Y.getStyleFunction()||r.getStyleFunction();if(gt&&(Q=gt(Y,o)),Q){const lt=this.renderFeature(Y,et,Q,H,c,st);l.dirty=l.dirty||lt}},F=S.getFeatures();a&&a!==l.renderedRenderOrder&&F.sort(a);for(let Y=0,st=F.length;Y<st;++Y){const Q=F[Y];(!P||ki(P,Q.getGeometry().getExtent()))&&R.call(this,Q,Y)}const U=H.finish(),z=r.getRenderMode()!=="vector"&&c&&m.length===1?null:W,it=new X_(z,o,e,h.getOverlaps(),U,r.getRenderBuffer(),!!((b=this.frameState)!=null&&b.declutter));t.executorGroups[y].push(it)}l.renderedRevision=s,l.renderedRenderOrder=a,l.renderedResolution=o}forEachFeatureAtCoordinate(t,e,n,r,s){const a=e.viewState.resolution,o=e.viewState.rotation;n=n??0;const l=this.getLayer(),c=l.getSource().getTileGridForProjection(e.viewState.projection),f=Qu([t]);va(f,a*n,f);const g={},d=function(b,x,E){let S=b.getId();S===void 0&&(S=Qt(b));const M=g[S];if(M){if(M!==!0&&E<M.distanceSq){if(E===0)return g[S]=!0,s.splice(s.lastIndexOf(M),1),r(b,l,x);M.geometry=x,M.distanceSq=E}}else{if(E===0)return g[S]=!0,r(b,l,x);s.push(g[S]={feature:b,layer:l,geometry:x,distanceSq:E,callback:r})}},m=this.renderedTiles;let y;for(let b=0,x=m.length;!y&&b<x;++b){const E=m[b],S=c.getTileCoordExtent(E.wrappedTileCoord);if(!ki(S,f))continue;const M=Qt(l),D=[E.executorGroups[M]],W=l.getDeclutter();D.some(j=>{const P=W?e.declutter[W].all().map(H=>H.value):null;for(let H=0,et=j.length;H<et;++H)if(y=j[H].forEachFeatureAtCoordinate(t,a,o,n,d,P),y)return!0})}return y}getFeatures(t){return new Promise((e,n)=>{const r=this.getLayer(),s=Qt(r),a=r.getSource(),o=this.renderedProjection,l=o.getExtent(),h=this.renderedResolution,c=a.getTileGridForProjection(o),f=xi(this.renderedPixelToCoordinateTransform_,t.slice()),g=c.getTileCoordForCoordAndResolution(f,h);let d;for(let S=0,M=this.renderedTiles.length;S<M;++S)if(g.toString()===this.renderedTiles[S].tileCoord.toString()){if(d=this.renderedTiles[S],d.getState()===Zt.LOADED){const D=c.getTileCoordExtent(d.tileCoord);a.getWrapX()&&o.canWrapX()&&!As(l,D)&&Df(f,o);break}d=void 0}if(!d||d.loadingSourceTiles>0){e([]);return}const m=c.getTileCoordExtent(d.wrappedTileCoord),y=Aa(m),b=[(f[0]-y[0])/h,(y[1]-f[1])/h],x=d.getSourceTiles().reduce(function(S,M){return S.concat(M.getFeatures())},[]);let E=d.hitDetectionImageData[s];if(!E){const S=kn(c.getTileSize(c.getZForResolution(h,a.zDirection))),M=this.renderedRotation_,D=[this.getRenderTransform(c.getTileCoordCenter(d.wrappedTileCoord),h,0,Kn,S[0]*Kn,S[1]*Kn,0)];E=Y_(S,D,x,r.getStyleFunction(),c.getTileCoordExtent(d.wrappedTileCoord),d.getReplayState(r).renderedResolution,M),d.hitDetectionImageData[s]=E}e(Z_(b,x,E))})}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.renderedLayerRevision_!==void 0&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}renderDeclutter(t,e){const n=this.context,r=n.globalAlpha;n.globalAlpha=e.opacity;const s=t.viewHints,a=!(s[ri.ANIMATING]||s[ri.INTERACTING]),o=this.renderedTiles;for(let l=0,h=o.length;l<h;++l){const c=o[l],f=c.executorGroups[Qt(this.getLayer())],g=this.getLayer().getDeclutter();if(f)for(let d=f.length-1;d>=0;--d)f[d].execute(this.context,[this.context.canvas.width,this.context.canvas.height],this.getTileRenderTransform(c,t),t.viewState.rotation,a,_f,g?t.declutter[g]:void 0)}n.globalAlpha=r}renderDeferredInternal(t){const n=this.renderedTiles.reduce((a,o,l)=>(o.executorGroups[Qt(this.getLayer())].forEach(h=>a.push({executorGroup:h,index:l})),a),[]),r=n.map(({executorGroup:a})=>a.getDeferredZIndexContexts());r.map(a=>Object.keys(a)).flat().sort(Rs).map(Number).forEach(a=>{r.forEach((o,l)=>{o[a]&&o[a].forEach(h=>{const{executorGroup:c,index:f}=n[l],g=c.getRenderedContext(),d=g.globalAlpha;g.globalAlpha=this.renderedOpacity_;const m=this.tileClipContexts_[f];m&&m.draw(g),h.draw(g),m&&g.restore(),g.globalAlpha=d,h.clear()})})})}getTileRenderTransform(t,e){const n=e.pixelRatio,r=e.viewState,s=r.center,a=r.resolution,o=r.rotation,l=e.size,h=Math.round(l[0]*n),c=Math.round(l[1]*n),g=this.getLayer().getSource().getTileGridForProjection(e.viewState.projection),d=t.tileCoord,m=g.getTileCoordExtent(t.wrappedTileCoord),y=g.getTileCoordExtent(d,this.tmpExtent)[0]-m[0];return Bf(tg(this.inversePixelTransform.slice(),1/n,1/n),this.getRenderTransform(s,a,o,n,h,c,y))}postRender(t,e){const n=e.viewHints,r=!(n[ri.ANIMATING]||n[ri.INTERACTING]);this.renderedPixelToCoordinateTransform_=e.pixelToCoordinateTransform.slice(),this.renderedRotation_=e.viewState.rotation,this.renderedOpacity_=e.layerStatesArray[e.layerIndex].opacity;const s=this.getLayer(),a=s.getRenderMode(),o=t.globalAlpha;t.globalAlpha=this.renderedOpacity_;const l=s.getDeclutter(),h=l?Qm[a].filter(M=>!_f.includes(M)):Qm[a],c=e.viewState,f=c.rotation,g=s.getSource(),m=g.getTileGridForProjection(c.projection).getZForResolution(c.resolution,g.zDirection),y=this.renderedTiles,b=[],x=[],E=[];let S=!0;for(let M=y.length-1;M>=0;--M){const D=y[M];S=S&&!D.getReplayState(s).dirty;const W=D.executorGroups[Qt(s)].filter(U=>U.hasExecutors(h));if(W.length===0)continue;const j=this.getTileRenderTransform(D,e),P=D.tileCoord[0];let H=!1;const et=W[0].getClipCoords(j);let R=t,F;if(et){l&&(F=new E1,R=F.getContext());for(let U=0,z=b.length;U<z;++U)if(m!==P&&P<x[U]){const it=b[U];ki([et[0],et[3],et[4],et[7]],[it[0],it[3],it[4],it[7]])&&(H||(R.save(),H=!0),R.beginPath(),R.moveTo(et[0],et[1]),R.lineTo(et[2],et[3]),R.lineTo(et[4],et[5]),R.lineTo(et[6],et[7]),R.moveTo(it[6],it[7]),R.lineTo(it[4],it[5]),R.lineTo(it[2],it[3]),R.lineTo(it[0],it[1]),R.clip())}b.push(et),x.push(P)}for(let U=0,z=W.length;U<z;++U)W[U].execute(t,[t.canvas.width,t.canvas.height],j,f,r,h);H&&(R===t?R.restore():E[M]=F)}t.globalAlpha=o,this.ready=S,this.tileClipContexts_=E,super.postRender(t,e)}renderFeature(t,e,n,r,s,a){if(!n)return!1;let o=!1;if(Array.isArray(n))for(let l=0,h=n.length;l<h;++l)o=vf(r,t,n[l],e,this.boundHandleStyleImageChange_,void 0,s,a)||o;else o=vf(r,t,n,e,this.boundHandleStyleImageChange_,void 0,s,a);return o}tileImageNeedsRender_(t){const e=this.getLayer();if(e.getRenderMode()==="vector")return!1;const n=t.getReplayState(e),r=e.getRevision(),s=t.wantedResolution;return n.renderedTileResolution!==s||n.renderedTileRevision!==r}renderTileImage_(t,e){const n=this.getLayer(),r=t.getReplayState(n),s=n.getRevision(),a=t.executorGroups[Qt(n)];r.renderedTileRevision=s;const o=t.wrappedTileCoord,l=o[0],h=n.getSource();let c=e.pixelRatio;const g=e.viewState.projection,d=h.getTileGridForProjection(g),m=d.getResolution(t.tileCoord[0]),y=e.pixelRatio/t.wantedResolution*m,b=d.getResolution(l),x=t.getContext(n);c=Math.round(Math.max(c,y/c));const E=h.getTilePixelSize(l,c,g);x.canvas.width=E[0],x.canvas.height=E[1];const S=c/y;if(S!==1){const j=Up(this.tmpTransform_);tg(j,S,S),x.setTransform.apply(x,j)}const M=d.getTileCoordExtent(o,this.tmpExtent),D=y/b,W=Up(this.tmpTransform_);tg(W,D,-D),Z2(W,-M[0],-M[3]);for(let j=0,P=a.length;j<P;++j)a[j].execute(x,[x.canvas.width*S,x.canvas.height*S],W,0,!0,nL[n.getRenderMode()],null);r.renderedTileResolution=t.wantedResolution}}class sL extends yc{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un;const n=t.renderMode||"hybrid";Ce(n=="hybrid"||n=="vector","`renderMode` must be `'hybrid'` or `'vector'`"),this.renderMode_=n,this.setPreload(t.preload?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0),this.getBackground,this.setBackground}createRenderer(){return new rL(this)}getFeatures(t){return super.getFeatures(t)}getRenderMode(){return this.renderMode_}getPreload(){return this.get(da.PRELOAD)}getUseInterimTilesOnError(){return this.get(da.USE_INTERIM_TILES_ON_ERROR)}setPreload(t){this.set(da.PRELOAD,t)}setUseInterimTilesOnError(t){this.set(da.USE_INTERIM_TILES_ON_ERROR,t)}}const aL=sL,t2=["fullscreenchange","webkitfullscreenchange","MSFullscreenChange"],e2={ENTERFULLSCREEN:"enterfullscreen",LEAVEFULLSCREEN:"leavefullscreen"};class oL extends ur{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target}),this.on,this.once,this.un,this.keys_=t.keys!==void 0?t.keys:!1,this.source_=t.source,this.isInFullscreen_=!1,this.boundHandleMapTargetChange_=this.handleMapTargetChange_.bind(this),this.cssClassName_=t.className!==void 0?t.className:"ol-full-screen",this.documentListeners_=[],this.activeClassName_=t.activeClassName!==void 0?t.activeClassName.split(" "):[this.cssClassName_+"-true"],this.inactiveClassName_=t.inactiveClassName!==void 0?t.inactiveClassName.split(" "):[this.cssClassName_+"-false"];const e=t.label!==void 0?t.label:"⤢";this.labelNode_=typeof e=="string"?document.createTextNode(e):e;const n=t.labelActive!==void 0?t.labelActive:"×";this.labelActiveNode_=typeof n=="string"?document.createTextNode(n):n;const r=t.tipLabel?t.tipLabel:"Toggle full-screen";this.button_=document.createElement("button"),this.button_.title=r,this.button_.setAttribute("type","button"),this.button_.appendChild(this.labelNode_),this.button_.addEventListener(le.CLICK,this.handleClick_.bind(this),!1),this.setClassName_(this.button_,this.isInFullscreen_),this.element.className=`${this.cssClassName_} ${jl} ${_c}`,this.element.appendChild(this.button_)}handleClick_(t){t.preventDefault(),this.handleFullScreen_()}handleFullScreen_(){const t=this.getMap();if(!t)return;const e=t.getOwnerDocument();if(i2(e))if(n2(e))hL(e);else{let n;this.source_?n=typeof this.source_=="string"?e.getElementById(this.source_):this.source_:n=t.getTargetElement(),this.keys_?lL(n):kv(n)}}handleFullScreenChange_(){const t=this.getMap();if(!t)return;const e=this.isInFullscreen_;this.isInFullscreen_=n2(t.getOwnerDocument()),e!==this.isInFullscreen_&&(this.setClassName_(this.button_,this.isInFullscreen_),this.isInFullscreen_?(rf(this.labelActiveNode_,this.labelNode_),this.dispatchEvent(e2.ENTERFULLSCREEN)):(rf(this.labelNode_,this.labelActiveNode_),this.dispatchEvent(e2.LEAVEFULLSCREEN)),t.updateSize())}setClassName_(t,e){e?(t.classList.remove(...this.inactiveClassName_),t.classList.add(...this.activeClassName_)):(t.classList.remove(...this.activeClassName_),t.classList.add(...this.inactiveClassName_))}setMap(t){const e=this.getMap();e&&e.removeChangeListener(Vi.TARGET,this.boundHandleMapTargetChange_),super.setMap(t),this.handleMapTargetChange_(),t&&t.addChangeListener(Vi.TARGET,this.boundHandleMapTargetChange_)}handleMapTargetChange_(){const t=this.documentListeners_;for(let n=0,r=t.length;n<r;++n)Ke(t[n]);t.length=0;const e=this.getMap();if(e){const n=e.getOwnerDocument();i2(n)?this.element.classList.remove(Jp):this.element.classList.add(Jp);for(let r=0,s=t2.length;r<s;++r)t.push(_e(n,t2[r],this.handleFullScreenChange_,this));this.handleFullScreenChange_()}}}function i2(i){const t=i.body;return!!(t.webkitRequestFullscreen||t.requestFullscreen&&i.fullscreenEnabled)}function n2(i){return!!(i.webkitIsFullScreen||i.fullscreenElement)}function kv(i){i.requestFullscreen?i.requestFullscreen():i.webkitRequestFullscreen&&i.webkitRequestFullscreen()}function lL(i){i.webkitRequestFullscreen?i.webkitRequestFullscreen():kv(i)}function hL(i){i.exitFullscreen?i.exitFullscreen():i.webkitExitFullscreen&&i.webkitExitFullscreen()}const Rg="projection",r2="coordinateFormat";class cL extends ur{constructor(t){t=t||{};const e=document.createElement("div");e.className=t.className!==void 0?t.className:"ol-mouse-position",super({element:e,render:t.render,target:t.target}),this.on,this.once,this.un,this.addChangeListener(Rg,this.handleProjectionChanged_),t.coordinateFormat&&this.setCoordinateFormat(t.coordinateFormat),t.projection&&this.setProjection(t.projection),this.renderOnMouseOut_=t.placeholder!==void 0,this.placeholder_=this.renderOnMouseOut_?t.placeholder:"&#160;",this.renderedHTML_=e.innerHTML,this.mapProjection_=null,this.transform_=null,this.wrapX_=t.wrapX!==!1}handleProjectionChanged_(){this.transform_=null}getCoordinateFormat(){return this.get(r2)}getProjection(){return this.get(Rg)}handleMouseMove(t){const e=this.getMap();this.updateHTML_(e.getEventPixel(t))}handleMouseOut(t){this.updateHTML_(null)}setMap(t){if(super.setMap(t),t){const e=t.getViewport();this.listenerKeys.push(_e(e,tc.POINTERMOVE,this.handleMouseMove,this)),this.renderOnMouseOut_&&this.listenerKeys.push(_e(e,tc.POINTEROUT,this.handleMouseOut,this)),this.updateHTML_(null)}}setCoordinateFormat(t){this.set(r2,t)}setProjection(t){this.set(Rg,ti(t))}updateHTML_(t){let e=this.placeholder_;if(t&&this.mapProjection_){if(!this.transform_){const s=this.getProjection();s?this.transform_=gc(this.mapProjection_,s):this.transform_=q0}const r=this.getMap().getCoordinateFromPixelInternal(t);if(r){if(this.transform_(r,r),this.wrapX_){const a=this.getProjection()||this.mapProjection_;Df(r,a)}const s=this.getCoordinateFormat();s?e=s(r):e=r.toString()}}(!this.renderedHTML_||e!==this.renderedHTML_)&&(this.element.innerHTML=e,this.renderedHTML_=e)}render(t){const e=t.frameState;e?this.mapProjection_!=e.viewState.projection&&(this.mapProjection_=e.viewState.projection,this.transform_=null):this.mapProjection_=null}}const uL=cL;class fL extends ur{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target}),this.extent=t.extent?t.extent:null;const e=t.className!==void 0?t.className:"ol-zoom-extent",n=t.label!==void 0?t.label:"E",r=t.tipLabel!==void 0?t.tipLabel:"Fit to extent",s=document.createElement("button");s.setAttribute("type","button"),s.title=r,s.appendChild(typeof n=="string"?document.createTextNode(n):n),s.addEventListener(le.CLICK,this.handleClick_.bind(this),!1);const a=e+" "+jl+" "+_c,o=this.element;o.className=a,o.appendChild(s)}handleClick_(t){t.preventDefault(),this.handleZoomToExtent()}handleZoomToExtent(){const e=this.getMap().getView(),n=this.extent?Yr(this.extent,e.getProjection()):e.getProjection().getExtent();e.fitInternal(Kg(n))}}const dL=fL;class gL extends oo{constructor(t){t=t||{},super(t),this.condition_=t.condition?t.condition:$f,this.lastAngle_=void 0,this.lastMagnitude_=void 0,this.lastScaleDelta_=0,this.duration_=t.duration!==void 0?t.duration:400}handleDragEvent(t){if(!gl(t))return;const e=t.map,n=e.getSize(),r=t.pixel,s=r[0]-n[0]/2,a=n[1]/2-r[1],o=Math.atan2(a,s),l=Math.sqrt(s*s+a*a),h=e.getView();if(this.lastAngle_!==void 0){const c=this.lastAngle_-o;h.adjustRotationInternal(c)}this.lastAngle_=o,this.lastMagnitude_!==void 0&&h.adjustResolutionInternal(this.lastMagnitude_/l),this.lastMagnitude_!==void 0&&(this.lastScaleDelta_=this.lastMagnitude_/l),this.lastMagnitude_=l}handleUpEvent(t){if(!gl(t))return!0;const n=t.map.getView(),r=this.lastScaleDelta_>1?1:-1;return n.endInteraction(this.duration_,r),this.lastScaleDelta_=0,!1}handleDownEvent(t){return gl(t)&&this.condition_(t)?(t.map.getView().beginInteraction(),this.lastAngle_=void 0,this.lastMagnitude_=void 0,!0):!1}}const pL=gL,mL={SELECT:"select"};class _L extends Nr{constructor(t,e,n,r){super(t),this.selected=e,this.deselected=n,this.mapBrowserEvent=r}}const Du={};class O1 extends zl{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=t.condition?t.condition:O_,this.addCondition_=t.addCondition?t.addCondition:s0,this.removeCondition_=t.removeCondition?t.removeCondition:s0,this.toggleCondition_=t.toggleCondition?t.toggleCondition:$f,this.multi_=t.multi?t.multi:!1,this.filter_=t.filter?t.filter:_a,this.hitTolerance_=t.hitTolerance?t.hitTolerance:0,this.style_=t.style!==void 0?t.style:vL(),this.features_=t.features||new Tr;let e;if(t.layers)if(typeof t.layers=="function")e=t.layers;else{const n=t.layers;e=function(r){return n.includes(r)}}else e=_a;this.layerFilter_=e,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(t,e){this.featureLayerAssociation_[Qt(t)]=e}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(t){return this.featureLayerAssociation_[Qt(t)]}setHitTolerance(t){this.hitTolerance_=t}setMap(t){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(t),t?(this.features_.addEventListener(Yi.ADD,this.boundAddFeature_),this.features_.addEventListener(Yi.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(Yi.ADD,this.boundAddFeature_),this.features_.removeEventListener(Yi.REMOVE,this.boundRemoveFeature_))}addFeature_(t){const e=t.element;if(this.style_&&this.applySelectedStyle_(e),!this.getLayer(e)){const n=this.getMap().getAllLayers().find(function(r){if(r instanceof li&&r.getSource()&&r.getSource().hasFeature(e))return r});n&&this.addFeatureLayerAssociation_(e,n)}}removeFeature_(t){this.style_&&this.restorePreviousStyle_(t.element)}getStyle(){return this.style_}applySelectedStyle_(t){const e=Qt(t);e in Du||(Du[e]=t.getStyle()),t.setStyle(this.style_)}restorePreviousStyle_(t){const e=this.getMap().getInteractions().getArray();for(let r=e.length-1;r>=0;--r){const s=e[r];if(s!==this&&s instanceof O1&&s.getStyle()&&s.getFeatures().getArray().lastIndexOf(t)!==-1){t.setStyle(s.getStyle());return}}const n=Qt(t);t.setStyle(Du[n]),delete Du[n]}removeFeatureLayerAssociation_(t){delete this.featureLayerAssociation_[Qt(t)]}handleEvent(t){if(!this.condition_(t))return!0;const e=this.addCondition_(t),n=this.removeCondition_(t),r=this.toggleCondition_(t),s=!e&&!n&&!r,a=t.map,o=this.getFeatures(),l=[],h=[];if(s){ro(this.featureLayerAssociation_),a.forEachFeatureAtPixel(t.pixel,(c,f)=>{if(!(!(c instanceof lr)||!this.filter_(c,f)))return this.addFeatureLayerAssociation_(c,f),h.push(c),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let c=o.getLength()-1;c>=0;--c){const f=o.item(c),g=h.indexOf(f);g>-1?h.splice(g,1):(o.remove(f),l.push(f))}h.length!==0&&o.extend(h)}else{a.forEachFeatureAtPixel(t.pixel,(c,f)=>{if(!(!(c instanceof lr)||!this.filter_(c,f)))return(e||r)&&!o.getArray().includes(c)?(this.addFeatureLayerAssociation_(c,f),h.push(c)):(n||r)&&o.getArray().includes(c)&&(l.push(c),this.removeFeatureLayerAssociation_(c)),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let c=l.length-1;c>=0;--c)o.remove(l[c]);o.extend(h)}return(h.length>0||l.length>0)&&this.dispatchEvent(new _L(mL.SELECT,h,l,t)),!0}}function vL(){const i=w_();return $n(i.Polygon,i.LineString),$n(i.GeometryCollection,i.LineString),function(t){return t.getGeometry()?i[t.getGeometry().getType()]:null}}const Dv=O1;function yL(i){const t=Object.keys(i.defs),e=t.length;let n,r;for(n=0;n<e;++n){const s=t[n];if(!ti(s)){const a=i.defs(s);let o=a.units;!o&&a.projName==="longlat"&&(o="degrees"),V2(new k0({code:s,axisOrientation:a.axis,metersPerUnit:a.to_meter,units:o}))}}for(n=0;n<e;++n){const s=t[n],a=ti(s);for(r=0;r<e;++r){const o=t[r],l=ti(o);if(!I2(s,o))if(i.defs[s]===i.defs[o])Hg([a,l]);else{const h=i(s,o);B5(a,l,Bp(a,l,h.forward),Bp(l,a,h.inverse))}}}}function xL(i){i("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),i("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),i("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),i.WGS84=i["EPSG:4326"],i["EPSG:3785"]=i["EPSG:3857"],i.GOOGLE=i["EPSG:3857"],i["EPSG:900913"]=i["EPSG:3857"],i["EPSG:102113"]=i["EPSG:3857"]}var io=1,no=2,xl=3,bL=4,M0=5,s2=6378137,wL=6356752314e-3,a2=.0066943799901413165,Dh=484813681109536e-20,Mt=Math.PI/2,EL=.16666666666666666,SL=.04722222222222222,LL=.022156084656084655,kt=1e-10,tn=.017453292519943295,Jr=57.29577951308232,Ge=Math.PI/4,ac=Math.PI*2,Ai=3.14159265359,zn={};zn.greenwich=0;zn.lisbon=-9.131906111111;zn.paris=2.337229166667;zn.bogota=-74.080916666667;zn.madrid=-3.687938888889;zn.rome=12.452333333333;zn.bern=7.439583333333;zn.jakarta=106.807719444444;zn.ferro=-17.666666666667;zn.brussels=4.367975;zn.stockholm=18.058277777778;zn.athens=23.7163375;zn.oslo=10.722916666667;const CL={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}};var o2=/[\s_\-\/\(\)]/g;function La(i,t){if(i[t])return i[t];for(var e=Object.keys(i),n=t.toLowerCase().replace(o2,""),r=-1,s,a;++r<e.length;)if(s=e[r],a=s.toLowerCase().replace(o2,""),a===n)return i[s]}function T0(i){var t={},e=i.split("+").map(function(o){return o.trim()}).filter(function(o){return o}).reduce(function(o,l){var h=l.split("=");return h.push(!0),o[h[0].toLowerCase()]=h[1],o},{}),n,r,s,a={proj:"projName",datum:"datumCode",rf:function(o){t.rf=parseFloat(o)},lat_0:function(o){t.lat0=o*tn},lat_1:function(o){t.lat1=o*tn},lat_2:function(o){t.lat2=o*tn},lat_ts:function(o){t.lat_ts=o*tn},lon_0:function(o){t.long0=o*tn},lon_1:function(o){t.long1=o*tn},lon_2:function(o){t.long2=o*tn},alpha:function(o){t.alpha=parseFloat(o)*tn},gamma:function(o){t.rectified_grid_angle=parseFloat(o)},lonc:function(o){t.longc=o*tn},x_0:function(o){t.x0=parseFloat(o)},y_0:function(o){t.y0=parseFloat(o)},k_0:function(o){t.k0=parseFloat(o)},k:function(o){t.k0=parseFloat(o)},a:function(o){t.a=parseFloat(o)},b:function(o){t.b=parseFloat(o)},r:function(o){t.a=t.b=parseFloat(o)},r_a:function(){t.R_A=!0},zone:function(o){t.zone=parseInt(o,10)},south:function(){t.utmSouth=!0},towgs84:function(o){t.datum_params=o.split(",").map(function(l){return parseFloat(l)})},to_meter:function(o){t.to_meter=parseFloat(o)},units:function(o){t.units=o;var l=La(CL,o);l&&(t.to_meter=l.to_meter)},from_greenwich:function(o){t.from_greenwich=o*tn},pm:function(o){var l=La(zn,o);t.from_greenwich=(l||parseFloat(o))*tn},nadgrids:function(o){o==="@null"?t.datumCode="none":t.nadgrids=o},axis:function(o){var l="ewnsud";o.length===3&&l.indexOf(o.substr(0,1))!==-1&&l.indexOf(o.substr(1,1))!==-1&&l.indexOf(o.substr(2,1))!==-1&&(t.axis=o)},approx:function(){t.approx=!0}};for(n in e)r=e[n],n in a?(s=a[n],typeof s=="function"?s(r):t[s]=r):t[n]=r;return typeof t.datumCode=="string"&&t.datumCode!=="WGS84"&&(t.datumCode=t.datumCode.toLowerCase()),t}var oc=1,jv=2,Bv=3,wf=4,Gv=5,k1=-1,AL=/\s/,ML=/[A-Za-z]/,TL=/[A-Za-z84_]/,od=/[,\]]/,zv=/[\d\.E\-\+]/;function Ds(i){if(typeof i!="string")throw new Error("not a string");this.text=i.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=oc}Ds.prototype.readCharicter=function(){var i=this.text[this.place++];if(this.state!==wf)for(;AL.test(i);){if(this.place>=this.text.length)return;i=this.text[this.place++]}switch(this.state){case oc:return this.neutral(i);case jv:return this.keyword(i);case wf:return this.quoted(i);case Gv:return this.afterquote(i);case Bv:return this.number(i);case k1:return}};Ds.prototype.afterquote=function(i){if(i==='"'){this.word+='"',this.state=wf;return}if(od.test(i)){this.word=this.word.trim(),this.afterItem(i);return}throw new Error(`havn't handled "`+i+'" in afterquote yet, index '+this.place)};Ds.prototype.afterItem=function(i){if(i===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=oc;return}if(i==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=oc,this.currentObject=this.stack.pop(),this.currentObject||(this.state=k1);return}};Ds.prototype.number=function(i){if(zv.test(i)){this.word+=i;return}if(od.test(i)){this.word=parseFloat(this.word),this.afterItem(i);return}throw new Error(`havn't handled "`+i+'" in number yet, index '+this.place)};Ds.prototype.quoted=function(i){if(i==='"'){this.state=Gv;return}this.word+=i};Ds.prototype.keyword=function(i){if(TL.test(i)){this.word+=i;return}if(i==="["){var t=[];t.push(this.word),this.level++,this.root===null?this.root=t:this.currentObject.push(t),this.stack.push(this.currentObject),this.currentObject=t,this.state=oc;return}if(od.test(i)){this.afterItem(i);return}throw new Error(`havn't handled "`+i+'" in keyword yet, index '+this.place)};Ds.prototype.neutral=function(i){if(ML.test(i)){this.word=i,this.state=jv;return}if(i==='"'){this.word="",this.state=wf;return}if(zv.test(i)){this.word=i,this.state=Bv;return}if(od.test(i)){this.afterItem(i);return}throw new Error(`havn't handled "`+i+'" in neutral yet, index '+this.place)};Ds.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===k1)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function PL(i){var t=new Ds(i);return t.output()}function l2(i,t,e){Array.isArray(t)&&(e.unshift(t),t=null);var n=t?{}:i,r=e.reduce(function(s,a){return ll(a,s),s},n);t&&(i[t]=r)}function ll(i,t){if(!Array.isArray(i)){t[i]=!0;return}var e=i.shift();if(e==="PARAMETER"&&(e=i.shift()),i.length===1){if(Array.isArray(i[0])){t[e]={},ll(i[0],t[e]);return}t[e]=i[0];return}if(!i.length){t[e]=!0;return}if(e==="TOWGS84"){t[e]=i;return}if(e==="AXIS"){e in t||(t[e]=[]),t[e].push(i);return}Array.isArray(e)||(t[e]={});var n;switch(e){case"UNIT":case"PRIMEM":case"VERT_DATUM":t[e]={name:i[0].toLowerCase(),convert:i[1]},i.length===3&&ll(i[2],t[e]);return;case"SPHEROID":case"ELLIPSOID":t[e]={name:i[0],a:i[1],rf:i[2]},i.length===4&&ll(i[3],t[e]);return;case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":i[0]=["name",i[0]],l2(t,e,i);return;default:for(n=-1;++n<i.length;)if(!Array.isArray(i[n]))return ll(i,t[e]);return l2(t,e,i)}}var IL=.017453292519943295;function RL(i,t){var e=t[0],n=t[1];!(e in i)&&n in i&&(i[e]=i[n],t.length===3&&(i[e]=t[2](i[e])))}function Ur(i){return i*IL}function NL(i){if(i.type==="GEOGCS"?i.projName="longlat":i.type==="LOCAL_CS"?(i.projName="identity",i.local=!0):typeof i.PROJECTION=="object"?i.projName=Object.keys(i.PROJECTION)[0]:i.projName=i.PROJECTION,i.AXIS){for(var t="",e=0,n=i.AXIS.length;e<n;++e){var r=[i.AXIS[e][0].toLowerCase(),i.AXIS[e][1].toLowerCase()];r[0].indexOf("north")!==-1||(r[0]==="y"||r[0]==="lat")&&r[1]==="north"?t+="n":r[0].indexOf("south")!==-1||(r[0]==="y"||r[0]==="lat")&&r[1]==="south"?t+="s":r[0].indexOf("east")!==-1||(r[0]==="x"||r[0]==="lon")&&r[1]==="east"?t+="e":(r[0].indexOf("west")!==-1||(r[0]==="x"||r[0]==="lon")&&r[1]==="west")&&(t+="w")}t.length===2&&(t+="u"),t.length===3&&(i.axis=t)}i.UNIT&&(i.units=i.UNIT.name.toLowerCase(),i.units==="metre"&&(i.units="meter"),i.UNIT.convert&&(i.type==="GEOGCS"?i.DATUM&&i.DATUM.SPHEROID&&(i.to_meter=i.UNIT.convert*i.DATUM.SPHEROID.a):i.to_meter=i.UNIT.convert));var s=i.GEOGCS;i.type==="GEOGCS"&&(s=i),s&&(s.DATUM?i.datumCode=s.DATUM.name.toLowerCase():i.datumCode=s.name.toLowerCase(),i.datumCode.slice(0,2)==="d_"&&(i.datumCode=i.datumCode.slice(2)),(i.datumCode==="new_zealand_geodetic_datum_1949"||i.datumCode==="new_zealand_1949")&&(i.datumCode="nzgd49"),(i.datumCode==="wgs_1984"||i.datumCode==="world_geodetic_system_1984")&&(i.PROJECTION==="Mercator_Auxiliary_Sphere"&&(i.sphere=!0),i.datumCode="wgs84"),i.datumCode.slice(-6)==="_ferro"&&(i.datumCode=i.datumCode.slice(0,-6)),i.datumCode.slice(-8)==="_jakarta"&&(i.datumCode=i.datumCode.slice(0,-8)),~i.datumCode.indexOf("belge")&&(i.datumCode="rnb72"),s.DATUM&&s.DATUM.SPHEROID&&(i.ellps=s.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),i.ellps.toLowerCase().slice(0,13)==="international"&&(i.ellps="intl"),i.a=s.DATUM.SPHEROID.a,i.rf=parseFloat(s.DATUM.SPHEROID.rf,10)),s.DATUM&&s.DATUM.TOWGS84&&(i.datum_params=s.DATUM.TOWGS84),~i.datumCode.indexOf("osgb_1936")&&(i.datumCode="osgb36"),~i.datumCode.indexOf("osni_1952")&&(i.datumCode="osni52"),(~i.datumCode.indexOf("tm65")||~i.datumCode.indexOf("geodetic_datum_of_1965"))&&(i.datumCode="ire65"),i.datumCode==="ch1903+"&&(i.datumCode="ch1903"),~i.datumCode.indexOf("israel")&&(i.datumCode="isr93")),i.b&&!isFinite(i.b)&&(i.b=i.a);function a(h){var c=i.to_meter||1;return h*c}var o=function(h){return RL(i,h)},l=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Ur],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Ur],["x0","false_easting",a],["y0","false_northing",a],["long0","central_meridian",Ur],["lat0","latitude_of_origin",Ur],["lat0","standard_parallel_1",Ur],["lat1","standard_parallel_1",Ur],["lat2","standard_parallel_2",Ur],["azimuth","Azimuth"],["alpha","azimuth",Ur],["srsCode","name"]];l.forEach(o),!i.long0&&i.longc&&(i.projName==="Albers_Conic_Equal_Area"||i.projName==="Lambert_Azimuthal_Equal_Area")&&(i.long0=i.longc),!i.lat_ts&&i.lat1&&(i.projName==="Stereographic_South_Pole"||i.projName==="Polar Stereographic (variant B)")?(i.lat0=Ur(i.lat1>0?90:-90),i.lat_ts=i.lat1):!i.lat_ts&&i.lat0&&i.projName==="Polar_Stereographic"&&(i.lat_ts=i.lat0,i.lat0=Ur(i.lat0>0?90:-90))}function qv(i){var t=PL(i),e=t.shift(),n=t.shift();t.unshift(["name",n]),t.unshift(["type",e]);var r={};return ll(t,r),NL(r),r}function wn(i){var t=this;if(arguments.length===2){var e=arguments[1];typeof e=="string"?e.charAt(0)==="+"?wn[i]=T0(arguments[1]):wn[i]=qv(arguments[1]):wn[i]=e}else if(arguments.length===1){if(Array.isArray(i))return i.map(function(n){Array.isArray(n)?wn.apply(t,n):wn(n)});if(typeof i=="string"){if(i in wn)return wn[i]}else"EPSG"in i?wn["EPSG:"+i.EPSG]=i:"ESRI"in i?wn["ESRI:"+i.ESRI]=i:"IAU2000"in i?wn["IAU2000:"+i.IAU2000]=i:console.log(i);return}}xL(wn);function FL(i){return typeof i=="string"}function OL(i){return i in wn}var kL=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function DL(i){return kL.some(function(t){return i.indexOf(t)>-1})}var jL=["3857","900913","3785","102113"];function BL(i){var t=La(i,"authority");if(t){var e=La(t,"epsg");return e&&jL.indexOf(e)>-1}}function GL(i){var t=La(i,"extension");if(t)return La(t,"proj4")}function zL(i){return i[0]==="+"}function qL(i){if(FL(i)){if(OL(i))return wn[i];if(DL(i)){var t=qv(i);if(BL(t))return wn["EPSG:3857"];var e=GL(t);return e?T0(e):t}if(zL(i))return T0(i)}else return i}function h2(i,t){i=i||{};var e,n;if(!t)return i;for(n in t)e=t[n],e!==void 0&&(i[n]=e);return i}function rs(i,t,e){var n=i*t;return e/Math.sqrt(1-n*n)}function bc(i){return i<0?-1:1}function Gt(i){return Math.abs(i)<=Ai?i:i-bc(i)*ac}function Rr(i,t,e){var n=i*e,r=.5*i;return n=Math.pow((1-n)/(1+n),r),Math.tan(.5*(Mt-t))/n}function lc(i,t){for(var e=.5*i,n,r,s=Mt-2*Math.atan(t),a=0;a<=15;a++)if(n=i*Math.sin(s),r=Mt-2*Math.atan(t*Math.pow((1-n)/(1+n),e))-s,s+=r,Math.abs(r)<=1e-10)return s;return-9999}function UL(){var i=this.b/this.a;this.es=1-i*i,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=rs(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function WL(i){var t=i.x,e=i.y;if(e*Jr>90&&e*Jr<-90&&t*Jr>180&&t*Jr<-180)return null;var n,r;if(Math.abs(Math.abs(e)-Mt)<=kt)return null;if(this.sphere)n=this.x0+this.a*this.k0*Gt(t-this.long0),r=this.y0+this.a*this.k0*Math.log(Math.tan(Ge+.5*e));else{var s=Math.sin(e),a=Rr(this.e,e,s);n=this.x0+this.a*this.k0*Gt(t-this.long0),r=this.y0-this.a*this.k0*Math.log(a)}return i.x=n,i.y=r,i}function VL(i){var t=i.x-this.x0,e=i.y-this.y0,n,r;if(this.sphere)r=Mt-2*Math.atan(Math.exp(-e/(this.a*this.k0)));else{var s=Math.exp(-e/(this.a*this.k0));if(r=lc(this.e,s),r===-9999)return null}return n=Gt(this.long0+t/(this.a*this.k0)),i.x=n,i.y=r,i}var HL=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"];const XL={init:UL,forward:WL,inverse:VL,names:HL};function YL(){}function c2(i){return i}var ZL=["longlat","identity"];const KL={init:YL,forward:c2,inverse:c2,names:ZL};var $L=[XL,KL],Yu={},Ef=[];function Uv(i,t){var e=Ef.length;return i.names?(Ef[e]=i,i.names.forEach(function(n){Yu[n.toLowerCase()]=e}),this):(console.log(t),!0)}function JL(i){if(!i)return!1;var t=i.toLowerCase();if(typeof Yu[t]<"u"&&Ef[Yu[t]])return Ef[Yu[t]]}function QL(){$L.forEach(Uv)}const t4={start:QL,add:Uv,get:JL};var ue={};ue.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};ue.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};ue.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"};ue.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};ue.airy={a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"};ue.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};ue.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};ue.mod_airy={a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"};ue.andrae={a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};ue.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"};ue.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};ue.bessel={a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"};ue.bess_nam={a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};ue.clrk66={a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"};ue.clrk80={a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."};ue.clrk80ign={a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"};ue.clrk58={a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"};ue.CPM={a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};ue.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};ue.engelis={a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"};ue.evrst30={a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"};ue.evrst48={a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"};ue.evrst56={a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"};ue.evrst69={a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"};ue.evrstSS={a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"};ue.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};ue.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};ue.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};ue.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};ue.hough={a:6378270,rf:297,ellipseName:"Hough"};ue.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};ue.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};ue.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};ue.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};ue.new_intl={a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"};ue.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};ue.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};ue.SEasia={a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"};ue.walbeck={a:6376896,b:63558348467e-4,ellipseName:"Walbeck"};ue.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"};ue.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};ue.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var e4=ue.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};ue.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};function i4(i,t,e,n){var r=i*i,s=t*t,a=(r-s)/r,o=0;n?(i*=1-a*(EL+a*(SL+a*LL)),r=i*i,a=0):o=Math.sqrt(a);var l=(r-s)/s;return{es:a,e:o,ep2:l}}function n4(i,t,e,n,r){if(!i){var s=La(ue,n);s||(s=e4),i=s.a,t=s.b,e=s.rf}return e&&!t&&(t=(1-1/e)*i),(e===0||Math.abs(i-t)<kt)&&(r=!0,t=i),{a:i,b:t,rf:e,sphere:r}}var zi={};zi.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"};zi.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"};zi.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"};zi.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"};zi.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"};zi.potsdam={towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"};zi.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"};zi.hermannskogel={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"};zi.militargeographische_institut={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"};zi.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"};zi.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"};zi.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"};zi.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"};zi.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"};zi.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"};zi.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"};zi.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"};zi.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"};function r4(i,t,e,n,r,s,a){var o={};return i===void 0||i==="none"?o.datum_type=M0:o.datum_type=bL,t&&(o.datum_params=t.map(parseFloat),(o.datum_params[0]!==0||o.datum_params[1]!==0||o.datum_params[2]!==0)&&(o.datum_type=io),o.datum_params.length>3&&(o.datum_params[3]!==0||o.datum_params[4]!==0||o.datum_params[5]!==0||o.datum_params[6]!==0)&&(o.datum_type=no,o.datum_params[3]*=Dh,o.datum_params[4]*=Dh,o.datum_params[5]*=Dh,o.datum_params[6]=o.datum_params[6]/1e6+1)),a&&(o.datum_type=xl,o.grids=a),o.a=e,o.b=n,o.es=r,o.ep2=s,o}var Wv={};function s4(i,t){var e=new DataView(t),n=l4(e),r=h4(e,n),s=c4(e,r,n),a={header:r,subgrids:s};return Wv[i]=a,a}function a4(i){if(i===void 0)return null;var t=i.split(",");return t.map(o4)}function o4(i){if(i.length===0)return null;var t=i[0]==="@";return t&&(i=i.slice(1)),i==="null"?{name:"null",mandatory:!t,grid:null,isNull:!0}:{name:i,mandatory:!t,grid:Wv[i]||null,isNull:!1}}function hl(i){return i/3600*Math.PI/180}function l4(i){var t=i.getInt32(8,!1);return t===11?!1:(t=i.getInt32(8,!0),t!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function h4(i,t){return{nFields:i.getInt32(8,t),nSubgridFields:i.getInt32(24,t),nSubgrids:i.getInt32(40,t),shiftType:P0(i,56,64).trim(),fromSemiMajorAxis:i.getFloat64(120,t),fromSemiMinorAxis:i.getFloat64(136,t),toSemiMajorAxis:i.getFloat64(152,t),toSemiMinorAxis:i.getFloat64(168,t)}}function P0(i,t,e){return String.fromCharCode.apply(null,new Uint8Array(i.buffer.slice(t,e)))}function c4(i,t,e){for(var n=176,r=[],s=0;s<t.nSubgrids;s++){var a=f4(i,n,e),o=d4(i,n,a,e),l=Math.round(1+(a.upperLongitude-a.lowerLongitude)/a.longitudeInterval),h=Math.round(1+(a.upperLatitude-a.lowerLatitude)/a.latitudeInterval);r.push({ll:[hl(a.lowerLongitude),hl(a.lowerLatitude)],del:[hl(a.longitudeInterval),hl(a.latitudeInterval)],lim:[l,h],count:a.gridNodeCount,cvs:u4(o)}),n+=176+a.gridNodeCount*16}return r}function u4(i){return i.map(function(t){return[hl(t.longitudeShift),hl(t.latitudeShift)]})}function f4(i,t,e){return{name:P0(i,t+8,t+16).trim(),parent:P0(i,t+24,t+24+8).trim(),lowerLatitude:i.getFloat64(t+72,e),upperLatitude:i.getFloat64(t+88,e),lowerLongitude:i.getFloat64(t+104,e),upperLongitude:i.getFloat64(t+120,e),latitudeInterval:i.getFloat64(t+136,e),longitudeInterval:i.getFloat64(t+152,e),gridNodeCount:i.getInt32(t+168,e)}}function d4(i,t,e,n){for(var r=t+176,s=16,a=[],o=0;o<e.gridNodeCount;o++){var l={latitudeShift:i.getFloat32(r+o*s,n),longitudeShift:i.getFloat32(r+o*s+4,n),latitudeAccuracy:i.getFloat32(r+o*s+8,n),longitudeAccuracy:i.getFloat32(r+o*s+12,n)};a.push(l)}return a}function es(i,t){if(!(this instanceof es))return new es(i);t=t||function(h){if(h)throw h};var e=qL(i);if(typeof e!="object"){t(i);return}var n=es.projections.get(e.projName);if(!n){t(i);return}if(e.datumCode&&e.datumCode!=="none"){var r=La(zi,e.datumCode);r&&(e.datum_params=e.datum_params||(r.towgs84?r.towgs84.split(","):null),e.ellps=r.ellipse,e.datumName=r.datumName?r.datumName:e.datumCode)}e.k0=e.k0||1,e.axis=e.axis||"enu",e.ellps=e.ellps||"wgs84",e.lat1=e.lat1||e.lat0;var s=n4(e.a,e.b,e.rf,e.ellps,e.sphere),a=i4(s.a,s.b,s.rf,e.R_A),o=a4(e.nadgrids),l=e.datum||r4(e.datumCode,e.datum_params,s.a,s.b,a.es,a.ep2,o);h2(this,e),h2(this,n),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=a.es,this.e=a.e,this.ep2=a.ep2,this.datum=l,this.init(),t(null,this)}es.projections=t4;es.projections.start();function g4(i,t){return i.datum_type!==t.datum_type||i.a!==t.a||Math.abs(i.es-t.es)>5e-11?!1:i.datum_type===io?i.datum_params[0]===t.datum_params[0]&&i.datum_params[1]===t.datum_params[1]&&i.datum_params[2]===t.datum_params[2]:i.datum_type===no?i.datum_params[0]===t.datum_params[0]&&i.datum_params[1]===t.datum_params[1]&&i.datum_params[2]===t.datum_params[2]&&i.datum_params[3]===t.datum_params[3]&&i.datum_params[4]===t.datum_params[4]&&i.datum_params[5]===t.datum_params[5]&&i.datum_params[6]===t.datum_params[6]:!0}function Vv(i,t,e){var n=i.x,r=i.y,s=i.z?i.z:0,a,o,l,h;if(r<-Mt&&r>-1.001*Mt)r=-Mt;else if(r>Mt&&r<1.001*Mt)r=Mt;else{if(r<-Mt)return{x:-1/0,y:-1/0,z:i.z};if(r>Mt)return{x:1/0,y:1/0,z:i.z}}return n>Math.PI&&(n-=2*Math.PI),o=Math.sin(r),h=Math.cos(r),l=o*o,a=e/Math.sqrt(1-t*l),{x:(a+s)*h*Math.cos(n),y:(a+s)*h*Math.sin(n),z:(a*(1-t)+s)*o}}function Hv(i,t,e,n){var r=1e-12,s=r*r,a=30,o,l,h,c,f,g,d,m,y,b,x,E,S,M=i.x,D=i.y,W=i.z?i.z:0,j,P,H;if(o=Math.sqrt(M*M+D*D),l=Math.sqrt(M*M+D*D+W*W),o/e<r){if(j=0,l/e<r)return P=Mt,H=-n,{x:i.x,y:i.y,z:i.z}}else j=Math.atan2(D,M);h=W/l,c=o/l,f=1/Math.sqrt(1-t*(2-t)*c*c),m=c*(1-t)*f,y=h*f,S=0;do S++,d=e/Math.sqrt(1-t*y*y),H=o*m+W*y-d*(1-t*y*y),g=t*d/(d+H),f=1/Math.sqrt(1-g*(2-g)*c*c),b=c*(1-g)*f,x=h*f,E=x*m-b*y,m=b,y=x;while(E*E>s&&S<a);return P=Math.atan(x/Math.abs(b)),{x:j,y:P,z:H}}function p4(i,t,e){if(t===io)return{x:i.x+e[0],y:i.y+e[1],z:i.z+e[2]};if(t===no){var n=e[0],r=e[1],s=e[2],a=e[3],o=e[4],l=e[5],h=e[6];return{x:h*(i.x-l*i.y+o*i.z)+n,y:h*(l*i.x+i.y-a*i.z)+r,z:h*(-o*i.x+a*i.y+i.z)+s}}}function m4(i,t,e){if(t===io)return{x:i.x-e[0],y:i.y-e[1],z:i.z-e[2]};if(t===no){var n=e[0],r=e[1],s=e[2],a=e[3],o=e[4],l=e[5],h=e[6],c=(i.x-n)/h,f=(i.y-r)/h,g=(i.z-s)/h;return{x:c+l*f-o*g,y:-l*c+f+a*g,z:o*c-a*f+g}}}function ju(i){return i===io||i===no}function _4(i,t,e){if(g4(i,t)||i.datum_type===M0||t.datum_type===M0)return e;var n=i.a,r=i.es;if(i.datum_type===xl){var s=u2(i,!1,e);if(s!==0)return;n=s2,r=a2}var a=t.a,o=t.b,l=t.es;if(t.datum_type===xl&&(a=s2,o=wL,l=a2),r===l&&n===a&&!ju(i.datum_type)&&!ju(t.datum_type))return e;if(e=Vv(e,r,n),ju(i.datum_type)&&(e=p4(e,i.datum_type,i.datum_params)),ju(t.datum_type)&&(e=m4(e,t.datum_type,t.datum_params)),e=Hv(e,l,a,o),t.datum_type===xl){var h=u2(t,!0,e);if(h!==0)return}return e}function u2(i,t,e){if(i.grids===null||i.grids.length===0)return console.log("Grid shift grids not found"),-1;var n={x:-e.x,y:e.y},r={x:Number.NaN,y:Number.NaN},s=[];t:for(var a=0;a<i.grids.length;a++){var o=i.grids[a];if(s.push(o.name),o.isNull){r=n;break}if(o.mandatory,o.grid===null){if(o.mandatory)return console.log("Unable to find mandatory grid '"+o.name+"'"),-1;continue}for(var l=o.grid.subgrids,h=0,c=l.length;h<c;h++){var f=l[h],g=(Math.abs(f.del[1])+Math.abs(f.del[0]))/1e4,d=f.ll[0]-g,m=f.ll[1]-g,y=f.ll[0]+(f.lim[0]-1)*f.del[0]+g,b=f.ll[1]+(f.lim[1]-1)*f.del[1]+g;if(!(m>n.y||d>n.x||b<n.y||y<n.x)&&(r=v4(n,t,f),!isNaN(r.x)))break t}}return isNaN(r.x)?(console.log("Failed to find a grid shift table for location '"+-n.x*Jr+" "+n.y*Jr+" tried: '"+s+"'"),-1):(e.x=-r.x,e.y=r.y,0)}function v4(i,t,e){var n={x:Number.NaN,y:Number.NaN};if(isNaN(i.x))return n;var r={x:i.x,y:i.y};r.x-=e.ll[0],r.y-=e.ll[1],r.x=Gt(r.x-Math.PI)+Math.PI;var s=f2(r,e);if(t){if(isNaN(s.x))return n;s.x=r.x-s.x,s.y=r.y-s.y;var a=9,o=1e-12,l,h;do{if(h=f2(s,e),isNaN(h.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}l={x:r.x-(h.x+s.x),y:r.y-(h.y+s.y)},s.x+=l.x,s.y+=l.y}while(a--&&Math.abs(l.x)>o&&Math.abs(l.y)>o);if(a<0)return console.log("Inverse grid shift iterator failed to converge."),n;n.x=Gt(s.x+e.ll[0]),n.y=s.y+e.ll[1]}else isNaN(s.x)||(n.x=i.x+s.x,n.y=i.y+s.y);return n}function f2(i,t){var e={x:i.x/t.del[0],y:i.y/t.del[1]},n={x:Math.floor(e.x),y:Math.floor(e.y)},r={x:e.x-1*n.x,y:e.y-1*n.y},s={x:Number.NaN,y:Number.NaN},a;if(n.x<0||n.x>=t.lim[0]||n.y<0||n.y>=t.lim[1])return s;a=n.y*t.lim[0]+n.x;var o={x:t.cvs[a][0],y:t.cvs[a][1]};a++;var l={x:t.cvs[a][0],y:t.cvs[a][1]};a+=t.lim[0];var h={x:t.cvs[a][0],y:t.cvs[a][1]};a--;var c={x:t.cvs[a][0],y:t.cvs[a][1]},f=r.x*r.y,g=r.x*(1-r.y),d=(1-r.x)*(1-r.y),m=(1-r.x)*r.y;return s.x=d*o.x+g*l.x+m*c.x+f*h.x,s.y=d*o.y+g*l.y+m*c.y+f*h.y,s}function d2(i,t,e){var n=e.x,r=e.y,s=e.z||0,a,o,l,h={};for(l=0;l<3;l++)if(!(t&&l===2&&e.z===void 0))switch(l===0?(a=n,"ew".indexOf(i.axis[l])!==-1?o="x":o="y"):l===1?(a=r,"ns".indexOf(i.axis[l])!==-1?o="y":o="x"):(a=s,o="z"),i.axis[l]){case"e":h[o]=a;break;case"w":h[o]=-a;break;case"n":h[o]=a;break;case"s":h[o]=-a;break;case"u":e[o]!==void 0&&(h.z=a);break;case"d":e[o]!==void 0&&(h.z=-a);break;default:return null}return h}function Xv(i){var t={x:i[0],y:i[1]};return i.length>2&&(t.z=i[2]),i.length>3&&(t.m=i[3]),t}function y4(i){g2(i.x),g2(i.y)}function g2(i){if(typeof Number.isFinite=="function"){if(Number.isFinite(i))return;throw new TypeError("coordinates must be finite numbers")}if(typeof i!="number"||i!==i||!isFinite(i))throw new TypeError("coordinates must be finite numbers")}function x4(i,t){return(i.datum.datum_type===io||i.datum.datum_type===no||i.datum.datum_type===xl)&&t.datumCode!=="WGS84"||(t.datum.datum_type===io||t.datum.datum_type===no||t.datum.datum_type===xl)&&i.datumCode!=="WGS84"}function Sf(i,t,e,n){var r;Array.isArray(e)?e=Xv(e):e={x:e.x,y:e.y,z:e.z,m:e.m};var s=e.z!==void 0;if(y4(e),i.datum&&t.datum&&x4(i,t)&&(r=new es("WGS84"),e=Sf(i,r,e,n),i=r),n&&i.axis!=="enu"&&(e=d2(i,!1,e)),i.projName==="longlat")e={x:e.x*tn,y:e.y*tn,z:e.z||0};else if(i.to_meter&&(e={x:e.x*i.to_meter,y:e.y*i.to_meter,z:e.z||0}),e=i.inverse(e),!e)return;if(i.from_greenwich&&(e.x+=i.from_greenwich),e=_4(i.datum,t.datum,e),!!e)return t.from_greenwich&&(e={x:e.x-t.from_greenwich,y:e.y,z:e.z||0}),t.projName==="longlat"?e={x:e.x*Jr,y:e.y*Jr,z:e.z||0}:(e=t.forward(e),t.to_meter&&(e={x:e.x/t.to_meter,y:e.y/t.to_meter,z:e.z||0})),n&&t.axis!=="enu"?d2(t,!0,e):(e&&!s&&delete e.z,e)}var p2=es("WGS84");function Ng(i,t,e,n){var r,s,a;return Array.isArray(e)?(r=Sf(i,t,e,n)||{x:NaN,y:NaN},e.length>2?typeof i.name<"u"&&i.name==="geocent"||typeof t.name<"u"&&t.name==="geocent"?typeof r.z=="number"?[r.x,r.y,r.z].concat(e.splice(3)):[r.x,r.y,e[2]].concat(e.splice(3)):[r.x,r.y].concat(e.splice(2)):[r.x,r.y]):(s=Sf(i,t,e,n),a=Object.keys(e),a.length===2||a.forEach(function(o){if(typeof i.name<"u"&&i.name==="geocent"||typeof t.name<"u"&&t.name==="geocent"){if(o==="x"||o==="y"||o==="z")return}else if(o==="x"||o==="y")return;s[o]=e[o]}),s)}function m2(i){return i instanceof es?i:i.oProj?i.oProj:es(i)}function jn(i,t,e){i=m2(i);var n=!1,r;return typeof t>"u"?(t=i,i=p2,n=!0):(typeof t.x<"u"||Array.isArray(t))&&(e=t,t=i,i=p2,n=!0),t=m2(t),e?Ng(i,t,e):(r={forward:function(s,a){return Ng(i,t,s,a)},inverse:function(s,a){return Ng(t,i,s,a)}},n&&(r.oProj=t),r)}var _2=6,Yv="AJSAJS",Zv="AFAFAF",cl=65,Rn=73,ar=79,Mh=86,Th=90;const b4={forward:Kv,inverse:w4,toPoint:$v};function Kv(i,t){return t=t||5,L4(E4({lat:i[1],lon:i[0]}),t)}function w4(i){var t=D1(Qv(i.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat,t.lon,t.lat]:[t.left,t.bottom,t.right,t.top]}function $v(i){var t=D1(Qv(i.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat]:[(t.left+t.right)/2,(t.top+t.bottom)/2]}function Fg(i){return i*(Math.PI/180)}function v2(i){return 180*(i/Math.PI)}function E4(i){var t=i.lat,e=i.lon,n=6378137,r=.00669438,s=.9996,a,o,l,h,c,f,g,d=Fg(t),m=Fg(e),y,b;b=Math.floor((e+180)/6)+1,e===180&&(b=60),t>=56&&t<64&&e>=3&&e<12&&(b=32),t>=72&&t<84&&(e>=0&&e<9?b=31:e>=9&&e<21?b=33:e>=21&&e<33?b=35:e>=33&&e<42&&(b=37)),a=(b-1)*6-180+3,y=Fg(a),o=r/(1-r),l=n/Math.sqrt(1-r*Math.sin(d)*Math.sin(d)),h=Math.tan(d)*Math.tan(d),c=o*Math.cos(d)*Math.cos(d),f=Math.cos(d)*(m-y),g=n*((1-r/4-3*r*r/64-5*r*r*r/256)*d-(3*r/8+3*r*r/32+45*r*r*r/1024)*Math.sin(2*d)+(15*r*r/256+45*r*r*r/1024)*Math.sin(4*d)-35*r*r*r/3072*Math.sin(6*d));var x=s*l*(f+(1-h+c)*f*f*f/6+(5-18*h+h*h+72*c-58*o)*f*f*f*f*f/120)+5e5,E=s*(g+l*Math.tan(d)*(f*f/2+(5-h+9*c+4*c*c)*f*f*f*f/24+(61-58*h+h*h+600*c-330*o)*f*f*f*f*f*f/720));return t<0&&(E+=1e7),{northing:Math.round(E),easting:Math.round(x),zoneNumber:b,zoneLetter:S4(t)}}function D1(i){var t=i.northing,e=i.easting,n=i.zoneLetter,r=i.zoneNumber;if(r<0||r>60)return null;var s=.9996,a=6378137,o=.00669438,l,h=(1-Math.sqrt(1-o))/(1+Math.sqrt(1-o)),c,f,g,d,m,y,b,x,E,S=e-5e5,M=t;n<"N"&&(M-=1e7),b=(r-1)*6-180+3,l=o/(1-o),y=M/s,x=y/(a*(1-o/4-3*o*o/64-5*o*o*o/256)),E=x+(3*h/2-27*h*h*h/32)*Math.sin(2*x)+(21*h*h/16-55*h*h*h*h/32)*Math.sin(4*x)+151*h*h*h/96*Math.sin(6*x),c=a/Math.sqrt(1-o*Math.sin(E)*Math.sin(E)),f=Math.tan(E)*Math.tan(E),g=l*Math.cos(E)*Math.cos(E),d=a*(1-o)/Math.pow(1-o*Math.sin(E)*Math.sin(E),1.5),m=S/(c*s);var D=E-c*Math.tan(E)/d*(m*m/2-(5+3*f+10*g-4*g*g-9*l)*m*m*m*m/24+(61+90*f+298*g+45*f*f-252*l-3*g*g)*m*m*m*m*m*m/720);D=v2(D);var W=(m-(1+2*f+g)*m*m*m/6+(5-2*g+28*f-3*g*g+8*l+24*f*f)*m*m*m*m*m/120)/Math.cos(E);W=b+v2(W);var j;if(i.accuracy){var P=D1({northing:i.northing+i.accuracy,easting:i.easting+i.accuracy,zoneLetter:i.zoneLetter,zoneNumber:i.zoneNumber});j={top:P.lat,right:P.lon,bottom:D,left:W}}else j={lat:D,lon:W};return j}function S4(i){var t="Z";return 84>=i&&i>=72?t="X":72>i&&i>=64?t="W":64>i&&i>=56?t="V":56>i&&i>=48?t="U":48>i&&i>=40?t="T":40>i&&i>=32?t="S":32>i&&i>=24?t="R":24>i&&i>=16?t="Q":16>i&&i>=8?t="P":8>i&&i>=0?t="N":0>i&&i>=-8?t="M":-8>i&&i>=-16?t="L":-16>i&&i>=-24?t="K":-24>i&&i>=-32?t="J":-32>i&&i>=-40?t="H":-40>i&&i>=-48?t="G":-48>i&&i>=-56?t="F":-56>i&&i>=-64?t="E":-64>i&&i>=-72?t="D":-72>i&&i>=-80&&(t="C"),t}function L4(i,t){var e="00000"+i.easting,n="00000"+i.northing;return i.zoneNumber+i.zoneLetter+C4(i.easting,i.northing,i.zoneNumber)+e.substr(e.length-5,t)+n.substr(n.length-5,t)}function C4(i,t,e){var n=Jv(e),r=Math.floor(i/1e5),s=Math.floor(t/1e5)%20;return A4(r,s,n)}function Jv(i){var t=i%_2;return t===0&&(t=_2),t}function A4(i,t,e){var n=e-1,r=Yv.charCodeAt(n),s=Zv.charCodeAt(n),a=r+i-1,o=s+t,l=!1;a>Th&&(a=a-Th+cl-1,l=!0),(a===Rn||r<Rn&&a>Rn||(a>Rn||r<Rn)&&l)&&a++,(a===ar||r<ar&&a>ar||(a>ar||r<ar)&&l)&&(a++,a===Rn&&a++),a>Th&&(a=a-Th+cl-1),o>Mh?(o=o-Mh+cl-1,l=!0):l=!1,(o===Rn||s<Rn&&o>Rn||(o>Rn||s<Rn)&&l)&&o++,(o===ar||s<ar&&o>ar||(o>ar||s<ar)&&l)&&(o++,o===Rn&&o++),o>Mh&&(o=o-Mh+cl-1);var h=String.fromCharCode(a)+String.fromCharCode(o);return h}function Qv(i){if(i&&i.length===0)throw"MGRSPoint coverting from nothing";for(var t=i.length,e=null,n="",r,s=0;!/[A-Z]/.test(r=i.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+i;n+=r,s++}var a=parseInt(n,10);if(s===0||s+3>t)throw"MGRSPoint bad conversion from: "+i;var o=i.charAt(s++);if(o<="A"||o==="B"||o==="Y"||o>="Z"||o==="I"||o==="O")throw"MGRSPoint zone letter "+o+" not handled: "+i;e=i.substring(s,s+=2);for(var l=Jv(a),h=M4(e.charAt(0),l),c=T4(e.charAt(1),l);c<P4(o);)c+=2e6;var f=t-s;if(f%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+i;var g=f/2,d=0,m=0,y,b,x,E,S;return g>0&&(y=1e5/Math.pow(10,g),b=i.substring(s,s+g),d=parseFloat(b)*y,x=i.substring(s+g),m=parseFloat(x)*y),E=d+h,S=m+c,{easting:E,northing:S,zoneLetter:o,zoneNumber:a,accuracy:y}}function M4(i,t){for(var e=Yv.charCodeAt(t-1),n=1e5,r=!1;e!==i.charCodeAt(0);){if(e++,e===Rn&&e++,e===ar&&e++,e>Th){if(r)throw"Bad character: "+i;e=cl,r=!0}n+=1e5}return n}function T4(i,t){if(i>"V")throw"MGRSPoint given invalid Northing "+i;for(var e=Zv.charCodeAt(t-1),n=0,r=!1;e!==i.charCodeAt(0);){if(e++,e===Rn&&e++,e===ar&&e++,e>Mh){if(r)throw"Bad character: "+i;e=cl,r=!0}n+=1e5}return n}function P4(i){var t;switch(i){case"C":t=11e5;break;case"D":t=2e6;break;case"E":t=28e5;break;case"F":t=37e5;break;case"G":t=46e5;break;case"H":t=55e5;break;case"J":t=64e5;break;case"K":t=73e5;break;case"L":t=82e5;break;case"M":t=91e5;break;case"N":t=0;break;case"P":t=8e5;break;case"Q":t=17e5;break;case"R":t=26e5;break;case"S":t=35e5;break;case"T":t=44e5;break;case"U":t=53e5;break;case"V":t=62e5;break;case"W":t=7e6;break;case"X":t=79e5;break;default:t=-1}if(t>=0)return t;throw"Invalid zone letter: "+i}function Pl(i,t,e){if(!(this instanceof Pl))return new Pl(i,t,e);if(Array.isArray(i))this.x=i[0],this.y=i[1],this.z=i[2]||0;else if(typeof i=="object")this.x=i.x,this.y=i.y,this.z=i.z||0;else if(typeof i=="string"&&typeof t>"u"){var n=i.split(",");this.x=parseFloat(n[0],10),this.y=parseFloat(n[1],10),this.z=parseFloat(n[2],10)||0}else this.x=i,this.y=t,this.z=e||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Pl.fromMGRS=function(i){return new Pl($v(i))};Pl.prototype.toMGRS=function(i){return Kv([this.x,this.y],i)};var I4=1,R4=.25,y2=.046875,x2=.01953125,b2=.01068115234375,N4=.75,F4=.46875,O4=.013020833333333334,k4=.007120768229166667,D4=.3645833333333333,j4=.005696614583333333,B4=.3076171875;function ty(i){var t=[];t[0]=I4-i*(R4+i*(y2+i*(x2+i*b2))),t[1]=i*(N4-i*(y2+i*(x2+i*b2)));var e=i*i;return t[2]=e*(F4-i*(O4+i*k4)),e*=i,t[3]=e*(D4-i*j4),t[4]=e*i*B4,t}function ld(i,t,e,n){return e*=t,t*=t,n[0]*i-e*(n[1]+t*(n[2]+t*(n[3]+t*n[4])))}var G4=20;function ey(i,t,e){for(var n=1/(1-t),r=i,s=G4;s;--s){var a=Math.sin(r),o=1-t*a*a;if(o=(ld(r,a,Math.cos(r),e)-i)*(o*Math.sqrt(o))*n,r-=o,Math.abs(o)<kt)return r}return r}function z4(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=ty(this.es),this.ml0=ld(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function q4(i){var t=i.x,e=i.y,n=Gt(t-this.long0),r,s,a,o=Math.sin(e),l=Math.cos(e);if(this.es){var c=l*n,f=Math.pow(c,2),g=this.ep2*Math.pow(l,2),d=Math.pow(g,2),m=Math.abs(l)>kt?Math.tan(e):0,y=Math.pow(m,2),b=Math.pow(y,2);r=1-this.es*Math.pow(o,2),c=c/Math.sqrt(r);var x=ld(e,o,l,this.en);s=this.a*(this.k0*c*(1+f/6*(1-y+g+f/20*(5-18*y+b+14*g-58*y*g+f/42*(61+179*b-b*y-479*y)))))+this.x0,a=this.a*(this.k0*(x-this.ml0+o*n*c/2*(1+f/12*(5-y+9*g+4*d+f/30*(61+b-58*y+270*g-330*y*g+f/56*(1385+543*b-b*y-3111*y))))))+this.y0}else{var h=l*Math.sin(n);if(Math.abs(Math.abs(h)-1)<kt)return 93;if(s=.5*this.a*this.k0*Math.log((1+h)/(1-h))+this.x0,a=l*Math.cos(n)/Math.sqrt(1-Math.pow(h,2)),h=Math.abs(a),h>=1){if(h-1>kt)return 93;a=0}else a=Math.acos(a);e<0&&(a=-a),a=this.a*this.k0*(a-this.lat0)+this.y0}return i.x=s,i.y=a,i}function U4(i){var t,e,n,r,s=(i.x-this.x0)*(1/this.a),a=(i.y-this.y0)*(1/this.a);if(this.es)if(t=this.ml0+a/this.k0,e=ey(t,this.es,this.en),Math.abs(e)<Mt){var f=Math.sin(e),g=Math.cos(e),d=Math.abs(g)>kt?Math.tan(e):0,m=this.ep2*Math.pow(g,2),y=Math.pow(m,2),b=Math.pow(d,2),x=Math.pow(b,2);t=1-this.es*Math.pow(f,2);var E=s*Math.sqrt(t)/this.k0,S=Math.pow(E,2);t=t*d,n=e-t*S/(1-this.es)*.5*(1-S/12*(5+3*b-9*m*b+m-4*y-S/30*(61+90*b-252*m*b+45*x+46*m-S/56*(1385+3633*b+4095*x+1574*x*b)))),r=Gt(this.long0+E*(1-S/6*(1+2*b+m-S/20*(5+28*b+24*x+8*m*b+6*m-S/42*(61+662*b+1320*x+720*x*b))))/g)}else n=Mt*bc(a),r=0;else{var o=Math.exp(s/this.k0),l=.5*(o-1/o),h=this.lat0+a/this.k0,c=Math.cos(h);t=Math.sqrt((1-Math.pow(c,2))/(1+Math.pow(l,2))),n=Math.asin(t),a<0&&(n=-n),l===0&&c===0?r=0:r=Gt(Math.atan2(l,c)+this.long0)}return i.x=r,i.y=n,i}var W4=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const Zu={init:z4,forward:q4,inverse:U4,names:W4};function iy(i){var t=Math.exp(i);return t=(t-1/t)/2,t}function hr(i,t){i=Math.abs(i),t=Math.abs(t);var e=Math.max(i,t),n=Math.min(i,t)/(e||1);return e*Math.sqrt(1+Math.pow(n,2))}function V4(i){var t=1+i,e=t-1;return e===0?i:i*Math.log(t)/e}function H4(i){var t=Math.abs(i);return t=V4(t*(1+t/(hr(1,t)+1))),i<0?-t:t}function j1(i,t){for(var e=2*Math.cos(2*t),n=i.length-1,r=i[n],s=0,a;--n>=0;)a=-s+e*r+i[n],s=r,r=a;return t+a*Math.sin(2*t)}function X4(i,t){for(var e=2*Math.cos(t),n=i.length-1,r=i[n],s=0,a;--n>=0;)a=-s+e*r+i[n],s=r,r=a;return Math.sin(t)*a}function Y4(i){var t=Math.exp(i);return t=(t+1/t)/2,t}function ny(i,t,e){for(var n=Math.sin(t),r=Math.cos(t),s=iy(e),a=Y4(e),o=2*r*a,l=-2*n*s,h=i.length-1,c=i[h],f=0,g=0,d=0,m,y;--h>=0;)m=g,y=f,g=c,f=d,c=-m+o*g-l*f+i[h],d=-y+l*g+o*f;return o=n*a,l=r*s,[o*c-l*d,o*d+l*c]}function Z4(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(Zu.init.apply(this),this.forward=Zu.forward,this.inverse=Zu.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var i=this.es/(1+Math.sqrt(1-this.es)),t=i/(2-i),e=t;this.cgb[0]=t*(2+t*(-2/3+t*(-2+t*(116/45+t*(26/45+t*(-2854/675)))))),this.cbg[0]=t*(-2+t*(2/3+t*(4/3+t*(-82/45+t*(32/45+t*(4642/4725)))))),e=e*t,this.cgb[1]=e*(7/3+t*(-8/5+t*(-227/45+t*(2704/315+t*(2323/945))))),this.cbg[1]=e*(5/3+t*(-16/15+t*(-13/9+t*(904/315+t*(-1522/945))))),e=e*t,this.cgb[2]=e*(56/15+t*(-136/35+t*(-1262/105+t*(73814/2835)))),this.cbg[2]=e*(-26/15+t*(34/21+t*(8/5+t*(-12686/2835)))),e=e*t,this.cgb[3]=e*(4279/630+t*(-332/35+t*(-399572/14175))),this.cbg[3]=e*(1237/630+t*(-12/5+t*(-24832/14175))),e=e*t,this.cgb[4]=e*(4174/315+t*(-144838/6237)),this.cbg[4]=e*(-734/315+t*(109598/31185)),e=e*t,this.cgb[5]=e*(601676/22275),this.cbg[5]=e*(444337/155925),e=Math.pow(t,2),this.Qn=this.k0/(1+t)*(1+e*(1/4+e*(1/64+e/256))),this.utg[0]=t*(-.5+t*(2/3+t*(-37/96+t*(1/360+t*(81/512+t*(-96199/604800)))))),this.gtu[0]=t*(.5+t*(-2/3+t*(5/16+t*(41/180+t*(-127/288+t*(7891/37800)))))),this.utg[1]=e*(-1/48+t*(-1/15+t*(437/1440+t*(-46/105+t*(1118711/3870720))))),this.gtu[1]=e*(13/48+t*(-3/5+t*(557/1440+t*(281/630+t*(-1983433/1935360))))),e=e*t,this.utg[2]=e*(-17/480+t*(37/840+t*(209/4480+t*(-5569/90720)))),this.gtu[2]=e*(61/240+t*(-103/140+t*(15061/26880+t*(167603/181440)))),e=e*t,this.utg[3]=e*(-4397/161280+t*(11/504+t*(830251/7257600))),this.gtu[3]=e*(49561/161280+t*(-179/168+t*(6601661/7257600))),e=e*t,this.utg[4]=e*(-4583/161280+t*(108847/3991680)),this.gtu[4]=e*(34729/80640+t*(-3418889/1995840)),e=e*t,this.utg[5]=e*(-20648693/638668800),this.gtu[5]=e*(212378941/319334400);var n=j1(this.cbg,this.lat0);this.Zb=-this.Qn*(n+X4(this.gtu,2*n))}function K4(i){var t=Gt(i.x-this.long0),e=i.y;e=j1(this.cbg,e);var n=Math.sin(e),r=Math.cos(e),s=Math.sin(t),a=Math.cos(t);e=Math.atan2(n,a*r),t=Math.atan2(s*r,hr(n,r*a)),t=H4(Math.tan(t));var o=ny(this.gtu,2*e,2*t);e=e+o[0],t=t+o[1];var l,h;return Math.abs(t)<=2.623395162778?(l=this.a*(this.Qn*t)+this.x0,h=this.a*(this.Qn*e+this.Zb)+this.y0):(l=1/0,h=1/0),i.x=l,i.y=h,i}function $4(i){var t=(i.x-this.x0)*(1/this.a),e=(i.y-this.y0)*(1/this.a);e=(e-this.Zb)/this.Qn,t=t/this.Qn;var n,r;if(Math.abs(t)<=2.623395162778){var s=ny(this.utg,2*e,2*t);e=e+s[0],t=t+s[1],t=Math.atan(iy(t));var a=Math.sin(e),o=Math.cos(e),l=Math.sin(t),h=Math.cos(t);e=Math.atan2(a*h,hr(l,h*o)),t=Math.atan2(l,h*o),n=Gt(t+this.long0),r=j1(this.cgb,e)}else n=1/0,r=1/0;return i.x=n,i.y=r,i}var J4=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const Ku={init:Z4,forward:K4,inverse:$4,names:J4};function Q4(i,t){if(i===void 0){if(i=Math.floor((Gt(t)+Math.PI)*30/Math.PI)+1,i<0)return 0;if(i>60)return 60}return i}var tC="etmerc";function eC(){var i=Q4(this.zone,this.long0);if(i===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(i)-183)*tn,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Ku.init.apply(this),this.forward=Ku.forward,this.inverse=Ku.inverse}var iC=["Universal Transverse Mercator System","utm"];const nC={init:eC,names:iC,dependsOn:tC};function B1(i,t){return Math.pow((1-i)/(1+i),t)}var rC=20;function sC(){var i=Math.sin(this.lat0),t=Math.cos(this.lat0);t*=t,this.rc=Math.sqrt(1-this.es)/(1-this.es*i*i),this.C=Math.sqrt(1+this.es*t*t/(1-this.es)),this.phic0=Math.asin(i/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Ge)/(Math.pow(Math.tan(.5*this.lat0+Ge),this.C)*B1(this.e*i,this.ratexp))}function aC(i){var t=i.x,e=i.y;return i.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*e+Ge),this.C)*B1(this.e*Math.sin(e),this.ratexp))-Mt,i.x=this.C*t,i}function oC(i){for(var t=1e-14,e=i.x/this.C,n=i.y,r=Math.pow(Math.tan(.5*n+Ge)/this.K,1/this.C),s=rC;s>0&&(n=2*Math.atan(r*B1(this.e*Math.sin(i.y),-.5*this.e))-Mt,!(Math.abs(n-i.y)<t));--s)i.y=n;return s?(i.x=e,i.y=n,i):null}var lC=["gauss"];const G1={init:sC,forward:aC,inverse:oC,names:lC};function hC(){G1.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function cC(i){var t,e,n,r;return i.x=Gt(i.x-this.long0),G1.forward.apply(this,[i]),t=Math.sin(i.y),e=Math.cos(i.y),n=Math.cos(i.x),r=this.k0*this.R2/(1+this.sinc0*t+this.cosc0*e*n),i.x=r*e*Math.sin(i.x),i.y=r*(this.cosc0*t-this.sinc0*e*n),i.x=this.a*i.x+this.x0,i.y=this.a*i.y+this.y0,i}function uC(i){var t,e,n,r,s;if(i.x=(i.x-this.x0)/this.a,i.y=(i.y-this.y0)/this.a,i.x/=this.k0,i.y/=this.k0,s=hr(i.x,i.y)){var a=2*Math.atan2(s,this.R2);t=Math.sin(a),e=Math.cos(a),r=Math.asin(e*this.sinc0+i.y*t*this.cosc0/s),n=Math.atan2(i.x*t,s*this.cosc0*e-i.y*this.sinc0*t)}else r=this.phic0,n=0;return i.x=n,i.y=r,G1.inverse.apply(this,[i]),i.x=Gt(i.x+this.long0),i}var fC=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const dC={init:hC,forward:cC,inverse:uC,names:fC};function gC(i,t,e){return t*=e,Math.tan(.5*(Mt+i))*Math.pow((1-t)/(1+t),.5*e)}function pC(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=kt&&(this.k0=.5*(1+bc(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=kt&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=kt&&Math.abs(Math.cos(this.lat_ts))>kt&&(this.k0=.5*this.cons*rs(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Rr(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=rs(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-Mt,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function mC(i){var t=i.x,e=i.y,n=Math.sin(e),r=Math.cos(e),s,a,o,l,h,c,f=Gt(t-this.long0);return Math.abs(Math.abs(t-this.long0)-Math.PI)<=kt&&Math.abs(e+this.lat0)<=kt?(i.x=NaN,i.y=NaN,i):this.sphere?(s=2*this.k0/(1+this.sinlat0*n+this.coslat0*r*Math.cos(f)),i.x=this.a*s*r*Math.sin(f)+this.x0,i.y=this.a*s*(this.coslat0*n-this.sinlat0*r*Math.cos(f))+this.y0,i):(a=2*Math.atan(this.ssfn_(e,n,this.e))-Mt,l=Math.cos(a),o=Math.sin(a),Math.abs(this.coslat0)<=kt?(h=Rr(this.e,e*this.con,this.con*n),c=2*this.a*this.k0*h/this.cons,i.x=this.x0+c*Math.sin(t-this.long0),i.y=this.y0-this.con*c*Math.cos(t-this.long0),i):(Math.abs(this.sinlat0)<kt?(s=2*this.a*this.k0/(1+l*Math.cos(f)),i.y=s*o):(s=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*o+this.cosX0*l*Math.cos(f))),i.y=s*(this.cosX0*o-this.sinX0*l*Math.cos(f))+this.y0),i.x=s*l*Math.sin(f)+this.x0,i))}function _C(i){i.x-=this.x0,i.y-=this.y0;var t,e,n,r,s,a=Math.sqrt(i.x*i.x+i.y*i.y);if(this.sphere){var o=2*Math.atan(a/(2*this.a*this.k0));return t=this.long0,e=this.lat0,a<=kt?(i.x=t,i.y=e,i):(e=Math.asin(Math.cos(o)*this.sinlat0+i.y*Math.sin(o)*this.coslat0/a),Math.abs(this.coslat0)<kt?this.lat0>0?t=Gt(this.long0+Math.atan2(i.x,-1*i.y)):t=Gt(this.long0+Math.atan2(i.x,i.y)):t=Gt(this.long0+Math.atan2(i.x*Math.sin(o),a*this.coslat0*Math.cos(o)-i.y*this.sinlat0*Math.sin(o))),i.x=t,i.y=e,i)}else if(Math.abs(this.coslat0)<=kt){if(a<=kt)return e=this.lat0,t=this.long0,i.x=t,i.y=e,i;i.x*=this.con,i.y*=this.con,n=a*this.cons/(2*this.a*this.k0),e=this.con*lc(this.e,n),t=this.con*Gt(this.con*this.long0+Math.atan2(i.x,-1*i.y))}else r=2*Math.atan(a*this.cosX0/(2*this.a*this.k0*this.ms1)),t=this.long0,a<=kt?s=this.X0:(s=Math.asin(Math.cos(r)*this.sinX0+i.y*Math.sin(r)*this.cosX0/a),t=Gt(this.long0+Math.atan2(i.x*Math.sin(r),a*this.cosX0*Math.cos(r)-i.y*this.sinX0*Math.sin(r)))),e=-1*lc(this.e,Math.tan(.5*(Mt+s)));return i.x=t,i.y=e,i}var vC=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)","Polar_Stereographic"];const yC={init:pC,forward:mC,inverse:_C,names:vC,ssfn_:gC};function xC(){var i=this.lat0;this.lambda0=this.long0;var t=Math.sin(i),e=this.a,n=this.rf,r=1/n,s=2*r-Math.pow(r,2),a=this.e=Math.sqrt(s);this.R=this.k0*e*Math.sqrt(1-s)/(1-s*Math.pow(t,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(i),4)),this.b0=Math.asin(t/this.alpha);var o=Math.log(Math.tan(Math.PI/4+this.b0/2)),l=Math.log(Math.tan(Math.PI/4+i/2)),h=Math.log((1+a*t)/(1-a*t));this.K=o-this.alpha*l+this.alpha*a/2*h}function bC(i){var t=Math.log(Math.tan(Math.PI/4-i.y/2)),e=this.e/2*Math.log((1+this.e*Math.sin(i.y))/(1-this.e*Math.sin(i.y))),n=-this.alpha*(t+e)+this.K,r=2*(Math.atan(Math.exp(n))-Math.PI/4),s=this.alpha*(i.x-this.lambda0),a=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(s))),o=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(s));return i.y=this.R/2*Math.log((1+Math.sin(o))/(1-Math.sin(o)))+this.y0,i.x=this.R*a+this.x0,i}function wC(i){for(var t=i.x-this.x0,e=i.y-this.y0,n=t/this.R,r=2*(Math.atan(Math.exp(e/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(r)+Math.sin(this.b0)*Math.cos(r)*Math.cos(n)),a=Math.atan(Math.sin(n)/(Math.cos(this.b0)*Math.cos(n)-Math.sin(this.b0)*Math.tan(r))),o=this.lambda0+a/this.alpha,l=0,h=s,c=-1e3,f=0;Math.abs(h-c)>1e-7;){if(++f>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(h))/2)),c=h,h=2*Math.atan(Math.exp(l))-Math.PI/2}return i.x=o,i.y=h,i}var EC=["somerc"];const SC={init:xC,forward:bC,inverse:wC,names:EC};var el=1e-7;function LC(i){var t=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],e=typeof i.PROJECTION=="object"?Object.keys(i.PROJECTION)[0]:i.PROJECTION;return"no_uoff"in i||"no_off"in i||t.indexOf(e)!==-1}function CC(){var i,t,e,n,r,s,a,o,l,h,c=0,f,g=0,d=0,m=0,y=0,b=0,x=0;this.no_off=LC(this),this.no_rot="no_rot"in this;var E=!1;"alpha"in this&&(E=!0);var S=!1;if("rectified_grid_angle"in this&&(S=!0),E&&(x=this.alpha),S&&(c=this.rectified_grid_angle*tn),E||S)g=this.longc;else if(d=this.long1,y=this.lat1,m=this.long2,b=this.lat2,Math.abs(y-b)<=el||(i=Math.abs(y))<=el||Math.abs(i-Mt)<=el||Math.abs(Math.abs(this.lat0)-Mt)<=el||Math.abs(Math.abs(b)-Mt)<=el)throw new Error;var M=1-this.es;t=Math.sqrt(M),Math.abs(this.lat0)>kt?(o=Math.sin(this.lat0),e=Math.cos(this.lat0),i=1-this.es*o*o,this.B=e*e,this.B=Math.sqrt(1+this.es*this.B*this.B/M),this.A=this.B*this.k0*t/i,n=this.B*t/(e*Math.sqrt(i)),r=n*n-1,r<=0?r=0:(r=Math.sqrt(r),this.lat0<0&&(r=-r)),this.E=r+=n,this.E*=Math.pow(Rr(this.e,this.lat0,o),this.B)):(this.B=1/t,this.A=this.k0,this.E=n=r=1),E||S?(E?(f=Math.asin(Math.sin(x)/n),S||(c=x)):(f=c,x=Math.asin(n*Math.sin(f))),this.lam0=g-Math.asin(.5*(r-1/r)*Math.tan(f))/this.B):(s=Math.pow(Rr(this.e,y,Math.sin(y)),this.B),a=Math.pow(Rr(this.e,b,Math.sin(b)),this.B),r=this.E/s,l=(a-s)/(a+s),h=this.E*this.E,h=(h-a*s)/(h+a*s),i=d-m,i<-Math.pi?m-=ac:i>Math.pi&&(m+=ac),this.lam0=Gt(.5*(d+m)-Math.atan(h*Math.tan(.5*this.B*(d-m))/l)/this.B),f=Math.atan(2*Math.sin(this.B*Gt(d-this.lam0))/(r-1/r)),c=x=Math.asin(n*Math.sin(f))),this.singam=Math.sin(f),this.cosgam=Math.cos(f),this.sinrot=Math.sin(c),this.cosrot=Math.cos(c),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A*this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(n*n-1)/Math.cos(x))),this.lat0<0&&(this.u_0=-this.u_0)),r=.5*f,this.v_pole_n=this.ArB*Math.log(Math.tan(Ge-r)),this.v_pole_s=this.ArB*Math.log(Math.tan(Ge+r))}function AC(i){var t={},e,n,r,s,a,o,l,h;if(i.x=i.x-this.lam0,Math.abs(Math.abs(i.y)-Mt)>kt){if(a=this.E/Math.pow(Rr(this.e,i.y,Math.sin(i.y)),this.B),o=1/a,e=.5*(a-o),n=.5*(a+o),s=Math.sin(this.B*i.x),r=(e*this.singam-s*this.cosgam)/n,Math.abs(Math.abs(r)-1)<kt)throw new Error;h=.5*this.ArB*Math.log((1-r)/(1+r)),o=Math.cos(this.B*i.x),Math.abs(o)<el?l=this.A*i.x:l=this.ArB*Math.atan2(e*this.cosgam+s*this.singam,o)}else h=i.y>0?this.v_pole_n:this.v_pole_s,l=this.ArB*i.y;return this.no_rot?(t.x=l,t.y=h):(l-=this.u_0,t.x=h*this.cosrot+l*this.sinrot,t.y=l*this.cosrot-h*this.sinrot),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function MC(i){var t,e,n,r,s,a,o,l={};if(i.x=(i.x-this.x0)*(1/this.a),i.y=(i.y-this.y0)*(1/this.a),this.no_rot?(e=i.y,t=i.x):(e=i.x*this.cosrot-i.y*this.sinrot,t=i.y*this.cosrot+i.x*this.sinrot+this.u_0),n=Math.exp(-this.BrA*e),r=.5*(n-1/n),s=.5*(n+1/n),a=Math.sin(this.BrA*t),o=(a*this.cosgam+r*this.singam)/s,Math.abs(Math.abs(o)-1)<kt)l.x=0,l.y=o<0?-Mt:Mt;else{if(l.y=this.E/Math.sqrt((1+o)/(1-o)),l.y=lc(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(r*this.cosgam-a*this.singam,Math.cos(this.BrA*t))}return l.x+=this.lam0,l}var TC=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const PC={init:CC,forward:AC,inverse:MC,names:TC};function IC(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<kt)){var i=this.b/this.a;this.e=Math.sqrt(1-i*i);var t=Math.sin(this.lat1),e=Math.cos(this.lat1),n=rs(this.e,t,e),r=Rr(this.e,this.lat1,t),s=Math.sin(this.lat2),a=Math.cos(this.lat2),o=rs(this.e,s,a),l=Rr(this.e,this.lat2,s),h=Rr(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>kt?this.ns=Math.log(n/o)/Math.log(r/l):this.ns=t,isNaN(this.ns)&&(this.ns=t),this.f0=n/(this.ns*Math.pow(r,this.ns)),this.rh=this.a*this.f0*Math.pow(h,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function RC(i){var t=i.x,e=i.y;Math.abs(2*Math.abs(e)-Math.PI)<=kt&&(e=bc(e)*(Mt-2*kt));var n=Math.abs(Math.abs(e)-Mt),r,s;if(n>kt)r=Rr(this.e,e,Math.sin(e)),s=this.a*this.f0*Math.pow(r,this.ns);else{if(n=e*this.ns,n<=0)return null;s=0}var a=this.ns*Gt(t-this.long0);return i.x=this.k0*(s*Math.sin(a))+this.x0,i.y=this.k0*(this.rh-s*Math.cos(a))+this.y0,i}function NC(i){var t,e,n,r,s,a=(i.x-this.x0)/this.k0,o=this.rh-(i.y-this.y0)/this.k0;this.ns>0?(t=Math.sqrt(a*a+o*o),e=1):(t=-Math.sqrt(a*a+o*o),e=-1);var l=0;if(t!==0&&(l=Math.atan2(e*a,e*o)),t!==0||this.ns>0){if(e=1/this.ns,n=Math.pow(t/(this.a*this.f0),e),r=lc(this.e,n),r===-9999)return null}else r=-Mt;return s=Gt(l/this.ns+this.long0),i.x=s,i.y=r,i}var FC=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const OC={init:IC,forward:RC,inverse:NC,names:FC};function kC(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function DC(i){var t,e,n,r,s,a,o,l=i.x,h=i.y,c=Gt(l-this.long0);return t=Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.alfa*this.e/2),e=2*(Math.atan(this.k*Math.pow(Math.tan(h/2+this.s45),this.alfa)/t)-this.s45),n=-c*this.alfa,r=Math.asin(Math.cos(this.ad)*Math.sin(e)+Math.sin(this.ad)*Math.cos(e)*Math.cos(n)),s=Math.asin(Math.cos(e)*Math.sin(n)/Math.cos(r)),a=this.n*s,o=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(r/2+this.s45),this.n),i.y=o*Math.cos(a)/1,i.x=o*Math.sin(a)/1,this.czech||(i.y*=-1,i.x*=-1),i}function jC(i){var t,e,n,r,s,a,o,l,h=i.x;i.x=i.y,i.y=h,this.czech||(i.y*=-1,i.x*=-1),a=Math.sqrt(i.x*i.x+i.y*i.y),s=Math.atan2(i.y,i.x),r=s/Math.sin(this.s0),n=2*(Math.atan(Math.pow(this.ro0/a,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),t=Math.asin(Math.cos(this.ad)*Math.sin(n)-Math.sin(this.ad)*Math.cos(n)*Math.cos(r)),e=Math.asin(Math.cos(n)*Math.sin(r)/Math.cos(t)),i.x=this.long0-e/this.alfa,o=t,l=0;var c=0;do i.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(t/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(o))/(1-this.e*Math.sin(o)),this.e/2))-this.s45),Math.abs(o-i.y)<1e-10&&(l=1),o=i.y,c+=1;while(l===0&&c<15);return c>=15?null:i}var BC=["Krovak","krovak"];const GC={init:kC,forward:DC,inverse:jC,names:BC};function Ln(i,t,e,n,r){return i*r-t*Math.sin(2*r)+e*Math.sin(4*r)-n*Math.sin(6*r)}function wc(i){return 1-.25*i*(1+i/16*(3+1.25*i))}function Ec(i){return .375*i*(1+.25*i*(1+.46875*i))}function Sc(i){return .05859375*i*i*(1+.75*i)}function Lc(i){return i*i*i*(35/3072)}function Il(i,t,e){var n=t*e;return i/Math.sqrt(1-n*n)}function ql(i){return Math.abs(i)<Mt?i:i-bc(i)*Math.PI}function Lf(i,t,e,n,r){var s,a;s=i/t;for(var o=0;o<15;o++)if(a=(i-(t*s-e*Math.sin(2*s)+n*Math.sin(4*s)-r*Math.sin(6*s)))/(t-2*e*Math.cos(2*s)+4*n*Math.cos(4*s)-6*r*Math.cos(6*s)),s+=a,Math.abs(a)<=1e-10)return s;return NaN}function zC(){this.sphere||(this.e0=wc(this.es),this.e1=Ec(this.es),this.e2=Sc(this.es),this.e3=Lc(this.es),this.ml0=this.a*Ln(this.e0,this.e1,this.e2,this.e3,this.lat0))}function qC(i){var t,e,n=i.x,r=i.y;if(n=Gt(n-this.long0),this.sphere)t=this.a*Math.asin(Math.cos(r)*Math.sin(n)),e=this.a*(Math.atan2(Math.tan(r),Math.cos(n))-this.lat0);else{var s=Math.sin(r),a=Math.cos(r),o=Il(this.a,this.e,s),l=Math.tan(r)*Math.tan(r),h=n*Math.cos(r),c=h*h,f=this.es*a*a/(1-this.es),g=this.a*Ln(this.e0,this.e1,this.e2,this.e3,r);t=o*h*(1-c*l*(1/6-(8-l+8*f)*c/120)),e=g-this.ml0+o*s/a*c*(.5+(5-l+6*f)*c/24)}return i.x=t+this.x0,i.y=e+this.y0,i}function UC(i){i.x-=this.x0,i.y-=this.y0;var t=i.x/this.a,e=i.y/this.a,n,r;if(this.sphere){var s=e+this.lat0;n=Math.asin(Math.sin(s)*Math.cos(t)),r=Math.atan2(Math.tan(t),Math.cos(s))}else{var a=this.ml0/this.a+e,o=Lf(a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-Mt)<=kt)return i.x=this.long0,i.y=Mt,e<0&&(i.y*=-1),i;var l=Il(this.a,this.e,Math.sin(o)),h=l*l*l/this.a/this.a*(1-this.es),c=Math.pow(Math.tan(o),2),f=t*this.a/l,g=f*f;n=o-l*Math.tan(o)/h*f*f*(.5-(1+3*c)*f*f/24),r=f*(1-g*(c/3+(1+3*c)*c*g/15))/Math.cos(o)}return i.x=Gt(r+this.long0),i.y=ql(n),i}var WC=["Cassini","Cassini_Soldner","cass"];const VC={init:zC,forward:qC,inverse:UC,names:WC};function ma(i,t){var e;return i>1e-7?(e=i*t,(1-i*i)*(t/(1-e*e)-.5/i*Math.log((1-e)/(1+e)))):2*t}var HC=1,XC=2,YC=3,ZC=4;function KC(){var i=Math.abs(this.lat0);if(Math.abs(i-Mt)<kt?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(i)<kt?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var t;switch(this.qp=ma(this.e,1),this.mmf=.5/(1-this.es),this.apa=sA(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=ma(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function $C(i){var t,e,n,r,s,a,o,l,h,c,f=i.x,g=i.y;if(f=Gt(f-this.long0),this.sphere){if(s=Math.sin(g),c=Math.cos(g),n=Math.cos(f),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e=this.mode===this.EQUIT?1+c*n:1+this.sinph0*s+this.cosph0*c*n,e<=kt)return null;e=Math.sqrt(2/e),t=e*c*Math.sin(f),e*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*c*n}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),Math.abs(g+this.lat0)<kt)return null;e=Ge-g*.5,e=2*(this.mode===this.S_POLE?Math.cos(e):Math.sin(e)),t=e*Math.sin(f),e*=n}}else{switch(o=0,l=0,h=0,n=Math.cos(f),r=Math.sin(f),s=Math.sin(g),a=ma(this.e,s),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(o=a/this.qp,l=Math.sqrt(1-o*o)),this.mode){case this.OBLIQ:h=1+this.sinb1*o+this.cosb1*l*n;break;case this.EQUIT:h=1+l*n;break;case this.N_POLE:h=Mt+g,a=this.qp-a;break;case this.S_POLE:h=g-Mt,a=this.qp+a;break}if(Math.abs(h)<kt)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:h=Math.sqrt(2/h),this.mode===this.OBLIQ?e=this.ymf*h*(this.cosb1*o-this.sinb1*l*n):e=(h=Math.sqrt(2/(1+l*n)))*o*this.ymf,t=this.xmf*h*l*r;break;case this.N_POLE:case this.S_POLE:a>=0?(t=(h=Math.sqrt(a))*r,e=n*(this.mode===this.S_POLE?h:-h)):t=e=0;break}}return i.x=this.a*t+this.x0,i.y=this.a*e+this.y0,i}function JC(i){i.x-=this.x0,i.y-=this.y0;var t=i.x/this.a,e=i.y/this.a,n,r,s,a,o,l,h;if(this.sphere){var c=0,f,g=0;if(f=Math.sqrt(t*t+e*e),r=f*.5,r>1)return null;switch(r=2*Math.asin(r),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(g=Math.sin(r),c=Math.cos(r)),this.mode){case this.EQUIT:r=Math.abs(f)<=kt?0:Math.asin(e*g/f),t*=g,e=c*f;break;case this.OBLIQ:r=Math.abs(f)<=kt?this.lat0:Math.asin(c*this.sinph0+e*g*this.cosph0/f),t*=g*this.cosph0,e=(c-Math.sin(r)*this.sinph0)*f;break;case this.N_POLE:e=-e,r=Mt-r;break;case this.S_POLE:r-=Mt;break}n=e===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(t,e)}else{if(h=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t/=this.dd,e*=this.dd,l=Math.sqrt(t*t+e*e),l<kt)return i.x=this.long0,i.y=this.lat0,i;a=2*Math.asin(.5*l/this.rq),s=Math.cos(a),t*=a=Math.sin(a),this.mode===this.OBLIQ?(h=s*this.sinb1+e*a*this.cosb1/l,o=this.qp*h,e=l*this.cosb1*s-e*this.sinb1*a):(h=e*a/l,o=this.qp*h,e=l*s)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(e=-e),o=t*t+e*e,!o)return i.x=this.long0,i.y=this.lat0,i;h=1-o/this.qp,this.mode===this.S_POLE&&(h=-h)}n=Math.atan2(t,e),r=aA(Math.asin(h),this.apa)}return i.x=Gt(this.long0+n),i.y=r,i}var QC=.3333333333333333,tA=.17222222222222222,eA=.10257936507936508,iA=.06388888888888888,nA=.0664021164021164,rA=.016415012942191543;function sA(i){var t,e=[];return e[0]=i*QC,t=i*i,e[0]+=t*tA,e[1]=t*iA,t*=i,e[0]+=t*eA,e[1]+=t*nA,e[2]=t*rA,e}function aA(i,t){var e=i+i;return i+t[0]*Math.sin(e)+t[1]*Math.sin(e+e)+t[2]*Math.sin(e+e+e)}var oA=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const lA={init:KC,forward:$C,inverse:JC,names:oA,S_POLE:HC,N_POLE:XC,EQUIT:YC,OBLIQ:ZC};function Ca(i){return Math.abs(i)>1&&(i=i>1?1:-1),Math.asin(i)}function hA(){Math.abs(this.lat1+this.lat2)<kt||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=rs(this.e3,this.sin_po,this.cos_po),this.qs1=ma(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=rs(this.e3,this.sin_po,this.cos_po),this.qs2=ma(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=ma(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>kt?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function cA(i){var t=i.x,e=i.y;this.sin_phi=Math.sin(e),this.cos_phi=Math.cos(e);var n=ma(this.e3,this.sin_phi),r=this.a*Math.sqrt(this.c-this.ns0*n)/this.ns0,s=this.ns0*Gt(t-this.long0),a=r*Math.sin(s)+this.x0,o=this.rh-r*Math.cos(s)+this.y0;return i.x=a,i.y=o,i}function uA(i){var t,e,n,r,s,a;return i.x-=this.x0,i.y=this.rh-i.y+this.y0,this.ns0>=0?(t=Math.sqrt(i.x*i.x+i.y*i.y),n=1):(t=-Math.sqrt(i.x*i.x+i.y*i.y),n=-1),r=0,t!==0&&(r=Math.atan2(n*i.x,n*i.y)),n=t*this.ns0/this.a,this.sphere?a=Math.asin((this.c-n*n)/(2*this.ns0)):(e=(this.c-n*n)/this.ns0,a=this.phi1z(this.e3,e)),s=Gt(r/this.ns0+this.long0),i.x=s,i.y=a,i}function fA(i,t){var e,n,r,s,a,o=Ca(.5*t);if(i<kt)return o;for(var l=i*i,h=1;h<=25;h++)if(e=Math.sin(o),n=Math.cos(o),r=i*e,s=1-r*r,a=.5*s*s/n*(t/(1-l)-e/s+.5/i*Math.log((1-r)/(1+r))),o=o+a,Math.abs(a)<=1e-7)return o;return null}var dA=["Albers_Conic_Equal_Area","Albers","aea"];const gA={init:hA,forward:cA,inverse:uA,names:dA,phi1z:fA};function pA(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function mA(i){var t,e,n,r,s,a,o,l,h=i.x,c=i.y;return n=Gt(h-this.long0),t=Math.sin(c),e=Math.cos(c),r=Math.cos(n),a=this.sin_p14*t+this.cos_p14*e*r,s=1,a>0||Math.abs(a)<=kt?(o=this.x0+this.a*s*e*Math.sin(n)/a,l=this.y0+this.a*s*(this.cos_p14*t-this.sin_p14*e*r)/a):(o=this.x0+this.infinity_dist*e*Math.sin(n),l=this.y0+this.infinity_dist*(this.cos_p14*t-this.sin_p14*e*r)),i.x=o,i.y=l,i}function _A(i){var t,e,n,r,s,a;return i.x=(i.x-this.x0)/this.a,i.y=(i.y-this.y0)/this.a,i.x/=this.k0,i.y/=this.k0,(t=Math.sqrt(i.x*i.x+i.y*i.y))?(r=Math.atan2(t,this.rc),e=Math.sin(r),n=Math.cos(r),a=Ca(n*this.sin_p14+i.y*e*this.cos_p14/t),s=Math.atan2(i.x*e,t*this.cos_p14*n-i.y*this.sin_p14*e),s=Gt(this.long0+s)):(a=this.phic0,s=0),i.x=s,i.y=a,i}var vA=["gnom"];const yA={init:pA,forward:mA,inverse:_A,names:vA};function xA(i,t){var e=1-(1-i*i)/(2*i)*Math.log((1-i)/(1+i));if(Math.abs(Math.abs(t)-e)<1e-6)return t<0?-1*Mt:Mt;for(var n=Math.asin(.5*t),r,s,a,o,l=0;l<30;l++)if(s=Math.sin(n),a=Math.cos(n),o=i*s,r=Math.pow(1-o*o,2)/(2*a)*(t/(1-i*i)-s/(1-o*o)+.5/i*Math.log((1-o)/(1+o))),n+=r,Math.abs(r)<=1e-10)return n;return NaN}function bA(){this.sphere||(this.k0=rs(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function wA(i){var t=i.x,e=i.y,n,r,s=Gt(t-this.long0);if(this.sphere)n=this.x0+this.a*s*Math.cos(this.lat_ts),r=this.y0+this.a*Math.sin(e)/Math.cos(this.lat_ts);else{var a=ma(this.e,Math.sin(e));n=this.x0+this.a*this.k0*s,r=this.y0+this.a*a*.5/this.k0}return i.x=n,i.y=r,i}function EA(i){i.x-=this.x0,i.y-=this.y0;var t,e;return this.sphere?(t=Gt(this.long0+i.x/this.a/Math.cos(this.lat_ts)),e=Math.asin(i.y/this.a*Math.cos(this.lat_ts))):(e=xA(this.e,2*i.y*this.k0/this.a),t=Gt(this.long0+i.x/(this.a*this.k0))),i.x=t,i.y=e,i}var SA=["cea"];const LA={init:bA,forward:wA,inverse:EA,names:SA};function CA(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function AA(i){var t=i.x,e=i.y,n=Gt(t-this.long0),r=ql(e-this.lat0);return i.x=this.x0+this.a*n*this.rc,i.y=this.y0+this.a*r,i}function MA(i){var t=i.x,e=i.y;return i.x=Gt(this.long0+(t-this.x0)/(this.a*this.rc)),i.y=ql(this.lat0+(e-this.y0)/this.a),i}var TA=["Equirectangular","Equidistant_Cylindrical","eqc"];const PA={init:CA,forward:AA,inverse:MA,names:TA};var w2=20;function IA(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=wc(this.es),this.e1=Ec(this.es),this.e2=Sc(this.es),this.e3=Lc(this.es),this.ml0=this.a*Ln(this.e0,this.e1,this.e2,this.e3,this.lat0)}function RA(i){var t=i.x,e=i.y,n,r,s,a=Gt(t-this.long0);if(s=a*Math.sin(e),this.sphere)Math.abs(e)<=kt?(n=this.a*a,r=-1*this.a*this.lat0):(n=this.a*Math.sin(s)/Math.tan(e),r=this.a*(ql(e-this.lat0)+(1-Math.cos(s))/Math.tan(e)));else if(Math.abs(e)<=kt)n=this.a*a,r=-1*this.ml0;else{var o=Il(this.a,this.e,Math.sin(e))/Math.tan(e);n=o*Math.sin(s),r=this.a*Ln(this.e0,this.e1,this.e2,this.e3,e)-this.ml0+o*(1-Math.cos(s))}return i.x=n+this.x0,i.y=r+this.y0,i}function NA(i){var t,e,n,r,s,a,o,l,h;if(n=i.x-this.x0,r=i.y-this.y0,this.sphere)if(Math.abs(r+this.a*this.lat0)<=kt)t=Gt(n/this.a+this.long0),e=0;else{a=this.lat0+r/this.a,o=n*n/this.a/this.a+a*a,l=a;var c;for(s=w2;s;--s)if(c=Math.tan(l),h=-1*(a*(l*c+1)-l-.5*(l*l+o)*c)/((l-a)/c-1),l+=h,Math.abs(h)<=kt){e=l;break}t=Gt(this.long0+Math.asin(n*Math.tan(l)/this.a)/Math.sin(e))}else if(Math.abs(r+this.ml0)<=kt)e=0,t=Gt(this.long0+n/this.a);else{a=(this.ml0+r)/this.a,o=n*n/this.a/this.a+a*a,l=a;var f,g,d,m,y;for(s=w2;s;--s)if(y=this.e*Math.sin(l),f=Math.sqrt(1-y*y)*Math.tan(l),g=this.a*Ln(this.e0,this.e1,this.e2,this.e3,l),d=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),m=g/this.a,h=(a*(f*m+1)-m-.5*f*(m*m+o))/(this.es*Math.sin(2*l)*(m*m+o-2*a*m)/(4*f)+(a-m)*(f*d-2/Math.sin(2*l))-d),l-=h,Math.abs(h)<=kt){e=l;break}f=Math.sqrt(1-this.es*Math.pow(Math.sin(e),2))*Math.tan(e),t=Gt(this.long0+Math.asin(n*f/this.a)/Math.sin(e))}return i.x=t,i.y=e,i}var FA=["Polyconic","poly"];const OA={init:IA,forward:RA,inverse:NA,names:FA};function kA(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function DA(i){var t,e=i.x,n=i.y,r=n-this.lat0,s=e-this.long0,a=r/Dh*1e-5,o=s,l=1,h=0;for(t=1;t<=10;t++)l=l*a,h=h+this.A[t]*l;var c=h,f=o,g=1,d=0,m,y,b=0,x=0;for(t=1;t<=6;t++)m=g*c-d*f,y=d*c+g*f,g=m,d=y,b=b+this.B_re[t]*g-this.B_im[t]*d,x=x+this.B_im[t]*g+this.B_re[t]*d;return i.x=x*this.a+this.x0,i.y=b*this.a+this.y0,i}function jA(i){var t,e=i.x,n=i.y,r=e-this.x0,s=n-this.y0,a=s/this.a,o=r/this.a,l=1,h=0,c,f,g=0,d=0;for(t=1;t<=6;t++)c=l*a-h*o,f=h*a+l*o,l=c,h=f,g=g+this.C_re[t]*l-this.C_im[t]*h,d=d+this.C_im[t]*l+this.C_re[t]*h;for(var m=0;m<this.iterations;m++){var y=g,b=d,x,E,S=a,M=o;for(t=2;t<=6;t++)x=y*g-b*d,E=b*g+y*d,y=x,b=E,S=S+(t-1)*(this.B_re[t]*y-this.B_im[t]*b),M=M+(t-1)*(this.B_im[t]*y+this.B_re[t]*b);y=1,b=0;var D=this.B_re[1],W=this.B_im[1];for(t=2;t<=6;t++)x=y*g-b*d,E=b*g+y*d,y=x,b=E,D=D+t*(this.B_re[t]*y-this.B_im[t]*b),W=W+t*(this.B_im[t]*y+this.B_re[t]*b);var j=D*D+W*W;g=(S*D+M*W)/j,d=(M*D-S*W)/j}var P=g,H=d,et=1,R=0;for(t=1;t<=9;t++)et=et*P,R=R+this.D[t]*et;var F=this.lat0+R*Dh*1e5,U=this.long0+H;return i.x=U,i.y=F,i}var BA=["New_Zealand_Map_Grid","nzmg"];const GA={init:kA,forward:DA,inverse:jA,names:BA};function zA(){}function qA(i){var t=i.x,e=i.y,n=Gt(t-this.long0),r=this.x0+this.a*n,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+e/2.5))*1.25;return i.x=r,i.y=s,i}function UA(i){i.x-=this.x0,i.y-=this.y0;var t=Gt(this.long0+i.x/this.a),e=2.5*(Math.atan(Math.exp(.8*i.y/this.a))-Math.PI/4);return i.x=t,i.y=e,i}var WA=["Miller_Cylindrical","mill"];const VA={init:zA,forward:qA,inverse:UA,names:WA};var HA=20;function XA(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=ty(this.es)}function YA(i){var t,e,n=i.x,r=i.y;if(n=Gt(n-this.long0),this.sphere){if(!this.m)r=this.n!==1?Math.asin(this.n*Math.sin(r)):r;else for(var s=this.n*Math.sin(r),a=HA;a;--a){var o=(this.m*r+Math.sin(r)-s)/(this.m+Math.cos(r));if(r-=o,Math.abs(o)<kt)break}t=this.a*this.C_x*n*(this.m+Math.cos(r)),e=this.a*this.C_y*r}else{var l=Math.sin(r),h=Math.cos(r);e=this.a*ld(r,l,h,this.en),t=this.a*n*h/Math.sqrt(1-this.es*l*l)}return i.x=t,i.y=e,i}function ZA(i){var t,e,n,r;return i.x-=this.x0,n=i.x/this.a,i.y-=this.y0,t=i.y/this.a,this.sphere?(t/=this.C_y,n=n/(this.C_x*(this.m+Math.cos(t))),this.m?t=Ca((this.m*t+Math.sin(t))/this.n):this.n!==1&&(t=Ca(Math.sin(t)/this.n)),n=Gt(n+this.long0),t=ql(t)):(t=ey(i.y/this.a,this.es,this.en),r=Math.abs(t),r<Mt?(r=Math.sin(t),e=this.long0+i.x*Math.sqrt(1-this.es*r*r)/(this.a*Math.cos(t)),n=Gt(e)):r-kt<Mt&&(n=this.long0)),i.x=n,i.y=t,i}var KA=["Sinusoidal","sinu"];const $A={init:XA,forward:YA,inverse:ZA,names:KA};function JA(){}function QA(i){for(var t=i.x,e=i.y,n=Gt(t-this.long0),r=e,s=Math.PI*Math.sin(e);;){var a=-(r+Math.sin(r)-s)/(1+Math.cos(r));if(r+=a,Math.abs(a)<kt)break}r/=2,Math.PI/2-Math.abs(e)<kt&&(n=0);var o=.900316316158*this.a*n*Math.cos(r)+this.x0,l=1.4142135623731*this.a*Math.sin(r)+this.y0;return i.x=o,i.y=l,i}function tM(i){var t,e;i.x-=this.x0,i.y-=this.y0,e=i.y/(1.4142135623731*this.a),Math.abs(e)>.999999999999&&(e=.999999999999),t=Math.asin(e);var n=Gt(this.long0+i.x/(.900316316158*this.a*Math.cos(t)));n<-Math.PI&&(n=-Math.PI),n>Math.PI&&(n=Math.PI),e=(2*t+Math.sin(2*t))/Math.PI,Math.abs(e)>1&&(e=1);var r=Math.asin(e);return i.x=n,i.y=r,i}var eM=["Mollweide","moll"];const iM={init:JA,forward:QA,inverse:tM,names:eM};function nM(){Math.abs(this.lat1+this.lat2)<kt||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=wc(this.es),this.e1=Ec(this.es),this.e2=Sc(this.es),this.e3=Lc(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=rs(this.e,this.sinphi,this.cosphi),this.ml1=Ln(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<kt?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=rs(this.e,this.sinphi,this.cosphi),this.ml2=Ln(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Ln(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function rM(i){var t=i.x,e=i.y,n;if(this.sphere)n=this.a*(this.g-e);else{var r=Ln(this.e0,this.e1,this.e2,this.e3,e);n=this.a*(this.g-r)}var s=this.ns*Gt(t-this.long0),a=this.x0+n*Math.sin(s),o=this.y0+this.rh-n*Math.cos(s);return i.x=a,i.y=o,i}function sM(i){i.x-=this.x0,i.y=this.rh-i.y+this.y0;var t,e,n,r;this.ns>=0?(e=Math.sqrt(i.x*i.x+i.y*i.y),t=1):(e=-Math.sqrt(i.x*i.x+i.y*i.y),t=-1);var s=0;if(e!==0&&(s=Math.atan2(t*i.x,t*i.y)),this.sphere)return r=Gt(this.long0+s/this.ns),n=ql(this.g-e/this.a),i.x=r,i.y=n,i;var a=this.g-e/this.a;return n=Lf(a,this.e0,this.e1,this.e2,this.e3),r=Gt(this.long0+s/this.ns),i.x=r,i.y=n,i}var aM=["Equidistant_Conic","eqdc"];const oM={init:nM,forward:rM,inverse:sM,names:aM};function lM(){this.R=this.a}function hM(i){var t=i.x,e=i.y,n=Gt(t-this.long0),r,s;Math.abs(e)<=kt&&(r=this.x0+this.R*n,s=this.y0);var a=Ca(2*Math.abs(e/Math.PI));(Math.abs(n)<=kt||Math.abs(Math.abs(e)-Mt)<=kt)&&(r=this.x0,e>=0?s=this.y0+Math.PI*this.R*Math.tan(.5*a):s=this.y0+Math.PI*this.R*-Math.tan(.5*a));var o=.5*Math.abs(Math.PI/n-n/Math.PI),l=o*o,h=Math.sin(a),c=Math.cos(a),f=c/(h+c-1),g=f*f,d=f*(2/h-1),m=d*d,y=Math.PI*this.R*(o*(f-m)+Math.sqrt(l*(f-m)*(f-m)-(m+l)*(g-m)))/(m+l);n<0&&(y=-y),r=this.x0+y;var b=l+f;return y=Math.PI*this.R*(d*b-o*Math.sqrt((m+l)*(l+1)-b*b))/(m+l),e>=0?s=this.y0+y:s=this.y0-y,i.x=r,i.y=s,i}function cM(i){var t,e,n,r,s,a,o,l,h,c,f,g,d;return i.x-=this.x0,i.y-=this.y0,f=Math.PI*this.R,n=i.x/f,r=i.y/f,s=n*n+r*r,a=-Math.abs(r)*(1+s),o=a-2*r*r+n*n,l=-2*a+1+2*r*r+s*s,d=r*r/l+(2*o*o*o/l/l/l-9*a*o/l/l)/27,h=(a-o*o/3/l)/l,c=2*Math.sqrt(-h/3),f=3*d/h/c,Math.abs(f)>1&&(f>=0?f=1:f=-1),g=Math.acos(f)/3,i.y>=0?e=(-c*Math.cos(g+Math.PI/3)-o/3/l)*Math.PI:e=-(-c*Math.cos(g+Math.PI/3)-o/3/l)*Math.PI,Math.abs(n)<kt?t=this.long0:t=Gt(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(n*n-r*r)+s*s))/2/n),i.x=t,i.y=e,i}var uM=["Van_der_Grinten_I","VanDerGrinten","vandg"];const fM={init:lM,forward:hM,inverse:cM,names:uM};function dM(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)}function gM(i){var t=i.x,e=i.y,n=Math.sin(i.y),r=Math.cos(i.y),s=Gt(t-this.long0),a,o,l,h,c,f,g,d,m,y,b,x,E,S,M,D,W,j,P,H,et,R,F;return this.sphere?Math.abs(this.sin_p12-1)<=kt?(i.x=this.x0+this.a*(Mt-e)*Math.sin(s),i.y=this.y0-this.a*(Mt-e)*Math.cos(s),i):Math.abs(this.sin_p12+1)<=kt?(i.x=this.x0+this.a*(Mt+e)*Math.sin(s),i.y=this.y0+this.a*(Mt+e)*Math.cos(s),i):(j=this.sin_p12*n+this.cos_p12*r*Math.cos(s),D=Math.acos(j),W=D?D/Math.sin(D):1,i.x=this.x0+this.a*W*r*Math.sin(s),i.y=this.y0+this.a*W*(this.cos_p12*n-this.sin_p12*r*Math.cos(s)),i):(a=wc(this.es),o=Ec(this.es),l=Sc(this.es),h=Lc(this.es),Math.abs(this.sin_p12-1)<=kt?(c=this.a*Ln(a,o,l,h,Mt),f=this.a*Ln(a,o,l,h,e),i.x=this.x0+(c-f)*Math.sin(s),i.y=this.y0-(c-f)*Math.cos(s),i):Math.abs(this.sin_p12+1)<=kt?(c=this.a*Ln(a,o,l,h,Mt),f=this.a*Ln(a,o,l,h,e),i.x=this.x0+(c+f)*Math.sin(s),i.y=this.y0+(c+f)*Math.cos(s),i):(g=n/r,d=Il(this.a,this.e,this.sin_p12),m=Il(this.a,this.e,n),y=Math.atan((1-this.es)*g+this.es*d*this.sin_p12/(m*r)),b=Math.atan2(Math.sin(s),this.cos_p12*Math.tan(y)-this.sin_p12*Math.cos(s)),b===0?P=Math.asin(this.cos_p12*Math.sin(y)-this.sin_p12*Math.cos(y)):Math.abs(Math.abs(b)-Math.PI)<=kt?P=-Math.asin(this.cos_p12*Math.sin(y)-this.sin_p12*Math.cos(y)):P=Math.asin(Math.sin(s)*Math.cos(y)/Math.sin(b)),x=this.e*this.sin_p12/Math.sqrt(1-this.es),E=this.e*this.cos_p12*Math.cos(b)/Math.sqrt(1-this.es),S=x*E,M=E*E,H=P*P,et=H*P,R=et*P,F=R*P,D=d*P*(1-H*M*(1-M)/6+et/8*S*(1-2*M)+R/120*(M*(4-7*M)-3*x*x*(1-7*M))-F/48*S),i.x=this.x0+D*Math.sin(b),i.y=this.y0+D*Math.cos(b),i))}function pM(i){i.x-=this.x0,i.y-=this.y0;var t,e,n,r,s,a,o,l,h,c,f,g,d,m,y,b,x,E,S,M,D,W,j,P;return this.sphere?(t=Math.sqrt(i.x*i.x+i.y*i.y),t>2*Mt*this.a?void 0:(e=t/this.a,n=Math.sin(e),r=Math.cos(e),s=this.long0,Math.abs(t)<=kt?a=this.lat0:(a=Ca(r*this.sin_p12+i.y*n*this.cos_p12/t),o=Math.abs(this.lat0)-Mt,Math.abs(o)<=kt?this.lat0>=0?s=Gt(this.long0+Math.atan2(i.x,-i.y)):s=Gt(this.long0-Math.atan2(-i.x,i.y)):s=Gt(this.long0+Math.atan2(i.x*n,t*this.cos_p12*r-i.y*this.sin_p12*n))),i.x=s,i.y=a,i)):(l=wc(this.es),h=Ec(this.es),c=Sc(this.es),f=Lc(this.es),Math.abs(this.sin_p12-1)<=kt?(g=this.a*Ln(l,h,c,f,Mt),t=Math.sqrt(i.x*i.x+i.y*i.y),d=g-t,a=Lf(d/this.a,l,h,c,f),s=Gt(this.long0+Math.atan2(i.x,-1*i.y)),i.x=s,i.y=a,i):Math.abs(this.sin_p12+1)<=kt?(g=this.a*Ln(l,h,c,f,Mt),t=Math.sqrt(i.x*i.x+i.y*i.y),d=t-g,a=Lf(d/this.a,l,h,c,f),s=Gt(this.long0+Math.atan2(i.x,i.y)),i.x=s,i.y=a,i):(t=Math.sqrt(i.x*i.x+i.y*i.y),b=Math.atan2(i.x,i.y),m=Il(this.a,this.e,this.sin_p12),x=Math.cos(b),E=this.e*this.cos_p12*x,S=-E*E/(1-this.es),M=3*this.es*(1-S)*this.sin_p12*this.cos_p12*x/(1-this.es),D=t/m,W=D-S*(1+S)*Math.pow(D,3)/6-M*(1+3*S)*Math.pow(D,4)/24,j=1-S*W*W/2-D*W*W*W/6,y=Math.asin(this.sin_p12*Math.cos(W)+this.cos_p12*Math.sin(W)*x),s=Gt(this.long0+Math.asin(Math.sin(b)*Math.sin(W)/Math.cos(y))),P=Math.sin(y),a=Math.atan2((P-this.es*j*this.sin_p12)*Math.tan(y),P*(1-this.es)),i.x=s,i.y=a,i))}var mM=["Azimuthal_Equidistant","aeqd"];const _M={init:dM,forward:gM,inverse:pM,names:mM};function vM(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function yM(i){var t,e,n,r,s,a,o,l,h=i.x,c=i.y;return n=Gt(h-this.long0),t=Math.sin(c),e=Math.cos(c),r=Math.cos(n),a=this.sin_p14*t+this.cos_p14*e*r,s=1,(a>0||Math.abs(a)<=kt)&&(o=this.a*s*e*Math.sin(n),l=this.y0+this.a*s*(this.cos_p14*t-this.sin_p14*e*r)),i.x=o,i.y=l,i}function xM(i){var t,e,n,r,s,a,o;return i.x-=this.x0,i.y-=this.y0,t=Math.sqrt(i.x*i.x+i.y*i.y),e=Ca(t/this.a),n=Math.sin(e),r=Math.cos(e),a=this.long0,Math.abs(t)<=kt?(o=this.lat0,i.x=a,i.y=o,i):(o=Ca(r*this.sin_p14+i.y*n*this.cos_p14/t),s=Math.abs(this.lat0)-Mt,Math.abs(s)<=kt?(this.lat0>=0?a=Gt(this.long0+Math.atan2(i.x,-i.y)):a=Gt(this.long0-Math.atan2(-i.x,i.y)),i.x=a,i.y=o,i):(a=Gt(this.long0+Math.atan2(i.x*n,t*this.cos_p14*r-i.y*this.sin_p14*n)),i.x=a,i.y=o,i))}var bM=["ortho"];const wM={init:vM,forward:yM,inverse:xM,names:bM};var di={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},ze={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function EM(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=Mt-Ge/2?this.face=di.TOP:this.lat0<=-(Mt-Ge/2)?this.face=di.BOTTOM:Math.abs(this.long0)<=Ge?this.face=di.FRONT:Math.abs(this.long0)<=Mt+Ge?this.face=this.long0>0?di.RIGHT:di.LEFT:this.face=di.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function SM(i){var t={x:0,y:0},e,n,r,s,a,o,l={value:0};if(i.x-=this.long0,this.es!==0?e=Math.atan(this.one_minus_f_squared*Math.tan(i.y)):e=i.y,n=i.x,this.face===di.TOP)s=Mt-e,n>=Ge&&n<=Mt+Ge?(l.value=ze.AREA_0,r=n-Mt):n>Mt+Ge||n<=-(Mt+Ge)?(l.value=ze.AREA_1,r=n>0?n-Ai:n+Ai):n>-(Mt+Ge)&&n<=-Ge?(l.value=ze.AREA_2,r=n+Mt):(l.value=ze.AREA_3,r=n);else if(this.face===di.BOTTOM)s=Mt+e,n>=Ge&&n<=Mt+Ge?(l.value=ze.AREA_0,r=-n+Mt):n<Ge&&n>=-Ge?(l.value=ze.AREA_1,r=-n):n<-Ge&&n>=-(Mt+Ge)?(l.value=ze.AREA_2,r=-n-Mt):(l.value=ze.AREA_3,r=n>0?-n+Ai:-n-Ai);else{var h,c,f,g,d,m,y;this.face===di.RIGHT?n=bl(n,+Mt):this.face===di.BACK?n=bl(n,+Ai):this.face===di.LEFT&&(n=bl(n,-Mt)),g=Math.sin(e),d=Math.cos(e),m=Math.sin(n),y=Math.cos(n),h=d*y,c=d*m,f=g,this.face===di.FRONT?(s=Math.acos(h),r=Bu(s,f,c,l)):this.face===di.RIGHT?(s=Math.acos(c),r=Bu(s,f,-h,l)):this.face===di.BACK?(s=Math.acos(-h),r=Bu(s,f,-c,l)):this.face===di.LEFT?(s=Math.acos(-c),r=Bu(s,f,h,l)):(s=r=0,l.value=ze.AREA_0)}return o=Math.atan(12/Ai*(r+Math.acos(Math.sin(r)*Math.cos(Ge))-Mt)),a=Math.sqrt((1-Math.cos(s))/(Math.cos(o)*Math.cos(o))/(1-Math.cos(Math.atan(1/Math.cos(r))))),l.value===ze.AREA_1?o+=Mt:l.value===ze.AREA_2?o+=Ai:l.value===ze.AREA_3&&(o+=1.5*Ai),t.x=a*Math.cos(o),t.y=a*Math.sin(o),t.x=t.x*this.a+this.x0,t.y=t.y*this.a+this.y0,i.x=t.x,i.y=t.y,i}function LM(i){var t={lam:0,phi:0},e,n,r,s,a,o,l,h,c,f={value:0};if(i.x=(i.x-this.x0)/this.a,i.y=(i.y-this.y0)/this.a,n=Math.atan(Math.sqrt(i.x*i.x+i.y*i.y)),e=Math.atan2(i.y,i.x),i.x>=0&&i.x>=Math.abs(i.y)?f.value=ze.AREA_0:i.y>=0&&i.y>=Math.abs(i.x)?(f.value=ze.AREA_1,e-=Mt):i.x<0&&-i.x>=Math.abs(i.y)?(f.value=ze.AREA_2,e=e<0?e+Ai:e-Ai):(f.value=ze.AREA_3,e+=Mt),c=Ai/12*Math.tan(e),a=Math.sin(c)/(Math.cos(c)-1/Math.sqrt(2)),o=Math.atan(a),r=Math.cos(e),s=Math.tan(n),l=1-r*r*s*s*(1-Math.cos(Math.atan(1/Math.cos(o)))),l<-1?l=-1:l>1&&(l=1),this.face===di.TOP)h=Math.acos(l),t.phi=Mt-h,f.value===ze.AREA_0?t.lam=o+Mt:f.value===ze.AREA_1?t.lam=o<0?o+Ai:o-Ai:f.value===ze.AREA_2?t.lam=o-Mt:t.lam=o;else if(this.face===di.BOTTOM)h=Math.acos(l),t.phi=h-Mt,f.value===ze.AREA_0?t.lam=-o+Mt:f.value===ze.AREA_1?t.lam=-o:f.value===ze.AREA_2?t.lam=-o-Mt:t.lam=o<0?-o-Ai:-o+Ai;else{var g,d,m;g=l,c=g*g,c>=1?m=0:m=Math.sqrt(1-c)*Math.sin(o),c+=m*m,c>=1?d=0:d=Math.sqrt(1-c),f.value===ze.AREA_1?(c=d,d=-m,m=c):f.value===ze.AREA_2?(d=-d,m=-m):f.value===ze.AREA_3&&(c=d,d=m,m=-c),this.face===di.RIGHT?(c=g,g=-d,d=c):this.face===di.BACK?(g=-g,d=-d):this.face===di.LEFT&&(c=g,g=d,d=-c),t.phi=Math.acos(-m)-Mt,t.lam=Math.atan2(d,g),this.face===di.RIGHT?t.lam=bl(t.lam,-Mt):this.face===di.BACK?t.lam=bl(t.lam,-Ai):this.face===di.LEFT&&(t.lam=bl(t.lam,+Mt))}if(this.es!==0){var y,b,x;y=t.phi<0?1:0,b=Math.tan(t.phi),x=this.b/Math.sqrt(b*b+this.one_minus_f_squared),t.phi=Math.atan(Math.sqrt(this.a*this.a-x*x)/(this.one_minus_f*x)),y&&(t.phi=-t.phi)}return t.lam+=this.long0,i.x=t.lam,i.y=t.phi,i}function Bu(i,t,e,n){var r;return i<kt?(n.value=ze.AREA_0,r=0):(r=Math.atan2(t,e),Math.abs(r)<=Ge?n.value=ze.AREA_0:r>Ge&&r<=Mt+Ge?(n.value=ze.AREA_1,r-=Mt):r>Mt+Ge||r<=-(Mt+Ge)?(n.value=ze.AREA_2,r=r>=0?r-Ai:r+Ai):(n.value=ze.AREA_3,r+=Mt)),r}function bl(i,t){var e=i+t;return e<-Ai?e+=ac:e>+Ai&&(e-=ac),e}var CM=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const AM={init:EM,forward:SM,inverse:LM,names:CM};var I0=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Ph=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],ry=.8487,sy=1.3523,ay=Jr/5,MM=1/ay,ul=18,Cf=function(i,t){return i[0]+t*(i[1]+t*(i[2]+t*i[3]))},TM=function(i,t){return i[1]+t*(2*i[2]+t*3*i[3])};function PM(i,t,e,n){for(var r=t;n;--n){var s=i(r);if(r-=s,Math.abs(s)<e)break}return r}function IM(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function RM(i){var t=Gt(i.x-this.long0),e=Math.abs(i.y),n=Math.floor(e*ay);n<0?n=0:n>=ul&&(n=ul-1),e=Jr*(e-MM*n);var r={x:Cf(I0[n],e)*t,y:Cf(Ph[n],e)};return i.y<0&&(r.y=-r.y),r.x=r.x*this.a*ry+this.x0,r.y=r.y*this.a*sy+this.y0,r}function NM(i){var t={x:(i.x-this.x0)/(this.a*ry),y:Math.abs(i.y-this.y0)/(this.a*sy)};if(t.y>=1)t.x/=I0[ul][0],t.y=i.y<0?-Mt:Mt;else{var e=Math.floor(t.y*ul);for(e<0?e=0:e>=ul&&(e=ul-1);;)if(Ph[e][0]>t.y)--e;else if(Ph[e+1][0]<=t.y)++e;else break;var n=Ph[e],r=5*(t.y-n[0])/(Ph[e+1][0]-n[0]);r=PM(function(s){return(Cf(n,s)-t.y)/TM(n,s)},r,kt,100),t.x/=Cf(I0[e],r),t.y=(5*e+r)*tn,i.y<0&&(t.y=-t.y)}return t.x=Gt(t.x+this.long0),t}var FM=["Robinson","robin"];const OM={init:IM,forward:RM,inverse:NM,names:FM};function kM(){this.name="geocent"}function DM(i){var t=Vv(i,this.es,this.a);return t}function jM(i){var t=Hv(i,this.es,this.a,this.b);return t}var BM=["Geocentric","geocentric","geocent","Geocent"];const GM={init:kM,forward:DM,inverse:jM,names:BM};var pn={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},Sh={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function zM(){if(Object.keys(Sh).forEach((function(e){if(typeof this[e]>"u")this[e]=Sh[e].def;else{if(Sh[e].num&&isNaN(this[e]))throw new Error("Invalid parameter value, must be numeric "+e+" = "+this[e]);Sh[e].num&&(this[e]=parseFloat(this[e]))}Sh[e].degrees&&(this[e]=this[e]*tn)}).bind(this)),Math.abs(Math.abs(this.lat0)-Mt)<kt?this.mode=this.lat0<0?pn.S_POLE:pn.N_POLE:Math.abs(this.lat0)<kt?this.mode=pn.EQUIT:(this.mode=pn.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var i=this.tilt,t=this.azi;this.cg=Math.cos(t),this.sg=Math.sin(t),this.cw=Math.cos(i),this.sw=Math.sin(i)}function qM(i){i.x-=this.long0;var t=Math.sin(i.y),e=Math.cos(i.y),n=Math.cos(i.x),r,s;switch(this.mode){case pn.OBLIQ:s=this.sinph0*t+this.cosph0*e*n;break;case pn.EQUIT:s=e*n;break;case pn.S_POLE:s=-t;break;case pn.N_POLE:s=t;break}switch(s=this.pn1/(this.p-s),r=s*e*Math.sin(i.x),this.mode){case pn.OBLIQ:s*=this.cosph0*t-this.sinph0*e*n;break;case pn.EQUIT:s*=t;break;case pn.N_POLE:s*=-(e*n);break;case pn.S_POLE:s*=e*n;break}var a,o;return a=s*this.cg+r*this.sg,o=1/(a*this.sw*this.h1+this.cw),r=(r*this.cg-s*this.sg)*this.cw*o,s=a*o,i.x=r*this.a,i.y=s*this.a,i}function UM(i){i.x/=this.a,i.y/=this.a;var t={x:i.x,y:i.y},e,n,r;r=1/(this.pn1-i.y*this.sw),e=this.pn1*i.x*r,n=this.pn1*i.y*this.cw*r,i.x=e*this.cg+n*this.sg,i.y=n*this.cg-e*this.sg;var s=hr(i.x,i.y);if(Math.abs(s)<kt)t.x=0,t.y=i.y;else{var a,o;switch(o=1-s*s*this.pfact,o=(this.p-Math.sqrt(o))/(this.pn1/s+s/this.pn1),a=Math.sqrt(1-o*o),this.mode){case pn.OBLIQ:t.y=Math.asin(a*this.sinph0+i.y*o*this.cosph0/s),i.y=(a-this.sinph0*Math.sin(t.y))*s,i.x*=o*this.cosph0;break;case pn.EQUIT:t.y=Math.asin(i.y*o/s),i.y=a*s,i.x*=o;break;case pn.N_POLE:t.y=Math.asin(a),i.y=-i.y;break;case pn.S_POLE:t.y=-Math.asin(a);break}t.x=Math.atan2(i.x,i.y)}return i.x=t.x+this.long0,i.y=t.y,i}var WM=["Tilted_Perspective","tpers"];const VM={init:zM,forward:qM,inverse:UM,names:WM};function HM(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var i=1-this.es,t=1/i;this.radius_p=Math.sqrt(i),this.radius_p2=i,this.radius_p_inv2=t,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function XM(i){var t=i.x,e=i.y,n,r,s,a;if(t=t-this.long0,this.shape==="ellipse"){e=Math.atan(this.radius_p2*Math.tan(e));var o=this.radius_p/hr(this.radius_p*Math.cos(e),Math.sin(e));if(r=o*Math.cos(t)*Math.cos(e),s=o*Math.sin(t)*Math.cos(e),a=o*Math.sin(e),(this.radius_g-r)*r-s*s-a*a*this.radius_p_inv2<0)return i.x=Number.NaN,i.y=Number.NaN,i;n=this.radius_g-r,this.flip_axis?(i.x=this.radius_g_1*Math.atan(s/hr(a,n)),i.y=this.radius_g_1*Math.atan(a/n)):(i.x=this.radius_g_1*Math.atan(s/n),i.y=this.radius_g_1*Math.atan(a/hr(s,n)))}else this.shape==="sphere"&&(n=Math.cos(e),r=Math.cos(t)*n,s=Math.sin(t)*n,a=Math.sin(e),n=this.radius_g-r,this.flip_axis?(i.x=this.radius_g_1*Math.atan(s/hr(a,n)),i.y=this.radius_g_1*Math.atan(a/n)):(i.x=this.radius_g_1*Math.atan(s/n),i.y=this.radius_g_1*Math.atan(a/hr(s,n))));return i.x=i.x*this.a,i.y=i.y*this.a,i}function YM(i){var t=-1,e=0,n=0,r,s,a,o;if(i.x=i.x/this.a,i.y=i.y/this.a,this.shape==="ellipse"){this.flip_axis?(n=Math.tan(i.y/this.radius_g_1),e=Math.tan(i.x/this.radius_g_1)*hr(1,n)):(e=Math.tan(i.x/this.radius_g_1),n=Math.tan(i.y/this.radius_g_1)*hr(1,e));var l=n/this.radius_p;if(r=e*e+l*l+t*t,s=2*this.radius_g*t,a=s*s-4*r*this.C,a<0)return i.x=Number.NaN,i.y=Number.NaN,i;o=(-s-Math.sqrt(a))/(2*r),t=this.radius_g+o*t,e*=o,n*=o,i.x=Math.atan2(e,t),i.y=Math.atan(n*Math.cos(i.x)/t),i.y=Math.atan(this.radius_p_inv2*Math.tan(i.y))}else if(this.shape==="sphere"){if(this.flip_axis?(n=Math.tan(i.y/this.radius_g_1),e=Math.tan(i.x/this.radius_g_1)*Math.sqrt(1+n*n)):(e=Math.tan(i.x/this.radius_g_1),n=Math.tan(i.y/this.radius_g_1)*Math.sqrt(1+e*e)),r=e*e+n*n+t*t,s=2*this.radius_g*t,a=s*s-4*r*this.C,a<0)return i.x=Number.NaN,i.y=Number.NaN,i;o=(-s-Math.sqrt(a))/(2*r),t=this.radius_g+o*t,e*=o,n*=o,i.x=Math.atan2(e,t),i.y=Math.atan(n*Math.cos(i.x)/t)}return i.x=i.x+this.long0,i}var ZM=["Geostationary Satellite View","Geostationary_Satellite","geos"];const KM={init:HM,forward:XM,inverse:YM,names:ZM};var jh=1.340264,Bh=-.081106,Gh=893e-6,zh=.003796,Af=Math.sqrt(3)/2;function $M(){this.es=0,this.long0=this.long0!==void 0?this.long0:0}function JM(i){var t=Gt(i.x-this.long0),e=i.y,n=Math.asin(Af*Math.sin(e)),r=n*n,s=r*r*r;return i.x=t*Math.cos(n)/(Af*(jh+3*Bh*r+s*(7*Gh+9*zh*r))),i.y=n*(jh+Bh*r+s*(Gh+zh*r)),i.x=this.a*i.x+this.x0,i.y=this.a*i.y+this.y0,i}function QM(i){i.x=(i.x-this.x0)/this.a,i.y=(i.y-this.y0)/this.a;var t=1e-9,e=12,n=i.y,r,s,a,o,l,h;for(h=0;h<e&&(r=n*n,s=r*r*r,a=n*(jh+Bh*r+s*(Gh+zh*r))-i.y,o=jh+3*Bh*r+s*(7*Gh+9*zh*r),n-=l=a/o,!(Math.abs(l)<t));++h);return r=n*n,s=r*r*r,i.x=Af*i.x*(jh+3*Bh*r+s*(7*Gh+9*zh*r))/Math.cos(n),i.y=Math.asin(Math.sin(n)/Af),i.x=Gt(i.x+this.long0),i}var tT=["eqearth","Equal Earth","Equal_Earth"];const eT={init:$M,forward:JM,inverse:QM,names:tT};function iT(i){i.Proj.projections.add(Zu),i.Proj.projections.add(Ku),i.Proj.projections.add(nC),i.Proj.projections.add(dC),i.Proj.projections.add(yC),i.Proj.projections.add(SC),i.Proj.projections.add(PC),i.Proj.projections.add(OC),i.Proj.projections.add(GC),i.Proj.projections.add(VC),i.Proj.projections.add(lA),i.Proj.projections.add(gA),i.Proj.projections.add(yA),i.Proj.projections.add(LA),i.Proj.projections.add(PA),i.Proj.projections.add(OA),i.Proj.projections.add(GA),i.Proj.projections.add(VA),i.Proj.projections.add($A),i.Proj.projections.add(iM),i.Proj.projections.add(oM),i.Proj.projections.add(fM),i.Proj.projections.add(_M),i.Proj.projections.add(wM),i.Proj.projections.add(AM),i.Proj.projections.add(OM),i.Proj.projections.add(GM),i.Proj.projections.add(VM),i.Proj.projections.add(KM),i.Proj.projections.add(eT)}jn.defaultDatum="WGS84";jn.Proj=es;jn.WGS84=new jn.Proj("WGS84");jn.Point=Pl;jn.toPoint=Xv;jn.defs=wn;jn.nadgrid=s4;jn.transform=Sf;jn.mgrs=b4;jn.version="__VERSION__";iT(jn);var nT=class extends Qn{constructor(t){t=t||{},super();var e=this.input=t.input;e||(e=this.input=document.createElement("INPUT"),t.type&&e.setAttribute("type",t.type),t.min!==void 0&&e.setAttribute("min",t.min),t.max!==void 0&&e.setAttribute("max",t.max),t.step!==void 0&&e.setAttribute("step",t.step),t.parent&&t.parent.appendChild(e)),t.disabled&&(e.disabled=!0),t.checked!==void 0&&(e.checked=!!t.checked),t.val!==void 0&&(e.value=t.val),t.hidden&&(e.style.display="none"),e.addEventListener("focus",(function(){this.element&&this.element.classList.add("ol-focus")}).bind(this));var n;e.addEventListener("focusout",(function(){this.element&&(n&&clearTimeout(n),n=setTimeout((function(){this.element.classList.remove("ol-focus")}).bind(this),0))}).bind(this))}_listenDrag(t,e){var n=(function(r){this.moving=!0,this.element.classList.add("ol-moving");var s=(function(a){a.type==="pointerup"&&(document.removeEventListener("pointermove",s),document.removeEventListener("pointerup",s),document.removeEventListener("pointercancel",s),setTimeout((function(){this.moving=!1,this.element.classList.remove("ol-moving")}).bind(this))),a.target===t&&e(a),a.stopPropagation(),a.preventDefault()}).bind(this);document.addEventListener("pointermove",s,!1),document.addEventListener("pointerup",s,!1),document.addEventListener("pointercancel",s,!1),r.stopPropagation(),r.preventDefault()}).bind(this);t.addEventListener("mousedown",n,!1),t.addEventListener("touchstart",n,!1)}setValue(t){t!==void 0&&(this.input.value=t),this.input.dispatchEvent(new Event("change"))}getValue(){return this.input.value}getInputElement(){return this.input}},z1=class extends nT{constructor(t){t=t||{},super(t);var e=this.element=document.createElement("LABEL");t.html instanceof Element?e.appendChild(t.html):t.html!==void 0&&(e.innerHTML=t.html),e.className=("ol-ext-check ol-ext-checkbox "+(t.className||"")).trim(),this.input.parentNode&&this.input.parentNode.insertBefore(e,this.input),e.appendChild(this.input),e.appendChild(document.createElement("SPAN")),t.after&&e.appendChild(document.createTextNode(t.after)),this.input.addEventListener("change",(function(){this.dispatchEvent({type:"check",checked:this.input.checked,value:this.input.value})}).bind(this))}isChecked(){return this.input.checked}},rT=class extends z1{constructor(t){t=t||{},super(t),this.element.className=("ol-ext-toggle-switch "+(t.className||"")).trim()}},sT=class extends z1{constructor(t){t=t||{},super(t),this.element.className=("ol-ext-check ol-ext-radio "+(t.className||"")).trim()}},ft={};ft.create=function(i,t){t=t||{};var e;if(i==="TEXT")e=document.createTextNode(t.html||""),t.parent&&t.parent.appendChild(e);else{e=document.createElement(i),/button/i.test(i)&&e.setAttribute("type","button");for(var n in t)switch(n){case"className":{t.className&&t.className.trim&&e.setAttribute("class",t.className.trim());break}case"text":{e.innerText=t.text;break}case"html":{t.html instanceof Element?e.appendChild(t.html):t.html!==void 0&&(e.innerHTML=t.html);break}case"parent":{t.parent&&t.parent.appendChild(e);break}case"options":{if(/select/i.test(i))for(var r in t.options)ft.create("OPTION",{html:r,value:t.options[r],parent:e});break}case"style":{ft.setStyle(e,t.style);break}case"change":case"click":{ft.addListener(e,n,t[n]);break}case"on":{for(var s in t.on)ft.addListener(e,s,t.on[s]);break}case"checked":{e.checked=!!t.checked;break}default:{e.setAttribute(n,t[n]);break}}}return e};ft.createSwitch=function(i){var t=ft.create("INPUT",{type:"checkbox",on:i.on,click:i.click,change:i.change,parent:i.parent}),e=Object.assign({input:t},i||{});return new rT(e),t};ft.createCheck=function(i){var t=ft.create("INPUT",{name:i.name,type:i.type==="radio"?"radio":"checkbox",on:i.on,parent:i.parent}),e=Object.assign({input:t},i||{});return i.type==="radio"?new sT(e):new z1(e),t};ft.setHTML=function(i,t){t instanceof Element?i.appendChild(t):t!==void 0&&(i.innerHTML=t)};ft.appendText=function(i,t){i.appendChild(document.createTextNode(t||""))};ft.addListener=function(i,t,e,n){typeof t=="string"&&(t=t.split(" ")),t.forEach(function(r){i.addEventListener(r,e,n)})};ft.removeListener=function(i,t,e){typeof t=="string"&&(t=t.split(" ")),t.forEach(function(n){i.removeEventListener(n,e)})};ft.show=function(i){i.style.display=""};ft.hide=function(i){i.style.display="none"};ft.hidden=function(i){return ft.getStyle(i,"display")==="none"};ft.toggle=function(i){i.style.display=i.style.display==="none"?"":"none"};ft.setStyle=function(i,t){for(var e in t)switch(e){case"top":case"left":case"bottom":case"right":case"minWidth":case"maxWidth":case"width":case"height":{typeof t[e]=="number"?i.style[e]=t[e]+"px":i.style[e]=t[e];break}default:i.style[e]=t[e]}};ft.getStyle=function(i,t){var e,n=(i.ownerDocument||document).defaultView;if(n&&n.getComputedStyle)t=t.replace(/([A-Z])/g,"-$1").toLowerCase(),e=n.getComputedStyle(i,null).getPropertyValue(t);else if(i.currentStyle&&(t=t.replace(/-(\w)/g,function(r,s){return s.toUpperCase()}),e=i.currentStyle[t],/^\d+(em|pt|%|ex)?$/i.test(e)))return function(r){var s=i.style.left,a=i.runtimeStyle.left;return i.runtimeStyle.left=i.currentStyle.left,i.style.left=r||0,r=i.style.pixelLeft+"px",i.style.left=s,i.runtimeStyle.left=a,r}(e);return/px$/.test(e)?parseInt(e):e};ft.outerHeight=function(i){return i.offsetHeight+ft.getStyle(i,"marginBottom")};ft.outerWidth=function(i){return i.offsetWidth+ft.getStyle(i,"marginLeft")};ft.offsetRect=function(i){var t=i.getBoundingClientRect();return{top:t.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:t.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0),height:t.height||t.bottom-t.top,width:t.width||t.right-t.left}};ft.getFixedOffset=function(i){var t={left:0,top:0},e=function(n){if(!n)return t;if(ft.getStyle(n,"position")==="absolute"&&ft.getStyle(n,"transform")!=="none"){var r=n.getBoundingClientRect();return t.left+=r.left,t.top+=r.top,t}return e(n.offsetParent)};return e(i.offsetParent)};ft.positionRect=function(i,t){var e=0,n=0,r=function(s){if(s)return e+=s.offsetLeft,n+=s.offsetTop,r(s.offsetParent);var a={top:i.offsetTop+n,left:i.offsetLeft+e};return t&&(a.top-=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,a.left-=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0),a.bottom=a.top+i.offsetHeight,a.right=a.top+i.offsetWidth,a};return r(i.offsetParent)};ft.scrollDiv=function(i,t){t=t||{};var e=!1,n=0,r,s=0,a=typeof t.onmove=="function"?t.onmove:function(){},o=t.vertical?"screenY":"screenX",l=t.vertical?"scrollTop":"scrollLeft",h=!1,c,f,g=0,d=function(){S&&(g++,setTimeout(m))},m=function(){if(S){if(g--,g)return;var j=i.clientHeight,P=i.scrollHeight;c=j/P,S.style.height=c*100+"%",S.style.top=i.scrollTop/P*100+"%",E.style.height=j+"px",j>P-.5?E.classList.add("ol-100pc"):E.classList.remove("ol-100pc")}},y=function(j){j.target.classList.contains("ol-noscroll")||(h=!1,e=j[o],s=new Date,i.classList.add("ol-move"),j.preventDefault(),window.addEventListener("pointermove",b),ft.addListener(window,["pointerup","pointercancel"],D))},b=function(j){if(e!==!1){var P=(f?-1/c:1)*(e-j[o]);h=h||Math.round(P),i[l]+=P,r=new Date,r-s&&(n=(n+P/(r-s))/2),e=j[o],s=r,P&&a(!0)}else h=!0},x=function(j){var P=j>0?Math.min(100,j/2):Math.max(-100,j/2);j-=P,i[l]+=P,-1<j&&j<1?(h?setTimeout(function(){i.classList.remove("ol-move")}):i.classList.remove("ol-move"),h=!1,a(!1)):setTimeout(function(){x(j)},40)},E,S;if(t.vertical&&t.minibar){var M=function(j){i.removeEventListener("pointermove",M),i.parentNode.classList.add("ol-miniscroll"),S=ft.create("DIV"),E=ft.create("DIV",{className:"ol-scroll",html:S}),i.parentNode.insertBefore(E,i),S.addEventListener("pointerdown",function(P){f=!0,y(P)}),t.mousewheel&&(ft.addListener(E,["mousewheel","DOMMouseScroll","onmousewheel"],function(P){W(P)}),ft.addListener(S,["mousewheel","DOMMouseScroll","onmousewheel"],function(P){W(P)})),i.parentNode.addEventListener("pointerenter",d),window.addEventListener("resize",d),j!==!1&&d()};i.parentNode?M(!1):i.addEventListener("pointermove",M),i.addEventListener("scroll",function(){d()})}i.style["touch-action"]="none",i.style.overflow="hidden",i.classList.add("ol-scrolldiv"),ft.addListener(i,["pointerdown"],function(j){f=!1,y(j)}),i.addEventListener("click",function(j){i.classList.contains("ol-move")&&(j.preventDefault(),j.stopPropagation())},!0);var D=function(j){s=new Date-s,s>100||f?n=0:s>0&&(n=((n||0)+(e-j[o])/s)/2),x(t.animate===!1?0:n*200),e=!1,n=0,s=0,i.classList.contains("ol-move")?i.classList.remove("ol-hasClick"):(i.classList.add("ol-hasClick"),setTimeout(function(){i.classList.remove("ol-hasClick")},500)),f=!1,window.removeEventListener("pointermove",b),ft.removeListener(window,["pointerup","pointercancel"],D)},W=function(j){var P=Math.max(-1,Math.min(1,j.wheelDelta||-j.detail));return i.classList.add("ol-move"),i[l]-=P*30,i.classList.remove("ol-move"),!1};return t.mousewheel&&ft.addListener(i,["mousewheel","DOMMouseScroll","onmousewheel"],W),{refresh:d}};ft.dispatchEvent=function(i,t){var e;try{e=new CustomEvent(i)}catch{e=document.createEvent("CustomEvent"),e.initCustomEvent(i,!0,!0,{})}t.dispatchEvent(e)};var oy=class extends ur{constructor(t){t=t||{};var e=(t.className||"")+" ol-search"+(t.target?"":" ol-unselectable ol-control"),n=ft.create("DIV",{className:e});super({element:n,target:t.target});var r=this;if(t.typing==null&&(t.typing=300),this._classname=t.className||"search",t.collapsed!==!1&&n.classList.add("ol-collapsed"),t.target||(this.button=document.createElement("BUTTON"),this.button.setAttribute("type","button"),this.button.setAttribute("title",t.title||t.label||"Search"),this.button.addEventListener("click",function(){if(n.classList.toggle("ol-collapsed"),!n.classList.contains("ol-collapsed")){n.querySelector("input.search").focus();for(var g=n.querySelectorAll("li"),d=0;d<g.length;d++)g[d].classList.remove("select");l.value||r.drawList_()}}),n.appendChild(this.button)),t.inputLabel){var s=document.createElement("LABEL");s.innerText=t.inputLabel,n.appendChild(s)}var a,o="",l=this._input=document.createElement("INPUT");l.setAttribute("type","search"),l.setAttribute("class","search"),l.setAttribute("autocomplete","off"),l.setAttribute("placeholder",t.placeholder||"Search..."),l.addEventListener("change",function(g){r.dispatchEvent({type:"change:input",input:g,value:l.value})});var h=function(g){var d=n.querySelector("ul.autocomplete li.select"),m=l.value;if(g.key=="ArrowDown"||g.key=="ArrowUp"||g.key=="Down"||g.key=="Up")d?(d.classList.remove("select"),d=/Down/.test(g.key)?d.nextElementSibling:d.previousElementSibling,d&&d.classList.add("select")):n.querySelector("ul.autocomplete li").classList.add("select");else if(g.type=="input"&&!m)setTimeout(function(){r.drawList_()},200);else if(d&&(g.type=="search"||g.key=="Enter"))n.classList.contains("ol-control")&&l.blur(),d.classList.remove("select"),o=m,r._handleSelect(r._list[d.getAttribute("data-search")]);else if(g.type=="search"||g.key=="Enter"||o!=m&&t.typing>=0)if(o=m,o){a&&clearTimeout(a);var y=r.get("minLength");a=setTimeout(function(){if(o.length>=y){var b=r.autocomplete(o,function(x){r.drawList_(x)});b&&r.drawList_(b)}else r.drawList_()},t.typing)}else r.drawList_();else d=n.querySelector("ul.autocomplete li"),d&&d.classList.remove("select")};if(l.addEventListener("keyup",h),l.addEventListener("search",h),l.addEventListener("cut",h),l.addEventListener("paste",h),l.addEventListener("input",h),t.noCollapse||(l.addEventListener("blur",(function(){setTimeout((function(){l!==document.activeElement&&(n.classList.add("ol-collapsed"),this.set("reverse",!1),n.classList.remove("ol-revers"))}).bind(this),200)}).bind(this)),l.addEventListener("focus",(function(){this.get("reverse")||(n.classList.remove("ol-collapsed"),n.classList.remove("ol-revers"))}).bind(this))),n.appendChild(l),t.reverse){var c=ft.create("BUTTON",{type:"button",class:"ol-revers",title:t.reverseTitle||"click on the map",click:(function(){this.get("reverse")?this.set("reverse",!1):(this.set("reverse",!this.get("reverse")),l.focus(),n.classList.add("ol-revers"))}).bind(this)});n.appendChild(c)}var f=document.createElement("UL");f.classList.add("autocomplete"),n.appendChild(f),typeof t.getTitle=="function"&&(this.getTitle=t.getTitle),typeof t.autocomplete=="function"&&(this.autocomplete=t.autocomplete),this.set("copy",t.copy),this.set("minLength",t.minLength||1),this.set("maxItems",t.maxItems||10),this.set("maxHistory",t.maxHistory||t.maxItems||10),t.onselect&&this.on("select",t.onselect),t.centerOnSelect&&this.on("select",(function(g){var d=this.getMap();d&&d.getView().setCenter(g.coordinate)}).bind(this)),t.zoomOnSelect&&this.on("select",(function(g){var d=this.getMap();d&&(d.getView().setCenter(g.coordinate),d.getView().getZoom()<t.zoomOnSelect&&d.getView().setZoom(t.zoomOnSelect))}).bind(this)),this.restoreHistory(),this.drawList_()}setMap(t){this._listener&&qh(this._listener),this._listener=null,super.setMap(t),t&&(this._listener=t.on("click",this._handleClick.bind(this)))}collapse(t){t===!1?this.element.classList.remove("ol-collapsed"):this.element.classList.add("ol-collapsed")}getInputField(){return this._input}getTitle(t){return t.name||"No title"}_getTitleTxt(t){return ft.create("DIV",{html:this.getTitle(t)}).innerText}search(){var t=this.element.querySelector("input.search");this._triggerCustomEvent("search",t)}_handleClick(t){this.get("reverse")&&(document.activeElement.blur(),this.reverseGeocode(t.coordinate))}reverseGeocode(){}_triggerCustomEvent(t,e){ft.dispatchEvent(t,e)}setInput(t,e){var n=this.element.querySelector("input.search");n.value=t,e&&this._triggerCustomEvent("keyup",n)}select(t,e,n,r){var s={type:"select",search:t,reverse:!!e,coordinate:n};if(r)for(var a in r)s[a]=r[a];this.dispatchEvent(s)}_handleSelect(t,e,n){if(t){var r=this.get("history"),s;try{var a=JSON.stringify(t);for(s=r.length-1;s>=0;s--)(!r[s]||JSON.stringify(r[s])===a)&&r.splice(s,1)}catch{for(s=r.length-1;s>=0;s--)r[s]===t&&r.splice(s,1)}r.unshift(t);for(var o=Math.max(0,this.get("maxHistory")||10)||0;r.length>o;)r.pop();this.saveHistory(),this.select(t,e,null,n),e&&(this.setInput(this._getTitleTxt(t)),this.drawList_(),setTimeout((function(){this.collapse(!1)}).bind(this),300))}}saveHistory(){try{this.get("maxHistory")>=0?localStorage["ol@search-"+this._classname]=JSON.stringify(this.get("history")):localStorage.removeItem("ol@search-"+this._classname)}catch{console.warn("Failed to access localStorage...")}}restoreHistory(){if(this._history[this._classname])this.set("history",this._history[this._classname]);else try{this._history[this._classname]=JSON.parse(localStorage["ol@search-"+this._classname]),this.set("history",this._history[this._classname])}catch{this.set("history",[])}}clearHistory(){this.set("history",[]),this.saveHistory(),this.drawList_()}getHistory(){return this.get("history")}autocomplete(t,e){return e([]),!1}drawList_(t){var e=this,n=this.element.querySelector("ul.autocomplete");if(n.innerHTML="",this._list=[],t)n.setAttribute("class","autocomplete");else{var r=this.element.querySelector("input.search"),s=r.value;if(!s)t=this.get("history");else return;n.setAttribute("class","autocomplete history")}for(var a,o=Math.min(e.get("maxItems"),t.length),l=0;l<o;l++)if(t[l]&&(!l||!e.equalFeatures(t[l],t[l-1]))){a=document.createElement("LI"),a.setAttribute("data-search",this._list.length),this._list.push(t[l]),a.addEventListener("click",function(c){e._handleSelect(e._list[c.currentTarget.getAttribute("data-search")])});var h=e.getTitle(t[l]);h instanceof Element?a.appendChild(h):a.innerHTML=h,n.appendChild(a)}o&&this.get("copy")&&(a=document.createElement("LI"),a.classList.add("copy"),a.innerHTML=this.get("copy"),n.appendChild(a))}equalFeatures(){return!1}};oy.prototype._history={};var q1=class extends Qn{constructor(t){t=t||{},super(),this._auth=t.auth,this.set("dataType",t.dataType||"JSON")}static get(t){var e=new q1(t);t.success&&e.on("success",function(n){t.success(n.response,n)}),t.error&&e.on("error",function(n){t.error(n)}),e.send(t.url,t.data,t.options)}static getCORS(t,e){var n=new XMLHttpRequest;n.open("GET",t,!0),n.send(),n.onreadystatechange=function(){this.readyState==this.HEADERS_RECEIVED&&e(n.getResponseHeader("Access-Control-Allow-Origin"))}}send(t,e,n){n=n||{};var r=this,s=n.encode!==!1;s&&(t=encodeURI(t));var a="";for(var o in e)e.hasOwnProperty(o)&&e[o]!==void 0&&(a+=(a?"&":"?")+o+"="+(s?encodeURIComponent(e[o]):e[o]));this._request&&n.abort!==!1&&this._request.abort();var l=this._request=new XMLHttpRequest;l.open("GET",t+a,!0),n.timeout&&(l.timeout=n.timeout),this._auth&&l.setRequestHeader("Authorization","Basic "+this._auth),this.dispatchEvent({type:"loadstart"}),l.onload=function(){if(r._request=null,r.dispatchEvent({type:"loadend"}),this.status>=200&&this.status<400){var h;try{switch(r.get("dataType")){case"JSON":{h=JSON.parse(this.response);break}default:h=this.response}}catch(c){r.dispatchEvent({type:"error",status:0,statusText:"parsererror",error:c,options:n,jqXHR:this});return}r.dispatchEvent({type:"success",response:h,status:this.status,statusText:this.statusText,options:n,jqXHR:this})}else r.dispatchEvent({type:"error",status:this.status,statusText:this.statusText,options:n,jqXHR:this})},l.ontimeout=function(){r._request=null,r.dispatchEvent({type:"loadend"}),r.dispatchEvent({type:"error",status:this.status,statusText:"Timeout",options:n,jqXHR:this})},l.onerror=function(){r._request=null,r.dispatchEvent({type:"loadend"}),r.dispatchEvent({type:"error",status:this.status,statusText:this.statusText,options:n,jqXHR:this})},l.send()}},aT=class extends oy{constructor(t){t=t||{},t.className=t.className||"JSON",delete t.autocomplete,t.minLength=t.minLength||3,t.typing=t.typing||800,super(t);var e=t.url||"";if(window.location.protocol==="https:"){var n=document.createElement("a");n.href=e,n.protocol=window.location.protocol,e=n.href}this.set("url",e),this._ajax=new q1({dataType:"JSON",auth:t.authentication}),this._ajax.on("success",(function(r){r.status>=200&&r.status<400?typeof this._callback=="function"&&this._callback(r.response):(typeof this._callback=="function"&&this._callback(!1,"error"),console.log("AJAX ERROR",arguments))}).bind(this)),this._ajax.on("error",(function(){typeof this._callback=="function"&&this._callback(!1,"error"),console.log("AJAX ERROR",arguments)}).bind(this)),this._ajax.on("loadstart",(function(){this.element.classList.add("searching")}).bind(this)),this._ajax.on("loadend",(function(){this.element.classList.remove("searching")}).bind(this)),typeof t.handleResponse=="function"&&(this.handleResponse=t.handleResponse)}ajax(t,e,n,r){r=r||{},this._callback=n,this._ajax.set("dataType",r.dataType||"JSON"),this._ajax.send(t,e,r)}autocomplete(t,e){var n=this.requestData(t),r=encodeURI(this.get("url"));this.ajax(r,n,function(s){typeof e=="function"&&e(this.handleResponse(s))})}requestData(t){return{q:t}}handleResponse(t){return t}},oT=class extends aT{constructor(t){t=t||{},t.className=t.className||"photon",t.url=t.url||"https://photon.komoot.io/api/",t.copy=t.copy||'<a href="http://www.openstreetmap.org/copyright" target="new">&copy; OpenStreetMap contributors</a>',super(t),this.set("lang",t.lang),this.set("position",t.position)}getTitle(t){var e=t.properties;return(e.housenumber||"")+" "+(e.street||e.name||"")+"<i> "+(e.postcode||"")+" "+(e.city||"")+" ("+e.country+")</i>"}requestData(t){var e={q:t,lang:this.get("lang"),limit:this.get("maxItems")};if(this.get("position")){var n=this.getMap().getView(),r=new Ir(n.getCenter());r=r.transform(n.getProjection(),"EPSG:4326").getCoordinates(),e.lon=r[0],e.lat=r[1]}return e}handleResponse(t){return t.features}equalFeatures(t,e){return this.getTitle(t)===this.getTitle(e)&&t.geometry.coordinates[0]===e.geometry.coordinates[0]&&t.geometry.coordinates[1]===e.geometry.coordinates[1]}select(t){var e=t.geometry.coordinates;try{e=ba(t.geometry.coordinates,"EPSG:4326",this.getMap().getView().getProjection())}catch{}this.dispatchEvent({type:"select",search:t,coordinate:e})}reverseData(t){var e=ba(t,this.getMap().getView().getProjection(),"EPSG:4326");return{lon:e[0],lat:e[1]}}reverseGeocode(t,e){this.ajax(this.get("url").replace("/api/","/reverse/").replace("/search/","/reverse/"),this.reverseData(t),(function(n){n.features&&(n=n.features),n instanceof Array||(n=[n]),e?e.call(this,n):this._handleSelect(n[0],!0)}).bind(this))}};function U1(i,t){return ly(i,t,[]).join("")}function ly(i,t,e){if(i.nodeType==Node.CDATA_SECTION_NODE||i.nodeType==Node.TEXT_NODE)t?e.push(String(i.nodeValue).replace(/(\r\n|\r|\n)/g,"")):e.push(i.nodeValue);else{let n;for(n=i.firstChild;n;n=n.nextSibling)ly(n,t,e)}return e}function lT(i){return"documentElement"in i}function hT(i){return new DOMParser().parseFromString(i,"application/xml")}function hy(i,t){return function(e,n){const r=i.call(t!==void 0?t:this,e,n);r!==void 0&&n[n.length-1].push(r)}}function Yn(i,t,e){return function(n,r){const s=i.call(e!==void 0?e:this,n,r);if(s!==void 0){const a=r[r.length-1],o=t!==void 0?t:n.localName;let l;o in a?l=a[o]:(l=[],a[o]=l),l.push(s)}}}function Ht(i,t,e){return function(n,r){const s=i.call(e!==void 0?e:this,n,r);if(s!==void 0){const a=r[r.length-1],o=t!==void 0?t:n.localName;a[o]=s}}}function rn(i,t,e){e=e!==void 0?e:{};let n,r;for(n=0,r=i.length;n<r;++n)e[i[n]]=t;return e}function cT(i,t,e,n){let r;for(r=t.firstElementChild;r;r=r.nextElementSibling){const s=i[r.namespaceURI];if(s!==void 0){const a=s[r.localName];a!==void 0&&a.call(n,r,e)}}}function $i(i,t,e,n,r){return n.push(i),cT(t,e,n,r),n.pop()}class uT{read(t){if(!t)return null;if(typeof t=="string"){const e=hT(t);return this.readFromDocument(e)}return lT(t)?this.readFromDocument(t):this.readFromNode(t)}readFromDocument(t){for(let e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readFromNode(e);return null}readFromNode(t){ae()}}function wl(i){const t=/^\s*(true|1)|(false|0)\s*$/.exec(i);if(t)return t[1]!==void 0||!1}function fl(i){const t=U1(i,!1);return Ls(t)}function Ls(i){const t=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(i);if(t)return parseFloat(t[1])}function Og(i){const t=U1(i,!1);return Mf(t)}function Mf(i){const t=/^\s*(\d+)\s*$/.exec(i);if(t)return parseInt(t[1],10)}function De(i){return U1(i,!1).trim()}const fT="http://www.w3.org/1999/xlink";function W1(i){return i.getAttributeNS(fT,"href")}const sn=[null,"http://www.opengis.net/wms"],dT=rn(sn,{Service:Ht(FT),Capability:Ht(NT)}),gT=rn(sn,{Request:Ht(zT),Exception:Ht(jT),Layer:Ht(BT)});class pT extends uT{constructor(){super(),this.version=void 0}readFromNode(t){this.version=t.getAttribute("version").trim();const e=$i({version:this.version},dT,t,[]);return e||null}}const mT=rn(sn,{Name:Ht(De),Title:Ht(De),Abstract:Ht(De),KeywordList:Ht(dy),OnlineResource:Ht(W1),ContactInformation:Ht(OT),Fees:Ht(De),AccessConstraints:Ht(De),LayerLimit:Ht(Og),MaxWidth:Ht(Og),MaxHeight:Ht(Og)}),_T=rn(sn,{ContactPersonPrimary:Ht(kT),ContactPosition:Ht(De),ContactAddress:Ht(DT),ContactVoiceTelephone:Ht(De),ContactFacsimileTelephone:Ht(De),ContactElectronicMailAddress:Ht(De)}),vT=rn(sn,{ContactPerson:Ht(De),ContactOrganization:Ht(De)}),yT=rn(sn,{AddressType:Ht(De),Address:Ht(De),City:Ht(De),StateOrProvince:Ht(De),PostCode:Ht(De),Country:Ht(De)}),xT=rn(sn,{Format:hy(De)}),cy=rn(sn,{Name:Ht(De),Title:Ht(De),Abstract:Ht(De),KeywordList:Ht(dy),CRS:Yn(De),EX_GeographicBoundingBox:Ht(RT),BoundingBox:Yn(IT),Dimension:Yn(GT),Attribution:Ht(PT),AuthorityURL:Yn(WT),Identifier:Yn(De),MetadataURL:Yn(VT),DataURL:Yn(Fs),FeatureListURL:Yn(Fs),Style:Yn(HT),MinScaleDenominator:Ht(fl),MaxScaleDenominator:Ht(fl),Layer:Yn(uy)}),bT=rn(sn,{Title:Ht(De),OnlineResource:Ht(W1),LogoURL:Ht(fy)}),wT=rn(sn,{westBoundLongitude:Ht(fl),eastBoundLongitude:Ht(fl),southBoundLatitude:Ht(fl),northBoundLatitude:Ht(fl)}),ET=rn(sn,{GetCapabilities:Ht(kg),GetMap:Ht(kg),GetFeatureInfo:Ht(kg)}),ST=rn(sn,{Format:Yn(De),DCPType:Yn(qT)}),LT=rn(sn,{HTTP:Ht(UT)}),CT=rn(sn,{Get:Ht(Fs),Post:Ht(Fs)}),AT=rn(sn,{Name:Ht(De),Title:Ht(De),Abstract:Ht(De),LegendURL:Yn(fy),StyleSheetURL:Ht(Fs),StyleURL:Ht(Fs)}),MT=rn(sn,{Format:Ht(De),OnlineResource:Ht(W1)}),TT=rn(sn,{Keyword:hy(De)});function PT(i,t){return $i({},bT,i,t)}function IT(i,t){const e=[Ls(i.getAttribute("minx")),Ls(i.getAttribute("miny")),Ls(i.getAttribute("maxx")),Ls(i.getAttribute("maxy"))],n=[Ls(i.getAttribute("resx")),Ls(i.getAttribute("resy"))];return{crs:i.getAttribute("CRS"),extent:e,res:n}}function RT(i,t){const e=$i({},wT,i,t);if(!e)return;const n=e.westBoundLongitude,r=e.southBoundLatitude,s=e.eastBoundLongitude,a=e.northBoundLatitude;if(!(n===void 0||r===void 0||s===void 0||a===void 0))return[n,r,s,a]}function NT(i,t){return $i({},gT,i,t)}function FT(i,t){return $i({},mT,i,t)}function OT(i,t){return $i({},_T,i,t)}function kT(i,t){return $i({},vT,i,t)}function DT(i,t){return $i({},yT,i,t)}function jT(i,t){return $i([],xT,i,t)}function BT(i,t){const e=$i({},cy,i,t);return e.Layer===void 0?Object.assign(e,uy(i,t)):e}function uy(i,t){const e=t[t.length-1],n=$i({},cy,i,t);if(!n)return;let r=wl(i.getAttribute("queryable"));r===void 0&&(r=e.queryable),n.queryable=r!==void 0?r:!1;let s=Mf(i.getAttribute("cascaded"));s===void 0&&(s=e.cascaded),n.cascaded=s;let a=wl(i.getAttribute("opaque"));a===void 0&&(a=e.opaque),n.opaque=a!==void 0?a:!1;let o=wl(i.getAttribute("noSubsets"));o===void 0&&(o=e.noSubsets),n.noSubsets=o!==void 0?o:!1;let l=Ls(i.getAttribute("fixedWidth"));l||(l=e.fixedWidth),n.fixedWidth=l;let h=Ls(i.getAttribute("fixedHeight"));return h||(h=e.fixedHeight),n.fixedHeight=h,["Style","CRS","AuthorityURL"].forEach(function(g){if(g in e){const d=n[g]||[];n[g]=d.concat(e[g])}}),["EX_GeographicBoundingBox","BoundingBox","Dimension","Attribution","MinScaleDenominator","MaxScaleDenominator"].forEach(function(g){if(!(g in n)){const d=e[g];n[g]=d}}),n}function GT(i,t){return{name:i.getAttribute("name"),units:i.getAttribute("units"),unitSymbol:i.getAttribute("unitSymbol"),default:i.getAttribute("default"),multipleValues:wl(i.getAttribute("multipleValues")),nearestValue:wl(i.getAttribute("nearestValue")),current:wl(i.getAttribute("current")),values:De(i)}}function Fs(i,t){return $i({},MT,i,t)}function zT(i,t){return $i({},ET,i,t)}function qT(i,t){return $i({},LT,i,t)}function UT(i,t){return $i({},CT,i,t)}function kg(i,t){return $i({},ST,i,t)}function fy(i,t){const e=Fs(i,t);if(e){const n=[Mf(i.getAttribute("width")),Mf(i.getAttribute("height"))];return e.size=n,e}}function WT(i,t){const e=Fs(i,t);if(e)return e.name=i.getAttribute("name"),e}function VT(i,t){const e=Fs(i,t);if(e)return e.type=i.getAttribute("type"),e}function HT(i,t){return $i({},AT,i,t)}function dy(i,t){return $i([],TT,i,t)}const XT=pT;var V1=class extends ur{constructor(t){t=t||{};var e=document.createElement("div");e.className=(t.className||"")+" ol-button ol-unselectable ol-control",super({element:e,target:t.target});var n=this,r=this.button_=document.createElement(/ol-text-button/.test(t.className)?"div":"button");r.type="button",t.title&&(r.title=t.title),t.name&&(r.name=t.name),t.html instanceof Element?r.appendChild(t.html):r.innerHTML=t.html||"";var s=function(a){a&&a.preventDefault&&(a.preventDefault(),a.stopPropagation()),t.handleClick&&t.handleClick.call(n,a)};r.addEventListener("click",s),e.appendChild(r),!t.title&&r.firstElementChild&&(r.title=r.firstElementChild.title),t.title&&this.set("title",t.title),t.title&&this.set("title",t.title),t.name&&this.set("name",t.name)}setVisible(t){t?ft.show(this.element):ft.hide(this.element)}setTitle(t){this.button_.setAttribute("title",t)}setHtml(t){ft.setHTML(this.button_,t)}getButtonElement(){return this.button_}},YT=class extends ur{constructor(t){t=t||{},t.fullscreen&&(t.target=document.body);var e=ft.create("DIV",{className:((t.className||"")+(t.zoom?" ol-zoom":"")+" ol-ext-dialog").trim()});super({element:e,target:t.target}),e.addEventListener("click",(function(s){this.get("hideOnBack")&&s.target===e&&this.close(),this.get("hideOnClick")&&this.close()}).bind(this));var n=ft.create("FORM",{on:{submit:this._onButton("submit")},parent:e});ft.create("H2",{parent:n}),ft.create("DIV",{className:"ol-closebox",click:this._onButton("cancel"),parent:n}),ft.create("DIV",{className:"ol-content",parent:n}),this._progress=ft.create("DIV",{style:{display:"none"},parent:n});var r=ft.create("DIV",{className:"ol-progress-bar",parent:this._progress});this._progressbar=ft.create("DIV",{parent:r}),this._progressMessage=ft.create("DIV",{className:"ol-progress-message",parent:this._progress}),ft.create("DIV",{className:"ol-buttons",parent:n}),this.set("closeBox",t.closeBox!==!1),this.set("zoom",!!t.zoom),this.set("hideOnClick",!!t.hideOnClick),this.set("hideOnBack",!!t.hideOnBack),this.set("className",e.className),this.set("closeOnSubmit",t.closeOnSubmit),this.set("buttons",t.buttons),this.setContent(t)}show(t){t&&((t instanceof Element||typeof t=="string")&&(t={content:t}),this.setContent(t)),this.element.classList.add("ol-visible");var e=this.element.querySelector('input[type="text"],input[type="search"],input[type="number"]');if(e&&e.focus(),this.dispatchEvent({type:"show"}),t){if(t.autoclose){var n=setTimeout((function(){this.hide()}).bind(this),t.autoclose);this.once("hide",function(){clearTimeout(n)})}if(t.hideOnBack){var r=this.get("hideOnBack");this.set("hideOnBack",!0),this.once("hide",(function(){this.set("hideOnBack",r)}).bind(this))}}}open(){this.show()}setContentMessage(t){if(t!==void 0){var e=this.getContentElement();t instanceof Element&&ft.setHTML(e,""),ft.setHTML(e,t||"")}}setTitle(t){var e=this.element.querySelector("form");e.querySelector("h2").innerText=t||"",t?e.classList.add("ol-title"):e.classList.remove("ol-title")}setContent(t){if(t){this.element.className=this.get("className"),typeof t=="string"&&(t={content:t}),t=t||{},this.setProgress(!1),t.max&&this.setProgress(0,t.max),t.progress!==void 0&&this.setProgress(t.progress),this.get("zoom")?this.element.classList.add("ol-zoom"):this.element.classList.remove("ol-zoom"),t.className&&t.className.split(" ").forEach((function(a){this.element.classList.add(a)}).bind(this));var e=this.element.querySelector("form");t.content!==void 0&&(t.content instanceof Element&&ft.setHTML(e.querySelector(".ol-content"),""),ft.setHTML(e.querySelector(".ol-content"),t.content||"")),this.setTitle(t.title),t.closeBox||this.get("closeBox")&&t.closeBox!==!1?e.classList.add("ol-closebox"):e.classList.remove("ol-closebox");var n=this.element.querySelector(".ol-buttons");n.innerHTML="";var r=t.buttons||this.get("buttons");if(r){e.classList.add("ol-button");for(var s in r)ft.create("INPUT",{type:s==="submit"?"submit":"button",value:r[s],click:this._onButton(s,t.onButton),parent:n})}else e.classList.remove("ol-button")}}getContentElement(){return this.element.querySelector("form .ol-content")}setProgress(t,e,n){if(t===!1){ft.setStyle(this._progress,{display:"none"});return}if(e>0?this.set("max",Number(e)):e=this.get("max"),!e)ft.setStyle(this._progress,{display:"none"});else{var r=Math.round(t/e*100);ft.setStyle(this._progress,{display:""}),this._progressbar.className=r?"":"notransition",ft.setStyle(this._progressbar,{width:r+"%"})}this._progressMessage.innerHTML="",ft.setHTML(this._progressMessage,n||"")}_onButton(t,e){var n=(function(r){r.preventDefault(),(t!=="submit"||this.get("closeOnSubmit")!==!1)&&this.hide();var s=this.getInputs();this.dispatchEvent({type:"button",button:t,inputs:s}),typeof e=="function"&&e(t,s)}).bind(this);return n}getInputs(){var t={};return["input","textarea","select"].forEach((function(e){this.element.querySelectorAll("form "+e).forEach(function(n){n.className&&n.className.split(" ").forEach(function(r){t[r]=n})})}).bind(this)),t}hide(){this.element.classList.remove("ol-visible"),this.dispatchEvent({type:"hide"})}close(){this.hide()}isOpen(){return this.element.classList.contains("ol-visible")}};L1.prototype.getPreview=function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAk6QAAJOkBUCTn+AAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAANeSURBVHic7ZpPiE1RHMc/780MBhkik79JSUlIUbOxI+wkI2yRhYSUlJLNpJF/xcpiJBmZGBZsNM1CkmhKITGkGbH0/BuPmXnP4rxbb/TOn3fvOffeec6nfqvb/b7f93fveeec37ng8Xg8Ho/nf6Uu4d+fDswFssCvhHOJhaXAMeApMAQUyyIPPAdOAiuTStAVy4EHjDWsix5gdRLJ2mY34ulWYz6IEeA4kIk9awtkgTOEM/5vdAKT4k0/Ou3YMR/ELcbRm9AKFLBbgCJwNE4TYZkJfMG++SIwDCyLz0o4bI17WdyJz0r1TAZ+oDcxCBwAFgIzEIuhvcBbg3sLwOK4DFXLFvQGniCGSSUagS4DjUPOHESkA3XiOWCORqMR6Nfo9DjI3QqPUSd+ylBnv0Zn0GrWFvmIOvGNhjqrNDp/EAutyFgRKUM2tgO+Gur81FxvAKYZaimxXYBvmuuLDHWWaK4X0RfJCNsF6NdcbzXU2a65PohYFKWOc+jn8PUajbWIXaBKp9NB7lZYh34OzwFbFfd/NtDYYSth27urLGIm0M31AL3APWAAmIooymaDnPIl/Vz4NN1yHrd7gcvxWQnHAuA3bsyPop8hUsE13BSgK04TUViBeFo2zedJ8S6wElexW4D2eNOPTjNi6WvD/DtEr8E6tk6GGoAmxFY2iFHE9NZiQf8gogiB9gTEH23izAZuE77vHyU+ANucO1QwD3hD/MbLowAcdm20EmkwXx4n3NodS9rMB2HabYpEWs0HcRqHp0fNwAvJD+eBTZr7p6BvmQVxUaEzEbiruNfJekH15L8jtrEm7JJolEcOmKXRqQOuKDQuY7HZY8s8iNfzkSLxIuI43FTrkkLnOlBfRW4VsWk+oAX5weknxFAxJQNckGgVgZuIRVoomoGXEmGTMa+iQ6K7M4SW7k24QYgiuDQPYinbhugiF4H3RGtzZYCzyIvQXfpNI1ybLyeLpf5+iTbkRbiP2EcocTHm4+YI8iI8RFHwWjAfsA95Q+YZFU6wasl8wB7kReijtNbIILa0vcg/PRlGfPQwHmlCviDqAzaA+OREtzqr1ejOIDorxlNEjTGUBV4nnUWCvAJxGDlA8q9j3DEArAn2zvXAfOwfl6eVAmJrPpJ0Ih6Px+PxeJLjLwPul3vj5d0eAAAAAElFTkSuQmCC"};Cv.prototype.getPreview=function(i,t){i||(i=[21020,6355964]),t||(t=150);var e=this.getTileGrid().getTileCoordForCoordAndResolution(i,t),n=this.getTileUrlFunction();return n.call(this,e,this.getProjection())};ci.prototype.getPreview=function(i,t){i||(i=[21020,6355964]),t||(t=150);var e=this.getTileUrlFunction();if(e){var n=this.getTileGrid()||this.getTileGridForProjection(this.getProjection()),r=n.getTileCoordForCoordAndResolution(i,t);return e.call(this,r,1,this.getProjection())}var s=this.getGetFeatureInfoUrl?this.getGetFeatureInfoUrl(i,t,this.getProjection()||"EPSG:3857",{}):this.getFeatureInfoUrl(i,t,this.getProjection()||"EPSG:3857",{});return s=s.replace(/getfeatureinfo/i,"GetMap"),s};Dl.prototype.getPreview=function(i,t,e){if(this.get("preview"))return[this.get("preview")];if(t||(t=150),t<this.getMinResolution()||t>this.getMaxResolution()){var n=this.getMinResolution(),r=this.getMaxResolution();for(r>1e5&&(r=156543),n<.15&&(n=.15),t=r;r>n;)n*=2,r/=2,t=n}var s=this.getExtent();if(i||(i=[21020,6355964]),s&&!ya(s,i)&&(i=[(s[0]+s[2])/2,(s[1]+s[3])/2]),e&&(i=ba(i,e,this.getSource().getProjection())),this.getSource&&this.getSource())try{return[this.getSource().getPreview(i,t)]}catch{}return[]};Cn.prototype.getPreview=function(i,t){if(this.get("preview"))return[this.get("preview")];var e=[];if(this.getLayers)for(var n=this.getLayers().getArray(),r=0;r<n.length;r++)e=e.concat(n[r].getPreview(i,t));return e};var H1=class extends V1{constructor(t){t=t||{};var e=Object.assign({},t||{});e.target===document.body&&delete e.target,e.target?(e.className=((e.className||"")+" ol-wmscapabilities ol-hidden").trim(),delete e.target):(e.className=((e.className||"")+" ol-wmscapabilities").trim(),e.handleClick=function(){n.showDialog()}),super(e);var n=this;this._proxy=t.proxy,this.set("srs",t.srs||[]),this.set("cors",t.cors),this.set("trace",t.trace),this.set("title",t.title),this.set("loadLabel",t.loadLabel),this.set("optional",t.optional),this.createDialog(t),this._elements.formVersion.value="1.0.0";var r=this._getParser();this._ajax=new q1({dataType:"text",auth:t.authentication}),this._ajax.on("success",(function(s){var a;try{a=r.read(s.response)}catch(o){this.showError({type:"load",error:o})}a&&(a.Capability.Layer.Layer?(a.url=s.options.url,this.showCapabilities(a)):this.showError({type:"noLayer"})),this.dispatchEvent({type:"capabilities",capabilities:a}),typeof s.options.callback=="function"&&s.options.callback(a)}).bind(this)),this._ajax.on("error",(function(s){this.showError({type:"load",error:s}),this.dispatchEvent({type:"capabilities"}),s.options.callback}).bind(this)),this._ajax.on("loadstart",(function(){this._elements.element.classList.add("ol-searching")}).bind(this)),this._ajax.on("loadend",(function(){this._elements.element.classList.remove("ol-searching")}).bind(this)),t.onselect&&this.on("load",function(s){t.onselect(s.layer,s.options)})}_getParser(){return new XT}createDialog(t){var e=t.target;(!e||e===document.body)&&(this._dialog=new YT({className:"ol-wmscapabilities",closeBox:!0,closeOnSubmit:!1,target:t.target}),this._dialog.on("button",(function(m){m.button==="submit"&&this.getCapabilities(m.inputs.url.value)}).bind(this)),e=null);var n=ft.create("DIV",{className:("ol-wmscapabilities "+(t.className||"")).trim(),parent:e});this._elements={element:e||n};var r=ft.create("DIV",{className:"ol-url",parent:n}),s=this._elements.input=ft.create("INPUT",{className:"url",type:"text",tabIndex:1,placeholder:t.placeholder||"service url...",autocorrect:"off",autocapitalize:"off",parent:r});if(s.addEventListener("keyup",(function(m){m.keyCode===13&&this.getCapabilities(s.value,t)}).bind(this)),t.services){var a=ft.create("SELECT",{className:"url",on:{change:(function(m){var y=m.target.options[m.target.selectedIndex].value;this.getCapabilities(y,t),m.target.selectedIndex=0}).bind(this)},parent:r});ft.create("OPTION",{html:" ",parent:a});for(var o in t.services)ft.create("OPTION",{html:o,value:t.services[o],parent:a})}ft.create("BUTTON",{click:(function(){this.getCapabilities(s.value,t)}).bind(this),html:t.searchLabel||"search",parent:r}),this._elements.error=ft.create("DIV",{className:"ol-error",parent:r});var l=this._elements.result=ft.create("DIV",{className:"ol-result",parent:n}),h=ft.create("DIV",{className:"ol-preview",html:t.previewLabel||"preview",parent:l});this._elements.preview=ft.create("IMG",{parent:h}),this._img=new Image,this._img.crossOrigin="Anonymous",this._img.addEventListener("error",(function(){h.className="ol-preview tainted",this._elements.formCrossOrigin.checked=!1}).bind(this)),this._img.addEventListener("load",(function(){h.className="ol-preview ok",this._elements.formCrossOrigin.checked=!0}).bind(this)),this._elements.select=ft.create("DIV",{className:"ol-select-list",tabIndex:2,parent:l}),this._elements.data=ft.create("DIV",{className:"ol-data",parent:l}),this._elements.buttons=ft.create("DIV",{className:"ol-buttons",parent:l}),this._elements.legend=ft.create("IMG",{className:"ol-legend",parent:l});var c=this._elements.form=ft.create("UL",{className:"ol-wmsform",parent:n}),f=(function(m,y,b){var x=ft.create("LI",{parent:c});if(ft.create("LABEL",{html:this.labels[m],parent:x}),typeof y=="boolean")this._elements[m]=ft.create("INPUT",{type:"checkbox",checked:y,parent:x});else if(y instanceof Array){var E=this._elements[m]=ft.create("SELECT",{parent:x});y.forEach((function(S){ft.create("OPTION",{html:S,value:S,parent:E})}).bind(this))}else this._elements[m]=ft.create("INPUT",{value:y===void 0?"":y,placeholder:b||"",type:typeof y=="number"?"number":"text",parent:x});return x}).bind(this);f("formTitle"),f("formLayer","","layer1,layer2,...");var g=f("formMap");g.setAttribute("data-param","map"),g=f("formStyle"),g.setAttribute("data-param","style"),f("formFormat",["image/png","image/jpeg"]),f("formMinZoom",0),f("formMaxZoom",20),g=f("formExtent","","xmin,ymin,xmax,ymax"),g.setAttribute("data-param","extent");var d=g.querySelector("input");return ft.create("BUTTON",{title:this.labels.mapExtent,click:(function(){d.value=this.getMap().getView().calculateExtent(this.getMap().getSize()).join(",")}).bind(this),parent:g}),g=f("formProjection",""),g.setAttribute("data-param","proj"),f("formCrossOrigin",!1),g=f("formVersion","1.3.0"),g.setAttribute("data-param","version"),f("formAttribution",""),ft.create("BUTTON",{html:this.get("loadLabel")||"Load",click:(function(){var m=this._getFormOptions(),y=this.getLayerFromOptions(m);this.dispatchEvent({type:"load",layer:y,options:m}),this._dialog.hide()}).bind(this),parent:c}),n}getLayerFromOptions(t){t.layer.source=new ci(t.source);var e=new Ue(t.layer);return delete t.layer.source,e}setMap(t){super.setMap(t),this._dialog&&this._dialog.setMap(t)}getDialog(){return this._dialog}showDialog(t,e){this.showError(),this._elements.formProjection.value||(this._elements.formProjection.value=this.getMap().getView().getProjection().getCode()),this._dialog&&this._dialog.show({title:this.get("title")===void 0?"WMS":this.get("title"),content:this._elements.element}),this.getCapabilities(t,e);var n=this._elements.select.querySelector(".selected");n&&(this._elements.select.scrollTop=n.offsetTop-20)}testUrl(t){var e=new RegExp("^(https?:\\/\\/)((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=\\/-]*)?(\\#[-a-z\\d_]*)?$","i");return!!e.test(t)}getRequestParam(t){return{SERVICE:"WMS",REQUEST:"GetCapabilities",VERSION:t.version||"1.3.0"}}getCapabilities(t,e){if(t){if(!this.testUrl(t)){this.showError({type:"badUrl"});return}e=e||{},t=t.split("?");var n=t[1];t=t[0],this._elements.formMap.value="",this._elements.formLayer.value="",this._elements.formStyle.value="",this._elements.formTitle.value="",this._elements.formProjection.value=this.getMap().getView().getProjection().getCode(),this._elements.formFormat.selectedIndex=0;var r=e.map||"",s={};n&&(n=n.replace(/^\?/,"").split("&"),n.forEach((function(g){if(g=g.split("="),g[1]=decodeURIComponent(g[1]||""),/^map$/i.test(g[0])&&(r=g[1],this._elements.formMap.value=r),/^layers$/i.test(g[0])&&(this._elements.formLayer.value=g[1],this._elements.formTitle.value=g[1].split(",")[0]),/^style$/i.test(g[0])&&(this._elements.formStyle.value=g[1]),/^crs$/i.test(g[0])&&(this._elements.formProjection.value=g[1]),/^format$/i.test(g[0])){for(var d,m=0;d=this._elements.formFormat.options[m];m++)if(d.value===g[1]){this._elements.formFormat.selectedIndex=m;break}}this.get("optional")&&this.get("optional").split(",").forEach((function(y){y===g[0]&&(s[y]=g[1])}).bind(this))}).bind(this)));var a=this.getRequestParam(e),o=[];r&&(a.MAP=r,o.push("map="+r));for(var l in s)a[l]=s[l],o.push(l+"="+s[l]);var h=this._elements.input.value=(t||"")+(o?"?"+o.join("&"):"");if(this.clearForm(),this._proxy){var c="";for(var f in a)c+=(c?"&":"")+f+"="+a[f];this._ajax.send(this._proxy,{url:c},{url:h,timeout:e.timeout||1e4,callback:e.onload,abort:!1})}else this._ajax.send(t,a,{url:h,timeout:e.timeout||1e4,callback:e.onload,abort:!1})}}showError(t){t?this._elements.error.innerHTML=this.error[t.type]||"ERROR ("+t.type+")":this._elements.error.innerHTML="",t&&t.type==="load"?this._elements.form.classList.add("visible"):this._elements.form.classList.remove("visible")}clearForm(){this._elements.result.classList.remove("ol-visible"),this.showError(),this._elements.select.innerHTML="",this._elements.data.innerHTML="",this._elements.preview.src="",this._elements.legend.src="",this._elements.legend.classList.remove("visible")}showCapabilities(t){this._elements.result.classList.add("ol-visible");var e=[],n=(function(r,s){s=s||0,r.Layer.forEach((function(a){a.Attribution||(a.Attribution=r.Attribution),a.EX_GeographicBoundingBox||(a.EX_GeographicBoundingBox=r.EX_GeographicBoundingBox);var o=ft.create("DIV",{className:(a.Layer?"ol-title ":"")+"level-"+s,html:a.Name||a.Title,click:(function(){this._elements.buttons.innerHTML="",this._elements.data.innerHTML="",this._elements.legend.src=this._elements.preview.src="",this._elements.element.classList.remove("ol-form"),this.showError();var l=this.getOptionsFromCap(a,t),h=this.getLayerFromOptions(l);if(this._currentOptions=l,e.forEach(function(g){g.classList.remove("selected")}),o.classList.add("selected"),h){ft.create("BUTTON",{html:this.get("loadLabel")||"Load",className:"ol-load",click:(function(){this.dispatchEvent({type:"load",layer:h,options:l}),this._dialog&&this._dialog.hide()}).bind(this),parent:this._elements.buttons}),ft.create("BUTTON",{className:"ol-wmsform",click:(function(){this._elements.element.classList.toggle("ol-form")}).bind(this),parent:this._elements.buttons});var c=this.getMap().getView().getResolution(),f=this.getMap().getView().getCenter();this._elements.preview.src=h.getPreview(f,c,this.getMap().getView().getProjection()),this._img.src=this._elements.preview.src,ft.create("p",{className:"ol-title",html:l.data.title,parent:this._elements.data}),ft.create("p",{html:l.data.abstract,parent:this._elements.data}),l.data.legend&&l.data.legend.length?(this._elements.legend.src=l.data.legend[0],this._elements.legend.classList.add("visible")):(this._elements.legend.src="",this._elements.legend.classList.remove("visible"))}}).bind(this),parent:this._elements.select});e.push(o),a.Layer&&n(a,s+1)}).bind(this))}).bind(this);this._elements.select.innerHTML="",n(t.Capability.Layer)}getLayerResolution(t,e,n){var r=t==="min"?"MinScaleDenominator":"MaxScaleDenominator";if(e[r]!==void 0)return e[r]/(72/2.54*100);if(!e.Layer)return t==="min"?0:156543.03392804097;n=t==="min"?156543.03392804097:0;for(var s=0;s<e.Layer.length;s++){var a=this.getLayerResolution(t,e.Layer[s],n);a!==void 0&&(n=Math[t](n,a))}return n}getOptionsFromCap(t,e){var n=e.Capability.Request.GetMap.Format,r,s,a=[/png/,/jpeg/,/gif/];for(s=0;s<3;s++){for(var o=0;o<n.length;o++)if(a[s].test(n[o])){r=n[o];break}if(r)break}r||(r=n[0]);var l=this.getMap().getView().getProjection().getCode();this.showError();var h=!1;t.CRS?t.CRS.indexOf(l)>=0?h=!0:t.CRS.indexOf("EPSG:4326")>=0?(l="EPSG:4326",h=!0):this.get("srs").forEach(function(M){t.CRS.indexOf(M)>=0&&(l=M,h=!0)}):h=!1,h||(this.showError({type:"srs"}),this.get("trace")&&console.log("BAD srs: ",t.CRS));var c=t.EX_GeographicBoundingBox;c&&(c=G5(c,"EPSG:4326",this.getMap().getView().getProjection()));var f=[];t.Attribution&&t.Attribution.Title&&f.push('<a href="'+encodeURI(t.Attribution.OnlineResource)+'">&copy; '+t.Attribution.Title.replace(/</g,"&lt;")+"</a>");var g={title:t.Title,extent:c,queryable:t.queryable,abstract:t.Abstract,minResolution:this.getLayerResolution("min",t),maxResolution:this.getLayerResolution("max",t)||156543.03392804097},d={url:e.Capability.Request.GetMap.DCPType[0].HTTP.Get.OnlineResource,projection:l,attributions:f,crossOrigin:this.get("cors")?"anonymous":null,params:{LAYERS:t.Name,FORMAT:r,VERSION:e.version||"1.3.0"}},m=new or({projection:this.getMap().getView().getProjection()});m.setResolution(g.minResolution);var y=Math.round(m.getZoom());m.setResolution(g.maxResolution);var b=Math.round(m.getZoom());if(this._fillForm({title:g.title,layers:d.params.LAYERS,format:d.params.FORMAT,minZoom:b,maxZoom:y,extent:c?c.join(","):"",projection:d.projection,attribution:d.attributions[0]||"",version:d.params.VERSION}),this.get("trace")){var x=JSON.stringify([d],null,"	").replace(/\\"/g,'"');g.source="SOURCE";var E="new ol.layer.Tile ("+JSON.stringify(g,null,"	")+")";E=E.replace(/\\"/g,'"').replace('"SOURCE"',"new ol.source.TileWMS("+x+")").replace(/\\t/g,"	").replace(/\\n/g,`
`).replace(`([
	`,"(").replace(`}
])`,"})"),console.log(E),delete g.source}var S=[];return t.Style&&t.Style.forEach(function(M){M.LegendURL&&S.push(M.LegendURL[0].OnlineResource)}),{layer:g,source:d,data:{title:t.Title,abstract:t.Abstract,logo:t.Attribution&&t.Attribution.LogoURL?t.Attribution.LogoURL.OnlineResource:void 0,keyword:t.KeywordList,legend:S,opaque:t.opaque,queryable:t.queryable}}}_getFormOptions(){var t=parseInt(this._elements.formMinZoom.value),e=parseInt(this._elements.formMaxZoom.value),n=new or({projection:this.getMap().getView().getProjection()});n.setZoom(t);var r=n.getResolution();n.setZoom(e);var s=n.getResolution(),a=[];this._elements.formExtent.value&&this._elements.formExtent.value.split(",").forEach(function(h){a.push(parseFloat(h))}),a.length!==4&&(a=void 0);var o=[];this._elements.formAttribution.value&&o.push(this._elements.formAttribution.value);var l={layer:{title:this._elements.formTitle.value,extent:a,maxResolution:r,minResolution:s},source:{url:this._elements.input.value,crossOrigin:this._elements.formCrossOrigin.checked?"anonymous":null,projection:this._elements.formProjection.value,attributions:o,params:{FORMAT:this._elements.formFormat.options[this._elements.formFormat.selectedIndex].value,LAYERS:this._elements.formLayer.value,VERSION:this._elements.formVersion.value}},data:{title:this._elements.formTitle.value}};return this._elements.formMap.value&&(l.source.params.MAP=this._elements.formMap.value),l}_fillForm(t){this._elements.formTitle.value=t.title,this._elements.formLayer.value=t.layers,this._elements.formStyle.value=t.style;var e,n;for(n=0;e=this._elements.formFormat.options[n];n++)if(e.value===t.format){this._elements.formFormat.selectedIndex=n;break}this._elements.formExtent.value=t.extent||"",this._elements.formMaxZoom.value=t.maxZoom,this._elements.formMinZoom.value=t.minZoom,this._elements.formProjection.value=t.projection,this._elements.formAttribution.value=t.attribution,this._elements.formVersion.value=t.version}loadLayer(t,e,n){this.getCapabilities(t,{onload:(function(r){r?r.Capability.Layer.Layer.forEach((function(s){if(s.Name===e||s.Identifier===e){var a=this.getOptionsFromCap(s,r),o=this.getLayerFromOptions(a);this.dispatchEvent({type:"load",layer:o,options:a}),typeof n=="function"&&n({layer:o,options:a})}}).bind(this)):this.dispatchEvent({type:"load",error:!0})}).bind(this)})}};H1.prototype.error={load:"Can't retrieve service capabilities, try to add it manually...",badUrl:"The input value is not a valid url...",TileMatrix:"No TileMatrixSet supported...",noLayer:"No layer available for this service...",srs:"The service projection looks different from that of your map, it may not display correctly..."};H1.prototype.labels={formTitle:"Title:",formLayer:"Layers:",formMap:"Map:",formStyle:"Style:",formFormat:"Format:",formMinZoom:"Min zoom level:",formMaxZoom:"Max zoom level:",formExtent:"Extent:",mapExtent:"use map extent...",formProjection:"Projection:",formCrossOrigin:"CrossOrigin:",formVersion:"Version:",formAttribution:"Attribution:"};var X1=class extends ur{constructor(t){t=t||{};var e=document.createElement("DIV");if(e.classList.add("ol-unselectable","ol-control","ol-bar"),t.className){var n=t.className.split(" ").filter(function(s){return s.length>0});e.classList.add.apply(e.classList,n)}if(t.group&&e.classList.add("ol-group"),super({element:e,target:t.target}),this.set("toggleOne",t.toggleOne),this.set("autoDeactivate",t.autoDeactivate),this.controls_=[],t.controls instanceof Array)for(var r=0;r<t.controls.length;r++)this.addControl(t.controls[r])}setVisible(t){t?this.element.style.display="":this.element.style.display="none"}getVisible(){return this.element.style.display!="none"}setMap(t){super.setMap(t);for(var e=0;e<this.controls_.length;e++){var n=this.controls_[e];n.setMap(t)}}getControls(){return this.controls_}setPosition(t){this.element.classList.remove("ol-left","ol-top","ol-bottom","ol-right"),t=t.split("-");for(var e=0;e<t.length;e++)switch(t[e]){case"top":case"left":case"bottom":case"right":this.element.classList.add("ol-"+t[e]);break}}addControl(t){this.controls_.push(t),t.setTarget(this.element),this.getMap()&&this.getMap().addControl(t),t._activateBar&&t.un("change:active",t._activateBar),t._activateBar=(function(e){this.onActivateControl_(e,t)}).bind(this),t.on("change:active",t._activateBar),t.getActive&&this.onActivateControl_({target:t,active:t.getActive()},t)}removeControl(t){const e=this.controls_.indexOf(t);e>-1&&(this.controls_.splice(e,1),this.getMap()&&this.getMap().removeControl(t),t._activateBar&&t.un("change:active",t._activateBar),delete t._activateBar)}deactivateControls(t){for(var e=0;e<this.controls_.length;e++)this.controls_[e]!==t&&this.controls_[e].setActive&&this.controls_[e].setActive(!1)}getActiveControls(){for(var t=[],e=0,n;n=this.controls_[e];e++)n.getActive&&n.getActive()&&t.push(n);return t}setActive(t){if(!t&&this.get("autoDeactivate")&&this.deactivateControls(),t)for(var e=this.getControls(),n=0,r;r=e[n];n++)r.get("autoActivate")&&r.setActive(!0)}onActivateControl_(t,e){if(this.get("toggleOne")){if(t.active){var n;for(n=0;n<this.controls_.length&&this.controls_[n]!==e;n++);if(n==this.controls_.length)return;this.deactivateControls(this.controls_[n])}else if(!this.getActiveControls().length){for(var r=0,s;s=this.controls_[r];r++)if(s.get("autoActivate")){s.setActive(!0);break}}}t.type?this.dispatchEvent({type:"control:active",control:e,active:t.active}):this.dispatchEvent({type:"control:add",control:e,active:t.active})}getControlsByName(t){var e=this.getControls();return e.filter(function(n){return n.get("name")===t})}},Tf=class extends V1{constructor(t){t=t||{},t.toggleFn&&(t.onToggle=t.toggleFn),t.handleClick=function(){e.toggle(),t.onToggle&&t.onToggle.call(e,e.getActive())},t.className=(t.className||"")+" ol-toggle",super(t);var e=this;this.interaction_=t.interaction,this.interaction_&&(this.interaction_.setActive(t.active),this.interaction_.on("change:active",function(){e.setActive(e.interaction_.getActive())})),this.set("title",t.title),this.set("autoActivate",t.autoActivate),t.bar&&this.setSubBar(t.bar),this.setActive(t.active),this.setDisable(t.disable)}setMap(t){!t&&this.getMap()&&(this.interaction_&&this.getMap().removeInteraction(this.interaction_),this.subbar_&&this.getMap().removeControl(this.subbar_)),super.setMap(t),t&&(this.interaction_&&t.addInteraction(this.interaction_),this.subbar_&&t.addControl(this.subbar_))}getSubBar(){return this.subbar_}setSubBar(t){var e=this.getMap();e&&this.subbar_&&e.removeControl(this.subbar_),this.subbar_=t,t&&(this.subbar_.setTarget(this.element),this.subbar_.element.classList.add("ol-option-bar"),e&&e.addControl(this.subbar_))}getDisable(){var t=this.element.querySelector("button");return t&&t.disabled}setDisable(t){this.getDisable()!=t&&(this.element.querySelector("button").disabled=t,t&&this.getActive()&&this.setActive(!1),this.dispatchEvent({type:"change:disable",key:"disable",oldValue:!t,disable:t}))}getActive(){return this.element.classList.contains("ol-active")}toggle(){this.getActive()?this.setActive(!1):this.setActive(!0)}setActive(t){this.interaction_&&this.interaction_.setActive(t),this.subbar_&&this.subbar_.setActive(t),this.getActive()!==t&&(t?this.element.classList.add("ol-active"):this.element.classList.remove("ol-active"),this.dispatchEvent({type:"change:active",key:"active",oldValue:!t,active:t}))}setInteraction(t){this.interaction_=t}getInteraction(){return this.interaction_}},E2=class extends V1{constructor(t){t=t||{},t.className=(t.className||"")+" ol-text-button",super(t)}},gy=class extends ur{constructor(t){t=t||{};var e=ft.create("DIV",{className:t.switcherClass||"ol-layerswitcher"});super({element:e,target:t.target});var n=this;this.dcount=0,this.show_progress=t.show_progress,this.oninfo=typeof t.oninfo=="function"?t.oninfo:null,this.onextent=typeof t.onextent=="function"?t.onextent:null,this.hasextent=t.extent||t.onextent,this.hastrash=t.trash,this.reordering=t.reordering!==!1,this._layers=[],this._layerGroup=t.layerGroup&&t.layerGroup.getLayers?t.layerGroup:null,this.onchangeCheck=typeof t.onchangeCheck=="function"?t.onchangeCheck:null,typeof t.displayInLayerSwitcher=="function"&&(this.displayInLayerSwitcher=t.displayInLayerSwitcher),t.target||(e.classList.add("ol-unselectable"),e.classList.add("ol-control"),e.classList.add(t.collapsed!==!1?"ol-collapsed":"ol-forceopen"),this.button=ft.create("BUTTON",{type:"button",parent:e}),this.button.addEventListener("touchstart",function(r){e.classList.toggle("ol-forceopen"),e.classList.add("ol-collapsed"),n.dispatchEvent({type:"toggle",collapsed:e.classList.contains("ol-collapsed")}),r.preventDefault(),n.overflow()}),this.button.addEventListener("click",function(){e.classList.toggle("ol-forceopen"),e.classList.add("ol-collapsed"),n.dispatchEvent({type:"toggle",collapsed:!e.classList.contains("ol-forceopen")}),n.overflow()}),t.mouseover&&(e.addEventListener("mouseleave",function(){e.classList.add("ol-collapsed"),n.dispatchEvent({type:"toggle",collapsed:!0})}),e.addEventListener("mouseover",function(){e.classList.remove("ol-collapsed"),n.dispatchEvent({type:"toggle",collapsed:!1})})),t.minibar&&(t.noScroll=!0),t.noScroll||(this.topv=ft.create("DIV",{className:"ol-switchertopdiv",parent:e,click:function(){n.overflow("+50%")}}),this.botv=ft.create("DIV",{className:"ol-switcherbottomdiv",parent:e,click:function(){n.overflow("-50%")}})),this._noScroll=t.noScroll),this.panel_=ft.create("UL",{className:"panel"}),this.panelContainer_=ft.create("DIV",{className:"panel-container",html:this.panel_,parent:e}),!t.target&&!t.noScroll&&ft.addListener(this.panel_,"mousewheel DOMMouseScroll onmousewheel",function(r){n.overflow(Math.max(-1,Math.min(1,r.wheelDelta||-r.detail)))&&(r.stopPropagation(),r.preventDefault())}),this.header_=ft.create("LI",{className:"ol-header",parent:this.panel_}),this.set("drawDelay",t.drawDelay||0),this.set("selection",t.selection),t.minibar&&setTimeout((function(){var r=ft.scrollDiv(this.panelContainer_,{mousewheel:!0,vertical:!0,minibar:!0});this.on(["drawlist","toggle"],function(){r.refresh()})}).bind(this))}displayInLayerSwitcher(t){return t.get("displayInLayerSwitcher")!==!1}setMap(t){if(super.setMap(t),this.drawPanel(),this._listener)for(var e in this._listener)qh(this._listener[e]);this._listener=null,t&&(this._listener={moveend:t.on("moveend",this.viewChange.bind(this)),size:t.on("change:size",this.overflow.bind(this))},this._layerGroup?this._listener.change=this._layerGroup.getLayers().on("change:length",this.drawPanel.bind(this)):this._listener.change=t.getLayerGroup().getLayers().on("change:length",this.drawPanel.bind(this)))}show(){this.element.classList.add("ol-forceopen"),this.overflow(),this.dispatchEvent({type:"toggle",collapsed:!1})}hide(){this.element.classList.remove("ol-forceopen"),this.overflow(),this.dispatchEvent({type:"toggle",collapsed:!0})}toggle(){this.element.classList.toggle("ol-forceopen"),this.overflow(),this.dispatchEvent({type:"toggle",collapsed:!this.isOpen()})}isOpen(){return this.element.classList.contains("ol-forceopen")}setHeader(t){ft.setHTML(this.header_,t)}overflow(t){if(this.button&&!this._noScroll){if(ft.hidden(this.panel_)){ft.setStyle(this.element,{height:"auto"});return}var e=ft.outerHeight(this.element),n=ft.outerHeight(this.panel_),r=this.button.offsetTop+ft.outerHeight(this.button),s=this.panel_.offsetTop-r;if(n>e-r){ft.setStyle(this.element,{height:"100%"});var a=this.panel_.querySelectorAll("li.ol-visible .li-content")[0],o=a?2*ft.getStyle(a,"height"):0;switch(t){case 1:s+=o;break;case-1:s-=o;break;case"+50%":s+=Math.round(e/2);break;case"-50%":s-=Math.round(e/2);break}return s+n<=e-3*r/2?(s=e-3*r/2-n,ft.hide(this.botv)):ft.show(this.botv),s>=0?(s=0,ft.hide(this.topv)):ft.show(this.topv),ft.setStyle(this.panel_,{top:s+"px"}),!0}else return ft.setStyle(this.element,{height:"auto"}),ft.setStyle(this.panel_,{top:0}),ft.hide(this.botv),ft.hide(this.topv),!1}else return!1}_setLayerForLI(t,e){var n=[];e.getLayers&&n.push(e.getLayers().on("change:length",this.drawPanel.bind(this))),t&&(n.push(e.on("change:opacity",(function(){this.setLayerOpacity(e,t)}).bind(this))),n.push(e.on("change:visible",(function(){this.setLayerVisibility(e,t)}).bind(this)))),n.push(e.on("propertychange",(function(r){(r.key==="displayInLayerSwitcher"||r.key==="openInLayerSwitcher"||r.key==="title"||r.key==="name")&&this.drawPanel(r)}).bind(this))),this._layers.push({li:t,layer:e,listeners:n})}setLayerOpacity(t,e){var n=e.querySelector(".layerswitcher-opacity-cursor");n&&(n.style.left=t.getOpacity()*100+"%"),this.dispatchEvent({type:"layer:opacity",layer:t})}setLayerVisibility(t,e){var n=e.querySelector(".ol-visibility");n&&(n.checked=t.getVisible()),t.getVisible()?e.classList.add("ol-visible"):e.classList.remove("ol-visible"),this.dispatchEvent({type:"layer:visible",layer:t})}_clearLayerForLI(){this._layers.forEach(function(t){t.listeners.forEach(function(e){qh(e)})}),this._layers=[]}_getLayerForLI(t){for(var e=0,n;n=this._layers[e];e++)if(n.li===t)return n.layer;return null}viewChange(){this.panel_.querySelectorAll("li").forEach((function(t){var e=this._getLayerForLI(t);e&&(this.testLayerVisibility(e)?t.classList.remove("ol-layer-hidden"):t.classList.add("ol-layer-hidden"))}).bind(this))}getPanel(){return this.panelContainer_}drawPanel(){if(this.getMap()){var t=this;this.dcount++,setTimeout(function(){t.drawPanel_()},this.get("drawDelay")||0)}}drawPanel_(){if(!(--this.dcount||this.dragging_)){var t=this.panelContainer_.scrollTop;this._clearLayerForLI(),this.panel_.querySelectorAll("li").forEach((function(e){e.classList.contains("ol-header")||e.remove()}).bind(this)),this._layerGroup?this.drawList(this.panel_,this._layerGroup.getLayers()):this.getMap()&&this.drawList(this.panel_,this.getMap().getLayers()),this.panelContainer_.scrollTop=t}}switchLayerVisibility(t,e){t.get("baseLayer")?(t.getVisible()||t.setVisible(!0),e.forEach(function(n){t!==n&&n.get("baseLayer")&&n.getVisible()&&n.setVisible(!1)})):t.setVisible(!t.getVisible())}testLayerVisibility(t){if(!this.getMap())return!0;var e=this.getMap().getView().getResolution(),n=this.getMap().getView().getZoom();if(t.getMaxResolution()<=e||t.getMinResolution()>=e)return!1;if(t.getMinZoom&&(t.getMinZoom()>=n||t.getMaxZoom()<n))return!1;var r=t.getExtent();if(r){var s=this.getMap().getView().calculateExtent(this.getMap().getSize());return ki(s,r)}return!0}dragOrdering_(t){t.stopPropagation(),t.preventDefault();var e=this,n=t.currentTarget.parentNode.parentNode,r=!0,s=this.panel_,a,o=t.pageY||t.touches&&t.touches.length&&t.touches[0].pageY||t.changedTouches&&t.changedTouches.length&&t.changedTouches[0].pageY,l,h,c,f;n.parentNode.classList.add("drag");function g(){if(l){var m=c,y=e.getSelection()===m;if(m&&l){var b;f?b=f.getLayers():b=e._layerGroup?e._layerGroup.getLayers():e.getMap().getLayers();for(var x=b.getArray(),E=0;E<x.length;E++)if(x[E]==m){b.removeAt(E);break}for(var S=0;S<x.length;S++)if(x[S]===l){E>S?b.insertAt(S,m):b.insertAt(S+1,m);break}}y&&e.selectLayer(m),e.dispatchEvent({type:"reorder-end",layer:m,group:f})}n.parentNode.querySelectorAll("li").forEach(function(M){M.classList.remove("dropover"),M.classList.remove("dropover-after"),M.classList.remove("dropover-before")}),n.classList.remove("drag"),n.parentNode.classList.remove("drag"),e.element.classList.remove("drag"),h&&h.remove(),ft.removeListener(document,"mousemove touchmove",d),ft.removeListener(document,"mouseup touchend touchcancel",g)}function d(m){if(a=m.pageY||m.touches&&m.touches.length&&m.touches[0].pageY||m.changedTouches&&m.changedTouches.length&&m.changedTouches[0].pageY,r&&Math.abs(o-a)>2&&(r=!1,n.classList.add("drag"),c=e._getLayerForLI(n),l=!1,f=e._getLayerForLI(n.parentNode.parentNode),h=ft.create("LI",{className:"ol-dragover",html:n.innerHTML,style:{position:"absolute","z-index":1e4,left:n.offsetLeft,opacity:.5,width:ft.outerWidth(n),height:ft.getStyle(n,"height")},parent:s}),e.element.classList.add("drag"),e.dispatchEvent({type:"reorder-start",layer:c,group:f})),!r){m.preventDefault(),m.stopPropagation(),ft.setStyle(h,{top:a-ft.offsetRect(s).top+s.scrollTop+5});var y;if(!m.touches)y=m.target,m.target.shadowRoot&&(y=m.composedPath()[0]);else for(y=document.elementFromPoint(m.touches[0].clientX,m.touches[0].clientY);y.shadowRoot;)y=y.shadowRoot.elementFromPoint(m.touches[0].clientX,m.touches[0].clientY);for(y.classList.contains("ol-switcherbottomdiv")?e.overflow(-1):y.classList.contains("ol-switchertopdiv")&&e.overflow(1);y&&y.tagName!=="LI";)y=y.parentNode;(!y||!y.classList.contains("dropover"))&&n.parentNode.querySelectorAll("li").forEach(function(b){b.classList.remove("dropover"),b.classList.remove("dropover-after"),b.classList.remove("dropover-before")}),y&&y.parentNode.classList.contains("drag")&&y!==n?(l=e._getLayerForLI(y),l&&!l.get("allwaysOnTop")==!c.get("allwaysOnTop")?(y.classList.add("dropover"),y.classList.add(n.offsetTop<y.offsetTop?"dropover-after":"dropover-before")):l=!1,ft.show(h)):(l=!1,y===n?ft.hide(h):ft.show(h)),l?h.classList.remove("forbidden"):h.classList.add("forbidden")}}ft.addListener(document,"mousemove touchmove",d),ft.addListener(document,"mouseup touchend touchcancel",g)}dragOpacity_(t){t.stopPropagation(),t.preventDefault();var e=this,n=t.target,r=this._getLayerForLI(n.parentNode.parentNode.parentNode);if(!r)return;var s=t.pageX||t.touches&&t.touches.length&&t.touches[0].pageX||t.changedTouches&&t.changedTouches.length&&t.changedTouches[0].pageX,a=ft.getStyle(n,"left")-s;e.dragging_=!0;function o(){ft.removeListener(document,"mouseup touchend touchcancel",o),ft.removeListener(document,"mousemove touchmove",l),e.dragging_=!1}function l(h){var c=h.pageX||h.touches&&h.touches.length&&h.touches[0].pageX||h.changedTouches&&h.changedTouches.length&&h.changedTouches[0].pageX,f=(a+c)/ft.getStyle(n.parentNode,"width"),g=Math.max(0,Math.min(1,f));ft.setStyle(n,{left:g*100+"%"}),n.parentNode.nextElementSibling.innerHTML=Math.round(g*100),r.setOpacity(g)}ft.addListener(document,"mouseup touchend touchcancel",o),ft.addListener(document,"mousemove touchmove",l)}drawList(t,e){var n=this,r=e.getArray(),s=function(f){f.stopPropagation(),f.preventDefault();var g=n._getLayerForLI(this.parentNode.parentNode);n.switchLayerVisibility(g,e),n.get("selection")&&g.getVisible()&&n.selectLayer(g),n.onchangeCheck&&n.onchangeCheck(g)};function a(f){f.stopPropagation(),f.preventDefault();var g=n._getLayerForLI(this.parentNode.parentNode);n.oninfo(g),n.dispatchEvent({type:"info",layer:g})}function o(f){f.stopPropagation(),f.preventDefault();var g=n._getLayerForLI(this.parentNode.parentNode);n.onextent?n.onextent(g):n.getMap().getView().fit(g.getExtent(),n.getMap().getSize()),n.dispatchEvent({type:"extent",layer:g})}function l(f){f.stopPropagation(),f.preventDefault();var g=this.parentNode.parentNode.parentNode.parentNode,d,m=n._getLayerForLI(g);m?(d=n._getLayerForLI(this.parentNode.parentNode),m.getLayers().remove(d),m.getLayers().getLength()==0&&!m.get("noSwitcherDelete")&&l.call(g.querySelectorAll(".layerTrash")[0],f)):(g=this.parentNode.parentNode,n.getMap().removeLayer(n._getLayerForLI(g)))}function h(f){if(!this.displayInLayerSwitcher(f)){this._setLayerForLI(null,f);return}var g=ft.create("LI",{className:(f.getVisible()?"ol-visible ":" ")+(f.get("baseLayer")?"baselayer":""),parent:t});this._setLayerForLI(g,f),this._selectedLayer===f&&g.classList.add("ol-layer-select");var d=ft.create("DIV",{className:"ol-layerswitcher-buttons",parent:g}),m=ft.create("DIV",{className:"li-content",parent:g});ft.create("INPUT",{type:f.get("baseLayer")?"radio":"checkbox",className:"ol-visibility",checked:f.getVisible(),click:s,parent:m});var y=ft.create("LABEL",{title:f.get("title")||f.get("name"),click:s,style:{userSelect:"none"},parent:m});if(y.addEventListener("selectstart",function(){return!1}),ft.create("SPAN",{html:f.get("title")||f.get("name"),click:(function(D){this.get("selection")&&(D.stopPropagation(),this.selectLayer(f))}).bind(this),parent:y}),this.reordering&&(c<r.length-1&&(f.get("allwaysOnTop")||!r[c+1].get("allwaysOnTop"))||c>0&&(!f.get("allwaysOnTop")||r[c-1].get("allwaysOnTop")))&&ft.create("DIV",{className:"layerup ol-noscroll",title:this.tip.up,on:{"mousedown touchstart":function(D){n.dragOrdering_(D)}},parent:d}),f.getLayers){var b=0;f.getLayers().forEach(function(D){n.displayInLayerSwitcher(D)&&b++}),b&&ft.create("DIV",{className:f.get("openInLayerSwitcher")?"collapse-layers":"expend-layers",title:this.tip.plus,click:function(){var D=n._getLayerForLI(this.parentNode.parentNode);D.set("openInLayerSwitcher",!D.get("openInLayerSwitcher"))},parent:d})}if(this.oninfo&&ft.create("DIV",{className:"layerInfo",title:this.tip.info,click:a,parent:d}),this.hastrash&&!f.get("noSwitcherDelete")&&ft.create("DIV",{className:"layerTrash",title:this.tip.trash,click:l,parent:d}),this.hasextent&&r[c].getExtent()){var x=r[c].getExtent();x.length==4&&x[0]<x[2]&&x[1]<x[3]&&ft.create("DIV",{className:"layerExtent",title:this.tip.extent,click:o,parent:d})}if(this.show_progress&&f instanceof Ue){var E=ft.create("DIV",{className:"layerswitcher-progress",parent:m});this.setprogress_(f),f.layerswitcher_progress=ft.create("DIV",{parent:E})}var S=ft.create("DIV",{className:"layerswitcher-opacity",click:function(D){if(D.target===this){D.stopPropagation(),D.preventDefault();var W=Math.max(0,Math.min(1,D.offsetX/ft.getStyle(this,"width")));n._getLayerForLI(this.parentNode.parentNode).setOpacity(W),this.parentNode.querySelectorAll(".layerswitcher-opacity-label")[0].innerHTML=Math.round(W*100)}},parent:m});if(ft.create("DIV",{className:"layerswitcher-opacity-cursor ol-noscroll",style:{left:f.getOpacity()*100+"%"},on:{"mousedown touchstart":function(D){n.dragOpacity_(D)}},parent:S}),ft.create("DIV",{className:"layerswitcher-opacity-label",html:Math.round(f.getOpacity()*100),parent:m}),f.getLayers&&(g.classList.add("ol-layer-group"),f.get("openInLayerSwitcher")===!0)){var M=ft.create("UL",{parent:g});this.drawList(M,f.getLayers())}g.classList.add(this.getLayerClass(f)),this.dispatchEvent({type:"drawlist",layer:f,li:g})}for(var c=r.length-1;c>=0;c--)h.call(this,r[c]);this.viewChange(),t===this.panel_&&this.overflow()}getLayerClass(t){return t?t.getLayers?"ol-layer-group":t instanceof li?"ol-layer-vector":t instanceof aL?"ol-layer-vectortile":t instanceof Ue?"ol-layer-tile":t instanceof lS?"ol-layer-image":t instanceof iL?"ol-layer-heatmap":t.getFeatures?"ol-layer-vectorimage":"unknown":"none"}selectLayer(t,e){if(!t){if(!this.getMap())return;t=this.getMap().getLayers().item(this.getMap().getLayers().getLength()-1)}this._selectedLayer=t,this.drawPanel(),e||this.dispatchEvent({type:"select",layer:t})}getSelection(){return this._selectedLayer}setprogress_(t){if(!t.layerswitcher_progress){var e=0,n=0,r=function(){n===e?(n=e=0,ft.setStyle(t.layerswitcher_progress,{width:0})):ft.setStyle(t.layerswitcher_progress,{width:(e/n*100).toFixed(1)+"%"})};t.getSource().on("tileloadstart",function(){n++,r()}),t.getSource().on("tileloadend",function(){e++,r()}),t.getSource().on("tileloaderror",function(){e++,r()})}}};gy.prototype.tip={up:"up/down",down:"down",info:"informations...",extent:"zoom to extent",trash:"remove layer",plus:"expand/shrink"};const ZT=new Fe({image:new Bn({src:"./data/sle.svg",scale:.9})}),KT=new Fe({image:new Bn({src:"./data/weh.svg",scale:.9})}),$T=new Fe({image:new Bn({src:"./data/bru_nlwkn.svg",scale:.9})}),JT=new Fe({image:new Bn({src:"./data/bru_andere.svg",scale:.9})}),QT=new Fe({image:new Bn({src:"./data/due.svg",scale:.9})}),t6=new Fe({image:new Bn({src:"./data/que.svg",scale:.9})}),py=new Fe({stroke:new si({color:"rgba(173, 114, 3, 1)",width:3})}),e6=new Fe({stroke:new si({color:"rgba(173, 114, 3, 1)",width:3})});function i6(i){const t=i.get("Massn_ID");let e;switch(t){case 3:case 4:case 5:e="blue";break;case 6:case 7:case 8:case 9:case 10:e="black";break;case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 26:case 27:e="green";break;case 22:case 23:e="rgba(255, 190, 190, 0.5)";break;case 24:case 50:case 2:e="rgba(230, 152, 0, 0.5)";break;case 200:case 201:e="rgba(205, 205, 205, 1)";break;case 300:e="rgba(230, 230, 0, 0.5)";break;case 400:e="rgba(130, 130, 130, 1)";break;default:e="grey"}return new Fe({stroke:new si({color:e,width:5})})}function n6(i){const t=i.get("Kat"),e=i.get("IDUabschn");let n,r=[10,15];return t==="E"?n="green":n="red",[new Fe({stroke:new si({color:n,width:5,lineDash:r}),fill:new bi({color:n})}),new Fe({geometry:function(s){const a=s.getGeometry().getCoordinates();return new Qf([a[0],a[a.length-1]])},image:new Ta({radius:5,fill:new bi({color:"black"})})}),new Fe({text:new Xf({text:e,font:"bold 14px Arial",fill:new bi({color:"#000"}),stroke:new si({color:"#fff",width:3}),overflow:!0,placement:"point",rotation:0})})]}function r6(i){const t=i.get("bauart");let e,n,r;return t==="Anlegehilfe"?(e="blue",n=5):/sohlgl|umgehungs|fisch/i.test(t)?(e="red",n=5,r=[10,15]):/fuß|rad/i.test(t)?(e="olive",n=5,r=[20,10]):/bio/i.test(t)?(e="green",n=5,r=[17.5,10]):/strasse|Straße/i.test(t)?(e="Black",n=5,r=[12.5,10]):(e="blue",n=5,r=void 0),new Fe({fill:new bi({color:e}),stroke:new si({color:e,width:n,lineDash:r})})}function s6(i){const t=i.get("Ein_ord");let e;switch(t){case"1. Ordnung":e="./data/einErsterOrdnung.svg";break;case"2. Ordnung":e="./data/einZweiterOrdnung.svg";break;case"3. Ordnung":e="./data/einDritterOrdnung.svg";break;case"Einleitung":e="./data/einEinleitung.svg";break;case"Sonstige":e="./data/einSonstige.svg";break;default:e="./data/einSonstige.svg"}return new Fe({image:new Bn({src:e,scale:.9})})}function a6(i){const t=i.get("bauart");let e;return/boots/i.test(t)?e="./data/bwSonPun_Anleger.svg":/betriebs/i.test(t)?e="./data/sonPunBetrieb.svg":t==="Infotafel"?e="./data/sonPunInfo.svg":t==="Auskolkung"?e="./data/sonPunKolk.svg":t==="Furt"?e="./data/bwSonPun_Furt.svg":t==="Tor"?e="./data/bwSonPun_Tor.svg":t==="Überfahrt"?e="./data/bwSonPun_Ueberfahrt.svg":t==="Betriebspegel"?e="./data/bwSonPun_Betriebspegel.svg":e="./data/sonPunSonstige.svg",new Fe({image:new Bn({src:e,scale:.9})})}function o6(i){const t=i.get("Art");let e,n;switch(t){case"p":e="rgba(200, 200, 200, .6)",n="black";break;case"o":e="rgba(255, 220, 220, .6)",n="black";break;case"l":e="rgba(255, 190, 150, .6)",n="black";break;default:e="rgba(255, 255, 255, 1)",n="grey"}return new Fe({fill:new bi({color:e}),stroke:new si({color:n,width:.5})})}const l6=new Fe({stroke:new si({color:"grey",width:.5})}),h6=function(i,t,e){var n=0,r=5,s=t/1e3,a=s.toFixed(2);return e>n&&e<r?new Fe({text:new Xf({text:a.toString(),font:'normal 18px "Arial Light", "Helvetica Neue Light", Arial, sans-serif',offsetX:-20,offsetY:10}),stroke:new si({color:"black",width:1})}):null},c6=function(i,t,e){var n=0,r=14,s=t/1e3,a=s.toFixed(2);return e>n&&e<r?new Fe({text:new Xf({text:a.toString(),font:'bold 20px "Arial Light", "Helvetica Neue Light", Arial, sans-serif',offsetX:-35,offsetY:10,fill:new bi({color:"rgba(0, 0, 0, 1)"})}),stroke:new si({color:"black",width:2})}):null};new Fe({stroke:new si({color:"black",width:4})});new Fe({geometry:function(i){const t=i.getGeometry().getCoordinates();return new Ir(t[t.length-1])},image:new Ta({radius:6,fill:new bi({color:"red"}),stroke:new si({color:"black",width:2})})});new Fe({fill:new bi({color:"rgba(0, 0, 255, 0.2)",opacity:.5}),image:new Bn({src:"./data/location-heading.svg",imgSize:[27,55],rotateWithView:!0})});jn.defs("EPSG:32632","+proj=utm +zone=32 +datum=WGS84 +units=m +no_defs");yL(jn);var Pf=!1;const R0=new I_({collapsible:!1,html:'<a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>'}),u6=new or({center:H2([7.35,52.7]),zoom:9}),Vt=new Tw({target:"map",view:u6,controls:R_().extend([new oL,new dL({extent:[727361,6839277,858148,6990951]}),R0]),interactions:D_().extend([new pL])});function my(){const i=Vt.getSize()[0]<600;R0.setCollapsible(i),R0.setCollapsed(i)}Vt.on("change:size",my);my();const Gu=new mi;let Yo=null,S2=!0,zu=null;document.createElement("div");const f6=new li({source:new mi({format:new pi,url:function(i){return"./myLayers/exp_gew_info_fla.geojson?bbox="+i.join(",")},strategy:Gi}),title:"Gewässerflächen",name:"exp_gew_fla",style:py,visible:!1}),d6=new li({source:new mi({format:new pi,url:function(i){return"./myLayers/exp_bw_biotope_noh.geojson?bbox="+i.join(",")},strategy:Gi}),title:"Biotope_Noh",name:"exp_bw_biotope_noh",style:py,visible:!1}),g6=new li({source:new mi({format:new pi,url:function(i){return"./myLayers/gehoelz_vec.geojson?bbox="+i.join(",")},strategy:Gi}),title:"Gehölz(Plan)",name:"gehoelz_vec",style:e6,visible:!1}),_y=new li({source:new mi({format:new pi,url:function(i){return"./myLayers/exp_allgm_fsk.geojson?bbox="+i.join(",")},strategy:Gi}),title:"fsk",name:"fsk",style:o6,visible:!1,minResolution:0,maxResolution:4}),p6=new li({source:new mi({format:new pi,url:function(i){return"./myLayers/exp_bw_son_lin.geojson?bbox="+i.join(",")},strategy:Gi}),title:"Sonstig, Linien",name:"son_lin",style:r6,visible:!1}),m6=new li({source:new mi({format:new pi,url:function(i){return"./myLayers/exp_gew_umn.geojson?bbox="+i.join(",")},strategy:Gi}),title:"U-Maßnahmen",name:"gew_umn",style:i6,visible:!1}),_6=new li({source:new mi({format:new pi,url:function(i){return"./myLayers/exp_gew_info.geojson?bbox="+i.join(",")},strategy:Gi}),title:"Gew, Info",name:"gew_info",style:n6,visible:!1}),v6=new li({source:new mi({format:new pi,url:function(i){return"./myLayers/gew.geojson?bbox="+i.join(",")},strategy:Gi}),title:"gew",name:"gew",style:new Fe({fill:new bi({color:"rgba(0,28, 240, 0.4)"}),stroke:new si({color:"blue",width:2})})}),y6=new li({source:new mi({format:new pi,url:function(i){return"./myLayers/exp_bw_son_pun.geojson?bbox="+i.join(",")},strategy:Gi}),title:"Sonstige, Punkte",name:"son_pun",style:a6,visible:!1}),x6=new li({source:new mi({format:new pi,strategy:Gi,loader:function(i,t,e){const n=`./myLayers/exp_bw_alle.geojson?bbox=${i.join(",")}`;fetch(n).then(r=>r.json()).then(r=>{const o=new pi().readFeatures(r,{featureProjection:e}).filter(l=>l.get("Art")==="EIN");this.addFeatures(o)})}}),title:"Einläufe",name:"ein",style:s6,visible:!1}),b6=new li({source:new mi({format:new pi,strategy:Gi,loader:function(i,t,e){const n=`./myLayers/exp_bw_alle.geojson?bbox=${i.join(",")}`;fetch(n).then(r=>r.json()).then(r=>{const o=new pi().readFeatures(r,{featureProjection:e}).filter(l=>l.get("Art")==="QUE");this.addFeatures(o)})}}),title:"Querung",name:"que",style:t6,visible:!1}),w6=new li({source:new mi({format:new pi,strategy:Gi,loader:function(i,t,e){const n=`./myLayers/exp_bw_alle.geojson?bbox=${i.join(",")}`;fetch(n).then(r=>r.json()).then(r=>{const o=new pi().readFeatures(r,{featureProjection:e}).filter(l=>l.get("Art")==="DUE");this.addFeatures(o)})}}),title:"Düker",name:"due",style:QT,visible:!1}),E6=new li({source:new mi({format:new pi,url:function(i){return"./myLayers/exp_bw_weh.geojson?bbox="+i.join(",")},strategy:Gi}),title:"Wehr",name:"weh",style:KT,visible:!1}),S6=new li({source:new mi({format:new pi,url:function(i){return"./myLayers/exp_bw_bru_nlwkn.geojson?bbox="+i.join(",")},strategy:Gi}),title:"Brücke (NLWKN)",name:"bru_nlwkn",style:$T,visible:!1}),L6=new li({source:new mi({format:new pi,url:function(i){return"./myLayers/exp_bw_bru_andere.geojson?bbox="+i.join(",")},strategy:Gi}),title:"Brücke (andere)",name:"bru_andere",style:JT,visible:!1}),C6=new li({source:new mi({format:new pi,url:function(i){return"./myLayers/exp_bw_sle.geojson?bbox="+i.join(",")},strategy:Gi}),title:"Schleuse",name:"sle",style:ZT,visible:!0,trash:!1}),A6=new li({source:new mi({format:new pi,url:function(i){return"./myLayers/km_10_scal.geojson?bbox="+i.join(",")},strategy:Gi}),title:"km10scal",style:l6,visible:!0,minResolution:0,maxResolution:1}),M6=new li({source:new mi({format:new pi,url:function(i){return"./myLayers/km_100_scal.geojson?bbox="+i.join(",")},strategy:Gi}),title:"km100scal",style:function(i,t){return h6(i,i.get("km"),t)},visible:!0,minResolution:0,maxResolution:3}),T6=new li({source:new mi({format:new pi,url:function(i){return"./myLayers/km_500_scal.geojson?bbox="+i.join(",")},strategy:Gi}),title:"km500scal",style:function(i,t){return c6(i,i.get("km"),t)},visible:!0}),P6=new Ue({title:"NSG",name:"NSG",source:new ci({url:"https://www.umweltkarten-niedersachsen.de/arcgis/services/Natur_wms/MapServer/WMSServer",params:{LAYERS:"Naturschutzgebiet",FORMAT:"image/png",TRANSPARENT:!0,TILED:!0}}),visible:!1,opacity:.5}),I6=new Ue({title:"LSG",name:"LSG",source:new ci({url:"https://www.umweltkarten-niedersachsen.de/arcgis/services/Natur_wms/MapServer/WMSServer",params:{LAYERS:"Landschaftsschutzgebiet",FORMAT:"image/png",TRANSPARENT:!0,TILED:!0}}),visible:!1,opacity:.5}),R6=new Ue({title:"ÜSG",name:"ÜSG",source:new ci({url:"https://www.umweltkarten-niedersachsen.de/arcgis/services/HWSchutz_wms/MapServer/WMSServer",params:{LAYERS:"Überschwemmungsgebiete_Verordnungsfläechen_Niedersachsen11182",FORMAT:"image/png",TRANSPARENT:!0,TILED:!0}}),visible:!1,opacity:.5}),N6=new Ue({title:"Fließgew.",name:"Fließgew.",source:new ci({url:"https://www.umweltkarten-niedersachsen.de/arcgis/services/WRRL_wms/MapServer/WMSServer",params:{LAYERS:"Natuerliche_erheblich_veraenderte_und_kuenstliche_Fliessgewaesser",FORMAT:"image/png",TRANSPARENT:!0,TILED:!0}}),visible:!0,opacity:1}),F6=new Ue({title:"GewWms",name:"GewWms",source:new ci({url:"https://www.umweltkarten-niedersachsen.de/arcgis/services/Hydro_wms/MapServer/WMSServer",params:{LAYERS:"Gewässernetz",FORMAT:"image/png",TRANSPARENT:!0,TILED:!0}}),visible:!1,opacity:1}),O6=new Ue({source:new ci({url:"https://opendata.lgln.niedersachsen.de/doorman/noauth/dop_wms",attributions:"Orthophotos Niedersachsen, LGLN",params:{LAYERS:"ni_dop20",TILED:"true",VERSION:"1.3.0"}}),title:"2023_NI",opacity:1,visible:!1}),k6=new Ue({source:new ci({url:"https://opendata.lgln.niedersachsen.de/doorman/noauth/doph_wms?",attributions:" ",params:{LAYERS:"ni_dop20h_rgb_2020",TILED:"true",VERSION:"1.3.0"}}),title:"2020_NI",opacity:1,visible:!1}),D6=new Ue({source:new ci({url:"https://opendata.lgln.niedersachsen.de/doorman/noauth/doph_wms?",attributions:" ",params:{LAYERS:"ni_dop20h_rgb_2017",TILED:"true",VERSION:"1.3.0"}}),title:"2017_NI",opacity:1,visible:!1}),j6=new Ue({source:new ci({url:"https://opendata.lgln.niedersachsen.de/doorman/noauth/doph_wms?",attributions:" ",params:{LAYERS:"ni_dop20h_rgb_2014",TILED:"true",VERSION:"1.3.0"}}),title:"2014_NI",opacity:1,visible:!1}),B6=new Ue({source:new ci({url:"https://geo.grafschaft.de/arcgis/services/Migratrion_Okt_2020/BAS_Luftbilder_2/MapServer/WMSServer",attributions:" ",params:{LAYERS:"9",TILED:"true",VERSION:"1.3.0"}}),title:"2012_NOH",opacity:1,visible:!1}),G6=new Ue({source:new ci({url:"https://opendata.lgln.niedersachsen.de/doorman/noauth/doph_wms?",attributions:" ",params:{LAYERS:"ni_dop20h_rgb_2011",TILED:"true",VERSION:"1.3.0"}}),title:"2011_NI",opacity:1,visible:!1}),z6=new Ue({source:new ci({url:"https://geo.grafschaft.de/arcgis/services/Migratrion_Okt_2020/BAS_Luftbilder_2/MapServer/WMSServer",attributions:" ",params:{LAYERS:"8",TILED:"true",VERSION:"1.3.0"}}),title:"2010_NOH",opacity:1,visible:!1}),q6=new Ue({source:new ci({url:"https://geo.grafschaft.de/arcgis/services/Migratrion_Okt_2020/BAS_Luftbilder_2/MapServer/WMSServer",attributions:" ",params:{LAYERS:"7",TILED:"true",VERSION:"1.3.0"}}),title:"2009_NOH",opacity:1,visible:!1}),U6=new Ue({source:new ci({url:"https://geo.grafschaft.de/arcgis/services/Migratrion_Okt_2020/BAS_Luftbilder_2/MapServer/WMSServer",attributions:" ",params:{LAYERS:"6",TILED:"true",VERSION:"1.3.0"}}),title:"2002_NOH",opacity:1,visible:!1}),W6=new Ue({source:new ci({url:"https://geo.grafschaft.de/arcgis/services/Migratrion_Okt_2020/BAS_Luftbilder_2/MapServer/WMSServer",attributions:" ",params:{LAYERS:"5",TILED:"true",VERSION:"1.3.0"}}),title:"1990_NOH",opacity:1,visible:!1}),V6=new Ue({source:new ci({url:"https://geo.grafschaft.de/arcgis/services/Migratrion_Okt_2020/BAS_Luftbilder_2/MapServer/WMSServer",attributions:" ",params:{LAYERS:"4",TILED:"true",VERSION:"1.3.0"}}),title:"1980_NOH",opacity:1,visible:!1}),H6=new Ue({source:new ci({url:"https://geo.grafschaft.de/arcgis/services/Migratrion_Okt_2020/BAS_Luftbilder_2/MapServer/WMSServer",attributions:" ",params:{LAYERS:"3",TILED:"true",VERSION:"1.3.0"}}),title:"1970_NOH",opacity:1,visible:!1}),X6=new Ue({source:new ci({url:"https://geo.grafschaft.de/arcgis/services/Migratrion_Okt_2020/BAS_Luftbilder_2/MapServer/WMSServer",attributions:" ",params:{LAYERS:"2",TILED:"true",VERSION:"1.3.0"}}),title:"1957_NOH",opacity:1,visible:!1}),Y6=new Ue({source:new ci({url:"https://geo.grafschaft.de/arcgis/services/Migratrion_Okt_2020/BAS_Luftbilder_2/MapServer/WMSServer",attributions:" ",params:{LAYERS:"1",TILED:"true",VERSION:"1.3.0"}}),title:"1937_NOH",opacity:1,visible:!1});var Z6=new Ue({title:"Base-DE",opacity:1,visible:!1,type:"base",source:new ci({url:"https://sgx.geodatenzentrum.de/wms_basemapde",attributions:"© GeoBasis-DE / BKG (Jahr des letzten Datenbezugs) CC BY 4.0",params:{LAYERS:"de_basemapde_web_raster_farbe",TILED:!0,VERSION:"1.3.0"}})}),K6=new Ue({title:"DOP20 NI",opacity:1,visible:!1,type:"base",source:new ci({url:"https://opendata.lgln.niedersachsen.de/doorman/noauth/dop_wms",attributions:"Orthophotos Niedersachsen, LGLN",params:{LAYERS:"ni_dop20",TILED:!0,VERSION:"1.3.0"}})});const $6=new Ue({title:"GoogleSat",type:"base",baseLayer:!1,visible:!1,source:new rd({url:"http://mt1.google.com/vt/lyrs=s&hl=pl&&x={x}&y={y}&z={z}"})}),J6=new Ue({title:"GoogleHybrid",type:"base",baseLayer:!1,visible:!1,source:new rd({url:"https://mt1.google.com/vt/lyrs=y&x={x}&y={y}&z={z}"})}),Q6=new Ue({title:"ESRI-Sat",type:"base",opacity:1,visible:!1,source:new I1({attributions:"Powered by Esri",url:"https://services.arcgisonline.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"})}),tP=new Ue({title:"ESRI-Grey",type:"base",opacity:1,visible:!1,source:new I1({attributions:"Powered by Esri",url:"http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}"})}),eP=new Ue({title:"osm-grey",className:"bw",type:"base",visible:!1,source:new Mv({url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png"})}),iP=new Ue({title:"osm-color",name:"osm-color",type:"base",source:new Mv({url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),visible:!0,opacity:.75}),nP=new gy({activationMode:"click",reverse:!0,trash:!0,tipLabel:"Legende"});Vt.addControl(nP);const Y1=new mi,vy=new li({displayInLayerSwitcher:!1,source:Y1,style:{"fill-color":"rgba(136, 136, 136, 0.526)","stroke-color":"blue","stroke-width":2,"circle-radius":7,"circle-fill-color":"#ffcc33"}});let Dg,Hr,Rl;const yy=function(i){if(i.pointerType==="touch"){if(i.dragging)return}else if(i.dragging)return};Vt.on("pointermove",yy);let Xa;const rP=function(i){const t=z2(i);let e;return t>1e3?e=Math.round(t/1e3*100)/100+" km":e=Math.round(t*100)/100+" m",e},sP=function(i){const t=q2(i);let e;return t>=1e4?e=(t/1e6).toFixed(3)+" km<sup>2</sup>":e=t.toFixed(3)+" m<sup>2</sup>",e},aP=new Fe({fill:new bi({color:"rgba(255, 255, 255, 0.2)"}),stroke:new si({color:"blue",width:2}),image:new Ta({radius:5,stroke:new si({color:"rgba(0, 0, 0, 0.7)"}),fill:new bi({color:"rgba(255, 255, 255, 0.2)"})})});function L2(i){Xa=new N3({source:Y1,type:i,style:function(e){const n=e.getGeometry().getType();if(n===i||n==="Point")return aP}}),Vt.addInteraction(Xa),C2();let t;Xa.on("drawstart",function(e){Dg=e.feature;let n=e.coordinate;t=Dg.getGeometry().on("change",function(r){const s=r.target;let a;s instanceof cr?(a=sP(s),n=s.getInteriorPoint().getCoordinates()):s instanceof pa&&(a=rP(s),n=s.getLastCoordinate()),Hr.innerHTML=a,Rl.setPosition(n)})}),Xa.on("drawend",function(){Hr.className="ol-tooltip ol-tooltip-static",Rl.setOffset([0,-7]),Dg=null,Hr=null,C2(),qh(t)})}function C2(){Hr&&Hr.parentNode.removeChild(Hr),Hr=document.createElement("div"),Hr.className="ol-tooltip ol-tooltip-measure",Rl=new w1({element:Hr,offset:[0,-15],positioning:"bottom-center",stopEvent:!1,insertFirst:!1}),Vt.addOverlay(Rl)}Vt.getViewport().addEventListener("contextmenu",function(i){if(i.preventDefault(),Xa){Y1.clear(),Xa.finishDrawing(),Vt.removeInteraction(Xa),Vt.un("pointermove",yy),Rl=null,Hr=null,Vt.removeOverlay(Rl);return}});class oP extends ur{constructor(t){const e=document.createElement("div");e.className="custom-controls1 ol-unselectable ol-control";const n=document.createElement("button");n.innerHTML="L",n.className="ol-button",n.addEventListener("click",function(){L2("LineString")});const r=document.createElement("button");r.innerHTML="F",r.className="ol-button",r.addEventListener("click",function(){L2("Polygon")}),e.appendChild(n),e.appendChild(r),super({element:e,target:t.target})}}Vt.addControl(new oP({target:"custom-controls"}));const lP=new Cn({title:"Bauw.(P)",name:"BauwP",fold:!0,fold:"close",layers:[y6,x6,b6,w6,L6,S6,E6,C6]}),hP=new Cn({title:"Bauw.(L)",name:"BauwL",fold:!0,fold:"close",layers:[g6,d6,f6,m6,p6,_6]}),cP=new Cn({title:"WMS-Lay",name:"WMS-Lay",fold:!0,fold:"close",visible:!1,layers:[I6,P6,R6,N6,F6]}),uP=new Cn({title:"Luftbilder",fold:!0,fold:"close",layers:[Y6,X6,H6,V6,W6,U6,q6,z6,G6,B6,j6,D6,k6,O6]}),fP=new Cn({title:"Station",fold:!0,fold:"close",layers:[A6,M6,T6]}),dP=new Cn({title:"Base",name:"Base",fold:!0,fold:"close",layers:[Q6,tP,J6,$6,K6,Z6,eP,iP]});Vt.addLayer(dP);Vt.addLayer(uP);Vt.addLayer(_y);Vt.addLayer(v6);Vt.addLayer(cP);Vt.addLayer(fP);Vt.addLayer(hP);Vt.addLayer(lP);Vt.addLayer(vy);var hc=new Tf({html:'<i class="icon fa-fw fa fa-arrow-circle-down" aria-hidden="true"></i>',className:"select",title:"Select Info",active:!0,interaction:jg,onToggle:function(i){alert("Jetzt ist BW-Abfrage "+(i?"activated":"deactivated")),jg.setActive(i),i||jg.getFeatures().clear(),i?Vt.addOverlay(gn):Vt.removeOverlay(gn),hc.element.classList.toggle("active",i),hc.element.querySelector(".icon").classList.toggle("active",i),i?Vt.un("singleclick",A2):Vt.on("singleclick",A2)}});hc.element.classList.add("active");hc.element.querySelector(".icon").classList.add("active");Vt.addControl(hc);var jg=new Dv({layers:[vy],hitTolerance:5}),Ih=new Dv({hitTolerance:5,multi:!0,condition:O_});Ih.on("select",function(i){i.selected.forEach(function(t){Ih.getLayer(t).get("name")!=="gew"?Ih.getLayer(t):Ih.getFeatures().clear()})});Vt.addInteraction(Ih);function xy(i){const t=[];return i.getLayers().forEach(e=>{e instanceof Cn?t.push(...xy(e)):t.push(e)}),t}function A2(i){const t=[];Vt.getLayers().forEach(r=>{const s=r.get("name");r.getVisible()&&(r instanceof Cn?s!=="GN-DOPs"&&s!=="Base"&&s!=="Station"&&s!=="BauwP"&&s!=="BauwL"&&s!==void 0&&t.push(...xy(r)):s!=="fsk"&&t.push(r))});const e=Vt.getView().getResolution(),n=Vt.getView().getProjection();t.forEach(r=>{if(r.getVisible()){const s=r.getSource();if(s instanceof ci&&typeof s.getFeatureInfoUrl=="function"){const a=r.get("name"),o=s.getFeatureInfoUrl(i.coordinate,e,n,{INFO_FORMAT:"text/html"});o&&fetch(o).then(l=>l.text()).then(l=>{if(l.trim()!==""){var h=/<body[^>]*>\s*<\/body>/i.test(l);if(h===!1){var c=checkForLinkInTH(l);const f=gP(a,c);document.body.appendChild(f)}else console.log("nichts verwertbares gefunden")}}).catch(l=>{console.error("Fehler beim Abrufen der Daten:",l),alert("Es ist ein Fehler aufgetreten")})}}})}function gP(i,t){const e=document.createElement("p");e.id="info",e.classList.add("Info"),e.innerHTML=`${t}`;const n=document.createElement("p");return n.innerHTML="&times;",n.classList.add("close-icon"),n.addEventListener("click",function(){e.style.display="none"}),e.appendChild(n),e}var pP=document.getElementById("popup"),Wr=document.getElementById("popup-content"),N0=document.getElementById("popup-closer"),gn=new w1({element:pP,id:"1",autoPan:!0,autoPanAnimation:{duration:250}});Vt.addOverlay(gn);N0.onclick=function(){return gn.setPosition(void 0),N0.blur(),!1};var N0=document.getElementById("popup-closer");Vt.on("click",function(i){if(Pf===!1){var t=i.coordinate;Vt.forEachFeatureAtPixel(i.pixel,function(e,n){console.log(n);var r=n.get("name"),s=e.get("beschreib_lang"),a="";if(s&&s.trim()!==""&&(a="<br><u>Beschreib (lang): </u>"+s+"</p>"),r!=="gew"&&r!=="km10scal"&&r!=="km100scal"&&r!=="km500scal"&&r!=="fsk"&&r!=="sle"&&r!=="weh"&&r!=="son_lin"&&r!=="exp_gew_fla")if(e){t=e.getGeometry().getCoordinates(),gn.setPosition(t);var o=e.get("foto1"),l="",h=e.get("foto2"),c="",f=e.get("foto3"),g="",d=e.get("foto4"),m="";o&&o.trim()!==""?l='<a href="'+o+`" onclick="window.open('`+o+`', '_blank'); return false;">Foto 1</a>`:l=" Foto 1 ",h&&h.trim()!==""?c='<a href="'+h+`" onclick="window.open('`+h+`', '_blank'); return false;">Foto 2</a>`:c=" Foto 2 ",f&&f.trim()!==""?g='<a href="'+f+`" onclick="window.open('`+f+`', '_blank'); return false;">Foto 3</a>`:g=" Foto 3 ",d&&d.trim()!==""?m='<a href="'+d+`" onclick="window.open('`+d+`', '_blank'); return false;">Foto 4</a>`:m=" Foto 4 ";var y=e.get("rwert"),b=e.get("hwert");let S=M2(y,b,32,!0);Wr.innerHTML='<div style="max-height: 200px; overflow-y: auto;"><p style="font-weight: bold; text-decoration: underline;">'+e.get("name")+"</p><p>Id = "+e.get("bw_id")+" ("+(e.get("KTR")?e.get("KTR"):"k.A.")+`)</p><p><a href="https://www.google.com/maps?q=&layer=c&cbll=${S}&cbp=12,90,0,0,1" target="_blank" rel="noopener noreferrer">streetview</a></p><p>U-Pflicht = `+e.get("upflicht")+"</p><p>Bauj. = "+(e.get("baujahr")?e.get("baujahr"):"k.A.")+"</p><p>"+l+" "+c+" "+g+" "+m+"<br><u>Beschreibung (kurz): </u>"+e.get("beschreib")+"</p><p>"+a+"</p></div>"}else gn.setPosition(void 0);if(r==="gew_info"){var o=e.get("foto1"),l="",h=e.get("foto2"),c="",f=e.get("foto3"),g="",d=e.get("foto4"),m="",x=e.get("URL_WKDB"),E="";o&&o.trim()!==""?l='<a href="'+o+`" onclick="window.open('`+o+`', '_blank'); return false;">Foto 1</a>`:l=" Foto 1 ",h&&h.trim()!==""?c='<a href="'+h+`" onclick="window.open('`+h+`', '_blank'); return false;">Foto 2</a>`:c=" Foto 2 ",f&&f.trim()!==""?g='<a href="'+f+`" onclick="window.open('`+f+`', '_blank'); return false;">Foto 3</a>`:g=" Foto 3 ",d&&d.trim()!==""?m='<a href="'+d+`" onclick="window.open('`+d+`', '_blank'); return false;">Foto 4</a>`:m=" Foto 4 ",d&&d.trim()!==""?m='<a href="'+d+`" onclick="window.open('`+d+`', '_blank'); return false;">Foto 4</a>`:m=" Foto 4 ",x&&x.trim()!==""?E='<a href="'+x+`" onclick="window.open('`+x+`', '_blank'); return false;">WK-Datenblatt</a>`:E="WK-Datenblatt",t=i.coordinate,gn.setPosition(t),Wr.innerHTML='<div style="max-height: 300px; overflow-y: auto;"><p>Name: '+e.get("IDUabschn")+"<br>von "+e.get("Bez_Anfang")+" bis "+e.get("Bez_Ende")+"</p><p>"+l+" "+c+" "+g+" "+m+'<p><a href="'+e.get("U_Steckbrief")+`" onclick="window.open('`+e.get("U_Steckbrief")+`', '_blank'); return false;">NLWKN-SB</a> <p>`+E+'<p><a href="'+e.get("BSB")+`" onclick="window.open('`+e.get("BSB")+`', '_blank'); return false;">BSB  </a><a href="`+e.get("MNB")+`" onclick="window.open('`+e.get("MNB")+`', '_blank'); return false;"> MNB</a><br> Kat: `+e.get("Kat")+"</a>, KTR: "+e.get("KTR")+"</a><br><u>Beschreibung (kurz): </u>"+e.get("beschreib")+"</p></div>"}if(r==="gew_umn"&&(t=i.coordinate,gn.setPosition(t),Wr.innerHTML='<div style="max-height: 300px; overflow-y: auto;"><p>ID: '+e.get("Massn_ID")+"<br><p>Bez (Art): "+e.get("UMnArtBez")+"<br><p>Bez (Gruppe): "+e.get("UMNGrBez")+"<br></div>"),r==="son_lin"){t=i.coordinate,gn.setPosition(t);var o=e.get("foto1"),l="",h=e.get("foto2"),c="",f=e.get("foto3"),g="",d=e.get("foto4"),m="";o&&o.trim()!==""?l='<a href="'+o+`" onclick="window.open('`+o+`', '_blank'); return false;">Foto 1</a>`:l=" Foto 1 ",h&&h.trim()!==""?c='<a href="'+h+`" onclick="window.open('`+h+`', '_blank'); return false;">Foto 2</a>`:c=" Foto 2 ",f&&f.trim()!==""?g='<a href="'+f+`" onclick="window.open('`+f+`', '_blank'); return false;">Foto 3</a>`:g=" Foto 3 ",d&&d.trim()!==""?m='<a href="'+d+`" onclick="window.open('`+d+`', '_blank'); return false;">Foto 4</a>`:m=" Foto 4 ",Wr.innerHTML='<div style="max-height: 200px; overflow-y: auto;"><p style="font-weight: bold; text-decoration: underline;">'+e.get("name")+"</p><p>Id = "+e.get("bw_id")+" ("+e.get("KTR")+")</p><p>U-Pflicht = "+e.get("upflicht")+"</p><p>Bauj. = "+e.get("baujahr")+"</p><p>"+l+" "+c+" "+g+" "+m+"<br><u>Beschreibung (kurz): </u>"+e.get("beschreib")+"</p><p>"+a+"</p></div>"}if(r==="exp_gew_fla"){t=i.coordinate,gn.setPosition(t);var o=e.get("foto1"),l="",h=e.get("foto2"),c="",f=e.get("foto3"),g="",d=e.get("foto4"),m="";o&&o.trim()!==""?l='<a href="'+o+`" onclick="window.open('`+o+`', '_blank'); return false;">Foto 1</a>`:l=" Foto 1 ",h&&h.trim()!==""?c='<a href="'+h+`" onclick="window.open('`+h+`', '_blank'); return false;">Foto 2</a>`:c=" Foto 2 ",f&&f.trim()!==""?g='<a href="'+f+`" onclick="window.open('`+f+`', '_blank'); return false;">Foto 3</a>`:g=" Foto 3 ",d&&d.trim()!==""?m='<a href="'+d+`" onclick="window.open('`+d+`', '_blank'); return false;">Foto 4</a>`:m=" Foto 4 ",Wr.innerHTML='<div style="max-height: 200px; overflow-y: auto;"><p style="font-weight: bold; text-decoration: underline;">'+e.get("name")+"</p><p>Id = "+e.get("bw_id")+" ("+e.get("KTR")+")</p><p>U-Pflicht = "+e.get("upflicht")+"</p><p>Bauj. = "+e.get("baujahr")+"</p><p>"+l+" "+c+" "+g+" "+m+"<br><u>Beschreibung (kurz): </u>"+e.get("beschreib")+"</p><p>"+a+"</p></div>"}if(r==="sle"){t=i.coordinate,gn.setPosition(t);var y=e.get("rwert"),b=e.get("hwert"),o=e.get("foto1"),l="",h=e.get("foto2"),c="",f=e.get("foto3"),g="",d=e.get("foto4"),m="";o&&o.trim()!==""?l='<a href="'+o+`" onclick="window.open('`+o+`', '_blank'); return false;">Foto 1</a>`:l=" Foto 1 ",h&&h.trim()!==""?c='<a href="'+h+`" onclick="window.open('`+h+`', '_blank'); return false;">Foto 2</a>`:c=" Foto 2 ",f&&f.trim()!==""?g='<a href="'+f+`" onclick="window.open('`+f+`', '_blank'); return false;">Foto 3</a>`:g=" Foto 3 ",d&&d.trim()!==""?m='<a href="'+d+`" onclick="window.open('`+d+`', '_blank'); return false;">Foto 4</a>`:m=" Foto 4 ";let U=M2(y,b,32,!0);Wr.innerHTML='<div style="max-height: 200px; overflow-y: auto;"><p style="font-weight: bold; text-decoration: underline;">'+e.get("name")+"</p><p>Id = "+e.get("bw_id")+" ("+e.get("KTR")+")</p><p>WSP (OW) = "+e.get("WSP_OW")+" m  WSP (UW) = "+e.get("WSP_UW")+` m</p><p><a href="https://www.google.com/maps?q=&layer=c&cbll=${U}&cbp=12,90,0,0,1" target="_blank" rel="noopener noreferrer">streetview</a></p><p>Bauj. = `+e.get("baujahr")+"</p><p>"+l+" "+c+" "+g+" "+m+"<br><u>Beschreibung (kurz): </u>"+e.get("beschreib")+"</p><p>"+a+"</p></div>"}if(r==="weh"){t=i.coordinate,gn.setPosition(t);var o=e.get("foto1"),l="",h=e.get("foto2"),c="",f=e.get("foto3"),g="",d=e.get("foto4"),m="";o&&o.trim()!==""?l='<a href="'+o+`" onclick="window.open('`+o+`', '_blank'); return false;">Foto 1</a>`:l=" Foto 1 ",h&&h.trim()!==""?c='<a href="'+h+`" onclick="window.open('`+h+`', '_blank'); return false;">Foto 2</a>`:c=" Foto 2 ",f&&f.trim()!==""?g='<a href="'+f+`" onclick="window.open('`+f+`', '_blank'); return false;">Foto 3</a>`:g=" Foto 3 ",d&&d.trim()!==""?m='<a href="'+d+`" onclick="window.open('`+d+`', '_blank'); return false;">Foto 4</a>`:m=" Foto 4 ",Wr.innerHTML='<div style="max-height: 200px; overflow-y: auto;"><p style="font-weight: bold; text-decoration: underline;">'+e.get("name")+"</p><p>Id = "+e.get("bw_id")+" ("+e.get("KTR")+")</p><p>WSP1 (OW) = "+e.get("Ziel_OW1")+" m  WSP2 (OW) = "+e.get("Ziel_OW2")+" m</p><p>Bauj. = "+e.get("baujahr")+"</p><p>"+l+" "+c+" "+g+" "+m+"<br><u>Beschreibung (kurz): </u>"+e.get("beschreib")+"</p><p>"+a+"</p></div>"}r==="gehoelz_vec"&&(t=i.coordinate,gn.setPosition(t),Wr.innerHTML='<div style="max-height: 300px; overflow-y: auto;"><p>Gehölzentwicklung<br><br>Bemerk: '+e.get("UMn_Bemerk")+"</p></div>"),r==="fsk"&&(e.get("Art")==="o"||e.get("Art")==="l"?(t=i.coordinate,gn.setPosition(t),Wr.innerHTML='<div style="max-height: 300px; overflow-y: auto;"><p><strong>gemark Flur Flurstück:</strong><br>'+e.get("Suche")+"</p>FSK: "+e.get("fsk")+"</p>FSK(ASL): "+e.get("FSK_ASL")+"</p><p>Eig.(öffentl.): "+e.get("Eig1")+"</p></div>"):(t=i.coordinate,gn.setPosition(t),Wr.innerHTML='<div style="max-height: 300px; overflow-y: auto;"><p><strong>gemark Flur Flurstück:</strong><br>'+e.get("Suche")+"</p>FSK: "+e.get("fsk")+"</p><p>Art (p=privat): "+e.get("Art")+"</p><p>Eig.(privat): "+e.get("Eig1")+"</p></div>"))})}else Pf===!0&&mP(i)});const Xr=new uL({coordinateFormat:$a(6),projection:"EPSG:4326",className:"custom-mouse-position",target:document.getElementById("mouse-position")});Vt.addControl(Xr);const Ya=document.getElementById("projecSelect");Ya.addEventListener("change",function(i){if(Ya.value==="EPSG:3857"){const t=$a(2);Xr.setCoordinateFormat(t),Xr.setProjection(i.target.value)}else if(Ya.value==="EPSG:4326"){const t=$a(6);Xr.setCoordinateFormat(t),Xr.setProjection(i.target.value)}else if(Ya.value==="EPSG:32632"){const t=$a(1);Xr.setCoordinateFormat(t),Xr.setProjection(i.target.value)}});function mP(i){const t=document.getElementById("mouse-position");if(by.checked){const e=document.createElement("div");if(e.className="marker",If=new w1({position:i.coordinate,positioning:"center-center",element:e,stopEvent:!1}),Vt.addOverlay(If),Ya.value==="EPSG:3857"){const n=$a(2),r=[i.coordinate[1],i.coordinate[0]];t.innerHTML=`Coordinates: ${n(r)}`}else if(Ya.value==="EPSG:4326"){const n=$a(6),r=_P(i.coordinate),s=[r[1],r[0]];t.innerHTML=`Coordinates: ${n(s)}`}else if(Ya.value==="EPSG:32632"){const n=$a(1),r=vP(i.coordinate),s=[r[1],r[0]];t.innerHTML=`Coordinates: ${n(s)}`}}}const by=document.getElementById("toggle-checkbox");by.addEventListener("change",function(){this.checked?(document.getElementById("mouse-position").innerHTML="",Vt.removeControl(Xr),Pf=!0):(If&&Vt.removeOverlay(If),Pf=!1,Vt.addControl(Xr))});let If;document.getElementById("hide-button").addEventListener("click",function(){const i=document.querySelector(".controls");i.classList.toggle("hidden");const t=document.getElementById("custom-controls");i.classList.contains("hidden")?(document.getElementById("toggle-checkbox").checked=!1,t.buttonLength.disabled=!0):(Vt.addControl(Xr),t.buttonLength.disabled=!1)});function _P(i){return ba(i,Vt.getView().getProjection(),"EPSG:4326")}function vP(i){return ba(i,"EPSG:3857","EPSG:32632")}document.addEventListener("DOMContentLoaded",function(){var i=document.getElementById("popup"),t=i.id;console.log(t);var e=document.getElementById("popup-closer"),n=document.createElement("div"),r=document.createElement("a");console.log(i),r.textContent="Weitere Infos";let s=52.458365,a=7.067449;r.addEventListener("click",function(o){o.preventDefault(),yP(s,a)}),n.appendChild(r),n.appendChild(e),i.appendChild(n)});function yP(i,t){var e=`https://www.google.com/maps?q=${i},${t}&layer=c&cbll=${i},${t}&cbp=12,90,0,0,1`;window.open(e,"_blank")}document.getElementById("popup-closer").onclick=function(){return gn.setPosition(void 0),!1};const xP={a0:[1189,841],a1:[841,594],a2:[594,420],a3:[420,297],a4:[297,210],a5:[210,148]};document.getElementById("print-button").addEventListener("click",function(){alert("Erstmal bitte nur mit OSM als Hintergrund"),document.body.style.cursor="progress";const i="a4",t="72",e=xP[i],n=Math.round(e[0]*t/25.4),r=Math.round(e[1]*t/25.4),s=Vt.getSize(),a=Vt.getView().getResolution();Vt.once("rendercomplete",function(){const h=document.createElement("canvas");h.width=n,h.height=r;const c=h.getContext("2d");Array.prototype.forEach.call(document.querySelectorAll(".ol-layer canvas"),function(g){if(g.width>0){const d=g.parentNode.style.opacity;c.globalAlpha=d===""?1:Number(d);const y=g.style.transform.match(/^matrix\(([^\(]*)\)$/)[1].split(",").map(Number);CanvasRenderingContext2D.prototype.setTransform.apply(c,y),c.drawImage(g,0,0)}}),c.globalAlpha=1,c.setTransform(1,0,0,1,0,0);const f=new re("landscape",void 0,i);f.addImage(h.toDataURL("image/jpeg"),"JPEG",0,0,e[0],e[1]),f.save("map.pdf"),Vt.setSize(s),Vt.getView().setResolution(a),document.getElementById("print-button").disabled=!1,document.body.style.cursor="auto"});const o=[n,r];Vt.setSize(o);const l=Math.min(n/s[0],r/s[1]);Vt.getView().setResolution(a/l)},!1);var cc=new li({source:new mi,style:new Fe({image:new Ta({radius:5,stroke:new si({color:"rgb(255,165,0)",width:3}),fill:new bi({color:"rgba(255,165,0,.3)"})}),stroke:new si({color:"rgb(255,165,0)",width:3}),fill:new bi({color:"rgba(255,165,0,.3)"})})});Vt.addLayer(cc);var wy=new oT({lang:"de",polygon:$("#polygon").prop("checked"),reverse:!0,position:!0});Vt.addControl(wy);wy.on("select",function(i){if(cc.getSource().clear(),i.search.geojson){var t=new pi,e=t.readFeature(i.search.geojson,{dataProjection:"EPSG:4326",featureProjection:Vt.getView().getProjection()});cc.getSource().addFeature(e);var n=Vt.getView(),r=n.getResolutionForExtent(e.getGeometry().getExtent(),Vt.getSize()),s=n.getZoomForResolution(r),a=ol.extent.getCenter(e.getGeometry().getExtent());setTimeout(function(){n.animate({center:a,zoom:Math.min(s,16)})},100)}else Vt.getView().animate({center:i.coordinate,zoom:Math.max(Vt.getView().getZoom(),16)});bP(i.coordinate)});function bP(i){var t=new lr({geometry:new Ir(i)}),e=new Fe({image:new Bn({src:"data/marker.svg"})});t.setStyle(e),cc.getSource().clear(),cc.getSource().addFeature(t)}var qu="",$u=null,wP=new X1({toggleOne:!0,controls:[new E2({html:"2.1",handleClick:function(){$u?($u.setStyle(null),$u=null):(qu=prompt("Bitte geben Sie einen Text ein:",""),console.log("Eingegebener Text:",qu),qu&&highlightFeature(qu))}}),new E2({html:"2.2",handleClick:function(){}})]});document.addEventListener("DOMContentLoaded",function(){const i=`
      <div class="modal-overlay" id="modalOverlay"></div>
      <div class="modal" id="customPrompt" style="display: none;">
          <div class="modal-content">
              <p>Wählen Sie ein Suchattribut:</p>
              <label><input type="radio" name="searchAttribute" value="Suche" checked> Fsk-Kennz.</label>
              <label><input type="radio" name="searchAttribute" value="fsk"> FSK-ID</label>

              <p>Geben Sie einen Suchtext ein:</p>
              <input type="text" id="searchInput">

              <button id="confirmButton">Suchen</button>
              <button id="cancelButton">Abbrechen</button>
          </div>
      </div>
  `;document.getElementById("modalContainer").innerHTML=i;var t="Suche",e="";document.getElementById("confirmButton").addEventListener("click",r),document.getElementById("cancelButton").addEventListener("click",n),window.openCustomPrompt=function(){document.getElementById("modalOverlay").style.display="block",document.getElementById("customPrompt").style.display="block"};function n(){document.getElementById("modalOverlay").style.display="none",document.getElementById("customPrompt").style.display="none"}function r(){const a=document.querySelector('input[name="searchAttribute"]:checked');t=a?a.value:"Suche",e=document.getElementById("searchInput").value,n(),e.trim()!==""?s(e,t):alert("Bitte geben Sie einen Text ein!")}function s(a,o){const h=_y.getSource().getFeatures();let c=!1;h.some(f=>f.get(o)===a?(f.setStyle(EP),Vt.getView().fit(f.getGeometry().getExtent(),{duration:1e3}),$u=f,c=!0,!0):!1),c||alert("Kein passendes Flurstück gefunden! Layer FSK angeschaltet und gezoomt?")}});const EP=new Fe({stroke:new si({color:"red",width:3}),fill:new bi({color:"rgba(255, 0, 0, 0.3)"})});var SP=new X1({toggleOne:!0,controls:[new Tf({html:"P",onToggle:function(){zu?(navigator.geolocation.clearWatch(zu),zu=null,Yo&&(Vt.removeLayer(Yo),Yo=null)):zu=navigator.geolocation.watchPosition(function(i){const t=[i.coords.longitude,i.coords.latitude],e=px(t,i.coords.accuracy);Gu.clear(!0),Gu.addFeatures([new lr(e.transform("EPSG:4326",Vt.getView().getProjection())),new lr(new Ir(H2(t)))]),S2&&(Vt.getView().fit(Gu.getExtent(),{maxZoom:13,duration:500}),S2=!1),Yo||(Yo=new li({displayInLayerSwitcher:!1,style:new Fe({image:new Ta({radius:8,opacity:.5,fill:new bi({color:"red"}),stroke:new si({color:"black",width:2})})}),source:Gu,title:"Null",name:"Null",zIndex:9999}),Vt.addLayer(Yo))},function(i){alert(`ERROR: ${i.message}`)},{enableHighAccuracy:!0})}}),new Tf({html:"2",onToggle:function(i){},bar:wP})]}),Ey=new X1({controls:[new Tf({html:"H",bar:SP,onToggle:function(){}})]});Vt.addControl(Ey);Ey.setPosition("left");document.addEventListener("DOMContentLoaded",function(){initializeWMS(H1,Vt)});function M2(i,t,e,n){const s=.081819191,a=.9996,o=Math.PI;n||(t-=1e7);let l=(e-1)*6-180+3,h=t/a,c=(1-Math.sqrt(1-s**2))/(1+Math.sqrt(1-s**2)),f=h/(6378137*(1-s**2/4-3*s**4/64-5*s**6/256)),g=f+(3*c/2-27*c**3/32)*Math.sin(2*f)+(21*c**2/16-55*c**4/32)*Math.sin(4*f)+151*c**3/96*Math.sin(6*f),d=6378137/Math.sqrt(1-s**2*Math.sin(g)**2),m=Math.tan(g)**2,y=s**2*Math.cos(g)**2/(1-s**2),b=6378137*(1-s**2)/Math.pow(1-s**2*Math.sin(g)**2,1.5),x=(i-5e5)/(d*a),E=(g-d*Math.tan(g)/b*(x**2/2-(5+3*m+10*y-4*y**2-9*s**2)*x**4/24+(61+90*m+298*y+45*m**2-252*s**2-3*y**2)*x**6/720))*180/o,S=l+(x-(1+2*m+y)*x**3/6+(5-2*y+28*m-3*y**2+8*s**2+24*m**2)*x**5/120)/Math.cos(g)*180/o;return`${E.toFixed(6)},${S.toFixed(6)}`}export{Xe as _,MP as c,Tx as g};
//# sourceMappingURL=index-BLD01_uB.js.map
